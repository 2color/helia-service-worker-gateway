diff --git a/node_modules/helia/dist/dist/index.min.js b/node_modules/helia/dist/dist/index.min.js
new file mode 100644
index 0000000..4226b25
--- /dev/null
+++ b/node_modules/helia/dist/dist/index.min.js
@@ -0,0 +1,3 @@
+(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Helia = factory()}(typeof self !== 'undefined' ? self : this, function () {
+"use strict";var Helia=(()=>{var Ku=Object.create;var gr=Object.defineProperty;var Xu=Object.getOwnPropertyDescriptor;var Ju=Object.getOwnPropertyNames;var Zu=Object.getPrototypeOf,Yu=Object.prototype.hasOwnProperty;var S=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),V=(r,e)=>{for(var t in e)gr(r,t,{get:e[t],enumerable:!0})},xo=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ju(e))!Yu.call(r,i)&&i!==t&&gr(r,i,{get:()=>e[i],enumerable:!(n=Xu(e,i))||n.enumerable});return r};var U=(r,e,t)=>(t=r!=null?Ku(Zu(r)):{},xo(e||!r||!r.__esModule?gr(t,"default",{value:r,enumerable:!0}):t,r)),el=r=>xo(gr({},"__esModule",{value:!0}),r);var Ho=S((bp,Wo)=>{Wo.exports=$o;var zo=128,zl=127,$l=~zl,Wl=Math.pow(2,31);function $o(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Wl;)e[t++]=r&255|zo,r/=128;for(;r&$l;)e[t++]=r&255|zo,r>>>=7;return e[t]=r|0,$o.bytes=t-n+1,e}});var jo=S((_p,Vo)=>{Vo.exports=jn;var Hl=128,qo=127;function jn(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw jn.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&qo)<<i:(s&qo)*Math.pow(2,i),i+=7}while(s>=Hl);return jn.bytes=o-n,t}});var Qo=S((vp,Go)=>{var ql=Math.pow(2,7),Vl=Math.pow(2,14),jl=Math.pow(2,21),Gl=Math.pow(2,28),Ql=Math.pow(2,35),Kl=Math.pow(2,42),Xl=Math.pow(2,49),Jl=Math.pow(2,56),Zl=Math.pow(2,63);Go.exports=function(r){return r<ql?1:r<Vl?2:r<jl?3:r<Gl?4:r<Ql?5:r<Kl?6:r<Xl?7:r<Jl?8:r<Zl?9:10}});var Xo=S((xp,Ko)=>{Ko.exports={encode:Ho(),decode:jo(),encodingLength:Qo()}});var Yo=S((kp,Zo)=>{"use strict";var Jo=Xo();Zo.exports=r=>{if(!(r instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;r.length>0;){let t=Jo.decode(r);e.push(t),r=r.slice(Jo.decode.bytes)}return e}});var rs=S((Ep,ts)=>{ts.exports=Gn;var es=128,Yl=127,ef=~Yl,tf=Math.pow(2,31);function Gn(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw Gn.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var n=t;r>=tf;)e[t++]=r&255|es,r/=128;for(;r&ef;)e[t++]=r&255|es,r>>>=7;return e[t]=r|0,Gn.bytes=t-n+1,e}});var os=S((Sp,is)=>{is.exports=Qn;var rf=128,ns=127;function Qn(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a||i>49)throw Qn.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&ns)<<i:(s&ns)*Math.pow(2,i),i+=7}while(s>=rf);return Qn.bytes=o-n,t}});var as=S((Tp,ss)=>{var nf=Math.pow(2,7),of=Math.pow(2,14),sf=Math.pow(2,21),af=Math.pow(2,28),cf=Math.pow(2,35),uf=Math.pow(2,42),lf=Math.pow(2,49),ff=Math.pow(2,56),hf=Math.pow(2,63);ss.exports=function(r){return r<nf?1:r<of?2:r<sf?3:r<af?4:r<cf?5:r<uf?6:r<lf?7:r<ff?8:r<hf?9:10}});var us=S((Ap,cs)=>{cs.exports={encode:rs(),decode:os(),encodingLength:as()}});var hs=S((Cp,fs)=>{var mt=1e3,yt=mt*60,gt=yt*60,Ge=gt*24,pf=Ge*7,mf=Ge*365.25;fs.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return yf(r);if(t==="number"&&isFinite(r))return e.long?wf(r):gf(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function yf(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*mf;case"weeks":case"week":case"w":return t*pf;case"days":case"day":case"d":return t*Ge;case"hours":case"hour":case"hrs":case"hr":case"h":return t*gt;case"minutes":case"minute":case"mins":case"min":case"m":return t*yt;case"seconds":case"second":case"secs":case"sec":case"s":return t*mt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function gf(r){var e=Math.abs(r);return e>=Ge?Math.round(r/Ge)+"d":e>=gt?Math.round(r/gt)+"h":e>=yt?Math.round(r/yt)+"m":e>=mt?Math.round(r/mt)+"s":r+"ms"}function wf(r){var e=Math.abs(r);return e>=Ge?_r(r,e,Ge,"day"):e>=gt?_r(r,e,gt,"hour"):e>=yt?_r(r,e,yt,"minute"):e>=mt?_r(r,e,mt,"second"):r+" ms"}function _r(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}});var ps=S((Lp,ds)=>{function bf(r){t.debug=t,t.default=t,t.coerce=c,t.disable=o,t.enable=i,t.enabled=s,t.humanize=hs(),t.destroy=u,Object.keys(r).forEach(l=>{t[l]=r[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let h=0;for(let d=0;d<l.length;d++)h=(h<<5)-h+l.charCodeAt(d),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(l){let h,d=null,v,y;function g(...k){if(!g.enabled)return;let I=g,O=Number(new Date),ne=O-(h||O);I.diff=ne,I.prev=h,I.curr=O,h=O,k[0]=t.coerce(k[0]),typeof k[0]!="string"&&k.unshift("%O");let $=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,(ie,Q)=>{if(ie==="%%")return"%";$++;let oe=t.formatters[Q];if(typeof oe=="function"){let ut=k[$];ie=oe.call(I,ut),k.splice($,1),$--}return ie}),t.formatArgs.call(I,k),(I.log||t.log).apply(I,k)}return g.namespace=l,g.useColors=t.useColors(),g.color=t.selectColor(l),g.extend=n,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(v!==t.namespaces&&(v=t.namespaces,y=t.enabled(l)),y),set:k=>{d=k}}),typeof t.init=="function"&&t.init(g),g}function n(l,h){let d=t(this.namespace+(typeof h>"u"?":":h)+l);return d.log=this.log,d}function i(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let h,d=(typeof l=="string"?l:"").split(/[\s,]+/),v=d.length;for(h=0;h<v;h++)d[h]&&(l=d[h].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.slice(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function o(){let l=[...t.names.map(a),...t.skips.map(a).map(h=>"-"+h)].join(",");return t.enable(""),l}function s(l){if(l[l.length-1]==="*")return!0;let h,d;for(h=0,d=t.skips.length;h<d;h++)if(t.skips[h].test(l))return!1;for(h=0,d=t.names.length;h<d;h++)if(t.names[h].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}ds.exports=bf});var ms=S((K,vr)=>{K.formatArgs=vf;K.save=xf;K.load=kf;K.useColors=_f;K.storage=Ef();K.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();K.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function _f(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function vf(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+vr.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(n=t))}),r.splice(n,0,e)}K.log=console.debug||console.log||(()=>{});function xf(r){try{r?K.storage.setItem("debug",r):K.storage.removeItem("debug")}catch{}}function kf(){let r;try{r=K.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function Ef(){try{return localStorage}catch{}}vr.exports=ps()(K);var{formatters:Sf}=vr.exports;Sf.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var gs=S((jp,ys)=>{"use strict";ys.exports=Lf;function Lf(r,e){for(var t=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)t[n++]=arguments[i++];return new Promise(function(a,c){t[n]=function(l){if(o)if(o=!1,l)c(l);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];a.apply(null,h)}};try{r.apply(e||null,t)}catch(u){o&&(o=!1,c(u))}})}});var vs=S(_s=>{"use strict";var kr=_s;kr.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&e.charAt(t)==="=";)++n;return Math.ceil(e.length*3)/4-n};var bt=new Array(64),bs=new Array(123);for(he=0;he<64;)bs[bt[he]=he<26?he+65:he<52?he+71:he<62?he-4:he-59|43]=he++;var he;kr.encode=function(e,t,n){for(var i=null,o=[],s=0,a=0,c;t<n;){var u=e[t++];switch(a){case 0:o[s++]=bt[u>>2],c=(u&3)<<4,a=1;break;case 1:o[s++]=bt[c|u>>4],c=(u&15)<<2,a=2;break;case 2:o[s++]=bt[c|u>>6],o[s++]=bt[u&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=bt[c],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var ws="invalid encoding";kr.decode=function(e,t,n){for(var i=n,o=0,s,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&o>1)break;if((c=bs[c])===void 0)throw Error(ws);switch(o){case 0:s=c,o=1;break;case 1:t[n++]=s<<2|(c&48)>>4,s=c,o=2;break;case 2:t[n++]=(s&15)<<4|(c&60)>>2,s=c,o=3;break;case 3:t[n++]=(s&3)<<6|c,o=0;break}}if(o===1)throw Error(ws);return n-i};kr.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var ks=S((Qp,xs)=>{"use strict";xs.exports=Er;function Er(){this._listeners={}}Er.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this};Er.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this};Er.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}});var Ls=S((Kp,Cs)=>{"use strict";Cs.exports=Es(Es);function Es(r){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),n=t[3]===128;function i(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3]}function o(c,u,l){e[0]=c,u[l]=t[3],u[l+1]=t[2],u[l+2]=t[1],u[l+3]=t[0]}r.writeFloatLE=n?i:o,r.writeFloatBE=n?o:i;function s(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],e[0]}function a(c,u){return t[3]=c[u],t[2]=c[u+1],t[1]=c[u+2],t[0]=c[u+3],e[0]}r.readFloatLE=n?s:a,r.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,o,s)}}r.writeFloatLE=e.bind(null,Ss),r.writeFloatBE=e.bind(null,Ts);function t(n,i,o){var s=n(i,o),a=(s>>31)*2+1,c=s>>>23&255,u=s&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}r.readFloatLE=t.bind(null,As),r.readFloatBE=t.bind(null,Bs)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),n=t[7]===128;function i(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3],u[l+4]=t[4],u[l+5]=t[5],u[l+6]=t[6],u[l+7]=t[7]}function o(c,u,l){e[0]=c,u[l]=t[7],u[l+1]=t[6],u[l+2]=t[5],u[l+3]=t[4],u[l+4]=t[3],u[l+5]=t[2],u[l+6]=t[1],u[l+7]=t[0]}r.writeDoubleLE=n?i:o,r.writeDoubleBE=n?o:i;function s(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],t[4]=c[u+4],t[5]=c[u+5],t[6]=c[u+6],t[7]=c[u+7],e[0]}function a(c,u){return t[7]=c[u],t[6]=c[u+1],t[5]=c[u+2],t[4]=c[u+3],t[3]=c[u+4],t[2]=c[u+5],t[1]=c[u+6],t[0]=c[u+7],e[0]}r.readDoubleLE=n?s:a,r.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,c){var u=s<0?1:0;if(u&&(s=-s),s===0)n(0,a,c+i),n(1/s>0?0:2147483648,a,c+o);else if(isNaN(s))n(0,a,c+i),n(2146959360,a,c+o);else if(s>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+o);else{var l;if(s<22250738585072014e-324)l=s/5e-324,n(l>>>0,a,c+i),n((u<<31|l/4294967296)>>>0,a,c+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),l=s*Math.pow(2,-h),n(l*4503599627370496>>>0,a,c+i),n((u<<31|h+1023<<20|l*1048576&1048575)>>>0,a,c+o)}}}r.writeDoubleLE=e.bind(null,Ss,0,4),r.writeDoubleBE=e.bind(null,Ts,4,0);function t(n,i,o,s,a){var c=n(s,a+i),u=n(s,a+o),l=(u>>31)*2+1,h=u>>>20&2047,d=4294967296*(u&1048575)+c;return h===2047?d?NaN:l*(1/0):h===0?l*5e-324*d:l*Math.pow(2,h-1075)*(d+4503599627370496)}r.readDoubleLE=t.bind(null,As,0,4),r.readDoubleBE=t.bind(null,Bs,4,0)}(),r}function Ss(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function Ts(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function As(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function Bs(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var Ps=S((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Ns=S(Is=>{"use strict";var Xn=Is;Xn.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?t+=1:n<2048?t+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};Xn.read=function(e,t,n){var i=n-t;if(i<1)return"";for(var o=null,s=[],a=0,c;t<n;)c=e[t++],c<128?s[a++]=c:c>191&&c<224?s[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[a++]=55296+(c>>10),s[a++]=56320+(c&1023)):s[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Xn.write=function(e,t,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128);return n-i}});var Ms=S((Jp,Ds)=>{"use strict";Ds.exports=Pf;function Pf(r,e,t){var n=t||8192,i=n>>>1,o=null,s=n;return function(c){if(c<1||c>i)return r(c);s+c>n&&(o=r(n),s=0);var u=e.call(o,s,s+=c);return s&7&&(s=(s|7)+1),u}}});var Os=S((Zp,Fs)=>{"use strict";Fs.exports=R;var Ht=Je();function R(r,e){this.lo=r>>>0,this.hi=e>>>0}var Xe=R.zero=new R(0,0);Xe.toNumber=function(){return 0};Xe.zzEncode=Xe.zzDecode=function(){return this};Xe.length=function(){return 1};var If=R.zeroHash="\0\0\0\0\0\0\0\0";R.fromNumber=function(e){if(e===0)return Xe;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new R(n,i)};R.from=function(e){if(typeof e=="number")return R.fromNumber(e);if(Ht.isString(e))if(Ht.Long)e=Ht.Long.fromString(e);else return R.fromNumber(parseInt(e,10));return e.low||e.high?new R(e.low>>>0,e.high>>>0):Xe};R.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+n*4294967296)}return this.lo+this.hi*4294967296};R.prototype.toLong=function(e){return Ht.Long?new Ht.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Me=String.prototype.charCodeAt;R.fromHash=function(e){return e===If?Xe:new R((Me.call(e,0)|Me.call(e,1)<<8|Me.call(e,2)<<16|Me.call(e,3)<<24)>>>0,(Me.call(e,4)|Me.call(e,5)<<8|Me.call(e,6)<<16|Me.call(e,7)<<24)>>>0)};R.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};R.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};R.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};R.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}});var Je=S(Jn=>{"use strict";var _=Jn;_.asPromise=gs();_.base64=vs();_.EventEmitter=ks();_.float=Ls();_.inquire=Ps();_.utf8=Ns();_.pool=Ms();_.LongBits=Os();_.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);_.global=_.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Jn;_.emptyArray=Object.freeze?Object.freeze([]):[];_.emptyObject=Object.freeze?Object.freeze({}):{};_.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};_.isString=function(e){return typeof e=="string"||e instanceof String};_.isObject=function(e){return e&&typeof e=="object"};_.isset=_.isSet=function(e,t){var n=e[t];return n!=null&&e.hasOwnProperty(t)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};_.Buffer=function(){try{var r=_.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();_._Buffer_from=null;_._Buffer_allocUnsafe=null;_.newBuffer=function(e){return typeof e=="number"?_.Buffer?_._Buffer_allocUnsafe(e):new _.Array(e):_.Buffer?_._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};_.Array=typeof Uint8Array<"u"?Uint8Array:Array;_.Long=_.global.dcodeIO&&_.global.dcodeIO.Long||_.global.Long||_.inquire("long");_.key2Re=/^true|false|0|1$/;_.key32Re=/^-?(?:0|[1-9][0-9]*)$/;_.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;_.longToHash=function(e){return e?_.LongBits.from(e).toHash():_.LongBits.zeroHash};_.longFromHash=function(e,t){var n=_.LongBits.fromHash(e);return _.Long?_.Long.fromBits(n.lo,n.hi,t):n.toNumber(!!t)};function Us(r,e,t){for(var n=Object.keys(e),i=0;i<n.length;++i)(r[n[i]]===void 0||!t)&&(r[n[i]]=e[n[i]]);return r}_.merge=Us;_.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Rs(r){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Us(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}_.newError=Rs;_.ProtocolError=Rs("ProtocolError");_.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(t[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};_.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}};_.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};_._configure=function(){var r=_.Buffer;if(!r){_._Buffer_from=_._Buffer_allocUnsafe=null;return}_._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,n){return new r(t,n)},_._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var ei=S((em,qs)=>{"use strict";qs.exports=M;var we=Je(),Yn,Ws=we.LongBits,Nf=we.utf8;function de(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function M(r){this.buf=r,this.pos=0,this.len=r.length}var zs=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new M(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new M(e);throw Error("illegal buffer")},Hs=function(){return we.Buffer?function(t){return(M.create=function(i){return we.Buffer.isBuffer(i)?new Yn(i):zs(i)})(t)}:zs};M.create=Hs();M.prototype._slice=we.Array.prototype.subarray||we.Array.prototype.slice;M.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,de(this,10);return e}}();M.prototype.int32=function(){return this.uint32()|0};M.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Zn(){var r=new Ws(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw de(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw de(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}M.prototype.bool=function(){return this.uint32()!==0};function Sr(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}M.prototype.fixed32=function(){if(this.pos+4>this.len)throw de(this,4);return Sr(this.buf,this.pos+=4)};M.prototype.sfixed32=function(){if(this.pos+4>this.len)throw de(this,4);return Sr(this.buf,this.pos+=4)|0};function $s(){if(this.pos+8>this.len)throw de(this,8);return new Ws(Sr(this.buf,this.pos+=4),Sr(this.buf,this.pos+=4))}M.prototype.float=function(){if(this.pos+4>this.len)throw de(this,4);var e=we.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};M.prototype.double=function(){if(this.pos+8>this.len)throw de(this,4);var e=we.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};M.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw de(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)};M.prototype.string=function(){var e=this.bytes();return Nf.read(e,0,e.length)};M.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw de(this,e);this.pos+=e}else do if(this.pos>=this.len)throw de(this);while(this.buf[this.pos++]&128);return this};M.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};M._configure=function(r){Yn=r,M.create=Hs(),Yn._configure();var e=we.Long?"toLong":"toNumber";we.merge(M.prototype,{int64:function(){return Zn.call(this)[e](!1)},uint64:function(){return Zn.call(this)[e](!0)},sint64:function(){return Zn.call(this).zzDecode()[e](!1)},fixed64:function(){return $s.call(this)[e](!0)},sfixed64:function(){return $s.call(this)[e](!1)}})}});var Qs=S((tm,Gs)=>{"use strict";Gs.exports=Ze;var js=ei();(Ze.prototype=Object.create(js.prototype)).constructor=Ze;var Vs=Je();function Ze(r){js.call(this,r)}Ze._configure=function(){Vs.Buffer&&(Ze.prototype._slice=Vs.Buffer.prototype.slice)};Ze.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ze._configure()});var ai=S((rm,Zs)=>{"use strict";Zs.exports=T;var ce=Je(),ti,Tr=ce.LongBits,Ks=ce.base64,Xs=ce.utf8;function qt(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function ni(){}function Df(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function T(){this.len=0,this.head=new qt(ni,0,0),this.tail=this.head,this.states=null}var Js=function(){return ce.Buffer?function(){return(T.create=function(){return new ti})()}:function(){return new T}};T.create=Js();T.alloc=function(e){return new ce.Array(e)};ce.Array!==Array&&(T.alloc=ce.pool(T.alloc,ce.Array.prototype.subarray));T.prototype._push=function(e,t,n){return this.tail=this.tail.next=new qt(e,t,n),this.len+=t,this};function ii(r,e,t){e[t]=r&255}function Mf(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function oi(r,e){this.len=r,this.next=void 0,this.val=e}oi.prototype=Object.create(qt.prototype);oi.prototype.fn=Mf;T.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new oi((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};T.prototype.int32=function(e){return e<0?this._push(si,10,Tr.fromNumber(e)):this.uint32(e)};T.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function si(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}T.prototype.uint64=function(e){var t=Tr.from(e);return this._push(si,t.length(),t)};T.prototype.int64=T.prototype.uint64;T.prototype.sint64=function(e){var t=Tr.from(e).zzEncode();return this._push(si,t.length(),t)};T.prototype.bool=function(e){return this._push(ii,1,e?1:0)};function ri(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}T.prototype.fixed32=function(e){return this._push(ri,4,e>>>0)};T.prototype.sfixed32=T.prototype.fixed32;T.prototype.fixed64=function(e){var t=Tr.from(e);return this._push(ri,4,t.lo)._push(ri,4,t.hi)};T.prototype.sfixed64=T.prototype.fixed64;T.prototype.float=function(e){return this._push(ce.float.writeFloatLE,4,e)};T.prototype.double=function(e){return this._push(ce.float.writeDoubleLE,8,e)};var Ff=ce.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};T.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(ii,1,0);if(ce.isString(e)){var n=T.alloc(t=Ks.length(e));Ks.decode(e,n,0),e=n}return this.uint32(t)._push(Ff,t,e)};T.prototype.string=function(e){var t=Xs.length(e);return t?this.uint32(t)._push(Xs.write,t,e):this._push(ii,1,0)};T.prototype.fork=function(){return this.states=new Df(this),this.head=this.tail=new qt(ni,0,0),this.len=0,this};T.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new qt(ni,0,0),this.len=0),this};T.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this};T.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t};T._configure=function(r){ti=r,T.create=Js(),ti._configure()}});var ta=S((nm,ea)=>{"use strict";ea.exports=be;var Ys=ai();(be.prototype=Object.create(Ys.prototype)).constructor=be;var Fe=Je();function be(){Ys.call(this)}be._configure=function(){be.alloc=Fe._Buffer_allocUnsafe,be.writeBytesBuffer=Fe.Buffer&&Fe.Buffer.prototype instanceof Uint8Array&&Fe.Buffer.prototype.set.name==="set"?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}};be.prototype.bytes=function(e){Fe.isString(e)&&(e=Fe._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(be.writeBytesBuffer,t,e),this};function Of(r,e,t){r.length<40?Fe.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}be.prototype.string=function(e){var t=Fe.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Of,t,e),this};be._configure()});var Or=S((by,ya)=>{"use strict";function ma(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Yf(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return ma(r,t)}catch{t.message=r.message,t.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),ma(new i,t)}}ya.exports=Yf});var xa=S((Oy,va)=>{"use strict";va.exports=function(){return Date.now()}});var Ea=S((Uy,ka)=>{"use strict";var zr=xa(),_i=class{constructor(e,t,n){let i=this;this._started=zr(),this._rescheduled=0,this._scheduled=t,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(zr()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=zr();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=zr(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function ch(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new _i(arguments[0],arguments[1],r)}ka.exports=ch});var Aa=S((Ry,Ta)=>{"use strict";var{AbortController:uh}=globalThis,Sa=Ea(),jt=class extends uh{constructor(e){super(),this._ms=e,this._timer=Sa(()=>this.abort(),e),Object.setPrototypeOf(this,jt.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=Sa(()=>this.abort(),this._ms)}};Ta.exports={TimeoutController:jt}});var Qr=S((kg,Ti)=>{"use strict";var Tt=typeof Reflect=="object"?Reflect:null,Na=Tt&&typeof Tt.apply=="function"?Tt.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},jr;Tt&&typeof Tt.ownKeys=="function"?jr=Tt.ownKeys:Object.getOwnPropertySymbols?jr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:jr=function(e){return Object.getOwnPropertyNames(e)};function Eh(r){console&&console.warn&&console.warn(r)}var Ma=Number.isNaN||function(e){return e!==e};function L(){L.init.call(this)}Ti.exports=L;Ti.exports.once=Bh;L.EventEmitter=L;L.prototype._events=void 0;L.prototype._eventsCount=0;L.prototype._maxListeners=void 0;var Da=10;function Gr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(L,"defaultMaxListeners",{enumerable:!0,get:function(){return Da},set:function(r){if(typeof r!="number"||r<0||Ma(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Da=r}});L.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};L.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Ma(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Fa(r){return r._maxListeners===void 0?L.defaultMaxListeners:r._maxListeners}L.prototype.getMaxListeners=function(){return Fa(this)};L.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")Na(c,this,t);else for(var u=c.length,l=$a(c,u),n=0;n<u;++n)Na(l[n],this,t);return!0};function Oa(r,e,t,n){var i,o,s;if(Gr(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=Fa(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,Eh(a)}return r}L.prototype.addListener=function(e,t){return Oa(this,e,t,!1)};L.prototype.on=L.prototype.addListener;L.prototype.prependListener=function(e,t){return Oa(this,e,t,!0)};function Sh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ua(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Sh.bind(n);return i.listener=t,n.wrapFn=i,i}L.prototype.once=function(e,t){return Gr(t),this.on(e,Ua(this,e,t)),this};L.prototype.prependOnceListener=function(e,t){return Gr(t),this.prependListener(e,Ua(this,e,t)),this};L.prototype.removeListener=function(e,t){var n,i,o,s,a;if(Gr(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():Th(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};L.prototype.off=L.prototype.removeListener;L.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Ra(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Ah(i):$a(i,i.length)}L.prototype.listeners=function(e){return Ra(this,e,!0)};L.prototype.rawListeners=function(e){return Ra(this,e,!1)};L.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):za.call(r,e)};L.prototype.listenerCount=za;function za(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}L.prototype.eventNames=function(){return this._eventsCount>0?jr(this._events):[]};function $a(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Th(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ah(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Bh(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Wa(r,e,o,{once:!0}),e!=="error"&&Ch(r,i,{once:!0})})}function Ch(r,e,t){typeof r.on=="function"&&Wa(r,"error",e,t)}function Wa(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var Ja=S((Ka,Xa)=>{"use strict";var qh=Math.exp;Ka=Xa.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,n=0,i=0,o=0,s,a={};function c(u,l){return 1-qh(-(u-l)/e)}return a.push=function(l,h){if(s){let d=c(l,s),v=h-t,y=d*v;t=d*h+(1-d)*t,n=(1-d)*(n+v*y),i=Math.sqrt(n),o=t+d*v}else t=h;s=l},a.movingAverage=function(){return t},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return o},a}});var rc=S((ew,Ui)=>{function tc(r){let e=new globalThis.AbortController;function t(){e.abort();for(let n of r)!n||!n.removeEventListener||n.removeEventListener("abort",t)}for(let n of r)if(!(!n||!n.addEventListener)){if(n.aborted){t();break}n.addEventListener("abort",t)}return e.signal}Ui.exports=tc;Ui.exports.anySignal=tc});var sc=S((yw,Ri)=>{"use strict";var Zh=Object.prototype.hasOwnProperty,q="~";function Zt(){}Object.create&&(Zt.prototype=Object.create(null),new Zt().__proto__||(q=!1));function Yh(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function oc(r,e,t,n,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new Yh(t,n||r,i),s=q?q+e:e;return r._events[s]?r._events[s].fn?r._events[s]=[r._events[s],o]:r._events[s].push(o):(r._events[s]=o,r._eventsCount++),r}function en(r,e){--r._eventsCount===0?r._events=new Zt:delete r._events[e]}function H(){this._events=new Zt,this._eventsCount=0}H.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)Zh.call(t,n)&&e.push(q?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};H.prototype.listeners=function(e){var t=q?q+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s};H.prototype.listenerCount=function(e){var t=q?q+e:e,n=this._events[t];return n?n.fn?1:n.length:0};H.prototype.emit=function(e,t,n,i,o,s){var a=q?q+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,s),!0}for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var d=c.length,v;for(h=0;h<d;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,n);break;case 4:c[h].fn.call(c[h].context,t,n,i);break;default:if(!l)for(v=1,l=new Array(u-1);v<u;v++)l[v-1]=arguments[v];c[h].fn.apply(c[h].context,l)}}return!0};H.prototype.on=function(e,t,n){return oc(this,e,t,n,!1)};H.prototype.once=function(e,t,n){return oc(this,e,t,n,!0)};H.prototype.removeListener=function(e,t,n,i){var o=q?q+e:e;if(!this._events[o])return this;if(!t)return en(this,o),this;var s=this._events[o];if(s.fn)s.fn===t&&(!i||s.once)&&(!n||s.context===n)&&en(this,o);else{for(var a=0,c=[],u=s.length;a<u;a++)(s[a].fn!==t||i&&!s[a].once||n&&s[a].context!==n)&&c.push(s[a]);c.length?this._events[o]=c.length===1?c[0]:c:en(this,o)}return this};H.prototype.removeAllListeners=function(e){var t;return e?(t=q?q+e:e,this._events[t]&&en(this,t)):(this._events=new Zt,this._eventsCount=0),this};H.prototype.off=H.prototype.removeListener;H.prototype.addListener=H.prototype.on;H.prefixed=q;H.EventEmitter=H;typeof Ri<"u"&&(Ri.exports=H)});var ep={};V(ep,{createHelia:()=>Yd});var Dn={};V(Dn,{identity:()=>Nn});var rp=new Uint8Array(0);var ko=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},ke=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var Eo=r=>new TextEncoder().encode(r),So=r=>new TextDecoder().decode(r);var tl=Co,Ao=128,rl=127,nl=~rl,il=Math.pow(2,31);function Co(r,e,t){e=e||[],t=t||0;for(var n=t;r>=il;)e[t++]=r&255|Ao,r/=128;for(;r&nl;)e[t++]=r&255|Ao,r>>>=7;return e[t]=r|0,Co.bytes=t-n+1,e}var ol=In,sl=128,Bo=127;function In(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw In.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&Bo)<<i:(s&Bo)*Math.pow(2,i),i+=7}while(s>=sl);return In.bytes=o-n,t}var al=Math.pow(2,7),cl=Math.pow(2,14),ul=Math.pow(2,21),ll=Math.pow(2,28),fl=Math.pow(2,35),hl=Math.pow(2,42),dl=Math.pow(2,49),pl=Math.pow(2,56),ml=Math.pow(2,63),yl=function(r){return r<al?1:r<cl?2:r<ul?3:r<ll?4:r<fl?5:r<hl?6:r<dl?7:r<pl?8:r<ml?9:10},gl={encode:tl,decode:ol,encodingLength:yl},wl=gl,Ut=wl;var Rt=(r,e=0)=>[Ut.decode(r,e),Ut.decode.bytes],lt=(r,e,t=0)=>(Ut.encode(r,e,t),e),ft=r=>Ut.encodingLength(r);var Ve=(r,e)=>{let t=e.byteLength,n=ft(r),i=n+ft(t),o=new Uint8Array(i+t);return lt(r,o,0),lt(t,o,n),o.set(e,i),new ht(r,t,e,o)},br=r=>{let e=ke(r),[t,n]=Rt(e),[i,o]=Rt(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ht(t,i,s,e)},Lo=(r,e)=>{if(r===e)return!0;{let t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&ko(r.bytes,t.bytes)}},ht=class{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}};var Po=0,bl="identity",Io=ke,_l=r=>Ve(Po,Io(r)),Nn={code:Po,name:bl,encode:Io,digest:_l};var Un={};V(Un,{sha256:()=>je,sha512:()=>On});var Fn=({name:r,code:e,encode:t})=>new Mn(r,e,t),Mn=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Ve(this.code,t):t.then(n=>Ve(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Do=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),je=Fn({name:"sha2-256",code:18,encode:Do("SHA-256")}),On=Fn({name:"sha2-512",code:19,encode:Do("SHA-512")});var Hn={};V(Hn,{base58btc:()=>E,base58flickr:()=>Tl});function vl(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,k=0,I=0,O=y.length;I!==O&&y[I]===0;)I++,g++;for(var ne=(O-I)*l+1>>>0,$=new Uint8Array(ne);I!==O;){for(var fe=y[I],ie=0,Q=ne-1;(fe!==0||ie<k)&&Q!==-1;Q--,ie++)fe+=256*$[Q]>>>0,$[Q]=fe%a>>>0,fe=fe/a>>>0;if(fe!==0)throw new Error("Non-zero carry");k=ie,I++}for(var oe=ne-k;oe!==ne&&$[oe]===0;)oe++;for(var ut=c.repeat(g);oe<ne;++oe)ut+=r.charAt($[oe]);return ut}function d(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var k=0,I=0;y[g]===c;)k++,g++;for(var O=(y.length-g)*u+1>>>0,ne=new Uint8Array(O);y[g];){var $=t[y.charCodeAt(g)];if($===255)return;for(var fe=0,ie=O-1;($!==0||fe<I)&&ie!==-1;ie--,fe++)$+=a*ne[ie]>>>0,ne[ie]=$%256>>>0,$=$/256>>>0;if($!==0)throw new Error("Non-zero carry");I=fe,g++}if(y[g]!==" "){for(var Q=O-I;Q!==O&&ne[Q]===0;)Q++;for(var oe=new Uint8Array(k+(O-Q)),ut=k;Q!==O;)oe[ut++]=ne[Q++];return oe}}}function v(y){var g=d(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:v}}var xl=vl,kl=xl,Mo=kl;var Rn=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},zn=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Fo(this,e)}},$n=class{constructor(e){this.decoders=e}or(e){return Fo(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Fo=(r,e)=>new $n({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Wn=class{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new Rn(e,t,n),this.decoder=new zn(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},pt=({name:r,prefix:e,encode:t,decode:n})=>new Wn(r,e,t,n),Ne=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:i}=Mo(t,e);return pt({prefix:r,name:e,encode:n,decode:o=>ke(i(o))})},El=(r,e,t,n)=>{let i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*t/8|0),a=0,c=0,u=0;for(let l=0;l<o;++l){let h=i[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},Sl=(r,e,t)=>{let n=e[e.length-1]==="=",i=(1<<t)-1,o="",s=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s&&(o+=e[i&a<<t-s]),n)for(;o.length*t&7;)o+="=";return o},D=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>pt({prefix:e,name:r,encode(i){return Sl(i,n,t)},decode(i){return El(i,n,t,r)}});var E=Ne({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Tl=Ne({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var qn={};V(qn,{base32:()=>j,base32hex:()=>Ll,base32hexpad:()=>Il,base32hexpadupper:()=>Nl,base32hexupper:()=>Pl,base32pad:()=>Bl,base32padupper:()=>Cl,base32upper:()=>Al,base32z:()=>Dl});var j=D({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Al=D({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bl=D({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Cl=D({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ll=D({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pl=D({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Il=D({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Nl=D({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dl=D({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Oo=(r,e)=>{let{bytes:t,version:n}=r;switch(n){case 0:return Fl(t,Vn(r),e||E.encoder);default:return Ol(t,Vn(r),e||j.encoder)}};var Uo=new WeakMap,Vn=r=>{let e=Uo.get(r);if(e==null){let t=new Map;return Uo.set(r,t),t}return e},x=class{constructor(e,t,n,i){this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:t}=this;if(e!==zt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ul)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return x.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=Ve(e,t);return x.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return x.equals(this,e)}static equals(e,t){let n=t;return n&&e.code===n.code&&e.version===n.version&&Lo(e.multihash,n.multihash)}toString(e){return Oo(this,e)}toJSON(){return{"/":Oo(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let t=e;if(t instanceof x)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:i,multihash:o,bytes:s}=t;return new x(n,i,o,s||Ro(n,i,o.bytes))}else if(t[Rl]===!0){let{version:n,multihash:i,code:o}=t,s=br(i);return x.create(n,o,s)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==zt)throw new Error(`Version 0 CID must use dag-pb (code: ${zt}) block encoding`);return new x(e,t,n,n.bytes)}case 1:{let i=Ro(e,t,n.bytes);return new x(e,t,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return x.create(0,zt,e)}static createV1(e,t){return x.create(1,e,t)}static decode(e){let[t,n]=x.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=x.inspectBytes(e),n=t.size-t.multihashSize,i=ke(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=i.subarray(t.multihashSize-t.digestSize),s=new ht(t.multihashCode,t.digestSize,o,i);return[t.version===0?x.createV0(s):x.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[h,d]=Rt(e.subarray(t));return t+=d,h},i=n(),o=zt;if(i===18?(i=0,t=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=t,a=n(),c=n(),u=t+c,l=u-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,t){let[n,i]=Ml(e,t),o=x.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Vn(o).set(n,e),o}},Ml=(r,e)=>{switch(r[0]){case"Q":{let t=e||E;return[E.prefix,t.decode(`${E.prefix}${r}`)]}case E.prefix:{let t=e||E;return[E.prefix,t.decode(r)]}case j.prefix:{let t=e||j;return[j.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},Fl=(r,e,t)=>{let{prefix:n}=t;if(n!==E.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let i=e.get(n);if(i==null){let o=t.encode(r).slice(1);return e.set(n,o),o}else return i},Ol=(r,e,t)=>{let{prefix:n}=t,i=e.get(n);if(i==null){let o=t.encode(r);return e.set(n,o),o}else return i},zt=112,Ul=18,Ro=(r,e,t)=>{let n=ft(r),i=n+ft(e),o=new Uint8Array(i+t.byteLength);return lt(r,o,0),lt(e,o,n),o.set(t,i),o},Rl=Symbol.for("@ipld/js-cid/CID");var sa=U(Yo(),1);var $t=U(us(),1);function df(r){let e=new Uint8Array(r.reduce((n,i)=>n+$t.default.encodingLength(i),0)),t=0;for(let n of r)e=$t.encode(n,e,t),t+=$t.default.encodingLength(n);return e}var ls=df;var se=U(ms(),1);var Kn={};V(Kn,{base64:()=>Wt,base64pad:()=>Tf,base64url:()=>Af,base64urlpad:()=>Bf});var Wt=D({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Tf=D({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Af=D({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bf=D({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});se.default.formatters.b=r=>r==null?"undefined":E.baseEncode(r);se.default.formatters.t=r=>r==null?"undefined":j.baseEncode(r);se.default.formatters.m=r=>r==null?"undefined":Wt.baseEncode(r);se.default.formatters.p=r=>r==null?"undefined":r.toString();se.default.formatters.c=r=>r==null?"undefined":r.toString();se.default.formatters.k=r=>r==null?"undefined":r.toString();function Cf(r){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=r,e.destroy=()=>!0,e.extend=()=>e,e}function wt(r){let e=Cf(`${r}:trace`);return se.default.enabled(`${r}:trace`)&&se.default.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(e=(0,se.default)(`${r}:trace`)),Object.assign((0,se.default)(r),{error:(0,se.default)(`${r}:error`),trace:e})}function Qe(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var Ke=class{constructor(e,t,n){this._refCounter=1,this.cid=e,this.priority=t??1,this.wantType=n}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(E)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};var De=class{constructor(e,t,n,i,o){this.entry=new Ke(e,t,n),this.cancel=!!i,this.sendDontHave=!!o}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(E)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}};var ae=(r,e)=>{let t=["bitswap"];return e!=null&&t.push(e),r!=null&&t.push(`${r.toString().slice(0,8)}`),wt(t.join(":"))};var xr=(r,e)=>{if(r.size!==e.size)return!1;for(let[t,n]of r){let i=e.get(t);if(i===void 0||n instanceof Uint8Array&&i instanceof Uint8Array&&!Qe(n,i)||n instanceof De&&i instanceof De&&!n.equals(i))return!1}return!0};var ci=U(ei(),1),ra=U(Qs(),1),na=U(Je(),1),ui=U(ai(),1),ia=U(ta(),1);function Uf(){na.default._configure(),ci.default._configure(ra.default),ui.default._configure(ia.default)}Uf();var oa=["uint64","int64","sint64","fixed64","sfixed64"];function Rf(r){for(let e of oa){if(r[e]==null)continue;let t=r[e];r[e]=function(){return BigInt(t.call(this).toString())}}return r}function li(r){return Rf(new ci.default(r))}function zf(r){for(let e of oa){if(r[e]==null)continue;let t=r[e];r[e]=function(n){return t.call(this,n.toString())}}return r}function fi(){return zf(ui.default.create())}function Ye(r,e){let t=li(r instanceof Uint8Array?r:r.subarray());return e.decode(t)}function et(r,e){let t=fi();return e.encode(r,t,{lengthDelimited:!1}),t.finish()}var _t;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(_t||(_t={}));function Ar(r,e,t,n){return{name:r,type:e,encode:t,decode:n}}function Br(r){function e(i){if(r[i.toString()]==null)throw new Error("Invalid enum value");return r[i]}let t=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return Ar("enum",_t.VARINT,t,n)}function tt(r,e){return Ar("message",_t.LENGTH_DELIMITED,r,e)}var G;(function(r){let e;(function(a){let c;(function(d){d.Block="Block",d.Have="Have"})(c=a.WantType||(a.WantType={}));let u;(function(d){d[d.Block=0]="Block",d[d.Have=1]="Have"})(u||(u={})),function(d){d.codec=()=>Br(u)}(c=a.WantType||(a.WantType={}));let l;(function(d){let v;d.codec=()=>(v==null&&(v=tt((y,g,k={})=>{k.lengthDelimited!==!1&&g.fork(),y.block!=null&&y.block.byteLength>0&&(g.uint32(10),g.bytes(y.block)),y.priority!=null&&y.priority!==0&&(g.uint32(16),g.int32(y.priority)),y.cancel!=null&&y.cancel!==!1&&(g.uint32(24),g.bool(y.cancel)),y.wantType!=null&&u[y.wantType]!==0&&(g.uint32(32),r.Wantlist.WantType.codec().encode(y.wantType,g)),y.sendDontHave!=null&&y.sendDontHave!==!1&&(g.uint32(40),g.bool(y.sendDontHave)),k.lengthDelimited!==!1&&g.ldelim()},(y,g)=>{let k={block:new Uint8Array(0),priority:0,cancel:!1,wantType:c.Block,sendDontHave:!1},I=g==null?y.len:y.pos+g;for(;y.pos<I;){let O=y.uint32();switch(O>>>3){case 1:k.block=y.bytes();break;case 2:k.priority=y.int32();break;case 3:k.cancel=y.bool();break;case 4:k.wantType=r.Wantlist.WantType.codec().decode(y);break;case 5:k.sendDontHave=y.bool();break;default:y.skipType(O&7);break}}return k})),v),d.encode=y=>et(y,d.codec()),d.decode=y=>Ye(y,d.codec())})(l=a.Entry||(a.Entry={}));let h;a.codec=()=>(h==null&&(h=tt((d,v,y={})=>{if(y.lengthDelimited!==!1&&v.fork(),d.entries!=null)for(let g of d.entries)v.uint32(10),r.Wantlist.Entry.codec().encode(g,v);d.full!=null&&d.full!==!1&&(v.uint32(16),v.bool(d.full)),y.lengthDelimited!==!1&&v.ldelim()},(d,v)=>{let y={entries:[],full:!1},g=v==null?d.len:d.pos+v;for(;d.pos<g;){let k=d.uint32();switch(k>>>3){case 1:y.entries.push(r.Wantlist.Entry.codec().decode(d,d.uint32()));break;case 2:y.full=d.bool();break;default:d.skipType(k&7);break}}return y})),h),a.encode=d=>et(d,a.codec()),a.decode=d=>Ye(d,a.codec())})(e=r.Wantlist||(r.Wantlist={}));let t;(function(a){let c;a.codec=()=>(c==null&&(c=tt((u,l,h={})=>{h.lengthDelimited!==!1&&l.fork(),u.prefix!=null&&u.prefix.byteLength>0&&(l.uint32(10),l.bytes(u.prefix)),u.data!=null&&u.data.byteLength>0&&(l.uint32(18),l.bytes(u.data)),h.lengthDelimited!==!1&&l.ldelim()},(u,l)=>{let h={prefix:new Uint8Array(0),data:new Uint8Array(0)},d=l==null?u.len:u.pos+l;for(;u.pos<d;){let v=u.uint32();switch(v>>>3){case 1:h.prefix=u.bytes();break;case 2:h.data=u.bytes();break;default:u.skipType(v&7);break}}return h})),c),a.encode=u=>et(u,a.codec()),a.decode=u=>Ye(u,a.codec())})(t=r.Block||(r.Block={}));let n;(function(a){a.Have="Have",a.DontHave="DontHave"})(n=r.BlockPresenceType||(r.BlockPresenceType={}));let i;(function(a){a[a.Have=0]="Have",a[a.DontHave=1]="DontHave"})(i||(i={})),function(a){a.codec=()=>Br(i)}(n=r.BlockPresenceType||(r.BlockPresenceType={}));let o;(function(a){let c;a.codec=()=>(c==null&&(c=tt((u,l,h={})=>{h.lengthDelimited!==!1&&l.fork(),u.cid!=null&&u.cid.byteLength>0&&(l.uint32(10),l.bytes(u.cid)),u.type!=null&&i[u.type]!==0&&(l.uint32(16),r.BlockPresenceType.codec().encode(u.type,l)),h.lengthDelimited!==!1&&l.ldelim()},(u,l)=>{let h={cid:new Uint8Array(0),type:n.Have},d=l==null?u.len:u.pos+l;for(;u.pos<d;){let v=u.uint32();switch(v>>>3){case 1:h.cid=u.bytes();break;case 2:h.type=r.BlockPresenceType.codec().decode(u);break;default:u.skipType(v&7);break}}return h})),c),a.encode=u=>et(u,a.codec()),a.decode=u=>Ye(u,a.codec())})(o=r.BlockPresence||(r.BlockPresence={}));let s;r.codec=()=>(s==null&&(s=tt((a,c,u={})=>{if(u.lengthDelimited!==!1&&c.fork(),a.wantlist!=null&&(c.uint32(10),r.Wantlist.codec().encode(a.wantlist,c)),a.blocks!=null)for(let l of a.blocks)c.uint32(18),c.bytes(l);if(a.payload!=null)for(let l of a.payload)c.uint32(26),r.Block.codec().encode(l,c);if(a.blockPresences!=null)for(let l of a.blockPresences)c.uint32(34),r.BlockPresence.codec().encode(l,c);a.pendingBytes!=null&&a.pendingBytes!==0&&(c.uint32(40),c.int32(a.pendingBytes)),u.lengthDelimited!==!1&&c.ldelim()},(a,c)=>{let u={blocks:[],payload:[],blockPresences:[],pendingBytes:0},l=c==null?a.len:a.pos+c;for(;a.pos<l;){let h=a.uint32();switch(h>>>3){case 1:u.wantlist=r.Wantlist.codec().decode(a,a.uint32());break;case 2:u.blocks.push(a.bytes());break;case 3:u.payload.push(r.Block.codec().decode(a,a.uint32()));break;case 4:u.blockPresences.push(r.BlockPresence.codec().decode(a,a.uint32()));break;case 5:u.pendingBytes=a.int32();break;default:a.skipType(h&7);break}}return u})),s),r.encode=a=>et(a,r.codec()),r.decode=a=>Ye(a,r.codec())})(G||(G={}));var Cr=class extends Error{constructor(e,t,n){super(e),this.code=t,this.name=n?.name??"CodeError",this.props=n??{}}};var $f,B=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,n,i,o){n==null&&(n=B.WantType.Block);let s=e.toString(E),a=this.wantlist.get(s);a!=null?(a.wantType===n&&(a.priority=t),i===!0&&(a.cancel=!!i),o===!0&&(a.sendDontHave=!!o),n===B.WantType.Block&&a.wantType===B.WantType.Have&&(a.wantType=n)):this.wantlist.set(s,new De(e,t,n,i,o))}addBlock(e,t){let n=e.toString(E);this.blocks.set(n,t)}addHave(e){let t=e.toString(E);this.blockPresences.has(t)||this.blockPresences.set(t,B.BlockPresenceType.Have)}addDontHave(e){let t=e.toString(E);this.blockPresences.has(t)||this.blockPresences.set(t,B.BlockPresenceType.DontHave)}cancel(e){let t=e.toString(E);this.wantlist.delete(t),this.addEntry(e,0,B.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){return G.encode({wantlist:{entries:Array.from(this.wantlist.values()).map(e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:!!e.cancel,wantType:G.Wantlist.WantType.Block,sendDontHave:!1})),full:!!this.full},blocks:Array.from(this.blocks.values())})}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:!!t.cancel,sendDontHave:!!t.sendDontHave})),full:!!this.full},blockPresences:[],payload:[],pendingBytes:this.pendingBytes,blocks:[]};for(let[t,n]of this.blocks.entries()){let i=x.parse(t),o=i.version,s=i.code,a=i.multihash.code,c=i.multihash.digest.length,u=ls([o,s,a,c]);e.payload.push({prefix:u,data:n})}for(let[t,n]of this.blockPresences)e.blockPresences.push({cid:x.parse(t).bytes,type:n});return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),G.encode(e)}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!xr(this.wantlist,e.wantlist)||!xr(this.blocks,e.blocks)||!xr(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};$f=B;B.Entry=De;B.WantType={Block:G.Wantlist.WantType.Block,Have:G.Wantlist.WantType.Have};B.BlockPresenceType={Have:G.BlockPresenceType.Have,DontHave:G.BlockPresenceType.DontHave};B.deserialize=async(r,e)=>{let t=G.decode(r),n=t.wantlist?.full===!0,i=new B(n);return t.wantlist?.entries.forEach(o=>{if(o.block==null)return;let s=x.decode(o.block);i.addEntry(s,o.priority??0,o.wantType,!!o.cancel,!!o.sendDontHave)}),t.blockPresences.forEach(o=>{if(o.cid==null)return;let s=x.decode(o.cid);o.type===B.BlockPresenceType.Have?i.addHave(s):i.addDontHave(s)}),t.blocks.length>0?(await Promise.all(t.blocks.map(async o=>{let s=await je.digest(o),a=x.createV0(s);i.addBlock(a,o)})),i):(t.payload.length>0&&(await Promise.all(t.payload.map(async o=>{if(o.prefix==null||o.data==null)return;let s=(0,sa.default)(o.prefix),a=s[0],c=s[1],u=s[2],l=u===je.code?je:await e?.getHasher(u);if(l==null)throw new Cr("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");let h=await l.digest(o.data),d=x.create(a,c,h);i.addBlock(d,o.data)})),i.setPendingBytes(t.pendingBytes)),i)};B.blockPresenceSize=r=>r.bytes.length+1;var hi=class extends Map{constructor(e){super();let{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){let t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}};function Oe(r){let{name:e,metrics:t}=r,n;return t!=null?n=new hi({name:e,metrics:t}):n=new Map,n}var aa={Block:G.Wantlist.WantType.Block,Have:G.Wantlist.WantType.Have},Wf=(r,e)=>Array.prototype.slice.call(e,0).sort((t,n)=>{let i=r(t),o=r(n);return i<o?-1:i>o?1:0}),Ee=class{constructor(e,t){this.set=t!=null?Oe({name:"ipfs_bitswap_wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,n){let i=e.toString(E),o=this.set.get(i);o!=null?(o.inc(),o.priority=t,o.wantType===aa.Have&&n===aa.Block&&(o.wantType=n)):(this.set.set(i,new Ke(e,t,n)),this._stats!=null&&this._stats.push(void 0,"wantListSize",1))}remove(e){let t=e.toString(E),n=this.set.get(t);n!=null&&(n.dec(),!n.hasRefs()&&(this.set.delete(t),this._stats!=null&&this._stats.push(void 0,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(Wf(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString(E);return this.set.has(t)}get(e){let t=e.toString(E);return this.set.get(t)}};Ee.Entry=Ke;var ca=Math.pow(2,31)-1,ua=1e3,la=1;var fa=Hf;function Hf(r,e,t){var n=null,i=null,o=function(){n&&(clearTimeout(n),i=null,n=null)},s=function(){var c=i;o(),c&&c()},a=function(){if(!e)return r.apply(this,arguments);var c=this,u=arguments,l=t&&!n;if(o(),i=function(){r.apply(c,u)},n=setTimeout(function(){if(n=null,!l){var h=i;return i=null,h()}},e),l)return i()};return a.cancel=o,a.flush=s,a}var Lr=class{constructor(e,t,n){this.peerId=t,this.network=n,this.refcnt=1,this._entries=[],this._log=ae(e,"msgqueue"),this.sendEntries=fa(this.sendEntries.bind(this),la)}addMessage(e,t={}){e.empty||this.send(e,t)}addEntries(e,t={}){this._entries=this._entries.concat(e),this.sendEntries(t)}sendEntries(e={}){if(this._entries.length===0)return;let t=new B(!1);this._entries.forEach(n=>{n.cancel===!0?t.cancel(n.cid):t.addEntry(n.cid,n.priority)}),this._entries=[],this.addMessage(t,e)}async send(e,t={}){try{await this.network.connectTo(this.peerId,t)}catch(n){this._log.error("cant connect to peer %p: %s",this.peerId,n.message);return}this._log("sending message to peer %p",this.peerId),this.network.sendMessage(this.peerId,e,t).catch(n=>{this._log.error("send error",n)})}};var Pr=class{constructor(e,t,n,i){this.peers=Oe({name:"ipfs_bitswap_want_manager_peers",metrics:i.metrics}),this.wantlist=new Ee(n,i),this.network=t,this._peerId=e,this._log=ae(e,"want")}_addEntries(e,t,n,i={}){let o=e.map((s,a)=>new B.Entry(s,ca-a,B.WantType.Block,t));o.forEach(s=>{s.cancel?n===!0?this.wantlist.removeForce(s.cid.toString(E)):this.wantlist.remove(s.cid):(this._log("adding to wantlist"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(o,i)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t!=null){t.refcnt++;return}t=new Lr(this._peerId,e,this.network);let n=new B(!0);for(let i of this.wantlist.entries())n.addEntry(i[1].cid,i[1].priority);return t.addMessage(n),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toString());t!=null&&(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1,!1,t),t.signal?.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>{this.disconnected(e.peerId)})}};function rt(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Se(r=0){return globalThis.Buffer?.alloc!=null?rt(globalThis.Buffer.alloc(r)):new Uint8Array(r)}function pe(r=0){return globalThis.Buffer?.allocUnsafe!=null?rt(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function pi(r,e){e==null&&(e=r.reduce((i,o)=>i+o.length,0));let t=pe(e),n=0;for(let i of r)t.set(i,n),n+=i.length;return rt(t)}var da=Symbol.for("@achingbrain/uint8arraylist");function ha(r,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let t=0;for(let n of r){let i=t+n.byteLength;if(e<i)return{buf:n,index:e-t};t=i}throw new RangeError("index is out of bounds")}function Ir(r){return!!r?.[da]}var _e=class{constructor(...e){Object.defineProperty(this,da,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(let n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else if(Ir(n))t+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(let n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else if(Ir(n))t+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}get(e){let t=ha(this.bufs,e);return t.buf[t.index]}set(e,t){let n=ha(this.bufs,e);n.buf[n.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else if(Ir(e))for(let n=0;n<e.length;n++)this.set(t+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,t){let{bufs:n,length:i}=this._subList(e,t);return pi(n,i)}subarray(e,t){let{bufs:n,length:i}=this._subList(e,t);return n.length===1?n[0]:pi(n,i)}sublist(e,t){let{bufs:n,length:i}=this._subList(e,t),o=new _e;return o.length=i,o.bufs=n,o}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(e===0&&t===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],a=i,c=a+s.byteLength;if(i=c,e>=c)continue;let u=e>=a&&e<c,l=t>a&&t<=c;if(u&&l){if(e===a&&t===c){n.push(s);break}let h=e-a;n.push(s.subarray(h,h+(t-e)));break}if(u){if(e===0){n.push(s);continue}n.push(s.subarray(e-a));continue}if(l){if(t===c){n.push(s);break}n.push(s.subarray(0,t-a));break}n.push(s)}return{bufs:n,length:t-e}}indexOf(e,t=0){if(!Ir(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),e.length===0)return t>this.length?this.length:t;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let h=0;h<o;h++)s[h]=-1;for(let h=0;h<i;h++)s[n[h]]=h;let a=s,c=this.byteLength-n.byteLength,u=n.byteLength-1,l;for(let h=t;h<=c;h+=l){l=0;for(let d=u;d>=0;d--){let v=this.get(h+d);if(n[d]!==v){l=Math.max(1,d-a[v]);break}}if(l===0)return h}return-1}getInt8(e){let t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,t),this.write(n,e)}getInt16(e,t){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,t)}setInt16(e,t,n){let i=Se(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,t,n),this.write(i,e)}getInt32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,t)}setInt32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,t,n),this.write(i,e)}getBigInt64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,t)}setBigInt64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,t,n),this.write(i,e)}getUint8(e){let t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,t),this.write(n,e)}getUint16(e,t){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,t)}setUint16(e,t,n){let i=Se(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,t,n),this.write(i,e)}getUint32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,t)}setUint32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,t,n),this.write(i,e)}getBigUint64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,t)}setBigUint64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,t,n),this.write(i,e)}getFloat32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,t)}setFloat32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,t,n),this.write(i,e)}getFloat64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,t)}setFloat64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,t,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof _e)||e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!Qe(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){let n=new _e;return n.bufs=e,t==null&&(t=e.reduce((i,o)=>i+o.byteLength,0)),n.length=t,n}};function Nr(r){return r instanceof Uint8Array?{get(e){return r[e]},set(e,t){r[e]=t}}:{get(e){return r.get(e)},set(e,t){r.set(e,t)}}}var pa=4294967296,X=class{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let t=~this.lo+1>>>0,n=~this.hi>>>0;return t===0&&(n=n+1>>>0),-(BigInt(t)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),t=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new X(n,t)}zzEncode(){let e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new X(t,n)}toBytes(e,t=0){let n=Nr(e);for(;this.hi>0;)n.set(t++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(t++,this.lo&127|128),this.lo=this.lo>>>7;n.set(t++,this.lo)}static fromBigInt(e){if(e===0n)return new X;let t=e<0;t&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return t&&(n=~n>>>0,i=~i>>>0,++i>pa&&(i=0,++n>pa&&(n=0))),new X(n,i)}static fromNumber(e){if(e===0)return new X;let t=e<0;t&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new X(i,n)}static fromBytes(e,t=0){let n=Nr(e),i=new X,o=0;if(e.length-t>4){for(;o<4;++o)if(i.lo=(i.lo|(n.get(t)&127)<<o*7)>>>0,n.get(t++)<128)return i;if(i.lo=(i.lo|(n.get(t)&127)<<28)>>>0,i.hi=(i.hi|(n.get(t)&127)>>4)>>>0,n.get(t++)<128)return i;o=0}else for(;o<4;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(i.lo=(i.lo|(n.get(t)&127)<<o*7)>>>0,n.get(t++)<128)return i}if(e.length-t>4){for(;o<5;++o)if(i.hi=(i.hi|(n.get(t)&127)<<o*7+3)>>>0,n.get(t++)<128)return i}else if(t<e.byteLength)for(;o<5;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(i.hi=(i.hi|(n.get(t)&127)<<o*7+3)>>>0,n.get(t++)<128)return i}throw RangeError("invalid varint encoding")}};var qf=Math.pow(2,7),Vf=Math.pow(2,14),jf=Math.pow(2,21),Gf=Math.pow(2,28),Qf=Math.pow(2,35),Kf=Math.pow(2,42),Xf=Math.pow(2,49),Jf=Math.pow(2,56),Zf=Math.pow(2,63),nt={encodingLength(r){return r<qf?1:r<Vf?2:r<jf?3:r<Gf?4:r<Qf?5:r<Kf?6:r<Xf?7:r<Jf?8:r<Zf?9:10},encode(r,e,t=0){if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=pe(nt.encodingLength(r))),X.fromNumber(r).toBytes(e,t),e},decode(r,e=0){return X.fromBytes(r,e).toNumber(!0)}};function Dr(r){return r[Symbol.asyncIterator]!=null}var Mr=r=>{let e=nt.encodingLength(r),t=pe(e);return nt.encode(r,t),Mr.bytes=e,t};Mr.bytes=0;function Fr(r,e){e=e??{};let t=e.lengthEncoder??Mr;function*n(i){let o=t(i.byteLength);o instanceof Uint8Array?yield o:yield*o,i instanceof Uint8Array?yield i:yield*i}return Dr(r)?async function*(){for await(let i of r)yield*n(i)}():function*(){for(let i of r)yield*n(i)}()}Fr.single=(r,e)=>{e=e??{};let t=e.lengthEncoder??Mr;return new _e(t(r.byteLength),r)};var vt=U(Or(),1);var eh=8,th=1024*1024*4,it;(function(r){r[r.LENGTH=0]="LENGTH",r[r.DATA=1]="DATA"})(it||(it={}));var mi=r=>{let e=nt.decode(r);return mi.bytes=nt.encodingLength(e),e};mi.bytes=0;function Vt(r,e){let t=new _e,n=it.LENGTH,i=-1,o=e?.lengthDecoder??mi,s=e?.maxLengthLength??eh,a=e?.maxDataLength??th;function*c(){for(;t.byteLength>0;){if(n===it.LENGTH)try{if(i=o(t),i<0)throw(0,vt.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,vt.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=o.bytes;t.consume(u),e?.onLength!=null&&e.onLength(i),n=it.DATA}catch(u){if(u instanceof RangeError){if(t.byteLength>s)throw(0,vt.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(n===it.DATA){if(t.byteLength<i)break;let u=t.sublist(0,i);t.consume(i),e?.onData!=null&&e.onData(u),yield u,n=it.LENGTH}}}return Dr(r)?async function*(){for await(let u of r)t.append(u),yield*c();if(t.byteLength>0)throw(0,vt.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let u of r)t.append(u),yield*c();if(t.byteLength>0)throw(0,vt.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Vt.fromReader=(r,e)=>{let t=1,n=async function*(){for(;;)try{let{done:o,value:s}=await r.next(t);if(o===!0)return;s!=null&&(yield s)}catch(o){if(o.code==="ERR_UNDER_READ")return{done:!0,value:null};throw o}finally{t=1}}();return Vt(n,{...e??{},onLength:o=>{t=o}})};var Ur=class{constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},xt=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Ur(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new Ur(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function kt(r={}){return nh(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function nh(r,e){e=e??{};let t=e.onEnd,n=new xt,i,o,s,a=async()=>n.isEmpty()?s?{done:!0}:await new Promise((g,k)=>{o=I=>{o=null,n.push(I);try{g(r(n))}catch(O){k(O)}return i}}):r(n),c=g=>o!=null?o(g):(n.push(g),i),u=g=>(n=new xt,o!=null?o({error:g}):(n.push({error:g}),i)),l=g=>{if(s)return i;if(e?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:g})},h=g=>s?i:(s=!0,g!=null?u(g):c({done:!0})),d=()=>(n=new xt,h(),{done:!0}),v=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:d,throw:v,push:l,end:h,get readableLength(){return n.size}},t==null)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),t!=null&&(t(g),t=void 0),{done:!0}},return(){return y.return(),t!=null&&(t(),t=void 0),{done:!0}},push:l,end(g){return y.end(g),t!=null&&(t(g),t=void 0),i},get readableLength(){return y.readableLength}},i}function ih(r){return r[Symbol.asyncIterator]!=null}function oh(...r){let e=[];for(let t of r)ih(t)||e.push(t);return e.length===r.length?function*(){for(let t of e)yield*t}():async function*(){let t=kt({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(r.map(async n=>{for await(let i of n)t.push(i)})),t.end()}catch(n){t.end(n)}}),yield*t}()}var Rr=oh;function gi(r,...e){if(r==null)throw new Error("Empty pipeline");if(yi(r)){let n=r;r=()=>n.source}else if(wa(r)||ga(r)){let n=r;r=()=>n}let t=[r,...e];if(t.length>1&&yi(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)yi(t[n])&&(t[n]=ah(t[n]));return sh(...t)}var sh=(...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e},ga=r=>r?.[Symbol.asyncIterator]!=null,wa=r=>r?.[Symbol.iterator]!=null,yi=r=>r==null?!1:r.sink!=null&&r.source!=null,ah=r=>e=>{let t=r.sink(e);if(t?.then!=null){let n=kt({objectMode:!0});t.then(()=>{n.end()},s=>{n.end(s)});let i,o=r.source;if(ga(o))i=async function*(){yield*o,n.end()};else if(wa(o))i=function*(){yield*o,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return Rr(n,i())}return r.source};var wi=Symbol.for("@libp2p/topology");var ba=()=>{},bi=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??ba,this.onDisconnect=e.onDisconnect??ba}get[Symbol.toStringTag](){return wi.toString()}get[wi](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function _a(r){return new bi(r)}var La=U(Aa(),1);var Gt=class extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}};function Ba(r){if(r!=null){if(typeof r[Symbol.iterator]=="function")return r[Symbol.iterator]();if(typeof r[Symbol.asyncIterator]=="function")return r[Symbol.asyncIterator]();if(typeof r.next=="function")return r}throw new Error("argument is not an iterator or iterable")}function Ca(r,e,t){let n=t??{},i=Ba(r);async function*o(){let s,a=()=>{s?.()};for(e.addEventListener("abort",a);;){let c;try{if(e.aborted){let{abortMessage:l,abortCode:h}=n;throw new Gt(l,h)}let u=new Promise((l,h)=>{s=()=>{let{abortMessage:d,abortCode:v}=n;h(new Gt(d,v))}});c=await Promise.race([u,i.next()]),s=null}catch(u){e.removeEventListener("abort",a);let l=u.type==="aborted"&&e.aborted;if(l&&n.onAbort!=null&&await n.onAbort(r),typeof i.return=="function")try{let h=i.return();h instanceof Promise&&h.catch(d=>{n.onReturnError!=null&&n.onReturnError(d)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(l&&n.returnOnAbort===!0)return;throw u}if(c.done===!0)break;yield c.value}e.removeEventListener("abort",a)}return o()}var C=class extends Event{constructor(e,t){super(e),this.detail=t}};function lh(r){return r[Symbol.asyncIterator]!=null}function fh(r,e){return lh(r)?async function*(){let t=0;if(!(e<1)){for await(let n of r)if(yield n,t++,t===e)return}}():function*(){let t=0;if(!(e<1)){for(let n of r)if(yield n,t++,t===e)return}}()}var Et=fh;function hh(r){return r[Symbol.asyncIterator]!=null}function dh(r){if(hh(r))return(async()=>{for await(let e of r);})();for(let e of r);}var Ue=dh;function ph(r){let[e,t]=r[Symbol.asyncIterator]!=null?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:i=>{n.push(i)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[t](){return this}}}var St=ph;function mh(r){return r[Symbol.asyncIterator]!=null}function yh(r,e){if(mh(r))return async function*(){for await(let a of r)yield e(a)}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();let o=e(n);if(typeof o.then=="function")return async function*(){yield await o;for await(let a of t)yield e(a)}();let s=e;return function*(){yield o;for(let a of t)yield s(a)}()}var vi=yh;var xi="/ipfs/bitswap/1.0.0",ki="/ipfs/bitswap/1.1.0",Ei="/ipfs/bitswap/1.2.0",wh=1024,bh=1024,_h=3e4,$r=class{constructor(e,t,n,i={}){this._log=ae(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[xi],i.b100Only!==!0&&(this._protocols.unshift(ki),this._protocols.unshift(Ei)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=i.hashLoader??{async getHasher(){throw new Error("Not implemented")}},this._maxInboundStreams=i.maxInboundStreams??wh,this._maxOutboundStreams=i.maxOutboundStreams??bh,this._incomingStreamTimeout=i.incomingStreamTimeout??_h}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});let e=_a({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(let t of this._protocols)this._registrarIds.push(await this._libp2p.register(t,e));this._libp2p.getConnections().forEach(t=>{this._onPeerConnect(t.remotePeer)})}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarIds!=null){for(let e of this._registrarIds)this._libp2p.unregister(e);this._registrarIds=[]}}_onConnection(e){if(!this._running)return;let{stream:t,connection:n}=e,i=new La.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then(async()=>{this._log("incoming new bitswap %s connection from %p",t.stat.protocol,n.remotePeer),await gi(Ca(t.source,i.signal),o=>Vt(o),async o=>{for await(let s of o){try{let a=await B.deserialize(s.subarray(),this._hashLoader);await this._bitswap._receiveMessage(n.remotePeer,a)}catch(a){this._bitswap._receiveError(a);break}i.reset()}})}).catch(o=>{this._log(o),t.abort(o)}).finally(()=>{i.clear(),t.close()})}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return t.onProgress?.(new C("bitswap:network:find-providers",e)),this._libp2p.contentRouting.findProviders(e,t)}async findAndConnect(e,t){await Ue(Et(vi(this.findProviders(e,t),async n=>await this.connectTo(n.id,t).catch(i=>{this._log.error(i)})),3)).catch(n=>{this._log.error(n)})}async provide(e,t={}){t.onProgress?.(new C("bitswap:network:provide",e)),await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t,n={}){if(!this._running)throw new Error("network isn't running");let i=e.toString();this._log("sendMessage to %s",i,t),n.onProgress?.(new C("bitswap:network:send-wantlist",e)),await this._writeMessage(e,t,n),this._updateSentStats(e,t.blocks)}async connectTo(e,t={}){if(!this._running)throw new Error("network isn't running");return t.onProgress?.(new C("bitswap:network:dial",e)),await this._libp2p.dial(e,t)}_updateSentStats(e,t){let n=e.toString();if(this._stats!=null){for(let i of t.values())this._stats.push(n,"dataSent",i.length);this._stats.push(n,"blocksSent",t.size)}}async _writeMessage(e,t,n={}){let i=await this._libp2p.dialProtocol(e,[Ei,ki,xi]);try{let o;switch(i.stat.protocol){case xi:o=t.serializeToBitswap100();break;case ki:case Ei:o=t.serializeToBitswap110();break;default:throw new Error(`Unknown protocol: ${i.stat.protocol}`)}await gi([o],s=>Fr(s),i)}catch(o){n.onProgress?.(new C("bitswap:network:send-wantlist:error",{peer:e,error:o})),this._log(o)}finally{i.close()}}};var Wr=class{constructor(e){this.partner=e,this.wantlist=new Ee,this.exchangeCount=0,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,n){this.wantlist.add(e,t,n)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};var Qt=class extends Map{constructor(e,t){super(),this._cmp=t??this._defaultSort,this._keys=[];for(let[n,i]of e??[])this.set(n,i)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let n=this._find(t);this._keys.splice(n,0,t)}set(e,t){if(this.has(e)){let i=this.indexOf(e);this._keys.splice(i,1)}super.set(e,t);let n=this._find(e);return this._keys.splice(n,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let n=1;n<this._keys.length;n++){if(this._keys[t+n]===e)return t+n;if(this._keys[t-n]===e)return t-n}return-1}_find(e){let t=0,n=this._keys.length;for(;t<n;){let i=t+n>>>1,o=this._kCmp(this._keys[i],e);if(o<0)t=i+1;else if(o>0)n=i;else return i}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t=this){if(e!=null)for(let n of this._keys){let i=this.get(n);if(i==null)throw new Error("Value cannot be undefined");e.apply(t,[[n,i]])}}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}};var vh={hasNewInfo(){return!1},merge(){}},Hr=class{constructor(e=vh){this._taskMerger=e,this._byPeer=new Qt([],qr.compare)}pushTasks(e,t){let n=this._byPeer.get(e.toString());n==null&&(n=new qr(e,this._taskMerger)),n.pushTasks(t),this._byPeer.set(e.toString(),n)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:n,pendingSize:i}=t.popTasks(e);if(n.length===0)return{tasks:n,pendingSize:i};let o=t.peerId;return t.isIdle()?this._byPeer.delete(o.toString()):this._byPeer.update(0),{peerId:o,tasks:n,pendingSize:i}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){this._byPeer.get(t.toString())?.remove(e)}tasksDone(e,t){let n=this._byPeer.get(e.toString());if(n==null)return;let i=this._byPeer.indexOf(e.toString());for(let o of t)n.taskDone(o);this._byPeer.update(i)}},qr=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new Si,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t!=null){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let n of this._active)n.topic===e.topic&&t.push(n);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,n=[],i=this._pending.tasks();for(let o=0;o<i.length&&t<e;o++){let s=i[o];n.push(s),t+=s.size,this._pending.delete(s.topic),this._activeTotalSize+=s.size,this._active.add(s)}return{tasks:n,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},Si=class{constructor(){this._tasks=new Qt([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return this._tasks?.get(e)?.task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let n=this._tasks.get(e);if(n==null)return;let i=this._tasks.indexOf(e);n.task.priority=t,this._tasks.update(i)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};var Pa={hasNewInfo(r,e){let t=!1,n=!1;for(let i of e)i.data.haveBlock&&(t=!0),i.data.isWantBlock&&(n=!0);return!!(!n&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){let t=r.data,n=e.data;!n.haveBlock&&t.haveBlock&&(n.haveBlock=t.haveBlock,n.blockSize=t.blockSize),!n.isWantBlock&&t.isWantBlock&&(n.isWantBlock=!0,(!n.haveBlock||t.haveBlock)&&(n.haveBlock=t.haveBlock,e.size=r.size)),n.isWantBlock&&n.haveBlock&&(e.size=n.blockSize)}};var Ia=B.WantType,xh=16*1024,kh=1024,Vr=class{constructor(e,t,n,i,o,s={}){this._log=ae(e,"engine"),this.blockstore=t,this.network=n,this._stats=i,this._opts=this._processOpts(s),this.ledgerMap=Oe({name:"ipfs_bitswap_ledger_map",metrics:o.metrics}),this._running=!1,this._requestQueue=new Hr(Pa)}_processOpts(e){return{maxSizeReplaceHasWithBlock:kh,targetMessageSize:xh,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks().catch(e=>{this._log.error("error processing stats",e)})})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:n}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let i=new B(!1);i.setPendingBytes(n);let o=[],s=new Map;for(let c of t){let u=x.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(o.push(u),s.set(c.topic,c.data)):i.addHave(u):i.addDontHave(u)}let a=await this._getBlocks(o);for(let[c,u]of s){let l=x.parse(c),h=a.get(c);h!=null?i.addBlock(l,h):u.sendDontHave&&i.addDontHave(l)}if(i.empty){e!=null&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e!=null&&await this.network.sendMessage(e,i);for(let[c,u]of a.entries())e!=null&&this.messageSent(e,x.parse(c),u)}catch(c){this._log.error(c)}e!=null&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toString(),n=this.ledgerMap.get(t);return n!=null?n.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toString(),n=this.ledgerMap.get(t);if(n!=null)return{peer:n.partner,value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(e.length!==0){for(let t of this.ledgerMap.values())for(let{cid:n,block:i}of e){let o=t.wantlistContains(n);if(o==null)continue;let s=i.length,a=this._sendAsBlock(o.wantType,s),c=s;a||(c=B.blockPresenceSize(o.cid)),this._requestQueue.pushTasks(t.partner,[{topic:o.cid.toString(E),priority:o.priority,size:c,data:{blockSize:s,isWantBlock:a,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){let n=this._findOrCreate(e);if(t.empty)return;if(t.full&&(n.wantlist=new Ee),this._updateBlockAccounting(t.blocks,n),t.wantlist.size===0){this._scheduleProcessTasks();return}let i=[],o=[];t.wantlist.forEach(s=>{s.cancel?(n.cancelWant(s.cid),i.push(s.cid)):(n.wants(s.cid,s.priority,s.wantType),o.push(s))}),this._cancelWants(e,i),await this._addWants(e,o),this._scheduleProcessTasks()}_cancelWants(e,t){for(let n of t)this._requestQueue.remove(n.toString(E),e)}async _addWants(e,t){let n=await this._getBlockSizes(t.map(o=>o.cid)),i=[];for(let o of t){let s=o.cid.toString(E),a=n.get(s);if(a==null)o.sendDontHave&&i.push({topic:s,priority:o.priority,size:B.blockPresenceSize(o.cid),data:{isWantBlock:o.wantType===Ia.Block,blockSize:0,haveBlock:!1,sendDontHave:o.sendDontHave}});else{let c=this._sendAsBlock(o.wantType,a),u=a;c||(u=B.blockPresenceSize(o.cid)),i.push({topic:s,priority:o.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:o.sendDontHave}})}this._requestQueue.pushTasks(e,i)}}_sendAsBlock(e,t){return e===Ia.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([n,i])=>[n,i.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async n=>{try{let i=await this.blockstore.get(n);t.set(n.toString(E),i)}catch(i){i.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",n,i)}})),t}_updateBlockAccounting(e,t){for(let n of e.values())this._log("got block (%s bytes)",n.length),t.receivedBytes(n.length)}messageSent(e,t,n){let i=this._findOrCreate(e);i.sentBytes(n.length),i.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){let t=e.toString(),n=this.ledgerMap.get(t);if(n!=null)return n;let i=new Wr(e);return this.ledgerMap.set(t,i),this._stats!=null&&this._stats.push(t,"peerCount",1),i}start(){this._running=!0}stop(){this._running=!1}};var Qa=U(Qr(),1);var Ai={};V(Ai,{identity:()=>Lh});var Lh=pt({prefix:"\0",name:"identity",encode:r=>So(r),decode:r=>Eo(r)});var Bi={};V(Bi,{base2:()=>Ph});var Ph=D({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ci={};V(Ci,{base8:()=>Ih});var Ih=D({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Li={};V(Li,{base10:()=>Nh});var Nh=Ne({prefix:"9",name:"base10",alphabet:"0123456789"});var Pi={};V(Pi,{base16:()=>Dh,base16upper:()=>Mh});var Dh=D({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mh=D({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ii={};V(Ii,{base36:()=>Kt,base36upper:()=>Fh});var Kt=Ne({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Fh=Ne({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ni={};V(Ni,{base256emoji:()=>$h});var Ha=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Oh=Ha.reduce((r,e,t)=>(r[t]=e,r),[]),Uh=Ha.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Rh(r){return r.reduce((e,t)=>(e+=Oh[t],e),"")}function zh(r){let e=[];for(let t of r){let n=Uh[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}var $h=pt({prefix:"\u{1F680}",name:"base256emoji",encode:Rh,decode:zh});var Kr=85;var Ng=new TextEncoder,Dg=new TextDecoder;var Mi={...Ai,...Bi,...Ci,...Li,...Pi,...qn,...Ii,...Hn,...Kn,...Ni},Rg={...Un,...Dn};function Va(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var qa=Va("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Fi=Va("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=pe(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Hh={utf8:qa,"utf-8":qa,hex:Mi.base16,latin1:Fi,ascii:Fi,binary:Fi,...Mi},Xr=Hh;function ot(r,e="utf8"){let t=Xr[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var ja=r=>`unwant:${ot(r.multihash.bytes,"base64")}`,Ga=r=>`block:${ot(r.multihash.bytes,"base64")}`,Jr=class extends Qa.EventEmitter{constructor(e){super(),this.setMaxListeners(ua),this._log=ae(e,"notif")}hasBlock(e,t){let n=Ga(e);this._log(n),this.emit(n,t)}async wantBlock(e,t={}){if(e==null)throw new Error("Not a valid cid");let n=Ga(e),i=ja(e);return this._log(`wantBlock:${e}`),await new Promise((o,s)=>{let a=()=>{this.removeListener(n,c),t.onProgress?.(new C("bitswap:want-block:unwant",e)),s(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(i,a),t.onProgress?.(new C("bitswap:want-block:block",e)),o(u)};this.once(i,a),this.once(n,c),t.signal?.addEventListener("abort",()=>{this.removeListener(n,c),this.removeListener(i,a),s(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=ja(e);this._log(t),this.emit(t)}};var ec=U(Qr(),1);var Za=U(Qr(),1),Oi=U(Ja(),1),Xt=class extends Za.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(n=>{this._stats[n]=BigInt(0),this._movingAverages[n]={},this._options.movingAverageIntervals.forEach(i=>{(this._movingAverages[n][i]=(0,Oi.default)(i)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._enabled=!1}stop(){this._timeout!=null&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout!=null&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=void 0,this._queue.length>0){let e;for(;this._queue.length>0;){let t=e=this._queue.shift();t!=null&&this._applyOp(t)}e!=null&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t>0&&Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,n){let i=this._frequencyAccumulators[e]??0;this._frequencyAccumulators[e]=0;let o=i/t*1e3,s=this._movingAverages[e];s==null&&(s=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=s[a];c==null&&(c=s[a]=(0,Oi.default)(a)),c.push(n,o)})}_applyOp(e){let t=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(n),this._frequencyAccumulators[t]==null&&(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=n}};var Ya={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},Zr=class extends ec.EventEmitter{constructor(e,t=[],n=Ya){super();let i=Object.assign({},Ya,n);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=i,this._enabled=this._options.enabled,this._global=new Xt(t,i),this._global.on("update",o=>this.emit("update",o)),this._peers=Oe({name:"ipfs_bitswap_stats_peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=e.toString();return this._peers.get(t)}push(e,t,n){if(this._enabled&&(this._global.push(t,n),e!=null)){let i=this._peers.get(e);i==null&&(i=new Xt(this._initialCounters,this._options),this._peers.set(e,i)),i.push(t,n)}}disconnected(e){let t=e.toString(),n=this._peers.get(t);n!=null&&(n.stop(),this._peers.delete(t))}};var nc=U(rc(),1);function Vh(r){return r[Symbol.asyncIterator]!=null}function jh(r,e){if(Vh(r))return async function*(){for await(let a of r)await e(a),yield a}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();if(typeof e(n)?.then=="function")return async function*(){yield n;for await(let a of t)await e(a),yield a}();let s=e;return function*(){yield n;for(let a of t)s(a),yield a}()}var Jt=jh;var Gh={async getHasher(){throw new Error("Not implemented")}},Qh={maxInboundStreams:1024,maxOutboundStreams:1024,incomingStreamTimeout:3e4,hashLoader:Gh,statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},Kh=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],Yr=class{constructor(e,t,n={}){this._libp2p=e,this._log=ae(this.peerId),n=Object.assign({},Qh,n),this.stats=new Zr(e,Kh,{enabled:n.statsEnabled,computeThrottleTimeout:n.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:n.statsComputeThrottleMaxQueueSize}),this.network=new $r(e,this,this.stats,{hashLoader:n.hashLoader,maxInboundStreams:n.maxInboundStreams,maxOutboundStreams:n.maxOutboundStreams,incomingStreamTimeout:n.incomingStreamTimeout}),this.blockstore=t,this.engine=new Vr(this.peerId,t,this.network,this.stats,e),this.wm=new Pr(this.peerId,this.network,this.stats,e),this.notifications=new Jr(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch{this._log("failed to receive message",t)}if(t.blocks.size===0)return;let n=[];for(let[i,o]of t.blocks.entries()){let s=x.parse(i);n.push({wasWanted:this.wm.wantlist.contains(s),cid:s,data:o})}this.wm.cancelWants(n.filter(({wasWanted:i})=>i).map(({cid:i})=>i)),await Promise.all(n.map(async({cid:i,wasWanted:o,data:s})=>{await this._handleReceivedBlock(e,i,s,o)}))}async _handleReceivedBlock(e,t,n,i){this._log("received block");let o=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,n,o),i&&await this.put(t,n)}_updateReceiveCounters(e,t,n,i){this.stats.push(e,"blocksReceived",1),this.stats.push(e,"dataReceived",n.length),i&&(this.stats.push(e,"dupBlksReceived",1),this.stats.push(e,"dupDataReceived",n.length))}_receiveError(e){this._log.error("ReceiveError",e)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this.stats.disconnected(e)}enableStats(){this.stats.enable()}disableStats(){this.stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async want(e,t={}){let n=async(c,u)=>(this.wm.wantBlocks([c],u),await this.notifications.wantBlock(c,u)),i=!1,o=async(c,u)=>{try{return await this.blockstore.get(c,u)}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l;return i||(i=!0,this.network.findAndConnect(c,u).catch(h=>{this._log.error(h)})),await n(c,u)}},s=new AbortController,a=t.signal!=null?(0,nc.anySignal)([t.signal,s.signal]):s.signal;try{return await Promise.race([this.notifications.wantBlock(e,{...t,signal:a}),o(e,{...t,signal:a})])}finally{s.abort()}}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(n=>{this.notifications.unwantBlock(n)})}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,n){await this.blockstore.put(e,t),this.notify(e,t)}async*putMany(e,t){yield*this.blockstore.putMany(Jt(e,({cid:n,block:i})=>{this.notify(n,i)}),t)}notify(e,t,n={}){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,block:t}]),this.network.provide(e,n).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}get peers(){return this.engine.peers()}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this.stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}};var ic=(r,e,t={})=>new Yr(r,e,t);function Xh(r){return r[Symbol.asyncIterator]!=null}function Jh(r,e){if(Xh(r))return async function*(){for await(let a of r)await e(a)&&(yield a)}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();let o=e(n);if(typeof o.then=="function")return async function*(){await o&&(yield n);for await(let a of t)await e(a)&&(yield a)}();let s=e;return function*(){o===!0&&(yield n);for(let a of t)s(a)&&(yield a)}()}var ve=Jh;var mc=U(sc(),1);var Yt=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},zi=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},ac=r=>globalThis.DOMException===void 0?new zi(r):new DOMException(r),cc=r=>{let e=r.reason===void 0?ac("This operation was aborted."):r.reason;return e instanceof Error?e:ac(e)};function $i(r,e,t,n){let i,o=new Promise((s,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(r);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:c}=n;c.aborted&&a(cc(c)),c.addEventListener("abort",()=>{a(cc(c))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{s(t())}catch(l){a(l)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,u=t instanceof Error?t:new Yt(c);typeof r.cancel=="function"&&r.cancel(),a(u)},e),(async()=>{try{s(await r)}catch(c){a(c)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return o.clear=()=>{clearTimeout(i),i=void 0},o}function Wi(r,e,t){let n=0,i=r.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;t(r[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var st=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Te,er=class{constructor(){Te.set(this,[])}enqueue(e,t){t={priority:0,...t};let n={priority:t.priority,run:e};if(this.size&&st(this,Te,"f")[this.size-1].priority>=t.priority){st(this,Te,"f").push(n);return}let i=Wi(st(this,Te,"f"),n,(o,s)=>s.priority-o.priority);st(this,Te,"f").splice(i,0,n)}dequeue(){let e=st(this,Te,"f").shift();return e?.run}filter(e){return st(this,Te,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return st(this,Te,"f").length}};Te=new WeakMap;var N=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},b=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},F,rr,nr,ze,an,ir,tn,me,tr,J,rn,Z,or,Re,nn,uc,lc,dc,fc,hc,on,Hi,qi,cn,pc,sn,un=class extends Error{},Ae=class extends mc.default{constructor(e){var t,n,i,o;if(super(),F.add(this),rr.set(this,void 0),nr.set(this,void 0),ze.set(this,0),an.set(this,void 0),ir.set(this,void 0),tn.set(this,0),me.set(this,void 0),tr.set(this,void 0),J.set(this,void 0),rn.set(this,void 0),Z.set(this,0),or.set(this,void 0),Re.set(this,void 0),nn.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:er,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);N(this,rr,e.carryoverConcurrencyCount,"f"),N(this,nr,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),N(this,an,e.intervalCap,"f"),N(this,ir,e.interval,"f"),N(this,J,new e.queueClass,"f"),N(this,rn,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,N(this,nn,e.throwOnTimeout===!0,"f"),N(this,Re,e.autoStart===!1,"f")}get concurrency(){return b(this,or,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);N(this,or,e,"f"),b(this,F,"m",cn).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:b(this,nn,"f"),...t},new Promise((n,i)=>{b(this,J,"f").enqueue(async()=>{var o,s,a;N(this,Z,(s=b(this,Z,"f"),s++,s),"f"),N(this,ze,(a=b(this,ze,"f"),a++,a),"f");try{if(!((o=t.signal)===null||o===void 0)&&o.aborted)throw new un("The task was aborted.");let c=e({signal:t.signal});t.timeout&&(c=$i(Promise.resolve(c),t.timeout)),t.signal&&(c=Promise.race([c,b(this,F,"m",pc).call(this,t.signal)]));let u=await c;n(u),this.emit("completed",u)}catch(c){if(c instanceof Yt&&!t.throwOnTimeout){n();return}i(c),this.emit("error",c)}finally{b(this,F,"m",dc).call(this)}},t),this.emit("add"),b(this,F,"m",on).call(this)})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return b(this,Re,"f")?(N(this,Re,!1,"f"),b(this,F,"m",cn).call(this),this):this}pause(){N(this,Re,!0,"f")}clear(){N(this,J,new(b(this,rn,"f")),"f")}async onEmpty(){b(this,J,"f").size!==0&&await b(this,F,"m",sn).call(this,"empty")}async onSizeLessThan(e){b(this,J,"f").size<e||await b(this,F,"m",sn).call(this,"next",()=>b(this,J,"f").size<e)}async onIdle(){b(this,Z,"f")===0&&b(this,J,"f").size===0||await b(this,F,"m",sn).call(this,"idle")}get size(){return b(this,J,"f").size}sizeBy(e){return b(this,J,"f").filter(e).length}get pending(){return b(this,Z,"f")}get isPaused(){return b(this,Re,"f")}};rr=new WeakMap,nr=new WeakMap,ze=new WeakMap,an=new WeakMap,ir=new WeakMap,tn=new WeakMap,me=new WeakMap,tr=new WeakMap,J=new WeakMap,rn=new WeakMap,Z=new WeakMap,or=new WeakMap,Re=new WeakMap,nn=new WeakMap,F=new WeakSet,uc=function(){return b(this,nr,"f")||b(this,ze,"f")<b(this,an,"f")},lc=function(){return b(this,Z,"f")<b(this,or,"f")},dc=function(){var e;N(this,Z,(e=b(this,Z,"f"),e--,e),"f"),b(this,F,"m",on).call(this),this.emit("next")},fc=function(){b(this,F,"m",qi).call(this),b(this,F,"m",Hi).call(this),N(this,tr,void 0,"f")},hc=function(){let e=Date.now();if(b(this,me,"f")===void 0){let t=b(this,tn,"f")-e;if(t<0)N(this,ze,b(this,rr,"f")?b(this,Z,"f"):0,"f");else return b(this,tr,"f")===void 0&&N(this,tr,setTimeout(()=>{b(this,F,"m",fc).call(this)},t),"f"),!0}return!1},on=function(){if(b(this,J,"f").size===0)return b(this,me,"f")&&clearInterval(b(this,me,"f")),N(this,me,void 0,"f"),this.emit("empty"),b(this,Z,"f")===0&&this.emit("idle"),!1;if(!b(this,Re,"f")){let e=!b(this,F,"a",hc);if(b(this,F,"a",uc)&&b(this,F,"a",lc)){let t=b(this,J,"f").dequeue();return t?(this.emit("active"),t(),e&&b(this,F,"m",Hi).call(this),!0):!1}}return!1},Hi=function(){b(this,nr,"f")||b(this,me,"f")!==void 0||(N(this,me,setInterval(()=>{b(this,F,"m",qi).call(this)},b(this,ir,"f")),"f"),N(this,tn,Date.now()+b(this,ir,"f"),"f"))},qi=function(){b(this,ze,"f")===0&&b(this,Z,"f")===0&&b(this,me,"f")&&(clearInterval(b(this,me,"f")),N(this,me,void 0,"f")),N(this,ze,b(this,rr,"f")?b(this,Z,"f"):0,"f"),b(this,F,"m",cn).call(this)},cn=function(){for(;b(this,F,"m",on).call(this););},pc=async function(e){return new Promise((t,n)=>{e.addEventListener("abort",()=>{n(new un("The task was aborted."))},{once:!0})})},sn=async function(e,t){return new Promise(n=>{let i=()=>{t&&!t()||(this.off(e,i),n())};this.on(e,i)})};var Vi=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},ji=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},yc=r=>globalThis.DOMException===void 0?new ji(r):new DOMException(r),gc=r=>{let e=r.reason===void 0?yc("This operation was aborted."):r.reason;return e instanceof Error?e:yc(e)};function Gi(r,e){let{milliseconds:t,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=e,s,a=new Promise((c,u)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){c(r);return}if(e.signal){let{signal:h}=e;h.aborted&&u(gc(h)),h.addEventListener("abort",()=>{u(gc(h))})}let l=new Vi;s=o.setTimeout.call(void 0,()=>{if(n){try{c(n())}catch(h){u(h)}return}typeof r.cancel=="function"&&r.cancel(),i===!1?c():i instanceof Error?u(i):(l.message=i??`Promise timed out after ${t} milliseconds`,u(l))},t),(async()=>{try{c(await r)}catch(h){u(h)}finally{o.clearTimeout.call(void 0,s)}})()});return a.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},a}var wc=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");var Qi="lock:worker:request-read",Ki="lock:worker:release-read",Xi="lock:master:grant-read",Ji="lock:worker:request-write",Zi="lock:worker:release-write",Yi="lock:master:grant-write";var $e={},At=r=>{r.addEventListener("message",e=>{At.dispatchEvent("message",r,e)}),r.port!=null&&r.port.addEventListener("message",e=>{At.dispatchEvent("message",r,e)})};At.addEventListener=(r,e)=>{$e[r]==null&&($e[r]=[]),$e[r].push(e)};At.removeEventListener=(r,e)=>{$e[r]!=null&&($e[r]=$e[r].filter(t=>t===e))};At.dispatchEvent=function(r,e,t){$e[r]!=null&&$e[r].forEach(n=>n(e,t))};var eo=At;var bc=(r,e,t,n,i)=>(o,s)=>{if(s.data.type!==t)return;let a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};r.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:async()=>(o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise(c=>{let u=l=>{if(l==null||l.data==null)return;let h={type:l.data.type,name:l.data.name,identifier:l.data.identifier};h.type===n&&h.identifier===a.identifier&&(o.removeEventListener("message",u),c())};o.addEventListener("message",u)}))}}))},_c=(r,e,t,n)=>async()=>{let i=wc();return globalThis.postMessage({type:e,identifier:i,name:r}),await new Promise(o=>{let s=a=>{if(a==null||a.data==null)return;let c={type:a.data.type,identifier:a.data.identifier};c.type===t&&c.identifier===i&&(globalThis.removeEventListener("message",s),o(()=>{globalThis.postMessage({type:n,identifier:i,name:r})}))};globalThis.addEventListener("message",s)})},ed={singleProcess:!1},vc=r=>{if(r=Object.assign({},ed,r),!!globalThis.document||r.singleProcess){let t=new EventTarget;return eo.addEventListener("message",bc(t,"requestReadLock",Qi,Ki,Xi)),eo.addEventListener("message",bc(t,"requestWriteLock",Ji,Zi,Yi)),t}return{isWorker:!0,readLock:t=>_c(t,Qi,Xi,Ki),writeLock:t=>_c(t,Ji,Yi,Zi)}};var at={},We;async function to(r,e){let t,n=new Promise(i=>{t=i});return r.add(async()=>await Gi((async()=>await new Promise(i=>{t(()=>{i()})}))(),{milliseconds:e.timeout})),await n}var td=(r,e)=>{if(We.isWorker===!0)return{readLock:We.readLock(r,e),writeLock:We.writeLock(r,e)};let t=new Ae({concurrency:1}),n;return{async readLock(){if(n!=null)return await to(n,e);n=new Ae({concurrency:e.concurrency,autoStart:!1});let i=n,o=to(n,e);return t.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await o},async writeLock(){return n=null,await to(t,e)}}},rd={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function ro(r){let e=Object.assign({},rd,r);return We==null&&(We=vc(e),We.isWorker!==!0&&(We.addEventListener("requestReadLock",t=>{at[t.data.name]!=null&&at[t.data.name].readLock().then(async n=>await t.data.handler().finally(()=>n()))}),We.addEventListener("requestWriteLock",async t=>{at[t.data.name]!=null&&at[t.data.name].writeLock().then(async n=>await t.data.handler().finally(()=>n()))}))),at[e.name]==null&&(at[e.name]=td(e.name,e)),at[e.name]}var ln=class{constructor(e,t,n={}){this.child=e,this.bitswap=n.bitswap,this.pins=t,this.lock=ro({singleProcess:n.holdGcLock})}unwrap(){return this.child}async put(e,t,n={}){let i=await this.lock.readLock();try{return await this.child.has(e)?(n.onProgress?.(new C("blocks:put:duplicate",e)),e):(this.bitswap?.isStarted()===!0&&(n.onProgress?.(new C("blocks:put:bitswap:notify",e)),this.bitswap.notify(e,t,n)),n.onProgress?.(new C("blocks:put:blockstore:put",e)),await this.child.put(e,t,n))}finally{i()}}async*putMany(e,t={}){let n=await this.lock.readLock();try{let i=ve(e,async({cid:s})=>{let a=await this.child.has(s);return a&&t.onProgress?.(new C("blocks:put-many:duplicate",s)),!a}),o=Jt(i,({cid:s,block:a})=>{t.onProgress?.(new C("blocks:put-many:bitswap:notify",s)),this.bitswap?.notify(s,a,t)});t.onProgress?.(new C("blocks:put-many:blockstore:put-many")),yield*this.child.putMany(o,t)}finally{n()}}async get(e,t={}){let n=await this.lock.readLock();try{if(this.bitswap?.isStarted()!=null&&!await this.child.has(e)){t.onProgress?.(new C("blocks:get:bitswap:get",e));let i=await this.bitswap.want(e,t);return t.onProgress?.(new C("blocks:get:blockstore:put",e)),await this.child.put(e,i,t),i}return t.onProgress?.(new C("blocks:get:blockstore:get",e)),await this.child.get(e,t)}finally{n()}}async*getMany(e,t={}){let n=await this.lock.readLock();try{t.onProgress?.(new C("blocks:get-many:blockstore:get-many")),yield*this.child.getMany(Jt(e,async i=>{if(this.bitswap?.isStarted()===!0&&!await this.child.has(i)){t.onProgress?.(new C("blocks:get-many:bitswap:get",i));let o=await this.bitswap.want(i,t);t.onProgress?.(new C("blocks:get-many:blockstore:put",i)),await this.child.put(i,o,t)}}))}finally{n()}}async delete(e,t={}){let n=await this.lock.writeLock();try{if(await this.pins.isPinned(e))throw new Error("CID was pinned");t.onProgress?.(new C("blocks:delete:blockstore:delete",e)),await this.child.delete(e,t)}finally{n()}}async*deleteMany(e,t={}){let n=await this.lock.writeLock();try{let i=this;t.onProgress?.(new C("blocks:delete-many:blockstore:delete-many")),yield*this.child.deleteMany(async function*(){for await(let o of e){if(await i.pins.isPinned(o))throw new Error("CID was pinned");yield o}}(),t)}finally{n()}}async has(e,t={}){let n=await this.lock.readLock();try{return await this.child.has(e,t)}finally{n()}}async*getAll(e={}){let t=await this.lock.readLock();try{e.onProgress?.(new C("blocks:get-all:blockstore:get-many")),yield*this.child.getAll(e)}finally{t()}}};var xc=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");function fn(r,e="utf8"){let t=Xr[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rt(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}var Be="/",kc=new TextEncoder().encode(Be),hn=kc[0],P=class{constructor(e,t){if(typeof e=="string")this._buf=fn(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==hn)throw new Error("Invalid key")}toString(e="utf8"){return ot(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new P(e.join(Be))}static random(){return new P(xc().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new P(e):typeof e.uint8Array=="function"?new P(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=kc),this._buf[0]!==hn){let e=new Uint8Array(this._buf.byteLength+1);e.fill(hn,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===hn;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return P.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Be).slice(1)}type(){return nd(this.baseNamespace())}name(){return id(this.baseNamespace())}instance(e){return new P(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Be)||(e+=Be),e+=this.type(),new P(e)}parent(){let e=this.list();return e.length===1?new P(Be):new P(e.slice(0,-1).join(Be))}child(e){return this.toString()===Be?e:e.toString()===Be?this:new P(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return P.withNamespaces([...this.namespaces(),...od(e.map(t=>t.namespaces()))])}};function nd(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function id(r){let e=r.split(":");return e[e.length-1]}function od(r){return[].concat(...r)}var sd=["string","number","bigint","symbol"],ad=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Ec(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(sd.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(cd(r))return"Buffer";let t=ud(r);return t||"Object"}function cd(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function ud(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(ad.includes(e))return e}var f=class{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};f.uint=new f(0,"uint",!0);f.negint=new f(1,"negint",!0);f.bytes=new f(2,"bytes",!0);f.string=new f(3,"string",!0);f.array=new f(4,"array",!1);f.map=new f(5,"map",!1);f.tag=new f(6,"tag",!1);f.float=new f(7,"float",!0);f.false=new f(7,"false",!0);f.true=new f(7,"true",!0);f.null=new f(7,"null",!0);f.undefined=new f(7,"undefined",!0);f.break=new f(7,"break",!0);var p=class{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var Bt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",ld=new TextDecoder,fd=new TextEncoder;function dn(r){return Bt&&globalThis.Buffer.isBuffer(r)}function sr(r){return r instanceof Uint8Array?dn(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}var Bc=Bt?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):Tc(r,e,t):(r,e,t)=>t-e>64?ld.decode(r.subarray(e,t)):Tc(r,e,t),pn=Bt?r=>r.length>64?globalThis.Buffer.from(r):Sc(r):r=>r.length>64?fd.encode(r):Sc(r),xe=r=>Uint8Array.from(r),Ct=Bt?(r,e,t)=>dn(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),Cc=Bt?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),sr(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),n=0;for(let i of r)n+i.length>t.length&&(i=i.subarray(0,t.length-n)),t.set(i,n),n+=i.length;return t},Lc=Bt?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);function Pc(r,e){if(dn(r)&&dn(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function Sc(r,e=1/0){let t,n=r.length,i=null,o=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Tc(r,e,t){let n=[];for(;e<t;){let i=r[e],o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=t){let a,c,u,l;switch(s){case 1:i<128&&(o=i);break;case 2:a=r[e+1],(a&192)===128&&(l=(i&31)<<6|a&63,l>127&&(o=l));break;case 3:a=r[e+1],c=r[e+2],(a&192)===128&&(c&192)===128&&(l=(i&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:a=r[e+1],c=r[e+2],u=r[e+3],(a&192)===128&&(c&192)===128&&(u&192)===128&&(l=(i&15)<<18|(a&63)<<12|(c&63)<<6|u&63,l>65535&&l<1114112&&(o=l))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),e+=s}return no(n)}var Ac=4096;function no(r){let e=r.length;if(e<=Ac)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=Ac));return t}var hd=256,ar=class{constructor(e=hd){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let i=t.length-(this.maxCursor-this.cursor)-1;t.set(e,i)}else{if(t){let i=t.length-(this.maxCursor-this.cursor)-1;i<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,i),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=Lc(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ct(n,0,this.cursor)}else t=Cc(this.chunks,this.cursor);return e&&this.reset(),t}};var w="CBOR decode error:",Lt="CBOR encode error:",cr=[];cr[23]=1;cr[24]=2;cr[25]=3;cr[26]=5;cr[27]=9;function Ce(r,e,t){if(r.length-e<t)throw new Error(`${w} not enough data for type`)}var z=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Y(r,e,t){Ce(r,e,1);let n=r[e];if(t.strict===!0&&n<z[0])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function ee(r,e,t){Ce(r,e,2);let n=r[e]<<8|r[e+1];if(t.strict===!0&&n<z[1])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function te(r,e,t){Ce(r,e,4);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&n<z[2])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function re(r,e,t){Ce(r,e,8);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],i=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(t.strict===!0&&o<z[3])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(t.allowBigInt===!0)return o;throw new Error(`${w} integers outside of the safe integer range are not supported`)}function Ic(r,e,t,n){return new p(f.uint,Y(r,e+1,n),2)}function Nc(r,e,t,n){return new p(f.uint,ee(r,e+1,n),3)}function Dc(r,e,t,n){return new p(f.uint,te(r,e+1,n),5)}function Mc(r,e,t,n){return new p(f.uint,re(r,e+1,n),9)}function ue(r,e){return W(r,0,e.value)}function W(r,e,t){if(t<z[0]){let n=Number(t);r.push([e|n])}else if(t<z[1]){let n=Number(t);r.push([e|24,n])}else if(t<z[2]){let n=Number(t);r.push([e|25,n>>>8,n&255])}else if(t<z[3]){let n=Number(t);r.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(t);if(n<z[4]){let i=[e|27,0,0,0,0,0,0,0],o=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=o&255,o=o>>8,i[7]=o&255,o=o>>8,i[6]=o&255,o=o>>8,i[5]=o&255,i[4]=s&255,s=s>>8,i[3]=s&255,s=s>>8,i[2]=s&255,s=s>>8,i[1]=s&255,r.push(i)}else throw new Error(`${w} encountered BigInt larger than allowable range`)}}ue.encodedSize=function(e){return W.encodedSize(e.value)};W.encodedSize=function(e){return e<z[0]?1:e<z[1]?2:e<z[2]?3:e<z[3]?5:9};ue.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function Fc(r,e,t,n){return new p(f.negint,-1-Y(r,e+1,n),2)}function Oc(r,e,t,n){return new p(f.negint,-1-ee(r,e+1,n),3)}function Uc(r,e,t,n){return new p(f.negint,-1-te(r,e+1,n),5)}var io=BigInt(-1),Rc=BigInt(1);function zc(r,e,t,n){let i=re(r,e+1,n);if(typeof i!="bigint"){let o=-1-i;if(o>=Number.MIN_SAFE_INTEGER)return new p(f.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${w} integers outside of the safe integer range are not supported`);return new p(f.negint,io-BigInt(i),9)}function mn(r,e){let t=e.value,n=typeof t=="bigint"?t*io-Rc:t*-1-1;W(r,e.type.majorEncoded,n)}mn.encodedSize=function(e){let t=e.value,n=typeof t=="bigint"?t*io-Rc:t*-1-1;return n<z[0]?1:n<z[1]?2:n<z[2]?3:n<z[3]?5:9};mn.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function ur(r,e,t,n){Ce(r,e,t+n);let i=Ct(r,e+t,e+t+n);return new p(f.bytes,i,t+n)}function $c(r,e,t,n){return ur(r,e,1,t)}function Wc(r,e,t,n){return ur(r,e,2,Y(r,e+1,n))}function Hc(r,e,t,n){return ur(r,e,3,ee(r,e+1,n))}function qc(r,e,t,n){return ur(r,e,5,te(r,e+1,n))}function Vc(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer bytes lengths not supported`);return ur(r,e,9,i)}function yn(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===f.string?pn(r.value):r.value),r.encodedBytes}function Pt(r,e){let t=yn(e);W(r,e.type.majorEncoded,t.length),r.push(t)}Pt.encodedSize=function(e){let t=yn(e);return W.encodedSize(t.length)+t.length};Pt.compareTokens=function(e,t){return pd(yn(e),yn(t))};function pd(r,e){return r.length<e.length?-1:r.length>e.length?1:Pc(r,e)}function lr(r,e,t,n,i){let o=t+n;Ce(r,e,o);let s=new p(f.string,Bc(r,e+t,e+o),o);return i.retainStringBytes===!0&&(s.byteValue=Ct(r,e+t,e+o)),s}function jc(r,e,t,n){return lr(r,e,1,t,n)}function Gc(r,e,t,n){return lr(r,e,2,Y(r,e+1,n),n)}function Qc(r,e,t,n){return lr(r,e,3,ee(r,e+1,n),n)}function Kc(r,e,t,n){return lr(r,e,5,te(r,e+1,n),n)}function Xc(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer string lengths not supported`);return lr(r,e,9,i,n)}var Jc=Pt;function It(r,e,t,n){return new p(f.array,n,t)}function Zc(r,e,t,n){return It(r,e,1,t)}function Yc(r,e,t,n){return It(r,e,2,Y(r,e+1,n))}function eu(r,e,t,n){return It(r,e,3,ee(r,e+1,n))}function tu(r,e,t,n){return It(r,e,5,te(r,e+1,n))}function ru(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer array lengths not supported`);return It(r,e,9,i)}function nu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return It(r,e,1,1/0)}function gn(r,e){W(r,f.array.majorEncoded,e.value)}gn.compareTokens=ue.compareTokens;gn.encodedSize=function(e){return W.encodedSize(e.value)};function Nt(r,e,t,n){return new p(f.map,n,t)}function iu(r,e,t,n){return Nt(r,e,1,t)}function ou(r,e,t,n){return Nt(r,e,2,Y(r,e+1,n))}function su(r,e,t,n){return Nt(r,e,3,ee(r,e+1,n))}function au(r,e,t,n){return Nt(r,e,5,te(r,e+1,n))}function cu(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer map lengths not supported`);return Nt(r,e,9,i)}function uu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return Nt(r,e,1,1/0)}function wn(r,e){W(r,f.map.majorEncoded,e.value)}wn.compareTokens=ue.compareTokens;wn.encodedSize=function(e){return W.encodedSize(e.value)};function lu(r,e,t,n){return new p(f.tag,t,1)}function fu(r,e,t,n){return new p(f.tag,Y(r,e+1,n),2)}function hu(r,e,t,n){return new p(f.tag,ee(r,e+1,n),3)}function du(r,e,t,n){return new p(f.tag,te(r,e+1,n),5)}function pu(r,e,t,n){return new p(f.tag,re(r,e+1,n),9)}function bn(r,e){W(r,f.tag.majorEncoded,e.value)}bn.compareTokens=ue.compareTokens;bn.encodedSize=function(e){return W.encodedSize(e.value)};var _d=20,vd=21,xd=22,kd=23;function mu(r,e,t,n){if(n.allowUndefined===!1)throw new Error(`${w} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new p(f.null,null,1):new p(f.undefined,void 0,1)}function yu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return new p(f.break,void 0,1)}function oo(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${w} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${w} Infinity values are not supported`)}return new p(f.float,r,e)}function gu(r,e,t,n){return oo(so(r,e+1),3,n)}function wu(r,e,t,n){return oo(ao(r,e+1),5,n)}function bu(r,e,t,n){return oo(ku(r,e+1),9,n)}function _n(r,e,t){let n=e.value;if(n===!1)r.push([f.float.majorEncoded|_d]);else if(n===!0)r.push([f.float.majorEncoded|vd]);else if(n===null)r.push([f.float.majorEncoded|xd]);else if(n===void 0)r.push([f.float.majorEncoded|kd]);else{let i,o=!1;(!t||t.float64!==!0)&&(vu(n),i=so(ye,1),n===i||Number.isNaN(n)?(ye[0]=249,r.push(ye.slice(0,3)),o=!0):(xu(n),i=ao(ye,1),n===i&&(ye[0]=250,r.push(ye.slice(0,5)),o=!0))),o||(Ed(n),i=ku(ye,1),ye[0]=251,r.push(ye.slice(0,9)))}}_n.encodedSize=function(e,t){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){vu(n);let i=so(ye,1);if(n===i||Number.isNaN(n))return 3;if(xu(n),i=ao(ye,1),n===i)return 5}return 9};var _u=new ArrayBuffer(9),le=new DataView(_u,1),ye=new Uint8Array(_u,0);function vu(r){if(r===1/0)le.setUint16(0,31744,!1);else if(r===-1/0)le.setUint16(0,64512,!1);else if(Number.isNaN(r))le.setUint16(0,32256,!1);else{le.setFloat32(0,r);let e=le.getUint32(0),t=(e&2139095040)>>23,n=e&8388607;if(t===255)le.setUint16(0,31744,!1);else if(t===0)le.setUint16(0,(r&2147483648)>>16|n>>13,!1);else{let i=t-127;i<-24?le.setUint16(0,0):i<-14?le.setUint16(0,(e&2147483648)>>16|1<<24+i,!1):le.setUint16(0,(e&2147483648)>>16|i+15<<10|n>>13,!1)}}}function so(r,e){if(r.length-e<2)throw new Error(`${w} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let n=t>>10&31,i=t&1023,o;return n===0?o=i*2**-24:n!==31?o=(i+1024)*2**(n-25):o=i===0?1/0:NaN,t&32768?-o:o}function xu(r){le.setFloat32(0,r,!1)}function ao(r,e){if(r.length-e<4)throw new Error(`${w} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function Ed(r){le.setFloat64(0,r,!1)}function ku(r,e){if(r.length-e<8)throw new Error(`${w} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}_n.compareTokens=ue.compareTokens;function A(r,e,t){throw new Error(`${w} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function vn(r){return()=>{throw new Error(`${w} ${r}`)}}var m=[];for(let r=0;r<=23;r++)m[r]=A;m[24]=Ic;m[25]=Nc;m[26]=Dc;m[27]=Mc;m[28]=A;m[29]=A;m[30]=A;m[31]=A;for(let r=32;r<=55;r++)m[r]=A;m[56]=Fc;m[57]=Oc;m[58]=Uc;m[59]=zc;m[60]=A;m[61]=A;m[62]=A;m[63]=A;for(let r=64;r<=87;r++)m[r]=$c;m[88]=Wc;m[89]=Hc;m[90]=qc;m[91]=Vc;m[92]=A;m[93]=A;m[94]=A;m[95]=vn("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)m[r]=jc;m[120]=Gc;m[121]=Qc;m[122]=Kc;m[123]=Xc;m[124]=A;m[125]=A;m[126]=A;m[127]=vn("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)m[r]=Zc;m[152]=Yc;m[153]=eu;m[154]=tu;m[155]=ru;m[156]=A;m[157]=A;m[158]=A;m[159]=nu;for(let r=160;r<=183;r++)m[r]=iu;m[184]=ou;m[185]=su;m[186]=au;m[187]=cu;m[188]=A;m[189]=A;m[190]=A;m[191]=uu;for(let r=192;r<=215;r++)m[r]=lu;m[216]=fu;m[217]=hu;m[218]=du;m[219]=pu;m[220]=A;m[221]=A;m[222]=A;m[223]=A;for(let r=224;r<=243;r++)m[r]=vn("simple values are not supported");m[244]=A;m[245]=A;m[246]=A;m[247]=mu;m[248]=vn("simple values are not supported");m[249]=gu;m[250]=wu;m[251]=bu;m[252]=A;m[253]=A;m[254]=A;m[255]=yu;var ge=[];for(let r=0;r<24;r++)ge[r]=new p(f.uint,r,1);for(let r=-1;r>=-24;r--)ge[31-r]=new p(f.negint,r,1);ge[64]=new p(f.bytes,new Uint8Array(0),1);ge[96]=new p(f.string,"",1);ge[128]=new p(f.array,0,1);ge[160]=new p(f.map,0,1);ge[244]=new p(f.false,!1,1);ge[245]=new p(f.true,!0,1);ge[246]=new p(f.null,null,1);function Eu(r){switch(r.type){case f.false:return xe([244]);case f.true:return xe([245]);case f.null:return xe([246]);case f.bytes:return r.value.length?void 0:xe([64]);case f.string:return r.value===""?xe([96]):void 0;case f.array:return r.value===0?xe([128]):void 0;case f.map:return r.value===0?xe([160]):void 0;case f.uint:return r.value<24?xe([Number(r.value)]):void 0;case f.negint:if(r.value>=-24)return xe([31-Number(r.value)])}}var Td={float64:!1,mapSorter:Cd,quickEncodeToken:Eu};function Ad(){let r=[];return r[f.uint.major]=ue,r[f.negint.major]=mn,r[f.bytes.major]=Pt,r[f.string.major]=Jc,r[f.array.major]=gn,r[f.map.major]=wn,r[f.tag.major]=bn,r[f.float.major]=_n,r}var Su=Ad(),co=new ar,Dt=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Lt} object contains circular references`);return new Dt(t,e)}},He={null:new p(f.null,null),undefined:new p(f.undefined,void 0),true:new p(f.true,!0),false:new p(f.false,!1),emptyArray:new p(f.array,0),emptyMap:new p(f.map,0)},qe={number(r,e,t,n){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new p(f.float,r):r>=0?new p(f.uint,r):new p(f.negint,r)},bigint(r,e,t,n){return r>=BigInt(0)?new p(f.uint,r):new p(f.negint,r)},Uint8Array(r,e,t,n){return new p(f.bytes,r)},string(r,e,t,n){return new p(f.string,r)},boolean(r,e,t,n){return r?He.true:He.false},null(r,e,t,n){return He.null},undefined(r,e,t,n){return He.undefined},ArrayBuffer(r,e,t,n){return new p(f.bytes,new Uint8Array(r))},DataView(r,e,t,n){return new p(f.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,n){if(!r.length)return t.addBreakTokens===!0?[He.emptyArray,new p(f.break)]:He.emptyArray;n=Dt.createCheck(n,r);let i=[],o=0;for(let s of r)i[o++]=xn(s,t,n);return t.addBreakTokens?[new p(f.array,r.length),i,new p(f.break)]:[new p(f.array,r.length),i]},Object(r,e,t,n){let i=e!=="Object",o=i?r.keys():Object.keys(r),s=i?r.size:o.length;if(!s)return t.addBreakTokens===!0?[He.emptyMap,new p(f.break)]:He.emptyMap;n=Dt.createCheck(n,r);let a=[],c=0;for(let u of o)a[c++]=[xn(u,t,n),xn(i?r.get(u):r[u],t,n)];return Bd(a,t),t.addBreakTokens?[new p(f.map,s),a,new p(f.break)]:[new p(f.map,s),a]}};qe.Map=qe.Object;qe.Buffer=qe.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))qe[`${r}Array`]=qe.DataView;function xn(r,e={},t){let n=Ec(r),i=e&&e.typeEncoders&&e.typeEncoders[n]||qe[n];if(typeof i=="function"){let s=i(r,n,e,t);if(s!=null)return s}let o=qe[n];if(!o)throw new Error(`${Lt} unsupported type: ${n}`);return o(r,n,e,t)}function Bd(r,e){e.mapSorter&&r.sort(e.mapSorter)}function Cd(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==n.type)return t.type.compare(n.type);let i=t.type.major,o=Su[i].compareTokens(t,n);return o===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function Tu(r,e,t,n){if(Array.isArray(e))for(let i of e)Tu(r,i,t,n);else t[e.type.major](r,e,n)}function Au(r,e,t){let n=xn(r,t);if(!Array.isArray(n)&&t.quickEncodeToken){let i=t.quickEncodeToken(n);if(i)return i;let o=e[n.type.major];if(o.encodedSize){let s=o.encodedSize(n,t),a=new ar(s);if(o(a,n,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return sr(a.chunks[0])}}return co.reset(),Tu(co,n,e,t),co.toBytes(!0)}function kn(r,e){return e=Object.assign({},Td,e),Au(r,Su,e)}var Ld={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},uo=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=ge[e];if(t===void 0){let n=m[e];if(!n)throw new Error(`${w} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;t=n(this.data,this.pos,i,this.options)}return this.pos+=t.encodedLength,t}},fr=Symbol.for("DONE"),En=Symbol.for("BREAK");function Pd(r,e,t){let n=[];for(let i=0;i<r.value;i++){let o=hr(e,t);if(o===En){if(r.value===1/0)break;throw new Error(`${w} got unexpected break to lengthed array`)}if(o===fr)throw new Error(`${w} found array but not enough entries (got ${i}, expected ${r.value})`);n[i]=o}return n}function Id(r,e,t){let n=t.useMaps===!0,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<r.value;s++){let a=hr(e,t);if(a===En){if(r.value===1/0)break;throw new Error(`${w} got unexpected break to lengthed map`)}if(a===fr)throw new Error(`${w} found map but not enough entries (got ${s} [no key], expected ${r.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${w} non-string keys not supported (got ${typeof a})`);if(t.rejectDuplicateMapKeys===!0&&(n&&o.has(a)||!n&&a in i))throw new Error(`${w} found repeat map key "${a}"`);let c=hr(e,t);if(c===fr)throw new Error(`${w} found map but not enough entries (got ${s} [no value], expected ${r.value})`);n?o.set(a,c):i[a]=c}return n?o:i}function hr(r,e){if(r.done())return fr;let t=r.next();if(t.type===f.break)return En;if(t.type.terminal)return t.value;if(t.type===f.array)return Pd(t,r,e);if(t.type===f.map)return Id(t,r,e);if(t.type===f.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let n=hr(r,e);return e.tags[t.value](n)}throw new Error(`${w} tag not supported (${t.value})`)}throw new Error("unsupported")}function Le(r,e){if(!(r instanceof Uint8Array))throw new Error(`${w} data to decode must be a Uint8Array`);e=Object.assign({},Ld,e);let t=e.tokenizer||new uo(r,e),n=hr(t,e);if(n===fr)throw new Error(`${w} did not find any content to decode`);if(n===En)throw new Error(`${w} got unexpected break`);if(!t.done())throw new Error(`${w} too many terminals, data makes no sense`);return n}function lo(){let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r}var Nd=new TextDecoder;function fo(r,e){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let i=r[e++];if(t+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[t,e]}function Sn(r,e){let t;[t,e]=fo(r,e);let n=e+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,n),n]}function Cu(r,e){let t;return[t,e]=fo(r,e),[t&7,t>>3,e]}function Dd(r){let e={},t=r.length,n=0;for(;n<t;){let i,o;if([i,o,n]=Cu(r,n),o===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Sn(r,n)}else if(o===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Sn(r,n),e.Name=Nd.decode(s)}else if(o===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[e.Tsize,n]=fo(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function Lu(r){let e=r.length,t=0,n,i=!1,o;for(;t<e;){let a,c;if([a,c,t]=Cu(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,t]=Sn(r,t),n&&(i=!0)}else if(c===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let u;[u,t]=Sn(r,t),n.push(Dd(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}var Xb=new TextEncoder,Jb=2**32,Zb=2**31;var t0=new TextEncoder;var Pu=112;function Iu(r){let e=Lu(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(n=>{let i={};try{i.Hash=x.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),t}var Nu=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){let t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===f.array&&(t.elements++,t.elements!==1&&e.push([44])),t.type===f.map&&(t.elements++,t.elements!==1&&(t.elements%2===1?e.push([44]):e.push([58]))))}[f.uint.major](e,t){this.prefix(e);let n=String(t.value),i=[];for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o);e.push(i)}[f.negint.major](e,t){this[f.uint.major](e,t)}[f.bytes.major](e,t){throw new Error(`${Lt} unsupported type: Uint8Array`)}[f.string.major](e,t){this.prefix(e);let n=pn(JSON.stringify(t.value));e.push(n.length>32?sr(n):n)}[f.array.major](e,t){this.prefix(e),this.inRecursive.push({type:f.array,elements:0}),e.push([91])}[f.map.major](e,t){this.prefix(e),this.inRecursive.push({type:f.map,elements:0}),e.push([123])}[f.tag.major](e,t){}[f.float.major](e,t){if(t.type.name==="break"){let s=this.inRecursive.pop();if(s){if(s.type===f.array)e.push([93]);else if(s.type===f.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${Lt} unsupported type: undefined`);if(this.prefix(e),t.type.name==="true"){e.push([116,114,117,101]);return}else if(t.type.name==="false"){e.push([102,97,108,115,101]);return}else if(t.type.name==="null"){e.push([110,117,108,108]);return}let n=String(t.value),i=[],o=!1;for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s),!o&&(i[s]===46||i[s]===101||i[s]===69)&&(o=!0);o||(i.push(46),i.push(48)),e.push(i)}};var Mt=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${w} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${w} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this.pos,t=!1,n=!1,i=a=>{for(;!this.done();){let c=this.ch();if(a.includes(c))this.pos++;else break}};if(this.ch()===45&&(t=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,n=!0;else return new p(f.uint,0,this.pos-e);if(i([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${w} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${w} unexpected token at position ${this.pos}`);n=!0,this.pos++,i([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,i([48,49,50,51,52,53,54,55,56,57]));let o=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),s=parseFloat(o);return n?new p(f.float,s,this.pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(s)?new p(s>=0?f.uint:f.negint,s,this.pos-e):new p(s>=0?f.uint:f.negint,BigInt(o),this.pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${w} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let o=this.pos,s=0;o<this.data.length&&s<65536;o++,s++){let a=this.data[o];if(a===92||a<32||a>=128)break;if(a===34){let c=String.fromCharCode.apply(null,this.data.subarray(this.pos,o));return this.pos=o+1,new p(f.string,c,s)}}let e=this.pos,t=[],n=()=>{if(this.pos+4>=this.data.length)throw new Error(`${w} unexpected end of unicode escape sequence at position ${this.pos}`);let o=0;for(let s=0;s<4;s++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${w} unexpected unicode escape character at position ${this.pos}`);o=o*16+a,this.pos++}return o},i=()=>{let o=this.ch(),s=null,a=o>239?4:o>223?3:o>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${w} unexpected unicode sequence at position ${this.pos}`);let c,u,l,h;switch(a){case 1:o<128&&(s=o);break;case 2:c=this.data[this.pos+1],(c&192)===128&&(h=(o&31)<<6|c&63,h>127&&(s=h));break;case 3:c=this.data[this.pos+1],u=this.data[this.pos+2],(c&192)===128&&(u&192)===128&&(h=(o&15)<<12|(c&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:c=this.data[this.pos+1],u=this.data[this.pos+2],l=this.data[this.pos+3],(c&192)===128&&(u&192)===128&&(l&192)===128&&(h=(o&15)<<18|(c&63)<<12|(u&63)<<6|l&63,h>65535&&h<1114112&&(s=h))}s===null?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|s&1023),t.push(s),this.pos+=a};for(;!this.done();){let o=this.ch(),s;switch(o){case 92:if(this.pos++,this.done())throw new Error(`${w} unexpected string termination at position ${this.pos}`);switch(s=this.ch(),this.pos++,s){case 34:case 39:case 92:case 47:t.push(s);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error(`${w} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new p(f.string,no(t),this.pos-e);default:if(o<32)throw new Error(`${w} invalid control character at position ${this.pos}`);o<128?(t.push(o),this.pos++):i()}}throw new Error(`${w} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new p(f.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new p(f.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new p(f.null,null,4);case 102:return this.expect([102,97,108,115,101]),new p(f.false,!1,5);case 116:return this.expect([116,114,117,101]),new p(f.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${w} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);if(this.ch()!==44)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new p(f.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);if(this.ch()!==44)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${w} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}};function ho(r,e){return e=Object.assign({tokenizer:new Mt(r,e)},e),Le(r,e)}var Du={codec:Pu,async*walk(r){yield*Iu(r).Links.map(t=>t.Hash)}},Mu={codec:Kr,async*walk(){}},Fu=42,Ou={codec:113,async*walk(r){let e=[],t=[];t[Fu]=n=>{if(n[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");let i=x.decode(n.subarray(1));return e.push(i),i},Le(r,{tags:t}),yield*e}},po=class extends Mt{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===f.map){let t=this._next();if(t.type===f.string&&t.value==="/"){let n=this._next();if(n.type===f.string){if(this._next().type!==f.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new p(f.tag,42,0)}if(n.type===f.map){let i=this._next();if(i.type===f.string&&i.value==="bytes"){let o=this._next();if(o.type===f.string){for(let a=0;a<2;a++)if(this._next().type!==f.break)throw new Error("Invalid encoded Bytes form");let s=Wt.decode(`m${o.value}`);return new p(f.bytes,s,o.value.length)}this.tokenBuffer.push(o)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(t)}return e}},Uu={codec:297,async*walk(r){let e=[],t=[];t[Fu]=n=>{let i=x.parse(n);return e.push(i),i},ho(r,{tags:t,tokenizer:new po(r,{tags:t,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})}),yield*e}};var Tn=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ft,mo,Ru,Od=[Mu,Du,Ou,Uu],Wu="/pin/",Hu="/pinned-block/",yo=Kt,zu=1;function $u(r){return r.version===0&&(r=r.toV1()),new P(`${Wu}${r.toString(yo)}`)}var An=class{constructor(e,t,n){Ft.add(this),this.datastore=e,this.blockstore=t,this.dagWalkers={},[...Od,...n].forEach(i=>{this.dagWalkers[i.codec]=i})}async add(e,t={}){let n=$u(e);if(await this.datastore.has(n))throw new Error("Already pinned");let i=Math.round(t.depth??1/0);if(i<0)throw new Error("Depth must be greater than or equal to 0");let o=new Ae({concurrency:zu});o.add(async()=>{await Tn(this,Ft,"m",mo).call(this,e,o,c=>{c.pinnedBy.find(u=>Qe(u,e.bytes))==null&&(c.pinCount++,c.pinnedBy.push(e.bytes))},{...t,depth:i})});let s=lo();o.on("error",c=>{o.clear(),s.reject(c)}),await Promise.race([o.onIdle(),s.promise]);let a={depth:i,metadata:t.metadata??{}};return await this.datastore.put(n,kn(a),t),{cid:e,...a}}async rm(e,t={}){let n=$u(e),i=await this.datastore.get(n,t),o=Le(i);await this.datastore.delete(n,t);let s=new Ae({concurrency:zu});return s.add(async()=>{await Tn(this,Ft,"m",mo).call(this,e,s,a=>{a.pinCount--,a.pinnedBy=a.pinnedBy.filter(c=>Qe(c,e.bytes))},{...t,depth:o.depth})}),await s.onIdle(),{cid:e,...o}}async*ls(e={}){for await(let{key:t,value:n}of this.datastore.query({prefix:Wu+(e.cid!=null?`${e.cid.toString(Kt)}`:"")},e)){let i=x.parse(t.toString().substring(5),Kt),o=Le(n);yield{cid:i,...o}}}async isPinned(e,t={}){let n=new P(`${Hu}${yo.encode(e.multihash.bytes)}`);return await this.datastore.has(n,t)}};Ft=new WeakSet,mo=async function r(e,t,n,i){if(i.depth===-1)return;let o=this.dagWalkers[e.code];if(o==null)throw new Error(`No dag walker found for cid codec ${e.code}`);let s=await this.blockstore.get(e);await Tn(this,Ft,"m",Ru).call(this,e,n,i);for await(let a of o.walk(s))t.add(async()=>{await Tn(this,Ft,"m",r).call(this,a,t,n,{...i,depth:i.depth-1})})},Ru=async function(e,t,n){let i=new P(`${Hu}${yo.encode(e.multihash.bytes)}`),o={pinCount:0,pinnedBy:[]};try{o=Le(await this.datastore.get(i,n))}catch(s){if(s.code!=="ERR_NOT_FOUND")throw s}if(t(o),o.pinCount===0&&await this.datastore.has(i)){await this.datastore.delete(i);return}await this.datastore.put(i,kn(o),n)};var go=new P("/version"),qu=1;async function Vu(r){if(!await r.has(go)){await r.put(go,fn(`${qu}`));return}let e=await r.get(go),t=ot(e);if(parseInt(t,10)!==qu)throw new Error("Unknown datastore version, a datastore migration may be required")}var ju=U(Or(),1);function Bn(r){return r=r??new Error("Not Found"),(0,ju.default)(r,"ERR_NOT_FOUND")}var Gu="SHARDING";function Rd(r){return r[Symbol.asyncIterator]!=null}function zd(r){if(Rd(r))return(async()=>{let t=[];for await(let n of r)t.push(n);return t})();let e=[];for(let t of r)e.push(t);return e}var wo=zd;function $d(r){return r[Symbol.asyncIterator]!=null}function Wd(r,e){return $d(r)?async function*(){yield*(await wo(r)).sort(e)}():function*(){yield*wo(r).sort(e)}()}var Cn=Wd;var Pe=class{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:n,value:i}of e)await this.put(n,i,t),yield n}async*getMany(e,t={}){for await(let n of e)yield{key:n,value:await this.get(n,t)}}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(n,i){e.push({key:n,value:i})},delete(n){t.push(n)},commit:async n=>{await Ue(this.putMany(e,n)),e=[],await Ue(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(e.prefix!=null){let i=e.prefix;n=ve(n,o=>o.key.toString().startsWith(i))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>ve(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>Cn(i,o),n)),e.offset!=null){let i=0,o=e.offset;n=ve(n,()=>i++>=o)}return e.limit!=null&&(n=Et(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(e.prefix!=null){let i=e.prefix;n=ve(n,o=>o.toString().startsWith(i))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>ve(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>Cn(i,o),n)),e.offset!=null){let i=e.offset,o=0;n=ve(n,()=>o++>=i)}return e.limit!=null&&(n=Et(n,e.limit)),n}};var pr=class extends Pe{constructor(){super(),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){let t=this.data.get(e.toString());if(t==null)throw Bn();return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(let[e,t]of this.data.entries())yield{key:new P(e),value:t}}*_allKeys(){for(let e of this.data.keys())yield new P(e)}};var d1=new P(Gu);var S1=wt("datastore:core:tiered");var Ln={};V(Ln,{abortedError:()=>Jd,closeFailedError:()=>jd,deleteFailedError:()=>Kd,getFailedError:()=>Qd,hasFailedError:()=>Xd,notFoundError:()=>bo,openFailedError:()=>Vd,putFailedError:()=>Gd});var Ie=U(Or(),1);function Vd(r){return r=r??new Error("Open failed"),(0,Ie.default)(r,"ERR_OPEN_FAILED")}function jd(r){return r=r??new Error("Close failed"),(0,Ie.default)(r,"ERR_CLOSE_FAILED")}function Gd(r){return r=r??new Error("Put failed"),(0,Ie.default)(r,"ERR_PUT_FAILED")}function Qd(r){return r=r??new Error("Get failed"),(0,Ie.default)(r,"ERR_GET_FAILED")}function Kd(r){return r=r??new Error("Delete failed"),(0,Ie.default)(r,"ERR_DELETE_FAILED")}function Xd(r){return r=r??new Error("Has failed"),(0,Ie.default)(r,"ERR_HAS_FAILED")}function bo(r){return r=r??new Error("Not Found"),(0,Ie.default)(r,"ERR_NOT_FOUND")}function Jd(r){return r=r??new Error("Aborted"),(0,Ie.default)(r,"ERR_ABORTED")}var mr=class{has(e,t){return Promise.reject(new Error(".has is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}async*putMany(e,t){for await(let{cid:n,block:i}of e)await this.put(n,i,t),yield n}get(e,t){return Promise.reject(new Error(".get is not implemented"))}async*getMany(e,t){for await(let n of e)yield{cid:n,block:await this.get(n,t)}}async delete(e,t){await Promise.reject(new Error(".delete is not implemented"))}async*deleteMany(e,t){for await(let n of e)await this.delete(n,t),yield n}async*getAll(e){throw new Error(".getAll is not implemented")}};var yr=class extends mr{constructor(){super(),this.data=new Map}put(e,t){return this.data.set(j.encode(e.multihash.bytes),t),e}get(e){let t=this.data.get(j.encode(e.multihash.bytes));if(t==null)throw bo();return t}has(e){return this.data.has(j.encode(e.multihash.bytes))}async delete(e){this.data.delete(j.encode(e.multihash.bytes))}async*getAll(){for(let[e,t]of this.data.entries())yield{cid:x.createV1(Kr,br(j.decode(e))),block:t}}};var G1={...Ln};var Zd=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},_o=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ot,vo=wt("helia"),Pn=class{constructor(e){Ot.set(this,void 0);let t=[je,On,Nn,...e.hashers??[]],n=e.datastore??new pr,i=e.blockstore??new yr,o=e.libp2p??new Proxy({},{get(s,a){let c=()=>{};if(["start","stop"].includes(a.toString()))return c;if(a==="isProxy")return!0;throw new Error("Please configure Helia with a libp2p instance")},set(){throw new Error("Please configure Helia with a libp2p instance")}});e.libp2p!=null&&Zd(this,Ot,e.bitswap??ic(o,i,{hashLoader:{getHasher:async s=>{let a=t.find(c=>c.code===s||c.name===s);if(a!=null)return await Promise.resolve(a);throw new Error(`Could not load hasher for code/name "${s}"`)}}}),"f"),this.pins=new An(n,i,e.dagWalkers??[]),this.libp2p=o,this.blockstore=new ln(i,this.pins,{bitswap:_o(this,Ot,"f"),holdGcLock:e.holdGcLock}),this.datastore=n}async start(){await Vu(this.datastore),await _o(this,Ot,"f")?.start(),await this.libp2p.start()}async stop(){await this.libp2p.stop(),await _o(this,Ot,"f")?.stop()}async gc(e={}){let t=await this.blockstore.lock.writeLock();try{let n=this,i=this.blockstore.unwrap();vo("gc start"),await Ue(i.deleteMany(async function*(){for await(let{cid:o}of i.getAll())try{if(await n.pins.isPinned(o,e))continue;yield o,e.onProgress?.(new C("helia:gc:deleted",o))}catch(s){vo.error("Error during gc",s),e.onProgress?.(new C("helia:gc:error",s))}}()))}finally{t()}vo("gc finished")}};Ot=new WeakMap;async function Yd(r={}){let e=new Pn(r);return r.start!==!1&&await e.start(),e}return el(ep);})();
+return Helia}));
diff --git a/node_modules/helia/dist/dist/src/helia.d.ts b/node_modules/helia/dist/dist/src/helia.d.ts
new file mode 100644
index 0000000..1ac8af4
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/helia.d.ts
@@ -0,0 +1,18 @@
+import type { GCOptions, Helia } from '@helia/interface';
+import type { Libp2p } from '@libp2p/interface-libp2p';
+import type { Datastore } from 'interface-datastore';
+import type { HeliaInit } from '.';
+import { BlockStorage } from './storage.js';
+import type { Pins } from '@helia/interface/pins';
+export declare class HeliaImpl implements Helia {
+    #private;
+    libp2p: Libp2p;
+    blockstore: BlockStorage;
+    datastore: Datastore;
+    pins: Pins;
+    constructor(init: HeliaInit);
+    start(): Promise<void>;
+    stop(): Promise<void>;
+    gc(options?: GCOptions): Promise<void>;
+}
+//# sourceMappingURL=helia.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/helia.d.ts.map b/node_modules/helia/dist/dist/src/helia.d.ts.map
new file mode 100644
index 0000000..d02b5a1
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/helia.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"helia.d.ts","sourceRoot":"","sources":["../../src/helia.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,kBAAkB,CAAA;AACxD,OAAO,KAAK,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAA;AACtD,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,qBAAqB,CAAA;AAKpD,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,GAAG,CAAA;AAElC,OAAO,EAAE,YAAY,EAAE,MAAM,cAAc,CAAA;AAC3C,OAAO,KAAK,EAAE,IAAI,EAAE,MAAM,uBAAuB,CAAA;AAWjD,qBAAa,SAAU,YAAW,KAAK;;IAC9B,MAAM,EAAE,MAAM,CAAA;IACd,UAAU,EAAE,YAAY,CAAA;IACxB,SAAS,EAAE,SAAS,CAAA;IACpB,IAAI,EAAE,IAAI,CAAA;gBAIJ,IAAI,EAAE,SAAS;IA4DtB,KAAK,IAAK,OAAO,CAAC,IAAI,CAAC;IAOvB,IAAI,IAAK,OAAO,CAAC,IAAI,CAAC;IAKtB,EAAE,CAAE,OAAO,GAAE,SAAc,GAAG,OAAO,CAAC,IAAI,CAAC;CA+BlD"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/helia.js b/node_modules/helia/dist/dist/src/helia.js
new file mode 100644
index 0000000..6af995c
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/helia.js
@@ -0,0 +1,114 @@
+var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
+    if (kind === "m") throw new TypeError("Private method is not writable");
+    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
+    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
+    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
+};
+var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
+    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
+    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
+    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
+};
+var _HeliaImpl_bitswap;
+import { identity } from 'multiformats/hashes/identity';
+import { sha256, sha512 } from 'multiformats/hashes/sha2';
+import { createBitswap } from 'ipfs-bitswap';
+import { BlockStorage } from './storage.js';
+import { PinsImpl } from './pins.js';
+import { assertDatastoreVersionIsCurrent } from './utils/datastore-version.js';
+import drain from 'it-drain';
+import { CustomProgressEvent } from 'progress-events';
+import { MemoryDatastore } from 'datastore-core';
+import { MemoryBlockstore } from 'blockstore-core';
+import { logger } from '@libp2p/logger';
+const log = logger('helia');
+export class HeliaImpl {
+    constructor(init) {
+        _HeliaImpl_bitswap.set(this, void 0);
+        const hashers = [
+            sha256,
+            sha512,
+            identity,
+            ...(init.hashers ?? [])
+        ];
+        const datastore = init.datastore ?? new MemoryDatastore();
+        const blockstore = init.blockstore ?? new MemoryBlockstore();
+        // @ts-expect-error incomplete libp2p implementation
+        const libp2p = init.libp2p ?? new Proxy({}, {
+            get(_, prop) {
+                const noop = () => { };
+                const noops = ['start', 'stop'];
+                if (noops.includes(prop.toString())) {
+                    return noop;
+                }
+                if (prop === 'isProxy') {
+                    return true;
+                }
+                throw new Error('Please configure Helia with a libp2p instance');
+            },
+            set() {
+                throw new Error('Please configure Helia with a libp2p instance');
+            }
+        });
+        if (init.libp2p != null) {
+            __classPrivateFieldSet(this, _HeliaImpl_bitswap, init.bitswap ?? createBitswap(libp2p, blockstore, {
+                hashLoader: {
+                    getHasher: async (codecOrName) => {
+                        const hasher = hashers.find(hasher => {
+                            return hasher.code === codecOrName || hasher.name === codecOrName;
+                        });
+                        if (hasher != null) {
+                            return await Promise.resolve(hasher);
+                        }
+                        throw new Error(`Could not load hasher for code/name "${codecOrName}"`);
+                    }
+                }
+            }), "f");
+        }
+        this.pins = new PinsImpl(datastore, blockstore, init.dagWalkers ?? []);
+        this.libp2p = libp2p;
+        this.blockstore = new BlockStorage(blockstore, this.pins, {
+            bitswap: __classPrivateFieldGet(this, _HeliaImpl_bitswap, "f"),
+            holdGcLock: init.holdGcLock
+        });
+        this.datastore = datastore;
+    }
+    async start() {
+        await assertDatastoreVersionIsCurrent(this.datastore);
+        await __classPrivateFieldGet(this, _HeliaImpl_bitswap, "f")?.start();
+        await this.libp2p.start();
+    }
+    async stop() {
+        await this.libp2p.stop();
+        await __classPrivateFieldGet(this, _HeliaImpl_bitswap, "f")?.stop();
+    }
+    async gc(options = {}) {
+        const releaseLock = await this.blockstore.lock.writeLock();
+        try {
+            const helia = this;
+            const blockstore = this.blockstore.unwrap();
+            log('gc start');
+            await drain(blockstore.deleteMany((async function* () {
+                for await (const { cid } of blockstore.getAll()) {
+                    try {
+                        if (await helia.pins.isPinned(cid, options)) {
+                            continue;
+                        }
+                        yield cid;
+                        options.onProgress?.(new CustomProgressEvent('helia:gc:deleted', cid));
+                    }
+                    catch (err) {
+                        log.error('Error during gc', err);
+                        options.onProgress?.(new CustomProgressEvent('helia:gc:error', err));
+                    }
+                }
+            }())));
+        }
+        finally {
+            releaseLock();
+        }
+        log('gc finished');
+    }
+}
+_HeliaImpl_bitswap = new WeakMap();
+//# sourceMappingURL=helia.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/helia.js.map b/node_modules/helia/dist/dist/src/helia.js.map
new file mode 100644
index 0000000..7838142
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/helia.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"helia.js","sourceRoot":"","sources":["../../src/helia.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/index.d.ts b/node_modules/helia/dist/dist/src/index.d.ts
new file mode 100644
index 0000000..34bf564
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/index.d.ts
@@ -0,0 +1,98 @@
+/**
+ * @packageDocumentation
+ *
+ * Create a Helia node.
+ *
+ * @example
+ *
+ * ```typescript
+ * import { createLibp2p } from 'libp2p'
+ * import { MemoryDatastore } from 'datastore-core'
+ * import { MemoryBlockstore } from 'blockstore-core'
+ * import { createHelia } from 'helia'
+ * import { unixfs } from '@helia/unixfs'
+ * import { CID } from 'multiformats/cid'
+ *
+ * const node = await createHelia({
+ *   blockstore: new MemoryBlockstore(),
+ *   datastore: new MemoryDatastore(),
+ *   libp2p: await createLibp2p({
+ *     //... libp2p options
+ *   })
+ * })
+ * const fs = unixfs(node)
+ * fs.cat(CID.parse('bafyFoo'))
+ * ```
+ */
+import type { Helia } from '@helia/interface';
+import type { Libp2p } from '@libp2p/interface-libp2p';
+import type { Blockstore } from 'interface-blockstore';
+import type { Datastore } from 'interface-datastore';
+import type { CID } from 'multiformats/cid';
+import type { MultihashHasher } from 'multiformats/hashes/interface';
+import type { Bitswap } from 'ipfs-bitswap';
+/**
+ * DAGWalkers take a block and yield CIDs encoded in that block
+ */
+export interface DAGWalker {
+    codec: number;
+    walk: (block: Uint8Array) => AsyncGenerator<CID, void, undefined>;
+}
+/**
+ * Options used to create a Helia node.
+ */
+export interface HeliaInit {
+    /**
+     * A libp2p node is required to perform network operations
+     */
+    libp2p?: Libp2p;
+    /**
+     * An optional custom bitswap implementation
+     */
+    bitswap?: Bitswap;
+    /**
+     * The blockstore is where blocks are stored
+     */
+    blockstore?: Blockstore;
+    /**
+     * The datastore is where data is stored
+     */
+    datastore?: Datastore;
+    /**
+     * By default sha256, sha512 and identity hashes are supported for
+     * bitswap operations. To bitswap blocks with CIDs using other hashes
+     * pass appropriate MultihashHashers here.
+     */
+    hashers?: MultihashHasher[];
+    /**
+     * In order to pin CIDs that correspond to a DAG, it's necessary to know
+     * how to traverse that DAG.  DAGWalkers take a block and yield any CIDs
+     * encoded within that block.
+     */
+    dagWalkers?: DAGWalker[];
+    /**
+     * Pass `false` to not start the Helia node
+     */
+    start?: boolean;
+    /**
+     * Garbage collection requires preventing blockstore writes during searches
+     * for unpinned blocks as DAGs are typically pinned after they've been
+     * imported - without locking this could lead to the deletion of blocks while
+     * they are being added to the blockstore.
+     *
+     * By default this lock is held on the main process (e.g. node cluster's
+     * primary process, the renderer thread in browsers) and other processes will
+     * contact the main process for access (worker processes in node cluster,
+     * webworkers in the browser).
+     *
+     * If Helia is being run wholly in a non-primary process, with no other process
+     * expected to access the blockstore (e.g. being run in the background in a
+     * webworker), pass true here to hold the gc lock in this process.
+     */
+    holdGcLock?: boolean;
+}
+/**
+ * Create and return a Helia node
+ */
+export declare function createHelia(init?: HeliaInit): Promise<Helia>;
+//# sourceMappingURL=index.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/index.d.ts.map b/node_modules/helia/dist/dist/src/index.d.ts.map
new file mode 100644
index 0000000..a10b3fe
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/index.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.d.ts","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;GAyBG;AAEH,OAAO,KAAK,EAAE,KAAK,EAAE,MAAM,kBAAkB,CAAA;AAC7C,OAAO,KAAK,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAA;AACtD,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AACtD,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,qBAAqB,CAAA;AACpD,OAAO,KAAK,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AAC3C,OAAO,KAAK,EAAE,eAAe,EAAE,MAAM,+BAA+B,CAAA;AAEpE,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,cAAc,CAAA;AAE3C;;GAEG;AACH,MAAM,WAAW,SAAS;IACxB,KAAK,EAAE,MAAM,CAAA;IACb,IAAI,EAAE,CAAC,KAAK,EAAE,UAAU,KAAK,cAAc,CAAC,GAAG,EAAE,IAAI,EAAE,SAAS,CAAC,CAAA;CAClE;AAED;;GAEG;AACH,MAAM,WAAW,SAAS;IACxB;;OAEG;IACH,MAAM,CAAC,EAAE,MAAM,CAAA;IAEf;;OAEG;IACH,OAAO,CAAC,EAAE,OAAO,CAAA;IAEjB;;OAEG;IACH,UAAU,CAAC,EAAE,UAAU,CAAA;IAEvB;;OAEG;IACH,SAAS,CAAC,EAAE,SAAS,CAAA;IAErB;;;;OAIG;IACH,OAAO,CAAC,EAAE,eAAe,EAAE,CAAA;IAE3B;;;;OAIG;IACH,UAAU,CAAC,EAAE,SAAS,EAAE,CAAA;IAExB;;OAEG;IACH,KAAK,CAAC,EAAE,OAAO,CAAA;IAEf;;;;;;;;;;;;;;OAcG;IACH,UAAU,CAAC,EAAE,OAAO,CAAA;CACrB;AAED;;GAEG;AACH,wBAAsB,WAAW,CAAE,IAAI,GAAE,SAAc,GAAG,OAAO,CAAC,KAAK,CAAC,CAQvE"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/index.js b/node_modules/helia/dist/dist/src/index.js
new file mode 100644
index 0000000..2622217
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/index.js
@@ -0,0 +1,38 @@
+/**
+ * @packageDocumentation
+ *
+ * Create a Helia node.
+ *
+ * @example
+ *
+ * ```typescript
+ * import { createLibp2p } from 'libp2p'
+ * import { MemoryDatastore } from 'datastore-core'
+ * import { MemoryBlockstore } from 'blockstore-core'
+ * import { createHelia } from 'helia'
+ * import { unixfs } from '@helia/unixfs'
+ * import { CID } from 'multiformats/cid'
+ *
+ * const node = await createHelia({
+ *   blockstore: new MemoryBlockstore(),
+ *   datastore: new MemoryDatastore(),
+ *   libp2p: await createLibp2p({
+ *     //... libp2p options
+ *   })
+ * })
+ * const fs = unixfs(node)
+ * fs.cat(CID.parse('bafyFoo'))
+ * ```
+ */
+import { HeliaImpl } from './helia.js';
+/**
+ * Create and return a Helia node
+ */
+export async function createHelia(init = {}) {
+    const helia = new HeliaImpl(init);
+    if (init.start !== false) {
+        await helia.start();
+    }
+    return helia;
+}
+//# sourceMappingURL=index.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/index.js.map b/node_modules/helia/dist/dist/src/index.js.map
new file mode 100644
index 0000000..8e18027
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/index.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;GAyBG;AAQH,OAAO,EAAE,SAAS,EAAE,MAAM,YAAY,CAAA;AAwEtC;;GAEG;AACH,MAAM,CAAC,KAAK,UAAU,WAAW,CAAE,OAAkB,EAAE;IACrD,MAAM,KAAK,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,CAAA;IAEjC,IAAI,IAAI,CAAC,KAAK,KAAK,KAAK,EAAE;QACxB,MAAM,KAAK,CAAC,KAAK,EAAE,CAAA;KACpB;IAED,OAAO,KAAK,CAAA;AACd,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/pins.d.ts b/node_modules/helia/dist/dist/src/pins.d.ts
new file mode 100644
index 0000000..c0d652b
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/pins.d.ts
@@ -0,0 +1,17 @@
+import type { AddOptions, IsPinnedOptions, LsOptions, Pin, Pins, RmOptions } from '@helia/interface/pins';
+import { Datastore } from 'interface-datastore';
+import { CID, Version } from 'multiformats/cid';
+import type { Blockstore } from 'interface-blockstore';
+import type { DAGWalker } from './index.js';
+export declare class PinsImpl implements Pins {
+    #private;
+    private readonly datastore;
+    private readonly blockstore;
+    private dagWalkers;
+    constructor(datastore: Datastore, blockstore: Blockstore, dagWalkers: DAGWalker[]);
+    add(cid: CID<unknown, number, number, Version>, options?: AddOptions): Promise<Pin>;
+    rm(cid: CID<unknown, number, number, Version>, options?: RmOptions): Promise<Pin>;
+    ls(options?: LsOptions): AsyncGenerator<Pin, void, undefined>;
+    isPinned(cid: CID, options?: IsPinnedOptions): Promise<boolean>;
+}
+//# sourceMappingURL=pins.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/pins.d.ts.map b/node_modules/helia/dist/dist/src/pins.d.ts.map
new file mode 100644
index 0000000..b0b80da
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/pins.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.d.ts","sourceRoot":"","sources":["../../src/pins.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,UAAU,EAAE,eAAe,EAAE,SAAS,EAAE,GAAG,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,uBAAuB,CAAA;AACzG,OAAO,EAAE,SAAS,EAAO,MAAM,qBAAqB,CAAA;AACpD,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,kBAAkB,CAAA;AAG/C,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AAKtD,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,YAAY,CAAA;AA6C3C,qBAAa,QAAS,YAAW,IAAI;;IACnC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAW;IACrC,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAY;IACvC,OAAO,CAAC,UAAU,CAA2B;gBAEhC,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,SAAS,EAAE;IAU5E,GAAG,CAAE,GAAG,EAAE,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,OAAO,GAAE,UAAe,GAAG,OAAO,CAAC,GAAG,CAAC;IAwHxF,EAAE,CAAE,GAAG,EAAE,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,OAAO,GAAE,SAAc,GAAG,OAAO,CAAC,GAAG,CAAC;IA4BpF,EAAE,CAAE,OAAO,GAAE,SAAc,GAAG,cAAc,CAAC,GAAG,EAAE,IAAI,EAAE,SAAS,CAAC;IAcpE,QAAQ,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,GAAE,eAAoB,GAAG,OAAO,CAAC,OAAO,CAAC;CAK3E"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/pins.js b/node_modules/helia/dist/dist/src/pins.js
new file mode 100644
index 0000000..043984d
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/pins.js
@@ -0,0 +1,181 @@
+var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
+    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
+    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
+    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
+};
+var _PinsImpl_instances, _PinsImpl_walkDag, _PinsImpl_updatePinnedBlock;
+import { Key } from 'interface-datastore';
+import { CID } from 'multiformats/cid';
+import * as cborg from 'cborg';
+import { base36 } from 'multiformats/bases/base36';
+import PQueue from 'p-queue';
+import { equals as uint8ArrayEquals } from 'uint8arrays/equals';
+import defer from 'p-defer';
+import { cborWalker, dagPbWalker, jsonWalker, rawWalker } from './utils/dag-walkers.js';
+const DEFAULT_DAG_WALKERS = [
+    rawWalker,
+    dagPbWalker,
+    cborWalker,
+    jsonWalker
+];
+const DATASTORE_PIN_PREFIX = '/pin/';
+const DATASTORE_BLOCK_PREFIX = '/pinned-block/';
+const DATASTORE_ENCODING = base36;
+// const DAG_WALK_MAX_QUEUE_LENGTH = 10
+const DAG_WALK_QUEUE_CONCURRENCY = 1;
+function toDSKey(cid) {
+    if (cid.version === 0) {
+        cid = cid.toV1();
+    }
+    return new Key(`${DATASTORE_PIN_PREFIX}${cid.toString(DATASTORE_ENCODING)}`);
+}
+export class PinsImpl {
+    constructor(datastore, blockstore, dagWalkers) {
+        _PinsImpl_instances.add(this);
+        this.datastore = datastore;
+        this.blockstore = blockstore;
+        this.dagWalkers = {};
+        [...DEFAULT_DAG_WALKERS, ...dagWalkers].forEach(dagWalker => {
+            this.dagWalkers[dagWalker.codec] = dagWalker;
+        });
+    }
+    async add(cid, options = {}) {
+        const pinKey = toDSKey(cid);
+        if (await this.datastore.has(pinKey)) {
+            throw new Error('Already pinned');
+        }
+        const depth = Math.round(options.depth ?? Infinity);
+        if (depth < 0) {
+            throw new Error('Depth must be greater than or equal to 0');
+        }
+        // use a queue to walk the DAG instead of recursion so we can traverse very large DAGs
+        const queue = new PQueue({
+            concurrency: DAG_WALK_QUEUE_CONCURRENCY
+        });
+        void queue.add(async () => {
+            await __classPrivateFieldGet(this, _PinsImpl_instances, "m", _PinsImpl_walkDag).call(this, cid, queue, (pinnedBlock) => {
+                // do not update pinned block if this block is already pinned by this CID
+                if (pinnedBlock.pinnedBy.find(c => uint8ArrayEquals(c, cid.bytes)) != null) {
+                    return;
+                }
+                pinnedBlock.pinCount++;
+                pinnedBlock.pinnedBy.push(cid.bytes);
+            }, {
+                ...options,
+                depth
+            });
+        });
+        // if a job in the queue errors, throw that error
+        const deferred = defer();
+        queue.on('error', (err) => {
+            queue.clear();
+            deferred.reject(err);
+        });
+        // wait for the queue to complete or error
+        await Promise.race([
+            queue.onIdle(),
+            deferred.promise
+        ]);
+        const pin = {
+            depth,
+            metadata: options.metadata ?? {}
+        };
+        await this.datastore.put(pinKey, cborg.encode(pin), options);
+        return {
+            cid,
+            ...pin
+        };
+    }
+    async rm(cid, options = {}) {
+        const pinKey = toDSKey(cid);
+        const buf = await this.datastore.get(pinKey, options);
+        const pin = cborg.decode(buf);
+        await this.datastore.delete(pinKey, options);
+        // use a queue to walk the DAG instead of recursion so we can traverse very large DAGs
+        const queue = new PQueue({
+            concurrency: DAG_WALK_QUEUE_CONCURRENCY
+        });
+        void queue.add(async () => {
+            await __classPrivateFieldGet(this, _PinsImpl_instances, "m", _PinsImpl_walkDag).call(this, cid, queue, (pinnedBlock) => {
+                pinnedBlock.pinCount--;
+                pinnedBlock.pinnedBy = pinnedBlock.pinnedBy.filter(c => uint8ArrayEquals(c, cid.bytes));
+            }, {
+                ...options,
+                depth: pin.depth
+            });
+        });
+        await queue.onIdle();
+        return {
+            cid,
+            ...pin
+        };
+    }
+    async *ls(options = {}) {
+        for await (const { key, value } of this.datastore.query({
+            prefix: DATASTORE_PIN_PREFIX + (options.cid != null ? `${options.cid.toString(base36)}` : '')
+        }, options)) {
+            const cid = CID.parse(key.toString().substring(5), base36);
+            const pin = cborg.decode(value);
+            yield {
+                cid,
+                ...pin
+            };
+        }
+    }
+    async isPinned(cid, options = {}) {
+        const blockKey = new Key(`${DATASTORE_BLOCK_PREFIX}${DATASTORE_ENCODING.encode(cid.multihash.bytes)}`);
+        return await this.datastore.has(blockKey, options);
+    }
+}
+_PinsImpl_instances = new WeakSet(), _PinsImpl_walkDag = 
+/**
+ * Walk the DAG behind the passed CID, ensure all blocks are present in the blockstore
+ * and update the pin count for them
+ */
+async function _PinsImpl_walkDag(cid, queue, withPinnedBlock, options) {
+    if (options.depth === -1) {
+        return;
+    }
+    const dagWalker = this.dagWalkers[cid.code];
+    if (dagWalker == null) {
+        throw new Error(`No dag walker found for cid codec ${cid.code}`);
+    }
+    const block = await this.blockstore.get(cid);
+    await __classPrivateFieldGet(this, _PinsImpl_instances, "m", _PinsImpl_updatePinnedBlock).call(this, cid, withPinnedBlock, options);
+    // walk dag, ensure all blocks are present
+    for await (const cid of dagWalker.walk(block)) {
+        void queue.add(async () => {
+            await __classPrivateFieldGet(this, _PinsImpl_instances, "m", _PinsImpl_walkDag).call(this, cid, queue, withPinnedBlock, {
+                ...options,
+                depth: options.depth - 1
+            });
+        });
+    }
+}, _PinsImpl_updatePinnedBlock = 
+/**
+ * Update the pin count for the CID
+ */
+async function _PinsImpl_updatePinnedBlock(cid, withPinnedBlock, options) {
+    const blockKey = new Key(`${DATASTORE_BLOCK_PREFIX}${DATASTORE_ENCODING.encode(cid.multihash.bytes)}`);
+    let pinnedBlock = {
+        pinCount: 0,
+        pinnedBy: []
+    };
+    try {
+        pinnedBlock = cborg.decode(await this.datastore.get(blockKey, options));
+    }
+    catch (err) {
+        if (err.code !== 'ERR_NOT_FOUND') {
+            throw err;
+        }
+    }
+    withPinnedBlock(pinnedBlock);
+    if (pinnedBlock.pinCount === 0) {
+        if (await this.datastore.has(blockKey)) {
+            await this.datastore.delete(blockKey);
+            return;
+        }
+    }
+    await this.datastore.put(blockKey, cborg.encode(pinnedBlock), options);
+};
+//# sourceMappingURL=pins.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/pins.js.map b/node_modules/helia/dist/dist/src/pins.js.map
new file mode 100644
index 0000000..9d3ec55
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/pins.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.js","sourceRoot":"","sources":["../../src/pins.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/storage.d.ts b/node_modules/helia/dist/dist/src/storage.d.ts
new file mode 100644
index 0000000..19bbb3c
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/storage.d.ts
@@ -0,0 +1,62 @@
+import type { Blockstore } from 'interface-blockstore';
+import type { Blocks, Pair, DeleteManyBlocksProgressEvents, DeleteBlockProgressEvents, GetBlockProgressEvents, GetManyBlocksProgressEvents, PutManyBlocksProgressEvents, PutBlockProgressEvents, GetAllBlocksProgressEvents } from '@helia/interface/blocks';
+import type { Bitswap } from 'ipfs-bitswap';
+import type { CID } from 'multiformats/cid';
+import type { AbortOptions } from '@libp2p/interfaces';
+import type { AwaitIterable } from 'interface-store';
+import type { Mortice } from 'mortice';
+import type { Pins } from '@helia/interface/pins';
+import { ProgressOptions } from 'progress-events';
+export interface BlockStorageInit {
+    holdGcLock?: boolean;
+    bitswap?: Bitswap;
+}
+export interface GetOptions extends AbortOptions {
+    progress?: (evt: Event) => void;
+}
+/**
+ * BlockStorage is a hybrid blockstore that puts/gets blocks from a configured
+ * blockstore (that may be on disk, s3, or something else). If the blocks are
+ * not present Bitswap will be used to fetch them from network peers.
+ */
+export declare class BlockStorage implements Blocks {
+    lock: Mortice;
+    private readonly child;
+    private readonly bitswap?;
+    private readonly pins;
+    /**
+     * Create a new BlockStorage
+     */
+    constructor(blockstore: Blockstore, pins: Pins, options?: BlockStorageInit);
+    unwrap(): Blockstore;
+    /**
+     * Put a block to the underlying datastore
+     */
+    put(cid: CID, block: Uint8Array, options?: AbortOptions & ProgressOptions<PutBlockProgressEvents>): Promise<CID>;
+    /**
+     * Put a multiple blocks to the underlying datastore
+     */
+    putMany(blocks: AwaitIterable<{
+        cid: CID;
+        block: Uint8Array;
+    }>, options?: AbortOptions & ProgressOptions<PutManyBlocksProgressEvents>): AsyncIterable<CID>;
+    /**
+     * Get a block by cid
+     */
+    get(cid: CID, options?: AbortOptions & ProgressOptions<GetBlockProgressEvents>): Promise<Uint8Array>;
+    /**
+     * Get multiple blocks back from an (async) iterable of cids
+     */
+    getMany(cids: AwaitIterable<CID>, options?: AbortOptions & ProgressOptions<GetManyBlocksProgressEvents>): AsyncIterable<Pair>;
+    /**
+     * Delete a block from the blockstore
+     */
+    delete(cid: CID, options?: AbortOptions & ProgressOptions<DeleteBlockProgressEvents>): Promise<void>;
+    /**
+     * Delete multiple blocks from the blockstore
+     */
+    deleteMany(cids: AwaitIterable<CID>, options?: AbortOptions & ProgressOptions<DeleteManyBlocksProgressEvents>): AsyncIterable<CID>;
+    has(cid: CID, options?: AbortOptions): Promise<boolean>;
+    getAll(options?: AbortOptions & ProgressOptions<GetAllBlocksProgressEvents>): AsyncIterable<Pair>;
+}
+//# sourceMappingURL=storage.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/storage.d.ts.map b/node_modules/helia/dist/dist/src/storage.d.ts.map
new file mode 100644
index 0000000..8add566
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/storage.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"storage.d.ts","sourceRoot":"","sources":["../../src/storage.ts"],"names":[],"mappings":"AACA,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AACtD,OAAO,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,8BAA8B,EAAE,yBAAyB,EAAE,sBAAsB,EAAE,2BAA2B,EAAE,2BAA2B,EAAE,sBAAsB,EAAE,0BAA0B,EAAE,MAAM,yBAAyB,CAAA;AAC5P,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,cAAc,CAAA;AAC3C,OAAO,KAAK,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AAC3C,OAAO,KAAK,EAAE,YAAY,EAAE,MAAM,oBAAoB,CAAA;AACtD,OAAO,KAAK,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AACpD,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,SAAS,CAAA;AAEtC,OAAO,KAAK,EAAE,IAAI,EAAE,MAAM,uBAAuB,CAAA;AAEjD,OAAO,EAAuB,eAAe,EAAE,MAAM,iBAAiB,CAAA;AAEtE,MAAM,WAAW,gBAAgB;IAC/B,UAAU,CAAC,EAAE,OAAO,CAAA;IACpB,OAAO,CAAC,EAAE,OAAO,CAAA;CAClB;AAED,MAAM,WAAW,UAAW,SAAQ,YAAY;IAC9C,QAAQ,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,KAAK,IAAI,CAAA;CAChC;AAED;;;;GAIG;AACH,qBAAa,YAAa,YAAW,MAAM;IAClC,IAAI,EAAE,OAAO,CAAA;IACpB,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAY;IAClC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAS;IAClC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAM;IAE3B;;OAEG;gBACU,UAAU,EAAE,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,GAAE,gBAAqB;IAS/E,MAAM,IAAK,UAAU;IAIrB;;OAEG;IACG,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,UAAU,EAAE,OAAO,GAAE,YAAY,GAAG,eAAe,CAAC,sBAAsB,CAAM,GAAG,OAAO,CAAC,GAAG,CAAC;IAsB3H;;OAEG;IACK,OAAO,CAAE,MAAM,EAAE,aAAa,CAAC;QAAE,GAAG,EAAE,GAAG,CAAC;QAAC,KAAK,EAAE,UAAU,CAAA;KAAE,CAAC,EAAE,OAAO,GAAE,YAAY,GAAG,eAAe,CAAC,2BAA2B,CAAM,GAAG,aAAa,CAAC,GAAG,CAAC;IA0BvK;;OAEG;IACG,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,GAAE,YAAY,GAAG,eAAe,CAAC,sBAAsB,CAAM,GAAG,OAAO,CAAC,UAAU,CAAC;IAqB/G;;OAEG;IACK,OAAO,CAAE,IAAI,EAAE,aAAa,CAAC,GAAG,CAAC,EAAE,OAAO,GAAE,YAAY,GAAG,eAAe,CAAC,2BAA2B,CAAM,GAAG,aAAa,CAAC,IAAI,CAAC;IAkB1I;;OAEG;IACG,MAAM,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,GAAE,YAAY,GAAG,eAAe,CAAC,yBAAyB,CAAM,GAAG,OAAO,CAAC,IAAI,CAAC;IAe/G;;OAEG;IACK,UAAU,CAAE,IAAI,EAAE,aAAa,CAAC,GAAG,CAAC,EAAE,OAAO,GAAE,YAAY,GAAG,eAAe,CAAC,8BAA8B,CAAM,GAAG,aAAa,CAAC,GAAG,CAAC;IAqBzI,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,GAAE,YAAiB,GAAG,OAAO,CAAC,OAAO,CAAC;IAU1D,MAAM,CAAE,OAAO,GAAE,YAAY,GAAG,eAAe,CAAC,0BAA0B,CAAM,GAAG,aAAa,CAAC,IAAI,CAAC;CAU/G"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/storage.js b/node_modules/helia/dist/dist/src/storage.js
new file mode 100644
index 0000000..a39366e
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/storage.js
@@ -0,0 +1,167 @@
+import filter from 'it-filter';
+import createMortice from 'mortice';
+import forEach from 'it-foreach';
+import { CustomProgressEvent } from 'progress-events';
+/**
+ * BlockStorage is a hybrid blockstore that puts/gets blocks from a configured
+ * blockstore (that may be on disk, s3, or something else). If the blocks are
+ * not present Bitswap will be used to fetch them from network peers.
+ */
+export class BlockStorage {
+    /**
+     * Create a new BlockStorage
+     */
+    constructor(blockstore, pins, options = {}) {
+        this.child = blockstore;
+        this.bitswap = options.bitswap;
+        this.pins = pins;
+        this.lock = createMortice({
+            singleProcess: options.holdGcLock
+        });
+    }
+    unwrap() {
+        return this.child;
+    }
+    /**
+     * Put a block to the underlying datastore
+     */
+    async put(cid, block, options = {}) {
+        const releaseLock = await this.lock.readLock();
+        try {
+            if (await this.child.has(cid)) {
+                options.onProgress?.(new CustomProgressEvent('blocks:put:duplicate', cid));
+                return cid;
+            }
+            if (this.bitswap?.isStarted() === true) {
+                options.onProgress?.(new CustomProgressEvent('blocks:put:bitswap:notify', cid));
+                this.bitswap.notify(cid, block, options);
+            }
+            options.onProgress?.(new CustomProgressEvent('blocks:put:blockstore:put', cid));
+            return await this.child.put(cid, block, options);
+        }
+        finally {
+            releaseLock();
+        }
+    }
+    /**
+     * Put a multiple blocks to the underlying datastore
+     */
+    async *putMany(blocks, options = {}) {
+        const releaseLock = await this.lock.readLock();
+        try {
+            const missingBlocks = filter(blocks, async ({ cid }) => {
+                const has = await this.child.has(cid);
+                if (has) {
+                    options.onProgress?.(new CustomProgressEvent('blocks:put-many:duplicate', cid));
+                }
+                return !has;
+            });
+            const notifyEach = forEach(missingBlocks, ({ cid, block }) => {
+                options.onProgress?.(new CustomProgressEvent('blocks:put-many:bitswap:notify', cid));
+                this.bitswap?.notify(cid, block, options);
+            });
+            options.onProgress?.(new CustomProgressEvent('blocks:put-many:blockstore:put-many'));
+            yield* this.child.putMany(notifyEach, options);
+        }
+        finally {
+            releaseLock();
+        }
+    }
+    /**
+     * Get a block by cid
+     */
+    async get(cid, options = {}) {
+        const releaseLock = await this.lock.readLock();
+        try {
+            if (this.bitswap?.isStarted() != null && !(await this.child.has(cid))) {
+                options.onProgress?.(new CustomProgressEvent('blocks:get:bitswap:get', cid));
+                const block = await this.bitswap.want(cid, options);
+                options.onProgress?.(new CustomProgressEvent('blocks:get:blockstore:put', cid));
+                await this.child.put(cid, block, options);
+                return block;
+            }
+            options.onProgress?.(new CustomProgressEvent('blocks:get:blockstore:get', cid));
+            return await this.child.get(cid, options);
+        }
+        finally {
+            releaseLock();
+        }
+    }
+    /**
+     * Get multiple blocks back from an (async) iterable of cids
+     */
+    async *getMany(cids, options = {}) {
+        const releaseLock = await this.lock.readLock();
+        try {
+            options.onProgress?.(new CustomProgressEvent('blocks:get-many:blockstore:get-many'));
+            yield* this.child.getMany(forEach(cids, async (cid) => {
+                if (this.bitswap?.isStarted() === true && !(await this.child.has(cid))) {
+                    options.onProgress?.(new CustomProgressEvent('blocks:get-many:bitswap:get', cid));
+                    const block = await this.bitswap.want(cid, options);
+                    options.onProgress?.(new CustomProgressEvent('blocks:get-many:blockstore:put', cid));
+                    await this.child.put(cid, block, options);
+                }
+            }));
+        }
+        finally {
+            releaseLock();
+        }
+    }
+    /**
+     * Delete a block from the blockstore
+     */
+    async delete(cid, options = {}) {
+        const releaseLock = await this.lock.writeLock();
+        try {
+            if (await this.pins.isPinned(cid)) {
+                throw new Error('CID was pinned');
+            }
+            options.onProgress?.(new CustomProgressEvent('blocks:delete:blockstore:delete', cid));
+            await this.child.delete(cid, options);
+        }
+        finally {
+            releaseLock();
+        }
+    }
+    /**
+     * Delete multiple blocks from the blockstore
+     */
+    async *deleteMany(cids, options = {}) {
+        const releaseLock = await this.lock.writeLock();
+        try {
+            const storage = this;
+            options.onProgress?.(new CustomProgressEvent('blocks:delete-many:blockstore:delete-many'));
+            yield* this.child.deleteMany((async function* () {
+                for await (const cid of cids) {
+                    if (await storage.pins.isPinned(cid)) {
+                        throw new Error('CID was pinned');
+                    }
+                    yield cid;
+                }
+            }()), options);
+        }
+        finally {
+            releaseLock();
+        }
+    }
+    async has(cid, options = {}) {
+        const releaseLock = await this.lock.readLock();
+        try {
+            return await this.child.has(cid, options);
+        }
+        finally {
+            releaseLock();
+        }
+    }
+    async *getAll(options = {}) {
+        const releaseLock = await this.lock.readLock();
+        try {
+            options.onProgress?.(new CustomProgressEvent('blocks:get-all:blockstore:get-many'));
+            yield* this.child.getAll(options);
+        }
+        finally {
+            releaseLock();
+        }
+    }
+}
+//# sourceMappingURL=storage.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/storage.js.map b/node_modules/helia/dist/dist/src/storage.js.map
new file mode 100644
index 0000000..4e61805
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/storage.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"storage.js","sourceRoot":"","sources":["../../src/storage.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/utils/dag-walkers.d.ts b/node_modules/helia/dist/dist/src/utils/dag-walkers.d.ts
new file mode 100644
index 0000000..663c2ba
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/utils/dag-walkers.d.ts
@@ -0,0 +1,22 @@
+import type { DAGWalker } from '../index.js';
+/**
+ * Dag walker for dag-pb CIDs
+ */
+export declare const dagPbWalker: DAGWalker;
+/**
+ * Dag walker for raw CIDs
+ */
+export declare const rawWalker: DAGWalker;
+/**
+ * Dag walker for dag-cbor CIDs. Does not actually use dag-cbor since
+ * all we are interested in is extracting the the CIDs from the block
+ * so we can just use cborg for that.
+ */
+export declare const cborWalker: DAGWalker;
+/**
+ * Dag walker for dag-json CIDs. Does not actually use dag-json since
+ * all we are interested in is extracting the the CIDs from the block
+ * so we can just use cborg/json for that.
+ */
+export declare const jsonWalker: DAGWalker;
+//# sourceMappingURL=dag-walkers.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/utils/dag-walkers.d.ts.map b/node_modules/helia/dist/dist/src/utils/dag-walkers.d.ts.map
new file mode 100644
index 0000000..8f7265e
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/utils/dag-walkers.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"dag-walkers.d.ts","sourceRoot":"","sources":["../../../src/utils/dag-walkers.ts"],"names":[],"mappings":"AAMA,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,aAAa,CAAA;AAK5C;;GAEG;AACH,eAAO,MAAM,WAAW,EAAE,SAOzB,CAAA;AAED;;GAEG;AACH,eAAO,MAAM,SAAS,EAAE,SAKvB,CAAA;AAKD;;;;GAIG;AACH,eAAO,MAAM,UAAU,EAAE,SAuBxB,CAAA;AAsED;;;;GAIG;AACH,eAAO,MAAM,UAAU,EAAE,SA6BxB,CAAA"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/utils/dag-walkers.js b/node_modules/helia/dist/dist/src/utils/dag-walkers.js
new file mode 100644
index 0000000..e24f267
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/utils/dag-walkers.js
@@ -0,0 +1,145 @@
+/* eslint max-depth: ["error", 7] */
+import * as dagPb from '@ipld/dag-pb';
+import * as cborg from 'cborg';
+import { Type, Token } from 'cborg';
+import * as cborgJson from 'cborg/json';
+import * as raw from 'multiformats/codecs/raw';
+import { CID } from 'multiformats';
+import { base64 } from 'multiformats/bases/base64';
+/**
+ * Dag walker for dag-pb CIDs
+ */
+export const dagPbWalker = {
+    codec: dagPb.code,
+    async *walk(block) {
+        const node = dagPb.decode(block);
+        yield* node.Links.map(l => l.Hash);
+    }
+};
+/**
+ * Dag walker for raw CIDs
+ */
+export const rawWalker = {
+    codec: raw.code,
+    async *walk() {
+        // no embedded CIDs in a raw block
+    }
+};
+// https://github.com/ipfs/go-ipfs/issues/3570#issuecomment-273931692
+const CID_TAG = 42;
+/**
+ * Dag walker for dag-cbor CIDs. Does not actually use dag-cbor since
+ * all we are interested in is extracting the the CIDs from the block
+ * so we can just use cborg for that.
+ */
+export const cborWalker = {
+    codec: 0x71,
+    async *walk(block) {
+        const cids = [];
+        const tags = [];
+        tags[CID_TAG] = (bytes) => {
+            if (bytes[0] !== 0) {
+                throw new Error('Invalid CID for CBOR tag 42; expected leading 0x00');
+            }
+            const cid = CID.decode(bytes.subarray(1)); // ignore leading 0x00
+            cids.push(cid);
+            return cid;
+        };
+        cborg.decode(block, {
+            tags
+        });
+        yield* cids;
+    }
+};
+/**
+ * Borrowed from @ipld/dag-json
+ */
+class DagJsonTokenizer extends cborgJson.Tokenizer {
+    constructor(data, options) {
+        super(data, options);
+        this.tokenBuffer = [];
+    }
+    done() {
+        return this.tokenBuffer.length === 0 && super.done();
+    }
+    _next() {
+        if (this.tokenBuffer.length > 0) {
+            // @ts-expect-error https://github.com/Microsoft/TypeScript/issues/30406
+            return this.tokenBuffer.pop();
+        }
+        return super.next();
+    }
+    /**
+     * Implements rules outlined in https://github.com/ipld/specs/pull/356
+     */
+    next() {
+        const token = this._next();
+        if (token.type === Type.map) {
+            const keyToken = this._next();
+            if (keyToken.type === Type.string && keyToken.value === '/') {
+                const valueToken = this._next();
+                if (valueToken.type === Type.string) { // *must* be a CID
+                    const breakToken = this._next(); // swallow the end-of-map token
+                    if (breakToken.type !== Type.break) {
+                        throw new Error('Invalid encoded CID form');
+                    }
+                    this.tokenBuffer.push(valueToken); // CID.parse will pick this up after our tag token
+                    return new Token(Type.tag, 42, 0);
+                }
+                if (valueToken.type === Type.map) {
+                    const innerKeyToken = this._next();
+                    if (innerKeyToken.type === Type.string && innerKeyToken.value === 'bytes') {
+                        const innerValueToken = this._next();
+                        if (innerValueToken.type === Type.string) { // *must* be Bytes
+                            for (let i = 0; i < 2; i++) {
+                                const breakToken = this._next(); // swallow two end-of-map tokens
+                                if (breakToken.type !== Type.break) {
+                                    throw new Error('Invalid encoded Bytes form');
+                                }
+                            }
+                            const bytes = base64.decode(`m${innerValueToken.value}`);
+                            return new Token(Type.bytes, bytes, innerValueToken.value.length);
+                        }
+                        this.tokenBuffer.push(innerValueToken); // bail
+                    }
+                    this.tokenBuffer.push(innerKeyToken); // bail
+                }
+                this.tokenBuffer.push(valueToken); // bail
+            }
+            this.tokenBuffer.push(keyToken); // bail
+        }
+        return token;
+    }
+}
+/**
+ * Dag walker for dag-json CIDs. Does not actually use dag-json since
+ * all we are interested in is extracting the the CIDs from the block
+ * so we can just use cborg/json for that.
+ */
+export const jsonWalker = {
+    codec: 0x0129,
+    async *walk(block) {
+        const cids = [];
+        const tags = [];
+        tags[CID_TAG] = (string) => {
+            const cid = CID.parse(string);
+            cids.push(cid);
+            return cid;
+        };
+        cborgJson.decode(block, {
+            tags,
+            tokenizer: new DagJsonTokenizer(block, {
+                tags,
+                allowIndefinite: true,
+                allowUndefined: true,
+                allowNaN: true,
+                allowInfinity: true,
+                allowBigInt: true,
+                strict: false,
+                rejectDuplicateMapKeys: false
+            })
+        });
+        yield* cids;
+    }
+};
+//# sourceMappingURL=dag-walkers.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/utils/dag-walkers.js.map b/node_modules/helia/dist/dist/src/utils/dag-walkers.js.map
new file mode 100644
index 0000000..9a50442
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/utils/dag-walkers.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"dag-walkers.js","sourceRoot":"","sources":["../../../src/utils/dag-walkers.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/utils/datastore-version.d.ts b/node_modules/helia/dist/dist/src/utils/datastore-version.d.ts
new file mode 100644
index 0000000..3efbd80
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/utils/datastore-version.d.ts
@@ -0,0 +1,3 @@
+import { Datastore } from 'interface-datastore';
+export declare function assertDatastoreVersionIsCurrent(datastore: Datastore): Promise<void>;
+//# sourceMappingURL=datastore-version.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/utils/datastore-version.d.ts.map b/node_modules/helia/dist/dist/src/utils/datastore-version.d.ts.map
new file mode 100644
index 0000000..8838feb
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/utils/datastore-version.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"datastore-version.d.ts","sourceRoot":"","sources":["../../../src/utils/datastore-version.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAO,MAAM,qBAAqB,CAAA;AAOpD,wBAAsB,+BAA+B,CAAE,SAAS,EAAE,SAAS,GAAG,OAAO,CAAC,IAAI,CAAC,CAe1F"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/utils/datastore-version.js b/node_modules/helia/dist/dist/src/utils/datastore-version.js
new file mode 100644
index 0000000..da38973
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/utils/datastore-version.js
@@ -0,0 +1,19 @@
+import { Key } from 'interface-datastore';
+import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';
+import { toString as uint8ArrayToString } from 'uint8arrays/to-string';
+const DS_VERSION_KEY = new Key('/version');
+const CURRENT_VERSION = 1;
+export async function assertDatastoreVersionIsCurrent(datastore) {
+    if (!(await datastore.has(DS_VERSION_KEY))) {
+        await datastore.put(DS_VERSION_KEY, uint8ArrayFromString(`${CURRENT_VERSION}`));
+        return;
+    }
+    const buf = await datastore.get(DS_VERSION_KEY);
+    const str = uint8ArrayToString(buf);
+    const version = parseInt(str, 10);
+    if (version !== CURRENT_VERSION) {
+        // TODO: write migrations when we break compatibility - for an example, see https://github.com/ipfs/js-ipfs-repo/tree/master/packages/ipfs-repo-migrations
+        throw new Error('Unknown datastore version, a datastore migration may be required');
+    }
+}
+//# sourceMappingURL=datastore-version.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/src/utils/datastore-version.js.map b/node_modules/helia/dist/dist/src/utils/datastore-version.js.map
new file mode 100644
index 0000000..5b19932
--- /dev/null
+++ b/node_modules/helia/dist/dist/src/utils/datastore-version.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"datastore-version.js","sourceRoot":"","sources":["../../../src/utils/datastore-version.ts"],"names":[],"mappings":"AAAA,OAAO,EAAa,GAAG,EAAE,MAAM,qBAAqB,CAAA;AACpD,OAAO,EAAE,UAAU,IAAI,oBAAoB,EAAE,MAAM,yBAAyB,CAAA;AAC5E,OAAO,EAAE,QAAQ,IAAI,kBAAkB,EAAE,MAAM,uBAAuB,CAAA;AAEtE,MAAM,cAAc,GAAG,IAAI,GAAG,CAAC,UAAU,CAAC,CAAA;AAC1C,MAAM,eAAe,GAAG,CAAC,CAAA;AAEzB,MAAM,CAAC,KAAK,UAAU,+BAA+B,CAAE,SAAoB;IACzE,IAAI,CAAC,CAAC,MAAM,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,EAAE;QAC1C,MAAM,SAAS,CAAC,GAAG,CAAC,cAAc,EAAE,oBAAoB,CAAC,GAAG,eAAe,EAAE,CAAC,CAAC,CAAA;QAE/E,OAAM;KACP;IAED,MAAM,GAAG,GAAG,MAAM,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;IAC/C,MAAM,GAAG,GAAG,kBAAkB,CAAC,GAAG,CAAC,CAAA;IACnC,MAAM,OAAO,GAAG,QAAQ,CAAC,GAAG,EAAE,EAAE,CAAC,CAAA;IAEjC,IAAI,OAAO,KAAK,eAAe,EAAE;QAC/B,0JAA0J;QAC1J,MAAM,IAAI,KAAK,CAAC,kEAAkE,CAAC,CAAA;KACpF;AACH,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/create-block.d.ts b/node_modules/helia/dist/dist/test/fixtures/create-block.d.ts
new file mode 100644
index 0000000..b812441
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/create-block.d.ts
@@ -0,0 +1,8 @@
+import type { Blockstore } from 'interface-blockstore';
+import { CID } from 'multiformats/cid';
+export declare function createBlock<Codec extends number>(codec: Codec, block: Uint8Array): Promise<{
+    cid: CID<unknown, Codec, 18>;
+    block: Uint8Array;
+}>;
+export declare function createAndPutBlock<Codec extends number>(codec: Codec, block: Uint8Array, blockstore: Blockstore): Promise<CID<unknown, Codec, 18>>;
+//# sourceMappingURL=create-block.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/create-block.d.ts.map b/node_modules/helia/dist/dist/test/fixtures/create-block.d.ts.map
new file mode 100644
index 0000000..3992c04
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/create-block.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"create-block.d.ts","sourceRoot":"","sources":["../../../test/fixtures/create-block.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AACtD,OAAO,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AAGtC,wBAAsB,WAAW,CAAE,KAAK,SAAS,MAAM,EAAG,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,GAAG,OAAO,CAAC;IAAE,GAAG,EAAE,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;IAAC,KAAK,EAAE,UAAU,CAAA;CAAE,CAAC,CAKvJ;AAED,wBAAsB,iBAAiB,CAAE,KAAK,SAAS,MAAM,EAAG,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,GAAG,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAMzJ"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/create-block.js b/node_modules/helia/dist/dist/test/fixtures/create-block.js
new file mode 100644
index 0000000..afc2553
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/create-block.js
@@ -0,0 +1,13 @@
+import { CID } from 'multiformats/cid';
+import { sha256 } from 'multiformats/hashes/sha2';
+export async function createBlock(codec, block) {
+    const mh = await sha256.digest(block);
+    const cid = CID.createV1(codec, mh);
+    return { cid, block };
+}
+export async function createAndPutBlock(codec, block, blockstore) {
+    const result = await createBlock(codec, block);
+    await blockstore.put(result.cid, block);
+    return result.cid;
+}
+//# sourceMappingURL=create-block.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/create-block.js.map b/node_modules/helia/dist/dist/test/fixtures/create-block.js.map
new file mode 100644
index 0000000..5847390
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/create-block.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"create-block.js","sourceRoot":"","sources":["../../../test/fixtures/create-block.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AACtC,OAAO,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAA;AAEjD,MAAM,CAAC,KAAK,UAAU,WAAW,CAAyB,KAAY,EAAE,KAAiB;IACvF,MAAM,EAAE,GAAG,MAAM,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;IACrC,MAAM,GAAG,GAAG,GAAG,CAAC,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAA;IAEnC,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,CAAA;AACvB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,iBAAiB,CAAyB,KAAY,EAAE,KAAiB,EAAE,UAAsB;IACrH,MAAM,MAAM,GAAG,MAAM,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,CAAA;IAE9C,MAAM,UAAU,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAA;IAEvC,OAAO,MAAM,CAAC,GAAG,CAAA;AACnB,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/create-dag.d.ts b/node_modules/helia/dist/dist/test/fixtures/create-dag.d.ts
new file mode 100644
index 0000000..b5375ab
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/create-dag.d.ts
@@ -0,0 +1,58 @@
+import type { Blockstore } from 'interface-blockstore';
+import type { CID } from 'multiformats/cid';
+export interface DAGNode {
+    cid: CID;
+    level: number;
+    links: CID[];
+}
+/**
+ * Creates a DAG for use with the dag walker
+ *
+ * E.g.
+ *
+ * ```
+ * createDag(..., 2, 3)
+ *
+ * // creates:
+ * {
+ *   'level-0': {
+ *     level: 0,
+ *     cid: CID(baedreibc6d3tr7glrwvflqkvsd7gszrb77kdmhgqukcwx5wnxdnydm3eia),
+ *     links: [
+ *       CID(baedreicvd6e5yvdg22elvqofvwjtnueennogk24zotw6sbrybrthme7bye),
+ *       CID(baedreicv6ufi5msnpsrqz4ziw2ekxgvopedluzhgpp74ukw6ncjtaypwlu),
+ *       CID(baedreifc4d4pzuzl6rmlf2vinsjcyfnuixogcqcabv65jqtgkbreu6czdm)
+ *     ]
+ *   },
+ *   'level-0-0': {
+ *     level: 1,
+ *     cid: CID(baedreicvd6e5yvdg22elvqofvwjtnueennogk24zotw6sbrybrthme7bye),
+ *     links: [
+ *       CID(baedreifcryimpj7cajld5znmpjis7z5gktwnsjbipbi6zkoe2y634sj5n4),
+ *       CID(baedreid375udk75eukd3xms5nqa7fq45uq2m5xddpf6reamgp3356dqvba),
+ *       CID(baedreig5ajzof2zotjqjaqloaqren2qc2ytuyalhsbf6e7qtpiwqzjyvsu)
+ *     ]
+ *   },
+ *   'level-0-1': {
+ *     level: 1,
+ *     cid: CID(baedreicv6ufi5msnpsrqz4ziw2ekxgvopedluzhgpp74ukw6ncjtaypwlu),
+ *     links: [
+ *       CID(baedreidqugkmpuyh3klk3ediwwltqfuapesi2dr65k2bkyokhrp4m5cuvq),
+ *       CID(baedreia75iubjvtv4ukrq2qxs6mwo5iyrmn4273hmkuvlbrsw3wwss2zwe),
+ *       CID(baedreibjyashtb6wj4inxvcfmsqbsfm5s375524fqo4liw3cshcmu2x7ma)
+ *     ]
+ *   },
+ *   'level-0-2': {
+ *     level: 1,
+ *     cid: CID(baedreifc4d4pzuzl6rmlf2vinsjcyfnuixogcqcabv65jqtgkbreu6czdm),
+ *     links: [
+ *       CID(baedreibfll7pocwwxysan5yprzywx277zzimmhwqdgrvs7bx3oujqd4xpa),
+ *       CID(baedreig5rrihh454f4qcef476m42aughuz5hf4rcc72damlz6okxdafpxe),
+ *       CID(baedreigytohidtspknvirjkslrox23g3qmye5mrx2wijn6ykrpthyg2kry)
+ *     ]
+ *   }
+ * }
+ * ```
+ */
+export declare function createDag(codec: number, blocks: Blockstore, depth: number, children: number): Promise<Record<string, DAGNode>>;
+//# sourceMappingURL=create-dag.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/create-dag.d.ts.map b/node_modules/helia/dist/dist/test/fixtures/create-dag.d.ts.map
new file mode 100644
index 0000000..7596f7c
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/create-dag.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"create-dag.d.ts","sourceRoot":"","sources":["../../../test/fixtures/create-dag.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AACtD,OAAO,KAAK,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AAI3C,MAAM,WAAW,OAAO;IACtB,GAAG,EAAE,GAAG,CAAA;IACR,KAAK,EAAE,MAAM,CAAA;IACb,KAAK,EAAE,GAAG,EAAE,CAAA;CACb;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAgDG;AACH,wBAAsB,SAAS,CAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAOrI"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/create-dag.js b/node_modules/helia/dist/dist/test/fixtures/create-dag.js
new file mode 100644
index 0000000..072ba3f
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/create-dag.js
@@ -0,0 +1,74 @@
+import { fromString as uint8arrayFromString } from 'uint8arrays/from-string';
+import { createAndPutBlock } from './create-block.js';
+/**
+ * Creates a DAG for use with the dag walker
+ *
+ * E.g.
+ *
+ * ```
+ * createDag(..., 2, 3)
+ *
+ * // creates:
+ * {
+ *   'level-0': {
+ *     level: 0,
+ *     cid: CID(baedreibc6d3tr7glrwvflqkvsd7gszrb77kdmhgqukcwx5wnxdnydm3eia),
+ *     links: [
+ *       CID(baedreicvd6e5yvdg22elvqofvwjtnueennogk24zotw6sbrybrthme7bye),
+ *       CID(baedreicv6ufi5msnpsrqz4ziw2ekxgvopedluzhgpp74ukw6ncjtaypwlu),
+ *       CID(baedreifc4d4pzuzl6rmlf2vinsjcyfnuixogcqcabv65jqtgkbreu6czdm)
+ *     ]
+ *   },
+ *   'level-0-0': {
+ *     level: 1,
+ *     cid: CID(baedreicvd6e5yvdg22elvqofvwjtnueennogk24zotw6sbrybrthme7bye),
+ *     links: [
+ *       CID(baedreifcryimpj7cajld5znmpjis7z5gktwnsjbipbi6zkoe2y634sj5n4),
+ *       CID(baedreid375udk75eukd3xms5nqa7fq45uq2m5xddpf6reamgp3356dqvba),
+ *       CID(baedreig5ajzof2zotjqjaqloaqren2qc2ytuyalhsbf6e7qtpiwqzjyvsu)
+ *     ]
+ *   },
+ *   'level-0-1': {
+ *     level: 1,
+ *     cid: CID(baedreicv6ufi5msnpsrqz4ziw2ekxgvopedluzhgpp74ukw6ncjtaypwlu),
+ *     links: [
+ *       CID(baedreidqugkmpuyh3klk3ediwwltqfuapesi2dr65k2bkyokhrp4m5cuvq),
+ *       CID(baedreia75iubjvtv4ukrq2qxs6mwo5iyrmn4273hmkuvlbrsw3wwss2zwe),
+ *       CID(baedreibjyashtb6wj4inxvcfmsqbsfm5s375524fqo4liw3cshcmu2x7ma)
+ *     ]
+ *   },
+ *   'level-0-2': {
+ *     level: 1,
+ *     cid: CID(baedreifc4d4pzuzl6rmlf2vinsjcyfnuixogcqcabv65jqtgkbreu6czdm),
+ *     links: [
+ *       CID(baedreibfll7pocwwxysan5yprzywx277zzimmhwqdgrvs7bx3oujqd4xpa),
+ *       CID(baedreig5rrihh454f4qcef476m42aughuz5hf4rcc72damlz6okxdafpxe),
+ *       CID(baedreigytohidtspknvirjkslrox23g3qmye5mrx2wijn6ykrpthyg2kry)
+ *     ]
+ *   }
+ * }
+ * ```
+ */
+export async function createDag(codec, blocks, depth, children) {
+    const dag = {};
+    const root = await createAndPutBlock(codec, uint8arrayFromString('level-0'), blocks);
+    await addChildren(root, 'level', 0, 0, depth, children, dag, codec, blocks);
+    return dag;
+}
+async function addChildren(cid, name, level, index, depth, children, dag, codec, blocks) {
+    if (depth === 0) {
+        return;
+    }
+    name = `${name}-${index}`;
+    dag[name] = {
+        level,
+        cid,
+        links: []
+    };
+    for (let i = 0; i < children; i++) {
+        const subChild = await createAndPutBlock(codec, uint8arrayFromString(`${name}-${i}`), blocks);
+        dag[name].links.push(subChild);
+        await addChildren(subChild, name, level + 1, index + i, depth - 1, children, dag, codec, blocks);
+    }
+}
+//# sourceMappingURL=create-dag.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/create-dag.js.map b/node_modules/helia/dist/dist/test/fixtures/create-dag.js.map
new file mode 100644
index 0000000..4f3a3ab
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/create-dag.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"create-dag.js","sourceRoot":"","sources":["../../../test/fixtures/create-dag.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,UAAU,IAAI,oBAAoB,EAAE,MAAM,yBAAyB,CAAA;AAC5E,OAAO,EAAE,iBAAiB,EAAE,MAAM,mBAAmB,CAAA;AAQrD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAgDG;AACH,MAAM,CAAC,KAAK,UAAU,SAAS,CAAE,KAAa,EAAE,MAAkB,EAAE,KAAa,EAAE,QAAgB;IACjG,MAAM,GAAG,GAA4B,EAAE,CAAA;IACvC,MAAM,IAAI,GAAG,MAAM,iBAAiB,CAAC,KAAK,EAAE,oBAAoB,CAAC,SAAS,CAAC,EAAE,MAAM,CAAC,CAAA;IAEpF,MAAM,WAAW,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,CAAC,CAAA;IAE3E,OAAO,GAAG,CAAA;AACZ,CAAC;AAED,KAAK,UAAU,WAAW,CAAE,GAAQ,EAAE,IAAY,EAAE,KAAa,EAAE,KAAa,EAAE,KAAa,EAAE,QAAgB,EAAE,GAA4B,EAAE,KAAa,EAAE,MAAkB;IAChL,IAAI,KAAK,KAAK,CAAC,EAAE;QACf,OAAM;KACP;IAED,IAAI,GAAG,GAAG,IAAI,IAAI,KAAK,EAAE,CAAA;IAEzB,GAAG,CAAC,IAAI,CAAC,GAAG;QACV,KAAK;QACL,GAAG;QACH,KAAK,EAAE,EAAE;KACV,CAAA;IAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,EAAE,EAAE;QACjC,MAAM,QAAQ,GAAG,MAAM,iBAAiB,CAAC,KAAK,EAAE,oBAAoB,CAAC,GAAG,IAAI,IAAI,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,CAAA;QAE7F,GAAG,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;QAE9B,MAAM,WAAW,CAAC,QAAQ,EAAE,IAAI,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,CAAC,CAAA;KACjG;AACH,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/dag-walker.d.ts b/node_modules/helia/dist/dist/test/fixtures/dag-walker.d.ts
new file mode 100644
index 0000000..7b65463
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/dag-walker.d.ts
@@ -0,0 +1,4 @@
+import type { DAGWalker } from '../../src/index.js';
+import type { DAGNode } from './create-dag.js';
+export declare function dagWalker(codec: number, dag: Record<string, DAGNode>): DAGWalker;
+//# sourceMappingURL=dag-walker.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/dag-walker.d.ts.map b/node_modules/helia/dist/dist/test/fixtures/dag-walker.d.ts.map
new file mode 100644
index 0000000..42813dd
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/dag-walker.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"dag-walker.d.ts","sourceRoot":"","sources":["../../../test/fixtures/dag-walker.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,oBAAoB,CAAA;AAEnD,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AAE9C,wBAAgB,SAAS,CAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CASjF"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/dag-walker.js b/node_modules/helia/dist/dist/test/fixtures/dag-walker.js
new file mode 100644
index 0000000..4809f02
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/dag-walker.js
@@ -0,0 +1,11 @@
+import { toString as uint8ArrayToString } from 'uint8arrays/to-string';
+export function dagWalker(codec, dag) {
+    return {
+        codec,
+        async *walk(block) {
+            const node = dag[uint8ArrayToString(block)] ?? { links: [] };
+            yield* node.links;
+        }
+    };
+}
+//# sourceMappingURL=dag-walker.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/fixtures/dag-walker.js.map b/node_modules/helia/dist/dist/test/fixtures/dag-walker.js.map
new file mode 100644
index 0000000..c812818
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/fixtures/dag-walker.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"dag-walker.js","sourceRoot":"","sources":["../../../test/fixtures/dag-walker.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,QAAQ,IAAI,kBAAkB,EAAE,MAAM,uBAAuB,CAAA;AAGtE,MAAM,UAAU,SAAS,CAAE,KAAa,EAAE,GAA4B;IACpE,OAAO;QACL,KAAK;QACL,KAAK,CAAC,CAAE,IAAI,CAAE,KAAK;YACjB,MAAM,IAAI,GAAG,GAAG,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,CAAA;YAE5D,KAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAA;QACpB,CAAC;KACF,CAAA;AACH,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/gc.spec.d.ts b/node_modules/helia/dist/dist/test/gc.spec.d.ts
new file mode 100644
index 0000000..7f33148
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/gc.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=gc.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/gc.spec.d.ts.map b/node_modules/helia/dist/dist/test/gc.spec.d.ts.map
new file mode 100644
index 0000000..550d128
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/gc.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"gc.spec.d.ts","sourceRoot":"","sources":["../../test/gc.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/gc.spec.js b/node_modules/helia/dist/dist/test/gc.spec.js
new file mode 100644
index 0000000..c6f0837
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/gc.spec.js
@@ -0,0 +1,159 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import * as raw from 'multiformats/codecs/raw';
+import { createAndPutBlock } from './fixtures/create-block.js';
+import * as dagPb from '@ipld/dag-pb';
+import * as dagCbor from '@ipld/dag-cbor';
+import * as dagJson from '@ipld/dag-json';
+describe('gc', () => {
+    let helia;
+    beforeEach(async () => {
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore: new MemoryBlockstore(),
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            })
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    it('pins a dag-pb node and does not garbage collect it or it\'s children', async () => {
+        const child1 = await createAndPutBlock(dagPb.code, dagPb.encode({
+            Data: Uint8Array.from([0, 1, 2, 3]),
+            Links: []
+        }), helia.blockstore);
+        const child2 = await createAndPutBlock(dagPb.code, dagPb.encode({
+            Data: Uint8Array.from([4, 5, 6, 7]),
+            Links: []
+        }), helia.blockstore);
+        const node = await createAndPutBlock(dagPb.code, dagPb.encode({
+            Links: [{
+                    Hash: child1,
+                    Name: 'child1'
+                }, {
+                    Hash: child2,
+                    Name: 'child2'
+                }]
+        }), helia.blockstore);
+        await helia.pins.add(node);
+        // this block will be garbage collected
+        const doomed = await createAndPutBlock(dagPb.code, dagPb.encode({
+            Data: Uint8Array.from([8, 9, 0, 1]),
+            Links: []
+        }), helia.blockstore);
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.true();
+        await helia.gc();
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.false();
+    });
+    it('pins a dag-cbor node and does not garbage collect it or it\'s children', async () => {
+        const child1 = await createAndPutBlock(dagCbor.code, dagCbor.encode({
+            foo: 'bar'
+        }), helia.blockstore);
+        const child2 = await createAndPutBlock(dagCbor.code, dagCbor.encode({
+            baz: 'qux'
+        }), helia.blockstore);
+        const node = await createAndPutBlock(dagCbor.code, dagCbor.encode({
+            children: [
+                child1,
+                child2
+            ]
+        }), helia.blockstore);
+        await helia.pins.add(node);
+        // this block will be garbage collected
+        const doomed = await createAndPutBlock(dagCbor.code, dagJson.encode({
+            quux: 'garply'
+        }), helia.blockstore);
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.true();
+        await helia.gc();
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.false();
+    });
+    it('pins a dag-json node and does not garbage collect it or it\'s children', async () => {
+        const child1 = await createAndPutBlock(dagJson.code, dagJson.encode({
+            foo: 'bar'
+        }), helia.blockstore);
+        const child2 = await createAndPutBlock(dagJson.code, dagJson.encode({
+            baz: 'qux'
+        }), helia.blockstore);
+        const node = await createAndPutBlock(dagJson.code, dagJson.encode({
+            children: [
+                child1,
+                child2
+            ]
+        }), helia.blockstore);
+        await helia.pins.add(node);
+        // this block will be garbage collected
+        const doomed = await createAndPutBlock(dagJson.code, dagJson.encode({
+            quux: 'garply'
+        }), helia.blockstore);
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.true();
+        await helia.gc();
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.false();
+    });
+    it('pins a raw node and does not garbage collect it', async () => {
+        const cid = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await helia.pins.add(cid);
+        // this block will be garbage collected
+        const doomed = await createAndPutBlock(raw.code, Uint8Array.from([4, 5, 6, 7]), helia.blockstore);
+        await expect(helia.blockstore.has(cid)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.true();
+        await helia.gc();
+        await expect(helia.blockstore.has(cid)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.false();
+    });
+    it('can garbage collect around a CID that causes an error', async () => {
+        const cid = await createAndPutBlock(0x10, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await expect(helia.blockstore.has(cid)).to.eventually.be.true('did not have cid');
+        const events = [];
+        // make the datastore break in some way
+        helia.datastore.has = async () => {
+            throw new Error('Urk!');
+        };
+        await helia.gc({
+            onProgress: (evt) => {
+                events.push(evt);
+            }
+        });
+        await expect(helia.blockstore.has(cid)).to.eventually.be.true('did not keep cid');
+        const errorEvents = events.filter(e => e.type === 'helia:gc:error');
+        expect(errorEvents).to.have.lengthOf(1);
+        expect(errorEvents[0].detail.toString()).to.include('Urk!');
+    });
+});
+//# sourceMappingURL=gc.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/gc.spec.js.map b/node_modules/helia/dist/dist/test/gc.spec.js.map
new file mode 100644
index 0000000..a997914
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/gc.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"gc.spec.js","sourceRoot":"","sources":["../../test/gc.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/index.spec.d.ts b/node_modules/helia/dist/dist/test/index.spec.d.ts
new file mode 100644
index 0000000..b37c2d2
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/index.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=index.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/index.spec.d.ts.map b/node_modules/helia/dist/dist/test/index.spec.d.ts.map
new file mode 100644
index 0000000..5c89780
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/index.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.spec.d.ts","sourceRoot":"","sources":["../../test/index.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/index.spec.js b/node_modules/helia/dist/dist/test/index.spec.js
new file mode 100644
index 0000000..e606de6
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/index.spec.js
@@ -0,0 +1,84 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import { CID } from 'multiformats/cid';
+import { Key } from 'interface-datastore';
+describe('helia', () => {
+    let helia;
+    beforeEach(async () => {
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore: new MemoryBlockstore(),
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            })
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    it('stops and starts', async () => {
+        expect(helia.libp2p.isStarted()).to.be.true();
+        await helia.stop();
+        expect(helia.libp2p.isStarted()).to.be.false();
+    });
+    it('should have a blockstore', async () => {
+        expect(helia).to.have.property('blockstore').that.is.ok();
+    });
+    it('should have a datastore', async () => {
+        expect(helia).to.have.property('datastore').that.is.ok();
+    });
+    it('should have a libp2p', async () => {
+        expect(helia).to.have.property('libp2p').that.is.ok();
+    });
+    it('allows creating offline node', async () => {
+        const helia = await createHelia({
+            start: false,
+            datastore: new MemoryDatastore(),
+            blockstore: new MemoryBlockstore(),
+            libp2p: await createLibp2p({
+                start: false,
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            })
+        });
+        expect(helia.libp2p.isStarted()).to.be.false();
+    });
+    it('does not require any constructor args', async () => {
+        const helia = await createHelia();
+        const cid = CID.parse('QmaQwYWpchozXhFv8nvxprECWBSCEppN9dfd2VQiJfRo3F');
+        const block = Uint8Array.from([0, 1, 2, 3]);
+        await helia.blockstore.put(cid, block);
+        expect(await helia.blockstore.has(cid)).to.be.true();
+        const key = new Key(`/${cid.toString()}`);
+        await helia.datastore.put(key, block);
+        expect(await helia.datastore.has(key)).to.be.true();
+        expect(() => {
+            helia.libp2p.isStarted();
+        }).to.throw('Please configure Helia with a libp2p instance');
+    });
+});
+//# sourceMappingURL=index.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/index.spec.js.map b/node_modules/helia/dist/dist/test/index.spec.js.map
new file mode 100644
index 0000000..c8efa6f
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/index.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.spec.js","sourceRoot":"","sources":["../../test/index.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.depth-limited.spec.d.ts b/node_modules/helia/dist/dist/test/pins.depth-limited.spec.d.ts
new file mode 100644
index 0000000..4f714af
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.depth-limited.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=pins.depth-limited.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.depth-limited.spec.d.ts.map b/node_modules/helia/dist/dist/test/pins.depth-limited.spec.d.ts.map
new file mode 100644
index 0000000..6758b48
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.depth-limited.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.depth-limited.spec.d.ts","sourceRoot":"","sources":["../../test/pins.depth-limited.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.depth-limited.spec.js b/node_modules/helia/dist/dist/test/pins.depth-limited.spec.js
new file mode 100644
index 0000000..0f89cda
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.depth-limited.spec.js
@@ -0,0 +1,104 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import { dagWalker } from './fixtures/dag-walker.js';
+import { createDag } from './fixtures/create-dag.js';
+const MAX_DEPTH = 3;
+describe('pins (depth limited)', () => {
+    let helia;
+    let dag;
+    beforeEach(async () => {
+        const blockstore = new MemoryBlockstore();
+        // arbitrary CID codec value
+        const codec = 7;
+        // create a DAG, MAX_DEPTH levels deep with each level having three children
+        dag = await createDag(codec, blockstore, MAX_DEPTH, 3);
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore,
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            }),
+            dagWalkers: [
+                dagWalker(codec, dag)
+            ]
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    for (let i = 0; i < MAX_DEPTH; i++) {
+        describe(`depth ${i}`, () => {
+            it(`pins a block to depth ${i}`, async () => {
+                await helia.pins.add(dag['level-0'].cid, {
+                    depth: i
+                });
+                // only root block should be pinned
+                for (const [name, node] of Object.entries(dag)) {
+                    if (node.level <= i) {
+                        await expect(helia.pins.isPinned(node.cid)).to.eventually.be.true(`did not pin ${name}`);
+                    }
+                    else {
+                        await expect(helia.pins.isPinned(node.cid)).to.eventually.be.false(`pinned ${name}`);
+                    }
+                    if (node.level > i) {
+                        // no children of this node should be pinned
+                        for (const cid of node.links) {
+                            await expect(helia.pins.isPinned(cid)).to.eventually.be.false(`pinned ${name}`);
+                        }
+                    }
+                }
+            });
+            it(`unpins to depth ${i}`, async () => {
+                await helia.pins.add(dag['level-0'].cid, {
+                    depth: i
+                });
+                await helia.pins.rm(dag['level-0'].cid);
+                // no blocks should be pinned
+                for (const [name, node] of Object.entries(dag)) {
+                    for (const cid of node.links) {
+                        await expect(helia.pins.isPinned(cid)).to.eventually.be.false(`did not unpin ${name}`);
+                    }
+                }
+            });
+            it(`does not delete a pinned sub-block under level ${i}`, async () => {
+                await helia.pins.add(dag['level-0'].cid, {
+                    depth: i
+                });
+                // no sub blocks should be pinned
+                for (const [name, node] of Object.entries(dag)) {
+                    if (node.level <= i) {
+                        await expect(helia.blockstore.delete(node.cid)).to.eventually.be.rejected
+                            .with.property('message', 'CID was pinned', `allowed deleting pinned block ${name}`);
+                    }
+                    else {
+                        await expect(helia.blockstore.delete(node.cid)).to.eventually.be.undefined(`allowed deleting pinned block ${name}`);
+                    }
+                    if (node.level > i) {
+                        // no children of this node should be pinned
+                        for (const cid of node.links) {
+                            await expect(helia.blockstore.delete(cid)).to.eventually.be.undefined(`allowed deleting pinned block ${name}`);
+                        }
+                    }
+                }
+            });
+        });
+    }
+});
+//# sourceMappingURL=pins.depth-limited.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.depth-limited.spec.js.map b/node_modules/helia/dist/dist/test/pins.depth-limited.spec.js.map
new file mode 100644
index 0000000..2c0d06b
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.depth-limited.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.depth-limited.spec.js","sourceRoot":"","sources":["../../test/pins.depth-limited.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.recursive.spec.d.ts b/node_modules/helia/dist/dist/test/pins.recursive.spec.d.ts
new file mode 100644
index 0000000..7d5a4fe
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.recursive.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=pins.recursive.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.recursive.spec.d.ts.map b/node_modules/helia/dist/dist/test/pins.recursive.spec.d.ts.map
new file mode 100644
index 0000000..9279192
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.recursive.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.recursive.spec.d.ts","sourceRoot":"","sources":["../../test/pins.recursive.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.recursive.spec.js b/node_modules/helia/dist/dist/test/pins.recursive.spec.js
new file mode 100644
index 0000000..73cf5d2
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.recursive.spec.js
@@ -0,0 +1,75 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import { dagWalker } from './fixtures/dag-walker.js';
+import { createDag } from './fixtures/create-dag.js';
+describe('pins (recursive)', () => {
+    let helia;
+    let dag;
+    beforeEach(async () => {
+        const blockstore = new MemoryBlockstore();
+        // arbitrary CID codec value
+        const codec = 7;
+        // create a DAG, two levels deep with each level having three children
+        dag = await createDag(codec, blockstore, 2, 3);
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore,
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            }),
+            dagWalkers: [
+                dagWalker(codec, dag)
+            ]
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    it('pins a block recursively', async () => {
+        await helia.pins.add(dag['level-0'].cid);
+        // all sub blocks should be pinned
+        for (const [name, node] of Object.entries(dag)) {
+            for (const cid of node.links) {
+                await expect(helia.pins.isPinned(cid)).to.eventually.be.true(`did not pin ${name}`);
+            }
+        }
+    });
+    it('unpins recursively', async () => {
+        await helia.pins.add(dag['level-0'].cid);
+        await helia.pins.rm(dag['level-0'].cid);
+        // no sub blocks should be pinned
+        for (const [name, node] of Object.entries(dag)) {
+            for (const cid of node.links) {
+                await expect(helia.pins.isPinned(cid)).to.eventually.be.false(`did not unpin ${name}`);
+            }
+        }
+    });
+    it('does not delete a pinned sub-block', async () => {
+        await helia.pins.add(dag['level-0'].cid);
+        // no sub blocks should be pinned
+        for (const [name, node] of Object.entries(dag)) {
+            for (const cid of node.links) {
+                await expect(helia.blockstore.delete(cid)).to.eventually.be.rejected
+                    .with.property('message', 'CID was pinned', `allowed deleting pinned block ${name}`);
+            }
+        }
+    });
+});
+//# sourceMappingURL=pins.recursive.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.recursive.spec.js.map b/node_modules/helia/dist/dist/test/pins.recursive.spec.js.map
new file mode 100644
index 0000000..a84a77a
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.recursive.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.recursive.spec.js","sourceRoot":"","sources":["../../test/pins.recursive.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.spec.d.ts b/node_modules/helia/dist/dist/test/pins.spec.d.ts
new file mode 100644
index 0000000..39f04da
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=pins.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.spec.d.ts.map b/node_modules/helia/dist/dist/test/pins.spec.d.ts.map
new file mode 100644
index 0000000..0162612
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.spec.d.ts","sourceRoot":"","sources":["../../test/pins.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.spec.js b/node_modules/helia/dist/dist/test/pins.spec.js
new file mode 100644
index 0000000..f75c0a8
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.spec.js
@@ -0,0 +1,109 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import { CID } from 'multiformats/cid';
+import * as raw from 'multiformats/codecs/raw';
+import { createAndPutBlock } from './fixtures/create-block.js';
+import all from 'it-all';
+describe('pins', () => {
+    let helia;
+    beforeEach(async () => {
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore: new MemoryBlockstore(),
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            })
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    it('pins a block', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        const cidV0 = CID.createV0(cidV1.multihash);
+        await helia.pins.add(cidV1);
+        await expect(helia.pins.isPinned(cidV1)).to.eventually.be.true('did not pin v1 CID');
+        await expect(helia.pins.isPinned(cidV0)).to.eventually.be.true('did not pin v0 CID');
+    });
+    it('unpins a block', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        const cidV0 = CID.createV0(cidV1.multihash);
+        await helia.pins.add(cidV1);
+        await expect(helia.pins.isPinned(cidV1)).to.eventually.be.true('did not pin v1 CID');
+        await expect(helia.pins.isPinned(cidV0)).to.eventually.be.true('did not pin v0 CID');
+        await helia.pins.rm(cidV1);
+        await expect(helia.pins.isPinned(cidV1)).to.eventually.be.false('did not unpin v1 CID');
+        await expect(helia.pins.isPinned(cidV0)).to.eventually.be.false('did not unpin v0 CID');
+    });
+    it('does not delete a pinned block', async () => {
+        const cid = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await helia.pins.add(cid);
+        await expect(helia.blockstore.delete(cid)).to.eventually.be.rejected
+            .with.property('message', 'CID was pinned');
+    });
+    it('lists pins created with default args', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await helia.pins.add(cidV1);
+        const pins = await all(helia.pins.ls());
+        expect(pins).to.have.lengthOf(1);
+        expect(pins).to.have.nested.property('[0].cid').that.eql(cidV1);
+        expect(pins).to.have.nested.property('[0].depth', Infinity);
+        expect(pins).to.have.nested.property('[0].metadata').that.eql({});
+    });
+    it('lists pins with depth', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await helia.pins.add(cidV1, {
+            depth: 5
+        });
+        const pins = await all(helia.pins.ls());
+        expect(pins).to.have.lengthOf(1);
+        expect(pins).to.have.nested.property('[0].cid').that.eql(cidV1);
+        expect(pins).to.have.nested.property('[0].depth', 5);
+    });
+    it('lists pins with metadata', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        const metadata = {
+            foo: 'bar',
+            baz: 5,
+            qux: false
+        };
+        await helia.pins.add(cidV1, {
+            metadata
+        });
+        const pins = await all(helia.pins.ls());
+        expect(pins).to.have.lengthOf(1);
+        expect(pins).to.have.nested.property('[0].cid').that.eql(cidV1);
+        expect(pins).to.have.nested.property('[0].metadata').that.eql(metadata);
+    });
+    it('lists pins directly', async () => {
+        const cid1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        const cid2 = await createAndPutBlock(raw.code, Uint8Array.from([4, 5, 6, 7]), helia.blockstore);
+        await helia.pins.add(cid1);
+        await helia.pins.add(cid2);
+        const pins = await all(helia.pins.ls({
+            cid: cid1
+        }));
+        expect(pins).to.have.lengthOf(1);
+        expect(pins).to.have.nested.property('[0].cid').that.eql(cid1);
+        expect(pins).to.have.nested.property('[0].depth', Infinity);
+        expect(pins).to.have.nested.property('[0].metadata').that.eql({});
+    });
+});
+//# sourceMappingURL=pins.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/pins.spec.js.map b/node_modules/helia/dist/dist/test/pins.spec.js.map
new file mode 100644
index 0000000..5a457b1
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/pins.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.spec.js","sourceRoot":"","sources":["../../test/pins.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/storage.spec.d.ts b/node_modules/helia/dist/dist/test/storage.spec.d.ts
new file mode 100644
index 0000000..b87a365
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/storage.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=storage.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/storage.spec.d.ts.map b/node_modules/helia/dist/dist/test/storage.spec.d.ts.map
new file mode 100644
index 0000000..375fbf0
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/storage.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"storage.spec.d.ts","sourceRoot":"","sources":["../../test/storage.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/storage.spec.js b/node_modules/helia/dist/dist/test/storage.spec.js
new file mode 100644
index 0000000..6e36af4
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/storage.spec.js
@@ -0,0 +1,136 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { BlockStorage } from '../src/storage.js';
+import { stubInterface } from 'sinon-ts';
+import { PinsImpl } from '../src/pins.js';
+import { createBlock } from './fixtures/create-block.js';
+import * as raw from 'multiformats/codecs/raw';
+import all from 'it-all';
+import delay from 'delay';
+import drain from 'it-drain';
+import Sinon from 'sinon';
+describe('storage', () => {
+    let storage;
+    let blockstore;
+    let bitswap;
+    let pins;
+    let blocks;
+    beforeEach(async () => {
+        blocks = [];
+        for (let i = 0; i < 10; i++) {
+            blocks.push(await createBlock(raw.code, Uint8Array.from([0, 1, 2, i])));
+        }
+        const datastore = new MemoryDatastore();
+        blockstore = new MemoryBlockstore();
+        bitswap = stubInterface();
+        pins = new PinsImpl(datastore, blockstore, []);
+        storage = new BlockStorage(blockstore, pins, {
+            bitswap,
+            holdGcLock: true
+        });
+    });
+    it('gets a block from the blockstore', async () => {
+        const { cid, block } = blocks[0];
+        await blockstore.put(cid, block);
+        const retrieved = await storage.get(cid);
+        expect(retrieved).to.equalBytes(block);
+    });
+    it('gets a block from the blockstore with progress', async () => {
+        const { cid, block } = blocks[0];
+        await blockstore.put(cid, block);
+        const onProgress = Sinon.stub();
+        await storage.get(cid, {
+            onProgress
+        });
+        expect(onProgress.called).to.be.true();
+    });
+    it('gets many blocks from the blockstore', async () => {
+        const count = 5;
+        for (let i = 0; i < count; i++) {
+            const { cid, block } = blocks[i];
+            await blockstore.put(cid, block);
+        }
+        const retrieved = await all(storage.getMany(async function* () {
+            for (let i = 0; i < count; i++) {
+                yield blocks[i].cid;
+                await delay(10);
+            }
+        }()));
+        expect(retrieved).to.deep.equal(new Array(count).fill(0).map((_, i) => blocks[i]));
+    });
+    it('puts a block into the blockstore', async () => {
+        const { cid, block } = blocks[0];
+        await storage.put(cid, block);
+        const retrieved = await blockstore.get(cid);
+        expect(retrieved).to.equalBytes(block);
+    });
+    it('puts many blocks into the blockstore', async () => {
+        const count = 5;
+        await drain(storage.putMany(async function* () {
+            for (let i = 0; i < count; i++) {
+                yield { cid: blocks[i].cid, block: blocks[i].block };
+                await delay(10);
+            }
+        }()));
+        const retrieved = await all(blockstore.getMany(new Array(count).fill(0).map((_, i) => blocks[i].cid)));
+        expect(retrieved).to.deep.equal(retrieved);
+    });
+    it('gets a block from bitswap when it is not in the blockstore', async () => {
+        const { cid, block } = blocks[0];
+        bitswap.isStarted.returns(true);
+        bitswap.want.withArgs(cid).resolves(block);
+        expect(await blockstore.has(cid)).to.be.false();
+        const returned = await storage.get(cid);
+        expect(await blockstore.has(cid)).to.be.true();
+        expect(returned).to.equalBytes(block);
+        expect(bitswap.want.called).to.be.true();
+    });
+    it('gets many blocks from bitswap when they are not in the blockstore', async () => {
+        bitswap.isStarted.returns(true);
+        const count = 5;
+        for (let i = 0; i < count; i++) {
+            const { cid, block } = blocks[i];
+            bitswap.want.withArgs(cid).resolves(block);
+            expect(await blockstore.has(cid)).to.be.false();
+        }
+        const retrieved = await all(storage.getMany(async function* () {
+            for (let i = 0; i < count; i++) {
+                yield blocks[i].cid;
+                await delay(10);
+            }
+        }()));
+        expect(retrieved).to.deep.equal(new Array(count).fill(0).map((_, i) => blocks[i]));
+        for (let i = 0; i < count; i++) {
+            const { cid } = blocks[i];
+            expect(bitswap.want.calledWith(cid)).to.be.true();
+            expect(await blockstore.has(cid)).to.be.true();
+        }
+    });
+    it('gets some blocks from bitswap when they are not in the blockstore', async () => {
+        bitswap.isStarted.returns(true);
+        const count = 5;
+        // blocks 0,1,3,4 are in the blockstore
+        await blockstore.put(blocks[0].cid, blocks[0].block);
+        await blockstore.put(blocks[1].cid, blocks[1].block);
+        await blockstore.put(blocks[3].cid, blocks[3].block);
+        await blockstore.put(blocks[4].cid, blocks[4].block);
+        // block #2 comes from bitswap but slowly
+        bitswap.want.withArgs(blocks[2].cid).callsFake(async () => {
+            await delay(100);
+            return blocks[2].block;
+        });
+        const retrieved = await all(storage.getMany(async function* () {
+            for (let i = 0; i < count; i++) {
+                yield blocks[i].cid;
+                await delay(10);
+            }
+        }()));
+        expect(retrieved).to.deep.equal(new Array(count).fill(0).map((_, i) => blocks[i]));
+        for (let i = 0; i < count; i++) {
+            expect(await blockstore.has(blocks[i].cid)).to.be.true();
+        }
+    });
+});
+//# sourceMappingURL=storage.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/test/storage.spec.js.map b/node_modules/helia/dist/dist/test/storage.spec.js.map
new file mode 100644
index 0000000..abe0c20
--- /dev/null
+++ b/node_modules/helia/dist/dist/test/storage.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"storage.spec.js","sourceRoot":"","sources":["../../test/storage.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/dist/tsconfig.tsbuildinfo b/node_modules/helia/dist/dist/tsconfig.tsbuildinfo
new file mode 100644
index 0000000..574627a
--- /dev/null
+++ b/node_modules/helia/dist/dist/tsconfig.tsbuildinfo
@@ -0,0 +1 @@
+{"program":{"fileNames":["../../../node_modules/typescript/lib/lib.es5.d.ts","../../../node_modules/typescript/lib/lib.es2015.d.ts","../../../node_modules/typescript/lib/lib.es2016.d.ts","../../../node_modules/typescript/lib/lib.es2017.d.ts","../../../node_modules/typescript/lib/lib.es2018.d.ts","../../../node_modules/typescript/lib/lib.es2019.d.ts","../../../node_modules/typescript/lib/lib.es2020.d.ts","../../../node_modules/typescript/lib/lib.es2021.d.ts","../../../node_modules/typescript/lib/lib.dom.d.ts","../../../node_modules/typescript/lib/lib.dom.iterable.d.ts","../../../node_modules/typescript/lib/lib.webworker.d.ts","../../../node_modules/typescript/lib/lib.es2015.core.d.ts","../../../node_modules/typescript/lib/lib.es2015.collection.d.ts","../../../node_modules/typescript/lib/lib.es2015.generator.d.ts","../../../node_modules/typescript/lib/lib.es2015.iterable.d.ts","../../../node_modules/typescript/lib/lib.es2015.promise.d.ts","../../../node_modules/typescript/lib/lib.es2015.proxy.d.ts","../../../node_modules/typescript/lib/lib.es2015.reflect.d.ts","../../../node_modules/typescript/lib/lib.es2015.symbol.d.ts","../../../node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","../../../node_modules/typescript/lib/lib.es2016.array.include.d.ts","../../../node_modules/typescript/lib/lib.es2017.object.d.ts","../../../node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","../../../node_modules/typescript/lib/lib.es2017.string.d.ts","../../../node_modules/typescript/lib/lib.es2017.intl.d.ts","../../../node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","../../../node_modules/typescript/lib/lib.es2018.asyncgenerator.d.ts","../../../node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","../../../node_modules/typescript/lib/lib.es2018.intl.d.ts","../../../node_modules/typescript/lib/lib.es2018.promise.d.ts","../../../node_modules/typescript/lib/lib.es2018.regexp.d.ts","../../../node_modules/typescript/lib/lib.es2019.array.d.ts","../../../node_modules/typescript/lib/lib.es2019.object.d.ts","../../../node_modules/typescript/lib/lib.es2019.string.d.ts","../../../node_modules/typescript/lib/lib.es2019.symbol.d.ts","../../../node_modules/typescript/lib/lib.es2019.intl.d.ts","../../../node_modules/typescript/lib/lib.es2020.bigint.d.ts","../../../node_modules/typescript/lib/lib.es2020.date.d.ts","../../../node_modules/typescript/lib/lib.es2020.promise.d.ts","../../../node_modules/typescript/lib/lib.es2020.sharedmemory.d.ts","../../../node_modules/typescript/lib/lib.es2020.string.d.ts","../../../node_modules/typescript/lib/lib.es2020.symbol.wellknown.d.ts","../../../node_modules/typescript/lib/lib.es2020.intl.d.ts","../../../node_modules/typescript/lib/lib.es2020.number.d.ts","../../../node_modules/typescript/lib/lib.es2021.promise.d.ts","../../../node_modules/typescript/lib/lib.es2021.string.d.ts","../../../node_modules/typescript/lib/lib.es2021.weakref.d.ts","../../../node_modules/typescript/lib/lib.es2021.intl.d.ts","../../../node_modules/typescript/lib/lib.esnext.intl.d.ts","../../../node_modules/@libp2p/interfaces/dist/src/index.d.ts","../../../node_modules/@libp2p/interfaces/dist/src/events.d.ts","../../../node_modules/@libp2p/interfaces/dist/src/startable.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/protocols-table.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/filter/multiaddr-filter.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/index.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/interface.d.ts","../../../node_modules/multiformats/dist/types/src/bases/interface.d.ts","../../../node_modules/multiformats/dist/types/src/block/interface.d.ts","../../../node_modules/multiformats/dist/types/src/link/interface.d.ts","../../../node_modules/multiformats/dist/types/src/cid.d.ts","../../../node_modules/@libp2p/interface-peer-id/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-peer-info/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-peer-discovery/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-dht/dist/src/index.d.ts","../../../node_modules/uint8arraylist/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-record/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-peer-store/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-connection/dist/src/status.d.ts","../../../node_modules/it-stream-types/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-connection/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-peer-routing/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-content-routing/dist/src/index.d.ts","../../../node_modules/it-pushable/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-pubsub/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-registrar/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-metrics/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-keychain/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-libp2p/dist/src/index.d.ts","../../../node_modules/interface-store/dist/src/index.d.ts","../../../node_modules/multiformats/dist/types/src/codecs/interface.d.ts","../../../node_modules/multiformats/dist/types/src/interface.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/digest.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/hasher.d.ts","../../../node_modules/multiformats/dist/types/src/varint.d.ts","../../../node_modules/multiformats/dist/types/src/bytes.d.ts","../../../node_modules/multiformats/dist/types/src/index.d.ts","../../../node_modules/multiformats/dist/types/src/codecs/raw.d.ts","../../../node_modules/multiformats/dist/types/src/codecs/json.d.ts","../../../node_modules/multiformats/dist/types/src/bases/base.d.ts","../../../node_modules/multiformats/dist/types/src/basics.d.ts","../../../node_modules/uint8arrays/dist/src/util/bases.d.ts","../../../node_modules/uint8arrays/dist/src/to-string.d.ts","../../../node_modules/interface-datastore/dist/src/key.d.ts","../../../node_modules/interface-datastore/dist/src/index.d.ts","../../../node_modules/progress-events/dist/src/index.d.ts","../../interface/dist/src/pins.d.ts","../../../node_modules/interface-blockstore/dist/src/index.d.ts","../../../node_modules/protons-runtime/dist/src/codec.d.ts","../../../node_modules/protons-runtime/dist/src/decode.d.ts","../../../node_modules/protons-runtime/dist/src/encode.d.ts","../../../node_modules/protons-runtime/dist/src/codecs/enum.d.ts","../../../node_modules/protons-runtime/dist/src/codecs/message.d.ts","../../../node_modules/protons-runtime/dist/src/utils.d.ts","../../../node_modules/protons-runtime/dist/src/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/message/message.d.ts","../../../node_modules/@vascosantos/moving-average/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/wantlist/entry.d.ts","../../../node_modules/ipfs-bitswap/dist/src/message/entry.d.ts","../../../node_modules/ipfs-bitswap/dist/src/message/index.d.ts","../../../node_modules/@types/node/assert.d.ts","../../../node_modules/@types/node/assert/strict.d.ts","../../../node_modules/@types/node/globals.d.ts","../../../node_modules/@types/node/async_hooks.d.ts","../../../node_modules/@types/node/buffer.d.ts","../../../node_modules/@types/node/child_process.d.ts","../../../node_modules/@types/node/cluster.d.ts","../../../node_modules/@types/node/console.d.ts","../../../node_modules/@types/node/constants.d.ts","../../../node_modules/@types/node/crypto.d.ts","../../../node_modules/@types/node/dgram.d.ts","../../../node_modules/@types/node/diagnostics_channel.d.ts","../../../node_modules/@types/node/dns.d.ts","../../../node_modules/@types/node/dns/promises.d.ts","../../../node_modules/@types/node/domain.d.ts","../../../node_modules/@types/node/dom-events.d.ts","../../../node_modules/@types/node/events.d.ts","../../../node_modules/@types/node/fs.d.ts","../../../node_modules/@types/node/fs/promises.d.ts","../../../node_modules/@types/node/http.d.ts","../../../node_modules/@types/node/http2.d.ts","../../../node_modules/@types/node/https.d.ts","../../../node_modules/@types/node/inspector.d.ts","../../../node_modules/@types/node/module.d.ts","../../../node_modules/@types/node/net.d.ts","../../../node_modules/@types/node/os.d.ts","../../../node_modules/@types/node/path.d.ts","../../../node_modules/@types/node/perf_hooks.d.ts","../../../node_modules/@types/node/process.d.ts","../../../node_modules/@types/node/punycode.d.ts","../../../node_modules/@types/node/querystring.d.ts","../../../node_modules/@types/node/readline.d.ts","../../../node_modules/@types/node/readline/promises.d.ts","../../../node_modules/@types/node/repl.d.ts","../../../node_modules/@types/node/stream.d.ts","../../../node_modules/@types/node/stream/promises.d.ts","../../../node_modules/@types/node/stream/consumers.d.ts","../../../node_modules/@types/node/stream/web.d.ts","../../../node_modules/@types/node/string_decoder.d.ts","../../../node_modules/@types/node/test.d.ts","../../../node_modules/@types/node/timers.d.ts","../../../node_modules/@types/node/timers/promises.d.ts","../../../node_modules/@types/node/tls.d.ts","../../../node_modules/@types/node/trace_events.d.ts","../../../node_modules/@types/node/tty.d.ts","../../../node_modules/@types/node/url.d.ts","../../../node_modules/@types/node/util.d.ts","../../../node_modules/@types/node/v8.d.ts","../../../node_modules/@types/node/vm.d.ts","../../../node_modules/@types/node/wasi.d.ts","../../../node_modules/@types/node/worker_threads.d.ts","../../../node_modules/@types/node/zlib.d.ts","../../../node_modules/@types/node/globals.global.d.ts","../../../node_modules/@types/node/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/stats/stat.d.ts","../../../node_modules/@libp2p/interface-stream-muxer/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-transport/dist/src/index.d.ts","../../../node_modules/libp2p/node_modules/@libp2p/interface-connection/dist/src/status.d.ts","../../../node_modules/libp2p/node_modules/@libp2p/interface-connection/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-address-manager/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/transport-manager.d.ts","../../../node_modules/libp2p/dist/src/identify/pb/message.d.ts","../../../node_modules/@libp2p/interface-connection-manager/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/identify/index.d.ts","../../../node_modules/@libp2p/interface-connection-gater/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-connection-encrypter/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/ping/index.d.ts","../../../node_modules/libp2p/dist/src/fetch/index.d.ts","../../../node_modules/libp2p/dist/src/autonat/index.d.ts","../../../node_modules/libp2p/dist/src/components.d.ts","../../../node_modules/@libp2p/keychain/dist/src/index.d.ts","../../../node_modules/@achingbrain/nat-port-mapper/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/nat-manager.d.ts","../../../node_modules/libp2p/dist/src/address-manager/index.d.ts","../../../node_modules/libp2p/dist/src/peer-routing.d.ts","../../../node_modules/libp2p/dist/src/connection-manager/latency-monitor.d.ts","../../../node_modules/libp2p/dist/src/connection-manager/index.d.ts","../../../node_modules/@libp2p/peer-collections/dist/src/map.d.ts","../../../node_modules/@libp2p/peer-collections/dist/src/set.d.ts","../../../node_modules/@libp2p/peer-collections/dist/src/list.d.ts","../../../node_modules/@libp2p/peer-collections/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/pb/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/server/reservation-store.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/server/advert-service.d.ts","../../../node_modules/it-pb-stream/node_modules/it-length-prefixed/dist/src/encode.d.ts","../../../node_modules/it-reader/dist/src/index.d.ts","../../../node_modules/it-pb-stream/node_modules/it-length-prefixed/dist/src/decode.d.ts","../../../node_modules/it-pb-stream/node_modules/it-length-prefixed/dist/src/index.d.ts","../../../node_modules/it-pb-stream/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/server/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/transport/reservation-store.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/transport/discovery.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/transport/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/index.d.ts","../../../node_modules/libp2p/dist/src/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/stats/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/wantlist/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/want-manager/msg-queue.d.ts","../../../node_modules/ipfs-bitswap/dist/src/want-manager/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/decision-engine/ledger.d.ts","../../../node_modules/ipfs-bitswap/dist/src/utils/sorted-map.d.ts","../../../node_modules/ipfs-bitswap/dist/src/decision-engine/req-queue.d.ts","../../../node_modules/ipfs-bitswap/dist/src/decision-engine/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/notifications.d.ts","../../../node_modules/ipfs-bitswap/dist/src/bitswap.d.ts","../../../node_modules/ipfs-bitswap/node_modules/@libp2p/interface-connection/dist/src/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/network.d.ts","../../../node_modules/ipfs-bitswap/dist/src/index.d.ts","../../interface/dist/src/blocks.d.ts","../../interface/dist/src/index.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/identity.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/sha2.d.ts","../src/index.ts","../../../node_modules/it-filter/dist/src/index.d.ts","../../../node_modules/mortice/dist/src/index.d.ts","../../../node_modules/it-foreach/dist/src/index.d.ts","../src/storage.ts","../../../node_modules/cborg/types/lib/token.d.ts","../../../node_modules/cborg/types/lib/bl.d.ts","../../../node_modules/cborg/types/interface.d.ts","../../../node_modules/cborg/types/lib/decode.d.ts","../../../node_modules/cborg/types/lib/encode.d.ts","../../../node_modules/cborg/types/cborg.d.ts","../../../node_modules/multiformats/dist/types/src/bases/base36.d.ts","../../../node_modules/eventemitter3/index.d.ts","../../../node_modules/p-queue/dist/queue.d.ts","../../../node_modules/p-queue/dist/options.d.ts","../../../node_modules/p-queue/dist/priority-queue.d.ts","../../../node_modules/p-queue/dist/index.d.ts","../../../node_modules/uint8arrays/dist/src/equals.d.ts","../../../node_modules/p-defer/index.d.ts","../../../node_modules/@ipld/dag-pb/dist/src/interface.d.ts","../../../node_modules/@ipld/dag-pb/dist/src/util.d.ts","../../../node_modules/@ipld/dag-pb/dist/src/index.d.ts","../../../node_modules/cborg/types/lib/json/encode.d.ts","../../../node_modules/cborg/types/lib/json/decode.d.ts","../../../node_modules/cborg/types/lib/json/json.d.ts","../../../node_modules/multiformats/dist/types/src/bases/base64.d.ts","../src/utils/dag-walkers.ts","../src/pins.ts","../../../node_modules/uint8arrays/dist/src/from-string.d.ts","../src/utils/datastore-version.ts","../../../node_modules/it-drain/dist/src/index.d.ts","../../../node_modules/datastore-core/dist/src/errors.d.ts","../../../node_modules/datastore-core/dist/src/shard.d.ts","../../../node_modules/datastore-core/dist/src/base.d.ts","../../../node_modules/datastore-core/dist/src/memory.d.ts","../../../node_modules/datastore-core/dist/src/keytransform.d.ts","../../../node_modules/datastore-core/dist/src/sharding.d.ts","../../../node_modules/datastore-core/dist/src/mount.d.ts","../../../node_modules/datastore-core/dist/src/tiered.d.ts","../../../node_modules/datastore-core/dist/src/namespace.d.ts","../../../node_modules/datastore-core/dist/src/index.d.ts","../../../node_modules/blockstore-core/dist/src/base.d.ts","../../../node_modules/blockstore-core/dist/src/memory.d.ts","../../../node_modules/blockstore-core/dist/src/index.d.ts","../../../node_modules/@libp2p/logger/dist/src/index.d.ts","../src/helia.ts","../../../node_modules/@types/chai/index.d.ts","../../../node_modules/@types/chai-as-promised/index.d.ts","../../../node_modules/chai-parentheses/index.d.ts","../../../node_modules/@types/chai-subset/index.d.ts","../../../node_modules/chai-bites/index.d.ts","../../../node_modules/@types/chai-string/index.d.ts","../../../node_modules/aegir/dist/utils/chai.d.ts","../../../../../node_modules/@types/ws/index.d.ts","../../../node_modules/it-ws/dist/src/web-socket.d.ts","../../../node_modules/it-ws/dist/src/sink.d.ts","../../../node_modules/it-ws/dist/src/duplex.d.ts","../../../node_modules/it-ws/dist/src/client.d.ts","../../../node_modules/@libp2p/websockets/dist/src/index.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/@types/basic.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/proto/payload.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/@types/libp2p.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/nonce.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/@types/handshake.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/crypto.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/noise.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/crypto/stablelib.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/index.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/node_modules/it-stream-types/dist/src/index.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/frame.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/config.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/stream.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/muxer.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/index.d.ts","../test/fixtures/create-block.ts","../../../node_modules/@ipld/dag-cbor/dist/src/index.d.ts","../../../node_modules/@ipld/dag-json/dist/src/index.d.ts","../test/gc.spec.ts","../test/index.spec.ts","../test/fixtures/create-dag.ts","../test/fixtures/dag-walker.ts","../test/pins.depth-limited.spec.ts","../test/pins.recursive.spec.ts","../../../node_modules/it-all/dist/src/index.d.ts","../test/pins.spec.ts","../../../node_modules/@types/sinonjs__fake-timers/index.d.ts","../../../node_modules/@types/sinon/index.d.ts","../../../node_modules/sinon-ts/dist/src/index.d.ts","../../../node_modules/delay/index.d.ts","../test/storage.spec.ts","../../../node_modules/keyv/src/index.d.ts","../../../node_modules/@types/http-cache-semantics/index.d.ts","../../../node_modules/@types/responselike/index.d.ts","../../../node_modules/@types/cacheable-request/index.d.ts","../../../node_modules/@types/ms/index.d.ts","../../../node_modules/@types/debug/index.d.ts","../../../node_modules/@types/extend/index.d.ts","../../../node_modules/@types/istanbul-lib-coverage/index.d.ts","../../../node_modules/@types/json-schema/index.d.ts","../../../node_modules/@types/json5/index.d.ts","../../../node_modules/@types/keyv/index.d.ts","../../../node_modules/@types/unist/index.d.ts","../../../node_modules/@types/mdast/index.d.ts","../../../node_modules/@types/minimatch/index.d.ts","../../../node_modules/@types/minimist/index.d.ts","../../../node_modules/@types/mocha/index.d.ts","../../../node_modules/@types/normalize-package-data/index.d.ts","../../../node_modules/@types/parse-json/index.d.ts","../../../node_modules/@types/retry/index.d.ts","../../../node_modules/@types/semver/classes/semver.d.ts","../../../node_modules/@types/semver/functions/parse.d.ts","../../../node_modules/@types/semver/functions/valid.d.ts","../../../node_modules/@types/semver/functions/clean.d.ts","../../../node_modules/@types/semver/functions/inc.d.ts","../../../node_modules/@types/semver/functions/diff.d.ts","../../../node_modules/@types/semver/functions/major.d.ts","../../../node_modules/@types/semver/functions/minor.d.ts","../../../node_modules/@types/semver/functions/patch.d.ts","../../../node_modules/@types/semver/functions/prerelease.d.ts","../../../node_modules/@types/semver/functions/compare.d.ts","../../../node_modules/@types/semver/functions/rcompare.d.ts","../../../node_modules/@types/semver/functions/compare-loose.d.ts","../../../node_modules/@types/semver/functions/compare-build.d.ts","../../../node_modules/@types/semver/functions/sort.d.ts","../../../node_modules/@types/semver/functions/rsort.d.ts","../../../node_modules/@types/semver/functions/gt.d.ts","../../../node_modules/@types/semver/functions/lt.d.ts","../../../node_modules/@types/semver/functions/eq.d.ts","../../../node_modules/@types/semver/functions/neq.d.ts","../../../node_modules/@types/semver/functions/gte.d.ts","../../../node_modules/@types/semver/functions/lte.d.ts","../../../node_modules/@types/semver/functions/cmp.d.ts","../../../node_modules/@types/semver/functions/coerce.d.ts","../../../node_modules/@types/semver/classes/comparator.d.ts","../../../node_modules/@types/semver/classes/range.d.ts","../../../node_modules/@types/semver/functions/satisfies.d.ts","../../../node_modules/@types/semver/ranges/max-satisfying.d.ts","../../../node_modules/@types/semver/ranges/min-satisfying.d.ts","../../../node_modules/@types/semver/ranges/to-comparators.d.ts","../../../node_modules/@types/semver/ranges/min-version.d.ts","../../../node_modules/@types/semver/ranges/valid.d.ts","../../../node_modules/@types/semver/ranges/outside.d.ts","../../../node_modules/@types/semver/ranges/gtr.d.ts","../../../node_modules/@types/semver/ranges/ltr.d.ts","../../../node_modules/@types/semver/ranges/intersects.d.ts","../../../node_modules/@types/semver/ranges/simplify.d.ts","../../../node_modules/@types/semver/ranges/subset.d.ts","../../../node_modules/@types/semver/internals/identifiers.d.ts","../../../node_modules/@types/semver/index.d.ts","../../../node_modules/@types/strip-bom/index.d.ts","../../../node_modules/@types/strip-json-comments/index.d.ts","../../../node_modules/@types/yargs-parser/index.d.ts","../../../node_modules/@types/yargs/index.d.ts","../../../node_modules/@types/yauzl/index.d.ts","../../../../../node_modules/@types/connect/index.d.ts","../../../../../node_modules/@types/body-parser/index.d.ts","../../../../../node_modules/@types/bonjour/index.d.ts","../../../../../node_modules/@types/range-parser/index.d.ts","../../../../../node_modules/@types/qs/index.d.ts","../../../../../node_modules/@types/express-serve-static-core/index.d.ts","../../../../../node_modules/@types/connect-history-api-fallback/index.d.ts","../../../../../node_modules/@types/eslint/helpers.d.ts","../../../../../node_modules/@types/estree/index.d.ts","../../../../../node_modules/@types/json-schema/index.d.ts","../../../../../node_modules/@types/eslint/index.d.ts","../../../../../node_modules/@types/eslint-scope/index.d.ts","../../../../../node_modules/@types/mime/mime.d.ts","../../../../../node_modules/@types/mime/index.d.ts","../../../../../node_modules/@types/serve-static/index.d.ts","../../../../../node_modules/@types/express/index.d.ts","../../../../../node_modules/@types/html-minifier-terser/index.d.ts","../../../../../node_modules/@types/http-proxy/index.d.ts","../../../../../node_modules/@types/linkify-it/index.d.ts","../../../../../node_modules/@types/mdurl/encode.d.ts","../../../../../node_modules/@types/mdurl/decode.d.ts","../../../../../node_modules/@types/mdurl/parse.d.ts","../../../../../node_modules/@types/mdurl/format.d.ts","../../../../../node_modules/@types/mdurl/index.d.ts","../../../../../node_modules/@types/markdown-it/lib/common/utils.d.ts","../../../../../node_modules/@types/markdown-it/lib/token.d.ts","../../../../../node_modules/@types/markdown-it/lib/rules_inline/state_inline.d.ts","../../../../../node_modules/@types/markdown-it/lib/helpers/parse_link_label.d.ts","../../../../../node_modules/@types/markdown-it/lib/helpers/parse_link_destination.d.ts","../../../../../node_modules/@types/markdown-it/lib/helpers/parse_link_title.d.ts","../../../../../node_modules/@types/markdown-it/lib/helpers/index.d.ts","../../../../../node_modules/@types/markdown-it/lib/ruler.d.ts","../../../../../node_modules/@types/markdown-it/lib/rules_block/state_block.d.ts","../../../../../node_modules/@types/markdown-it/lib/parser_block.d.ts","../../../../../node_modules/@types/markdown-it/lib/rules_core/state_core.d.ts","../../../../../node_modules/@types/markdown-it/lib/parser_core.d.ts","../../../../../node_modules/@types/markdown-it/lib/parser_inline.d.ts","../../../../../node_modules/@types/markdown-it/lib/renderer.d.ts","../../../../../node_modules/@types/markdown-it/lib/index.d.ts","../../../../../node_modules/@types/markdown-it/index.d.ts","../../../../../node_modules/@types/prop-types/index.d.ts","../../../../../node_modules/@types/react/global.d.ts","../../../../../node_modules/csstype/index.d.ts","../../../../../node_modules/@types/scheduler/tracing.d.ts","../../../../../node_modules/@types/react/index.d.ts","../../../../../node_modules/@types/scheduler/index.d.ts","../../../../../node_modules/@types/serve-index/index.d.ts","../../../../../node_modules/@types/sockjs/index.d.ts","../../../../../node_modules/@types/stats-lite/index.d.ts","../../../../../node_modules/@types/varint/index.d.ts"],"fileInfos":[{"version":"8730f4bf322026ff5229336391a18bcaa1f94d4f82416c8b2f3954e2ccaae2ba","affectsGlobalScope":true},"dc47c4fa66b9b9890cf076304de2a9c5201e94b740cffdf09f87296d877d71f6","7a387c58583dfca701b6c85e0adaf43fb17d590fb16d5b2dc0a2fbd89f35c467","8a12173c586e95f4433e0c6dc446bc88346be73ffe9ca6eec7aa63c8f3dca7f9","5f4e733ced4e129482ae2186aae29fde948ab7182844c3a5a51dd346182c7b06","4b421cbfb3a38a27c279dec1e9112c3d1da296f77a1a85ddadf7e7a425d45d18","1fc5ab7a764205c68fa10d381b08417795fc73111d6dd16b5b1ed36badb743d9","746d62152361558ea6d6115cf0da4dd10ede041d14882ede3568bce5dc4b4f1f",{"version":"3aafcb693fe5b5c3bd277bd4c3a617b53db474fe498fc5df067c5603b1eebde7","affectsGlobalScope":true},{"version":"f3d4da15233e593eacb3965cde7960f3fddf5878528d882bcedd5cbaba0193c7","affectsGlobalScope":true},{"version":"d3f4771304b6b07e5a2bb992e75af76ac060de78803b1b21f0475ffc5654d817","affectsGlobalScope":true},{"version":"adb996790133eb33b33aadb9c09f15c2c575e71fb57a62de8bf74dbf59ec7dfb","affectsGlobalScope":true},{"version":"8cc8c5a3bac513368b0157f3d8b31cfdcfe78b56d3724f30f80ed9715e404af8","affectsGlobalScope":true},{"version":"cdccba9a388c2ee3fd6ad4018c640a471a6c060e96f1232062223063b0a5ac6a","affectsGlobalScope":true},{"version":"c5c05907c02476e4bde6b7e76a79ffcd948aedd14b6a8f56e4674221b0417398","affectsGlobalScope":true},{"version":"5f406584aef28a331c36523df688ca3650288d14f39c5d2e555c95f0d2ff8f6f","affectsGlobalScope":true},{"version":"22f230e544b35349cfb3bd9110b6ef37b41c6d6c43c3314a31bd0d9652fcec72","affectsGlobalScope":true},{"version":"7ea0b55f6b315cf9ac2ad622b0a7813315bb6e97bf4bb3fbf8f8affbca7dc695","affectsGlobalScope":true},{"version":"3013574108c36fd3aaca79764002b3717da09725a36a6fc02eac386593110f93","affectsGlobalScope":true},{"version":"eb26de841c52236d8222f87e9e6a235332e0788af8c87a71e9e210314300410a","affectsGlobalScope":true},{"version":"3be5a1453daa63e031d266bf342f3943603873d890ab8b9ada95e22389389006","affectsGlobalScope":true},{"version":"17bb1fc99591b00515502d264fa55dc8370c45c5298f4a5c2083557dccba5a2a","affectsGlobalScope":true},{"version":"7ce9f0bde3307ca1f944119f6365f2d776d281a393b576a18a2f2893a2d75c98","affectsGlobalScope":true},{"version":"6a6b173e739a6a99629a8594bfb294cc7329bfb7b227f12e1f7c11bc163b8577","affectsGlobalScope":true},{"version":"81cac4cbc92c0c839c70f8ffb94eb61e2d32dc1c3cf6d95844ca099463cf37ea","affectsGlobalScope":true},{"version":"b0124885ef82641903d232172577f2ceb5d3e60aed4da1153bab4221e1f6dd4e","affectsGlobalScope":true},{"version":"0eb85d6c590b0d577919a79e0084fa1744c1beba6fd0d4e951432fa1ede5510a","affectsGlobalScope":true},{"version":"da233fc1c8a377ba9e0bed690a73c290d843c2c3d23a7bd7ec5cd3d7d73ba1e0","affectsGlobalScope":true},{"version":"d154ea5bb7f7f9001ed9153e876b2d5b8f5c2bb9ec02b3ae0d239ec769f1f2ae","affectsGlobalScope":true},{"version":"bb2d3fb05a1d2ffbca947cc7cbc95d23e1d053d6595391bd325deb265a18d36c","affectsGlobalScope":true},{"version":"c80df75850fea5caa2afe43b9949338ce4e2de086f91713e9af1a06f973872b8","affectsGlobalScope":true},{"version":"9d57b2b5d15838ed094aa9ff1299eecef40b190722eb619bac4616657a05f951","affectsGlobalScope":true},{"version":"6c51b5dd26a2c31dbf37f00cfc32b2aa6a92e19c995aefb5b97a3a64f1ac99de","affectsGlobalScope":true},{"version":"6e7997ef61de3132e4d4b2250e75343f487903ddf5370e7ce33cf1b9db9a63ed","affectsGlobalScope":true},{"version":"2ad234885a4240522efccd77de6c7d99eecf9b4de0914adb9a35c0c22433f993","affectsGlobalScope":true},{"version":"5e5e095c4470c8bab227dbbc61374878ecead104c74ab9960d3adcccfee23205","affectsGlobalScope":true},{"version":"09aa50414b80c023553090e2f53827f007a301bc34b0495bfb2c3c08ab9ad1eb","affectsGlobalScope":true},{"version":"d7f680a43f8cd12a6b6122c07c54ba40952b0c8aa140dcfcf32eb9e6cb028596","affectsGlobalScope":true},{"version":"3787b83e297de7c315d55d4a7c546ae28e5f6c0a361b7a1dcec1f1f50a54ef11","affectsGlobalScope":true},{"version":"e7e8e1d368290e9295ef18ca23f405cf40d5456fa9f20db6373a61ca45f75f40","affectsGlobalScope":true},{"version":"faf0221ae0465363c842ce6aa8a0cbda5d9296940a8e26c86e04cc4081eea21e","affectsGlobalScope":true},{"version":"06393d13ea207a1bfe08ec8d7be562549c5e2da8983f2ee074e00002629d1871","affectsGlobalScope":true},{"version":"2768ef564cfc0689a1b76106c421a2909bdff0acbe87da010785adab80efdd5c","affectsGlobalScope":true},{"version":"b248e32ca52e8f5571390a4142558ae4f203ae2f94d5bac38a3084d529ef4e58","affectsGlobalScope":true},{"version":"6c55633c733c8378db65ac3da7a767c3cf2cf3057f0565a9124a16a3a2019e87","affectsGlobalScope":true},{"version":"fb4416144c1bf0323ccbc9afb0ab289c07312214e8820ad17d709498c865a3fe","affectsGlobalScope":true},{"version":"5b0ca94ec819d68d33da516306c15297acec88efeb0ae9e2b39f71dbd9685ef7","affectsGlobalScope":true},{"version":"34c839eaaa6d78c8674ae2c37af2236dee6831b13db7b4ef4df3ec889a04d4f2","affectsGlobalScope":true},{"version":"52d1bb7ab7a3306fd0375c8bff560feed26ed676a5b0457fa8027b563aecb9a4","affectsGlobalScope":true},"a807c0a82557d68f6f0464d6af0a6566d1ef708f57c7d1d7dd8dde28879635bc","4a5612eb59f581a5b8e05d22e668b4199787751266a0291e3e07113fc52abf2a","16c594cd8a44be9f5398d3fc7dbc9575f0b67d91a6553f35bd3576136862b32b","5d055d8b54e2dec3fe4aa417f5f664658b78123e83e8735047285f99a1d24065","42b5333564fef3c9becbe8daf55b1ea124514cd86c2f8bed401d2a3f0037b3b1","109970171acb66c4c03fa6ba9d0a3bc2bf43c12540db2b0842d25d54fbe11f65","65da6f0b8f50b27e05ebf35c88a8757eb4308751cdf2b1064a0e310a2a485895","2e3dc1d28f2467b2af0c931a3b0d2c595746a2f21818fc3c7b5d050996ace788","237be372eeb9a7ce07c6b2a21358f22772cde924614d67de175a4ac0ba3eb486","862eacc247d6c92524d7879feac6da363f55428cc78270bce7b14f2d3d0b0cef","f55f3ab9485b5fd1a3ba3a5a53e680cb8d3acc3552816a5d58a1fa26324262d0","ee93f3313289b31afd1544da65086607942df227eb61aedf488b7c072aa1128f","edb50eace77052203c3bc6eb251fe31f44ab0107e2b6d949ec983a918726aaf4","70cbb43b1e838bb77b16e1085115494c8b6925a954edf7fbdd494ad56a88adb8","ad716342f559ff88871c01a351dbf89fe72c8313f329cd2a714f09f532c50eab","ea86fe238f679714f2b3662d9d932bc3b47a0500894985718243167043f2bda8","866f0c4f16380a56653adc6cbeac08c58c626dabb431f0fa6cc2ba07874836d8","e8c5b68c1182684e8cfc177430b80fef003976d1dbde326087c28f5125fe4b5d","6666d48a46dbfd565490e7f8789093e2392c5bdcc3a380dfdd91c77237e43101","a2023e18c62b1109f17241fb1f90a84e75fffcb3ee9265d2e9bc0fa40b6ede42","3ccf65e2230413ab1facbad92a2fb77b8e2bcd314618d0ebc12f6cb7aaa21619","9080b537cd4fa24273477f33faf5f983e5f10aa386c2de8fcb6de837c9cc9763","272cd5e6428b68d973ce707329c3f621ac6b3eb4bf5bd4421b1106299600ddde","d34a8917095f11006957bed03e1e60dacc0b82906f5d0ddc87b959e283fbb5cc","bffe8a5db9410d2f3320df7016f83e9de47328e377aa78b9aaed1fe6d5db9d66","14b8a1dd226271e6b045d91262602b15820ff871b3dab24510a15e6989d05a5d","0fc1e0effc8ea83ceca9a1ff36c2696489fefea040d33fc5cbe244111333fcd4","1217c84b164e559b2371aea1b8c11eea9f95e123dab98942c8a5a4aacc2ad252","28092d5b5aea82adc509a3d522d265d9d5a8a0ddf92f94c8fb336c5787893030","7735c3681e614d7e967a935f397210fedbd987243456206f697202cb7c266a41","8ad13afb5324460426b210f7c5040d3d19375accd24e22bb52a534c728aca73e","e1fe04ff1ffecfb18420f0895d0cd2652f98a27def5c33aae5ef328f186c905b","635e7c978a30ab2013a37c4d05d0d081e58e4ad867db46a009412ad24ee426d7","b27c2a28daf3e502ae6b631cbf51881247fffd3e0163520bc5904604f9e48096","87b44430497cae7542bbd5ac2fb6663df6a465dea7a46be58a49cd9416530439","32b67d761db3999f1e482d0add405b695d3ec5607e07ae4c963a96334c331814","8747571dae434deca4847b49e09b5421d7068b0956a1df841756812645d4e1ed","474ab86e676e0c1b664bfcd21b1e58bed351f3390ba1d892e8da703f371b7a4e","fb7a601066e19b5d0c173b564bd46b358cf00c9040e79fb6fd427b7aa223eed1","4a8ce4a308482d69bd9032ee59f895a9d91e28ac5324665b31ea3a374b45e686","8b097e48fdeabcee00e2aacd4d009dff135c2cd51675a272d74ec25dd853dfee","28235440c6b330eb66df3a7badfc11e32cf7e08fbdb17b518a6b775fb269170f","247a5bebf668df6d3bb7e0b297ed5a6b6913d9343dcfea5bf77ce4662ab102bf","531556008024c69163c0d120823a69e7a6a5be1279ea87fc725a63dc386278b7","e2e44effbf7b4b1fb5111ef7a4443a733aff4cace7875fafa86bc41130dfdb84","1104c3d427c1cd94c53b14c09dc27d342a1cc1b0070ef95423bc3732940360e0","8585273188f221f30b37b5d869eb57bee20aa7aa478fe3de632cc0a1cd25238d","9dffe4acb382f1232e9eaeda23ed7f07c934acb9ef06aa528f75799d12d35343","77411d10dad0e74a86ce28dd0f720cce2947421e42f3fb5d1849bc14520f9b5b","667c9ac7c2f61c4a36220c2fa02f848a170aa96d3a58be32a5831aad86330da2","eb15dfd1f8b6da5f546fe29a6a0f0de4ae6dbd4a5577af4eba4c8a54548ef0a2","01443e5da049881a99f223c72617d4bb1d8854930d03deceb628e4be83df1e4a","a380f922477db0b9b4a17cde7d29585e2280036fd62ac4564814d4844b64717a","a0263cc045540023e72c993a26fd1bef3adf8674b9719272009134c56ecfc336","df162b6f89985144d8aedccc36dfc366ab5e562ba8615125b2bfa25273f3006b","5c040fc4a38020743248e6a49d75dd0e0547960d89492b06a9cc0fb4247ff547","7f8f6d3576ead7698d78d3849b5cd55b79f923e5589e14a2cc5270b4d0c9fe96","98361c0bdf0a06c4d1f0d1df0a94ea45c01c2f8c31180f40bf44fce4eebe761f","1d29e7b02346845d12ce3a2d6e23baabe6b5ab84f62541824feef0ff4bfb58d8","e53930d95e52d39b90d130b2312f18669be0766393dff5a649829f318ac7df06","7e771891adaa85b690266bc37bd6eb43bc57eecc4b54693ead36467e7369952a","a69c09dbea52352f479d3e7ac949fde3d17b195abe90b045d619f747b38d6d1a",{"version":"57b6cb95756d1fe3bfeb20205de27b0c5406e4a86e130c6dfa6bd92af641e09d","affectsGlobalScope":true},"11e2d554398d2bd460e7d06b2fa5827a297c8acfbe00b4f894a224ac0862857f",{"version":"e193e634a99c9c1d71f1c6e4e1567a4a73584328d21ea02dd5cddbaad6693f61","affectsGlobalScope":true},"374ca798f244e464346f14301dc2a8b4b111af1a83b49fffef5906c338a1f922","5a94487653355b56018122d92392beb2e5f4a6c63ba5cef83bbe1c99775ef713",{"version":"d5135ad93b33adcce80b18f8065087934cdc1730d63db58562edcf017e1aad9b","affectsGlobalScope":true},"82408ed3e959ddc60d3e9904481b5a8dc16469928257af22a3f7d1a3bc7fd8c4","e596c9bb2f29a2699fdd4ae89139612652245192f67f45617c5a4b20832aaae9","bb9c4ffa5e6290c6980b63c815cdd1625876dadb2efaf77edbe82984be93e55e","1cdcfc1f624d6c08aa12c73935f6e13f095919cd99edf95752951796eb225729","216717f17c095cde1dc19375e1ab3af0a4a485355860c077a4f9d6ea59fab5b5","14b5aa23c5d0ae1907bc696ac7b6915d88f7d85799cc0dc2dcf98fbce2c5a67c","5c439dafdc09abe4d6c260a96b822fa0ba5be7203c71a63ab1f1423cd9e838ea",{"version":"6b526a5ec4a401ca7c26cfe6a48e641d8f30af76673bad3b06a1b4504594a960","affectsGlobalScope":true},{"version":"816ad2e607a96de5bcac7d437f843f5afd8957f1fa5eefa6bba8e4ed7ca8fd84","affectsGlobalScope":true},"80473bd0dd90ca1e166514c2dfead9d5803f9c51418864ca35abbeec6e6847e1","1c84b46267610a34028edfd0d035509341751262bac1062857f3c8df7aff7153","e6c86d83bd526c8bdb5d0bf935b8e72ce983763d600743f74d812fdf4abf4df6","a3d541d303ee505053f5dcbf9fafb65cac3d5631037501cd616195863a6c5740","8d3c583a07e0c37e876908c2d5da575019f689df8d9fa4c081d99119d53dba22","2c828a5405191d006115ab34e191b8474bc6c86ffdc401d1a9864b1b6e088a58",{"version":"e630e5528e899219ae319e83bef54bf3bcb91b01d76861ecf881e8e614b167f0","affectsGlobalScope":true},"bcebb922784739bdb34c18ee51095d25a92b560c78ccd2eaacd6bd00f7443d83","7ee6ed878c4528215c82b664fe0cfe80e8b4da6c0d4cc80869367868774db8b1","b0973c3cbcdc59b37bf477731d468696ecaf442593ec51bab497a613a580fe30",{"version":"4989e92ba5b69b182d2caaea6295af52b7dc73a4f7a2e336a676722884e7139d","affectsGlobalScope":true},{"version":"0715e4cd28ad471b2a93f3e552ff51a3ae423417a01a10aa1d3bc7c6b95059d6","affectsGlobalScope":true},"5153a2fd150e46ce57bb3f8db1318d33f6ad3261ed70ceeff92281c0608c74a3","210d54cd652ec0fec8c8916e4af59bb341065576ecda039842f9ffb2e908507c","36b03690b628eab08703d63f04eaa89c5df202e5f1edf3989f13ad389cd2c091","0effadd232a20498b11308058e334d3339cc5bf8c4c858393e38d9d4c0013dcf","25846d43937c672bab7e8195f3d881f93495df712ee901860effc109918938cc","7d55d78cd47cf5280643b53434b16c2d9d11d144126932759fbdd51da525eec4","1b952304137851e45bc009785de89ada562d9376177c97e37702e39e60c2f1ff","69ee23dd0d215b09907ad30d23f88b7790c93329d1faf31d7835552a10cf7cbf","44b8b584a338b190a59f4f6929d072431950c7bd92ec2694821c11bce180c8a5","23b89798789dffbd437c0c423f5d02d11f9736aea73d6abf16db4f812ff36eda","f69ff39996a61a0dd10f4bce73272b52e8024a4d58b13ab32bf4712909d0a2b7",{"version":"3c4ba1dd9b12ffa284b565063108f2f031d150ea15b8fafbdc17f5d2a07251f3","affectsGlobalScope":true},"e10177274a35a9d07c825615340b2fcde2f610f53f3fb40269fd196b4288dda6","c4577fb855ca259bdbf3ea663ca73988ce5f84251a92b4aef80a1f4122b6f98e","3c13ef48634e7b5012fcf7e8fce7496352c2d779a7201389ca96a2a81ee4314d","5d0a25ec910fa36595f85a67ac992d7a53dd4064a1ba6aea1c9f14ab73a023f2",{"version":"f0900cd5d00fe1263ff41201fb8073dbeb984397e4af3b8002a5c207a30bdc33","affectsGlobalScope":true},{"version":"ff07a9a03c65732ccc59b3c65bc584173da093bd563a6565411c01f5703bd3cb","affectsGlobalScope":true},"6de4a219df57d2b27274d59b67708f13c2cbf7ed211abe57d8f9ab8b25cde776","0fe8985a28f82c450a04a6edf1279d7181c0893f37da7d2a27f8efd4fd5edb03","e59a892d87e72733e2a9ca21611b9beb52977be2696c7ba4b216cbbb9a48f5aa",{"version":"da26af7362f53d122283bc69fed862b9a9fe27e01bc6a69d1d682e0e5a4df3e6","affectsGlobalScope":true},"8a300fa9b698845a1f9c41ecbe2c5966634582a8e2020d51abcace9b55aa959e",{"version":"ab9b9a36e5284fd8d3bf2f7d5fcbc60052f25f27e4d20954782099282c60d23e","affectsGlobalScope":true},"d8d555f3d607ecaa18d55de6995ea8f206342ecc93305919eac945c7c78c78c6","14df447cbd09928056c88fa3e8f3548715dd25437e4fad7ef1a7fb8ff8dbe6c6","4c5e54a2d502770a63859a00fbf77e8b91ce76b18080278f62866e7cdb582798","71dfda7df8d05d2d54627963af1c3c675ef99363d421b7ff42ae237d038db4ce","6666d48a46dbfd565490e7f8789093e2392c5bdcc3a380dfdd91c77237e43101","6377354dd753557d479933e0bec6ca6836f839c87394ecb071e85f062b708058","0dd67171a4a3fa82044faec51befa11ab96f9205fd8cc96be09de275b65d36ab","42570779c28480ae0d1fa0695974a888305ee2b2efd37bacdeb57204dec843db","dc35c5340756418041da9f388103218ead65f57397f40d5674672c216b008126","2596013e7e3f002455e29bad0a70e0ae1a1364cac8584d2590b73133e63d6073","b9f2a8333ccac1e6037afd66dbba82bdeea00f1ed011f741ce4f006ad4eb8b01","78599ccb7640bea7bc64e8fddf33e97b8cf512c1b2be2c8851655a66980e4268","cd5ab2f30a27d53001804b7ef51758a79b73e4ccb7716b8e2ab8e17d69a7183b","a9dc4418352bc4a8d1e9314aba1e29327b17d06c604b397c6140d6488c5b022a","6adcf362e079c177ea4730c8b7beb3e9848b3f970ef08b497a641e034b0a0ece","341331b97a90ac435664e68b81f116f1f622283f3de523c5425b67eb0a58cad1","5e76b98d51f23f9d9563ac7002139d43fd6543eb66646928bf2e9df6a468ace5","e0b109ec8368bbb8943bf7943af9fbcf0e895160d1363cf93dacd43bcc747794","f569da0d6f4c6fb153811dd6b7d34afb4511c7d85f5089e30a1db78004975ec1","537b1070107a0454a2fe365a633555700fff55a4b3e15d55520633b93dbf96d1","8571610b2e190937f6fcf0c626ad415ec9b02a4ff550d8881812d2b9efdd2847","8dac050016c78a797699221c95d569c47ea4176e403b47f9f5a2e95afe26cdd6","d8a63ecc9188f8ef5fce8c82ea2c691acce9a152b8bd07d75a6531c7d4c07df9","cf86d880d95988555dd6ac5d1d3c9aa99054df217f0a7ec1acf39b9d56f6445f","6426748248e4065207bda1892b18426f1c9072800edc015119d4c907f62af51d","4ce46cbc89a24ce3d0a00dec230826cefee2514181e790932230705db3f0849d","f7b2f9a0ffd520805cdf2440d48f45bd9074c905aea1a365b91de9170ccc9d58","8432e40770dd9f642c682661fea75226189e5b701b06189a98c6bcd3764d796b","8f0d013f819b91abf6b355e510e1bc039ff10699932d726ba7b3a4f447c031bc","4f7f48524408301ae348e9d310f9ca718210cc2ac1c2c6697eee1e0d487c7d00","34999b05c3aa15b73ab99dc1bd9a2d17b7f24cbf229a45b0850c7cd9e138ffe7","6c2d1a830c44b810afbc51d9c6e24acc69bba27bcd8f635142ebdfbe3e8512a3","86aa8428ca8e1061ca36c4d3d62add983e16b01c003b8644ad10e3baaa7fac22","975bbb148ebe1290081bb0f643d70aa4c5e4b09ef9121eb60dd78ec262042dac","d61d22e1b77ff3242e3ebdc209b1567edbf573fa619ef10841f282705124254c","91fe7b33847d945b1ad3a816c397ca4cddf5005dc36f5bea4ab11e1ca7b256f1","fe968d845c846a7b92645287133ba0b8e9f84fcfd31834993e77330a95e6e40c","a054d5318c7a96f630b21d0ecbbec6a5adf97f8d697f11dc1e7892f87be5ad02","a5e5b361a88c70f95156c17dadb55b39f658103e28f16d7a3158be79809b09fd","d40b8ae5d3a678fc5542430da94fc918f1c6859c214e899040c3df4c51742f2e","677634e24d8933e8820eac9ca51b590a63618d297f202cf0751777d2563c74c6","06d62ca3f63cc0a07f525f0df010713c02d0b3a12eff7e7c393641b36ec070cc","067a9f51aba2c72ba4edc53d3bd6824252fe04e2669ec94900f86ac4546df85d","f353277ba8d4cdeef520cb9b2f4783822905b2ce566a13164315169b3568ae5b","ae22d15cec861001bfbfb8c687a923d2e738cbc5c3d735efaf7c47f120b67f69","7358609d0e5b16530e1abd6733acc75563d256611acb3af8a4f972ac4c59939d","ab9167a9bbb00d296e4869ec2fb3eee2b21ff3499188fb4af34304a135d20bed","6260ecbf296c5b1c2ed8f1f0576be142dafbf40cbcdd8726dc3fa0613a886c17","2155af21eeb50fd776bb6bcebe3de578a147c8e8de31bb1ae109c677f506a12c","5439a1d73592e158c5b6cabb484c12d869201aa0858b81efcb36c07b876de05b","066ff6c630538b957b427d965491c943dbe09fb3b0d5f165c7d587650ab3743f","aeb0baac263e970354040d07ddc244e53df3c343dd4550cd6ce81728f508294a","6377354dd753557d479933e0bec6ca6836f839c87394ecb071e85f062b708058","f7aa4d992f548e3468050744e8a4ff8286655d381d4558ca21afa02333d4c462","3b5e6cad6e81d2989e658f1417cbae8fb8648edb8f2cedc7a254b55ae42b6f0f","4241fb087ba952bdd1efe05d7d842e7c717b2012cb0d8087b202109a9309921a","d40edaf951d4e5331a678c237c21f7068eece7171d77f3c4b5f62e2b90af7800","747d7c8ba669de2e9ddb908b14339990e432d081808cded290886ab06d82d15c","2f686fbec43c87bc9b9c3d0e237f780e0e822d2c3a9a25fc99a16030a294b764",{"version":"e6a01156a9c5e37d97bdda6d0766eda13db76b69fbf10c104730900ade424fa4","signature":"d6220b26516404238a39f13fc8dccce3b6d4488137f4792d1bc410d87fe1256d"},"b645e731f23a0f3900325f56e43c64355292d6648aaeccc52c1f15c74dec8b28","956106fa5b05d3c40eb69e9879e90e79e2ea0ae8c68a8c27bc7f6c49f166ce6a","d33ce9358de6447d71146be26bd735890a8c2b3f08a6f4dc2962d5d76ad308d5",{"version":"57ac950c9eee134a2d1a60bb101ccae812e1192fdb3e5f4389d1360b178f0d01","signature":"6a9de13549d27478f2b2070f3c4b8d593902895a9cf28ef769379121a21bf498"},"9020b97e51ba49623ce0cff9642a64539e87b3e8a60140976a6db1b8b619bf64","ba35c752e706209ad45d2b4c2d53fb3afac1f2a662165243e0d92676bd8dec97","eb88bd089559981e3550efbe72e14051643b7a440ee75f7624905f982c89aa36","2ea9917e07bebc215b2fbee3ceeab886ebe0c2b3b66b0716e1f3671ca9d64677","27a3b0deb06300567f3dca18081eadbb47fe8709df8836cd2068d01321fa3dcc","ca40d7f23f8e91cad30ebd788ab262c989921cc640b75f32a0f1cfae3ad7002f","0ad79a8c8111a71435f719197c80a96dddb64db990acf7e4f43c801cf6b728ab","b80c780c52524beb13488942543972c8b0e54400e8b59cee0169f38d0fabb968","a77fbecee25688f568e18b43f8f54195d6c278a2a9a687ada5ab3d2f726524eb","e29f2b3a93ca3392fe29fa8e7b93985e854b44fe28e2b5c113f08296095bd6b7","d27956c8b392088a06d882e1edb58aab4d5cf5ab1229b73f99329ab21f352147","90dab905b7ea5ab629b62ec5a4153b3f44469aff5b1f6132edb2802537e5d8a7","41faca5faa6859bbe93224fdd4007353393807527d2fb674fbd83b2edfd16af3","acd5d501223e3a7cdd229b501fce5fb071937b72bd05fa33e543eb21c8ee0aba","d685f99305de85b9acd7c1c829ad3da66f596b04f7c73aaa1a19ba98be38680a","ad71f9c46d418d0f9036cec85e25945cb144f4319f863fe7ea47562f79b55641","3ba21bde0811dc0a71ded3d7825224bf2f96cca6f961d5addfb535e7cb6a5871","88ff75494a7e218d56b9f5a56729b874c7b3db479030723f147bec7ebac75955","7a3765b6505614c9321bea7c2a1218f923a6151a4a85e18f30dd5aa56fc31749","5fff27268ff372b10164bc044abf011c2b52327d4be5fd7be90eb7b9b5183971","de3ba4fafdea18e37beed5924f34b180e32793e34669e311031ec39ded7b84fe",{"version":"beaea2d52d7e2f0c893a29f93030da4f1d4c4741704330d3afe759959926ce69","signature":"ea02d18c0b90e29e2057866146eff9be5b7a083bab50493a15a81da213bbd67d"},{"version":"36f6acdaf0086636777999b597def8d87a2a505e93880ea12d382fc6614f1819","signature":"a09fc0478ac838899435d672dd416edc9372bd6f24efb9a1b3c28b7d7c0f52ed"},"558b9c398ce6f03df00e76eca31d239960977a6c3f06c5fa067e7f176fd5e6be",{"version":"e2c0e5dd2454e739d21f67a1e8d7d7fb5638706499d33b0bf26dec69946c4ec4","signature":"68e5a5b380b050faca60039c764139f9372c684639224b822a03d99d3fdadb81"},"5fc52eff32c75afed919d4518e57e3e3c424f79b1a280c3c9f1d0cc5bd6ba7d9","69590a840434ba9f46be2f8d26bbe49813ead59588db2d71c05d716af1933693","6423f19283bea29983e02d03bd9783cadbd75fef30bc42bee711e05469e39621","f676094bcb50ef81359754116159ee65a1618ee42100f4f0168c252dafcc420d","1d53e16def3ea7211d7d0ef0b87aebacd185e21c75c742034e146cb1bfefb047","92a4c17860234795044e2f8f6a09da71f25566d7917940c6d8b059ef39130e20","a6a7cf3ee7811279f8309d82b5adbf7e39c8239fcdf8c057fed5199ecded0383","7b48a8adecc1dd870aa5c4891ad3afacc642c6bc1de9e5d1af34e6d05d042cd0","dfd7205c20d46b9b31082bd56f3d1c6937e95b2d1369c3edaafedf95f3b9cb3f","aee2b6f6d8dba73016b3356454492b9cba5f0a3f47409799a72a9aa7138b7743","3853b8248ae1d3e3e7bd6c14c9e5926d177918812ccd93486704c47f6823e487","89f3cdbbf9cb7b86ef859cefea8f2b669dbe0610d942a3a38e1fde983907a762","ed42a3b734edf70e551f833095d39fc7ec977e57408aa59639f88a5f97c096b4","60ae27564948e96266b3e1eb7b6762800c7c5deee3959443e1c48bffe709d7c4","b6d189963f04bd06137fe46fb8db1dca958aa65a15cc3aa210a3b2f9a2641c2a",{"version":"54badb0fb11fa68858e0f4071d5e9ff776dc8b27521663824c519a3a61a65d2b","signature":"499104eec27bf81b41b27a7e4c723c00e5f2e5bd45b24d81aebb0e8bd791c8dc"},{"version":"b9734142a4b241cfb505be4a2eb0261d211647df7c73043f817f4fdd8d96c846","affectsGlobalScope":true},{"version":"63e2182615c513e89bb8a3e749d08f7c379e86490fcdbf6d35f2c14b3507a6e8","affectsGlobalScope":true},{"version":"c1f79c6d85cd84518fd7349588b3c61bdc189f58e3866f925cbf4631c81e31f9","affectsGlobalScope":true},{"version":"f4c0db3a49cea9babd5d224ba14243a6a6119bf65a65198994033aaea3a60a71","affectsGlobalScope":true},{"version":"42f28f4cfca4a70bd89c1d55d76c7978275030b894f6793f36890265c11a83a4","affectsGlobalScope":true},{"version":"41071d2f1a39386d10bf36d1ba4712ad42a900047f16a109936df9e48f13673e","affectsGlobalScope":true},"961e669569be9491c20108cda7db74e91d9ceafde708d3db10603af69aef7e23","77c5c7f8578d139c74102a29384f5f4f0792a12d819ddcdcaf8307185ff2d45d","c77e66895200939e79d8f92626b2bf3f63fce26bec0595f627a75436e91f1a22","017febfe030b871299879422a871e5c35b56d892de5bc9b69f277a7953bf0c7b","118a93594fa1bc0778be39c1fe3b146665ac8d3e1cca0e7abbdce61fa0ef120d","192a3bb6b310dbf89e9c602a2eba1a249e71dc77610bd7f8b9e7a64cf8634b22","0f8cb712b156059593dbba6007ca600c9b8b7fd10d1000fd4dcca93736371461","634383ecece44671e25939c8a6710e8a9f1f02ea51424e9752c81c0c3f3ae6d5","594f11fc10f5fa50df7e09c3c7d3e925bf0bd5f10af78fa715b809a847cba718","63ad4205a06d0f4529ea385815c51ebb32ce68fc52ae4e650e51e866e5578ec5","ce8d5b83e00a61eb0b931ca091036266565ae8c730a0276c3687bf079f33b44b","25005fd1c08300ea0aced86760109ebc99ae29400f90163bbe1ee4a0fc57ed1d","c622790571b9723df8f1175ce4deb073728b55bef81f1c4c12ec4967249b53c6","c55719987df25500caf575194e75c0f249758f8a7cbc1eac25541faa49d18eab","6fe8555e7cff8fb4b1c4ee9c759e3ad0e205f1d20c302ccd47cd5c05dd3f67f5","940fd6ac43a78cbe1ed17db09ff8f93dcf7f9703cebaaea53071a6b448f25466","1738ee2a1396aff81a52e43d32ac60ffd203d20ffccab11418d116be2fc5b876","0ced1660cb3c37fdadc07c4643c95c30765fb0d444fd97801221cd3f676534ab","b87c7660d9b59a77ea1d98c3fd181d6ce749f33d98b76ae45286a8d9ca0f9975","24d3285154e14c9e6f598139aa3047fc43a6c26de1277e763d5b17a0a0b9b69a","a25d01e88b96b0168f3775f0f93f2fb68905671bc45d066eed57515097b7e4f4","968232cb9942a5ff67d7e85e961d8765b247f7fdf13aa0bd930cec89607734ab",{"version":"349bd3226884630f094bb940a93f07a545e160d82a89ee9816197cf07e89e473","signature":"501053edaaab7da4c9ac57663fb20190b11727fea93460859d4ebc75c95b3da0"},"1f88bf28e66030245be67bc6bc08a7dcf01ca25070ca3085dbb21bef3a502047","3a0019f4fa5bb4c995704a0cd8dbf46d7421ee92ba596091a7b81b45f0accafe",{"version":"20154fb90e94278940af6dfe8dc9a2b8bbc4d4f3e22222e535520500f4031a50","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"7cc871b0b4db0f4c737fc75bc6ca4484aea157b00f159e16abaa9be07a1ed8ca","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"736537dad078e5c2fa6c79bec21e0394b25cce00afd826d6c82479cbaddda7f2","signature":"4372cdc6246cb8f75075b638e7162f217c8ef1619440056a6a5a0756adae9353"},{"version":"6ffdac1e1e20bc96ab89d9165a598488225b9c30a17d30fdb851c0b6f9d3b9c1","signature":"d885e33554f5882f2b6ca0e27b558eb2e96b6748e1e8538478d0672499049520"},{"version":"aaba76758488bedf9d1c85bc89df8f234e3a191c0eb70453ad566189dc6fbb53","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"a4ff7a99e8a07d41fb8d16e3c2b7f9ec7d0713a4c3ac3198117698e23ce41dea","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},"7c09e89531304457acac5f7b76feb41ac616997ef367ea84868f2b244d2f2f4d",{"version":"61a7b0f1249c220c1e5019df52c39cbe791b8f425cea3bd8412cd53522fd6ed4","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},"f83b320cceccfc48457a818d18fc9a006ab18d0bdd727aa2c2e73dc1b4a45e98","354abbae08f72ea982b1a767a8908f1b3efe8bbe53955c64f9c0c249c8832d5d","3f3da7d825970e86514129ec0c3264c589def469dffd96a1c0f2a9495f7bcb33","4c7fb1f4c57f3cd9d571c5e4cae33503530273a45579fa0babaf36b64a776eaa",{"version":"1a51ab6073f3fa05b08bf6e52d006837a1ed3d5a8dda9b51d63a855030d65d66","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},"92edb6e257fa64d3baae647490e041912684f5dc1f243d0aedd60b4b383ff50b","cab425b5559edac18327eb2c3c0f47e7e9f71b667290b7689faafd28aac69eae","3cfb0cb51cc2c2e1b313d7c4df04dbf7e5bda0a133c6b309bf6af77cf614b971","f992cd6cc0bcbaa4e6c810468c90f2d8595f8c6c3cf050c806397d3de8585562","6a9c5127096b35264eb7cd21b2417bfc1d42cceca9ba4ce2bb0c3410b7816042","78828b06c0d3b586954015e9ebde5480b009e166c71244763bda328ec0920f41","80d50bca45b12deb542118e51aa1c5e6c779f2b387e589d475297c07de0b342d","8b06ac3faeacb8484d84ddb44571d8f410697f98d7bfa86c0fda60373a9f5215","f3e604694b624fa3f83f6684185452992088f5efb2cf136b62474aa106d6f1b6","96d14f21b7652903852eef49379d04dbda28c16ed36468f8c9fa08f7c14c9538","fec943fdb3275eb6e006b35e04a8e2e99e9adf3f4b969ddf15315ac7575a93e4","cddf5c26907c0b8378bc05543161c11637b830da9fadf59e02a11e675d11e180","5774751340e987a6a9e4a5dcc03ff68a6515adc2b91423e1af2f660fc8f30e81","8841e2aa774b89bd23302dede20663306dc1b9902431ac64b24be8b8d0e3f649","209e814e8e71aec74f69686a9506dd7610b97ab59dcee9446266446f72a76d05",{"version":"677646e2620795c98a539fb12fb531f10331c217cef1492132b2518f894fa92d","affectsGlobalScope":true},"6fa0008bf91a4cc9c8963bace4bba0bd6865cbfa29c3e3ccc461155660fb113a","2b8264b2fefd7367e0f20e2c04eed5d3038831fe00f5efbc110ff0131aab899b","58a3914b1cce4560d9ad6eee2b716caaa030eda0a90b21ca2457ea9e2783eaa3","2b93035328f7778d200252681c1d86285d501ed424825a18f81e4c3028aa51d9","2ac9c8332c5f8510b8bdd571f8271e0f39b0577714d5e95c1e79a12b2616f069","42c21aa963e7b86fa00801d96e88b36803188018d5ad91db2a9101bccd40b3ff","d31eb848cdebb4c55b4893b335a7c0cca95ad66dee13cbb7d0893810c0a9c301","77c1d91a129ba60b8c405f9f539e42df834afb174fe0785f89d92a2c7c16b77a","7a9e0a564fee396cacf706523b5aeed96e04c6b871a8bebefad78499fbffc5bc","906c751ef5822ec0dadcea2f0e9db64a33fb4ee926cc9f7efa38afe5d5371b2a","5387c049e9702f2d2d7ece1a74836a14b47fbebe9bbeb19f94c580a37c855351","c68391fb9efad5d99ff332c65b1606248c4e4a9f1dd9a087204242b56c7126d6","e9cf02252d3a0ced987d24845dcb1f11c1be5541f17e5daa44c6de2d18138d0c","e8b02b879754d85f48489294f99147aeccc352c760d95a6fe2b6e49cd400b2fe","9f6908ab3d8a86c68b86e38578afc7095114e66b2fc36a2a96e9252aac3998e0","0eedb2344442b143ddcd788f87096961cd8572b64f10b4afc3356aa0460171c6","71405cc70f183d029cc5018375f6c35117ffdaf11846c35ebf85ee3956b1b2a6","c68baff4d8ba346130e9753cefe2e487a16731bf17e05fdacc81e8c9a26aae9d","2cd15528d8bb5d0453aa339b4b52e0696e8b07e790c153831c642c3dea5ac8af","479d622e66283ffa9883fbc33e441f7fc928b2277ff30aacbec7b7761b4e9579","ade307876dc5ca267ca308d09e737b611505e015c535863f22420a11fffc1c54","f8cdefa3e0dee639eccbe9794b46f90291e5fd3989fcba60d2f08fde56179fb9","86c5a62f99aac7053976e317dbe9acb2eaf903aaf3d2e5bb1cafe5c2df7b37a8","2b300954ce01a8343866f737656e13243e86e5baef51bd0631b21dcef1f6e954","a2d409a9ffd872d6b9d78ead00baa116bbc73cfa959fce9a2f29d3227876b2a1","b288936f560cd71f4a6002953290de9ff8dfbfbf37f5a9391be5c83322324898","61178a781ef82e0ff54f9430397e71e8f365fc1e3725e0e5346f2de7b0d50dfa","6a6ccb37feb3aad32d9be026a3337db195979cd5727a616fc0f557e974101a54","c649ea79205c029a02272ef55b7ab14ada0903db26144d2205021f24727ac7a3","38e2b02897c6357bbcff729ef84c736727b45cc152abe95a7567caccdfad2a1d","d6610ea7e0b1a7686dba062a1e5544dd7d34140f4545305b7c6afaebfb348341","3dee35db743bdba2c8d19aece7ac049bde6fa587e195d86547c882784e6ba34c","b15e55c5fa977c2f25ca0b1db52cfa2d1fd4bf0baf90a8b90d4a7678ca462ff1","f41d30972724714763a2698ae949fbc463afb203b5fa7c4ad7e4de0871129a17","843dd7b6a7c6269fd43827303f5cbe65c1fecabc30b4670a50d5a15d57daeeb9","f06d8b8567ee9fd799bf7f806efe93b67683ef24f4dea5b23ef12edff4434d9d","6017384f697ff38bc3ef6a546df5b230c3c31329db84cbfe686c83bec011e2b2","e1a5b30d9248549ca0c0bb1d653bafae20c64c4aa5928cc4cd3017b55c2177b0","a593632d5878f17295bd53e1c77f27bf4c15212822f764a2bfc1702f4b413fa0","a868a534ba1c2ca9060b8a13b0ffbbbf78b4be7b0ff80d8c75b02773f7192c29","da7545aba8f54a50fde23e2ede00158dc8112560d934cee58098dfb03aae9b9d","34baf65cfee92f110d6653322e2120c2d368ee64b3c7981dff08ed105c4f19b0","6aee496bf0ecfbf6731aa8cca32f4b6e92cdc0a444911a7d88410408a45ecc5d","4006c872e38a2c4e09c593bc0cdd32b7b4f5c4843910bea0def631c483fff6c5","ab6aa3a65d473871ee093e3b7b71ed0f9c69e07d1d4295f45c9efd91a771241d","70e9a18da08294f75bf23e46c7d69e67634c0765d355887b9b41f0d959e1426e","e9eb1b173aa166892f3eddab182e49cfe59aa2e14d33aedb6b49d175ed6a3750","65dfa4bc49ccd1355789abb6ae215b302a5b050fdee9651124fe7e826f33113c","6d829824ead8999f87b6df21200df3c6150391b894b4e80662caa462bd48d073","afc559c1b93df37c25aef6b3dfa2d64325b0e112e887ee18bf7e6f4ec383fc90","d78e5898c8de5e0f934eee83f680262de005caa268d137101b833fd932f95e07","16d51f964ec125ad2024cf03f0af444b3bc3ec3614d9345cc54d09bab45c9a4c","ba601641fac98c229ccd4a303f747de376d761babb33229bb7153bed9356c9cc",{"version":"c5dd1fef4cd4aaffc78786047bed5ae6fc1200d19a1946cbc4e2d3ed4d62c8fa","affectsGlobalScope":true},"56cbe80e6c42d7e6e66b6f048add8b01c663797b843a074d9f19c4a3d63a269a",{"version":"64d4b35c5456adf258d2cf56c341e203a073253f229ef3208fc0d5020253b241","affectsGlobalScope":true},"a1c79f857f5c7754e14c93949dad8cfefcd7df2ecc0dc9dd79a30fd493e28449","f3e604694b624fa3f83f6684185452992088f5efb2cf136b62474aa106d6f1b6","e793f85164d47950e32731e98897e3e6b285339c5fa1b3a3ddd1711a54f371b1","e050a0afcdbb269720a900c85076d18e0c1ab73e580202a2bf6964978181222a","5b9ecf7da4d71cf3832dbb8336150fa924631811f488ad4690c2dfec2b4fb1d7","951c85f75aac041dddbedfedf565886a7b494e29ec1532e2a9b4a6180560b50e","e6f0cb9d8cb2e38bec66e032e73caa3e7c6671f21ed7196acb821aec462051f2","43cdd474c5aa3340da4816bb8f1ae7f3b1bcf9e70d997afc36a0f2c432378c84","ee65fe452abe1309389c5f50710f24114e08a302d40708101c4aa950a2a7d044","54c9959f2d8ba97a5fcc4345ac2fca6f1bc20fe5764570b7fef37bea107bc70b","6503fb6addf62f9b10f8564d9869ad824565a914ec1ac3dd7d13da14a3f57036","f313731860257325f13351575f381fef333d4dfe30daf5a2e72f894208feea08","951b37f7d86f6012f09e6b35f1de57c69d75f16908cb0adaa56b93675ea0b853","3816fc03ffd9cbd1a7a3362a264756a4a1d547caabea50ca68303046be40e376","0c417b4ec46b88fb62a43ec00204700b560d01eb5677c7faa8ecd34610f096a8","13d29cdeb64e8496424edf42749bbb47de5e42d201cf958911a4638cbcffbd3f","0f9e381eecc5860f693c31fe463b3ca20a64ca9b8db0cf6208cd4a053f064809","95902d5561c6aac5dfc40568a12b0aca324037749dcd32a81f23423bfde69bab","5dfb2aca4136abdc5a2740f14be8134a6e6b66fd53470bb2e954e40f8abfaf3e","577463167dd69bd81f76697dfc3f7b22b77a6152f60a602a9218e52e3183ad67","b8396e9024d554b611cbe31a024b176ba7116063d19354b5a02dccd8f0118989","4b28e1c5bf88d891e07a1403358b81a51b3ba2eae1ffada51cca7476b5ac6407","7150ad575d28bf98fae321a1c0f10ad17b127927811f488ded6ff1d88d4244e5","8b155c4757d197969553de3762c8d23d5866710301de41e1b66b97c9ed867003","93733466609dd8bf72eace502a24ca7574bd073d934216e628f1b615c8d3cb3c","45e9228761aabcadb79c82fb3008523db334491525bdb8e74e0f26eaf7a4f7f4","aeacac2778c9821512b6b889da79ac31606a863610c8f28da1e483579627bf90","569fdb354062fc098a6a3ba93a029edf22d6fe480cf72b231b3c07832b2e7c97","bf9876e62fb7f4237deafab8c7444770ef6e82b4cad2d5dc768664ff340feeb2","6cf60e76d37faf0fbc2f80a873eab0fd545f6b1bf300e7f0823f956ddb3083e9","6adaa6103086f931e3eee20f0987e86e8879e9d13aa6bd6075ccfc58b9c5681c","ee0af0f2b8d3b4d0baf669f2ff6fcef4a8816a473c894cc7c905029f7505fed0","6a386ff939f180ae8ef064699d8b7b6e62bc2731a62d7fbf5e02589383838dea",{"version":"bbdf156fea2fabed31a569445835aeedcc33643d404fcbaa54541f06c109df3f","affectsGlobalScope":true},"1c29793071152b207c01ea1954e343be9a44d85234447b2b236acae9e709a383","f5a8b384f182b3851cec3596ccc96cb7464f8d3469f48c74bf2befb782a19de5",{"version":"45e702668a69a742682ccc153d6159a8817fa6387b6d1d91a447e3e4534518b3","affectsGlobalScope":true},"74b0245c42990ed8a849df955db3f4362c81b13f799ebc981b7bec2d5b414a57","acebfe99678cf7cddcddc3435222cf132052b1226e902daac9fbb495c321a9b5","82b1f9a6eefef7386aebe22ac49f23b806421e82dbf35c6e5b7132d79e4165da","6a3816094633a8e76b1f3d7d3834b6ed2dc9dd08c8e996a74c118284468c6e7b","6e037a885b94caf06b3dd8146ad3f46fdffb8b5aca11e3de6a6a930266b4a460"],"options":{"composite":true,"declaration":true,"declarationMap":true,"emitDeclarationOnly":false,"esModuleInterop":true,"importsNotUsedAsValues":2,"module":6,"noEmitOnError":true,"noFallthroughCasesInSwitch":true,"noImplicitReturns":false,"noUnusedLocals":true,"noUnusedParameters":false,"outDir":"./","removeComments":false,"skipLibCheck":true,"sourceMap":true,"strict":true,"stripInternal":true,"target":7},"fileIdsList":[[129,156,163,376],[120,156,163],[155,156,163,381],[129,156,163],[156,384,386],[156],[156,320,383,384],[126,129,156,163,379,380],[156,377,380,381,390],[126,129,131,134,144,155,156,163],[156,414],[156,399],[156,403,404,405],[156,402],[156,404],[156,394,400,401,406,409,411,412,413],[156,401,407,408,414],[156,407,410],[156,401,402,407,414],[156,401,414],[156,395,396,397,398],[156,388],[156,389],[156,416,417,418,419],[127,156,391],[129,156,163,389],[156,163],[126,129,131,144,152,155,156,161,163],[156,281,283,284],[156,175,281,282],[156,281,283,285],[156,286],[156,175,282,286,287,288],[61,69,76,156,175,281,282,283,286],[156,281],[65,104,156],[156,266],[156,165,291,294],[73,156,165,290,291,292,293],[65,70,73,156,266,290,291,292],[60,80,156],[80,86,156,229],[80,156,241,242],[60,156],[60,156,241],[51,55,156],[61,69,156],[55,61,70,156],[50,51,55,61,70,156],[50,55,61,65,68,69,156],[50,60,62,156],[50,60,61,62,63,156],[57,61,156],[50,51,52,55,61,62,64,67,70,71,72,74,75,76,77,156],[70,156],[51,62,156],[56,60,156],[55,61,156],[50,61,62,156],[51,55,61,62,66,156],[51,61,65,70,73,156],[61,65,156],[61,70,156],[50,69,70,156],[50,51,55,69,70,156,165],[61,77,94,156],[156,187,188,189],[61,156],[50,129,156,163,166,275,279],[55,156],[53,54,156],[126,129,155,156,163,312,313,314],[156,268],[156,316],[126,156,163],[156,323],[110,156],[113,156],[114,119,147,156],[115,126,127,134,144,155,156],[115,116,126,134,156],[117,156],[118,119,127,135,156],[119,144,152,156],[120,122,126,134,156],[121,156],[122,123,156],[126,156],[124,126,156],[126,127,128,144,155,156],[126,127,128,141,144,147,156],[156,160],[122,129,134,144,155,156],[126,127,129,130,134,144,152,155,156],[129,131,144,152,155,156],[110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162],[126,132,156],[133,155,156],[122,126,134,144,156],[135,156],[136,156],[113,137,156],[138,154,156,160],[139,156],[140,156],[126,141,142,156],[141,143,156,158],[114,126,144,145,146,147,156],[114,144,146,156],[144,145,156],[147,156],[148,156],[126,150,151,156],[150,151,156],[119,134,144,152,156],[153,156],[134,154,156],[114,129,140,155,156],[119,156],[144,156,157],[156,158],[156,159],[114,119,126,128,137,144,155,156,158,160],[144,156,161],[129,144,156,163],[156,331,370],[156,331,355,370],[156,370],[156,331],[156,331,356,370],[156,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369],[156,356,370],[156,307],[156,373],[126,144,156,163],[156,268,269,270,271,272,273],[60,79,97,156],[156,263,264],[60,79,97,156,263],[156,227,229,230,231],[156,227,228],[156,227,229],[156,229],[156,227,228,229],[156,244,245],[156,268,269],[79,94,156],[94,156,253,254,255,256,257,258,259,260,261],[79,94,156,255,262],[79,93,94,156,255],[79,94,156,255],[94,156,257],[94,156,262],[60,79,156],[79,93,156],[92,156],[55,60,61,78,79,95,97,109,156,205,208,212,213,216,217],[60,61,78,97,105,107,108,109,156,205,209,211,216],[60,61,105,107,156,206],[61,156,210,212],[50,52,56,60,61,78,95,97,105,106,156,216],[60,105,107,156],[60,105,108,156,217],[50,55,60,61,62,75,78,95,109,156,168,205,214,217],[50,60,61,95,126,156,163,217],[61,106,126,156,163,164,204],[106,126,156,163],[55,60,61,78,95,156,205,206,207,216,217],[60,61,95,109,156,216,217],[60,105,156],[60,78,105,107,156,205],[50,55,61,65,69,156,167],[65,69,156,197],[65,69,156,195,197],[65,156,194,196],[65,69,156],[156,275,277,278],[69,156,275,276,277],[69,156,275],[156,275],[51,55,61,156,166,169],[52,61,71,75,156,166,169,172],[51,55,156,190,191,199,202],[51,52,72,156],[61,67,75,156,168,169,172,174,191,192,193,198,203],[50,52,55,61,156,190,191,203],[51,52,61,67,72,75,156,166,172],[61,67,72,75,156,166,169,172,174,200,201],[51,52,61,67,156,166,172],[52,61,64,67,71,72,74,75,76,94,156,166,168,169,172,174],[50,51,52,55,61,67,76,156,166,168,172,185],[51,156],[50,52,61,75,156,168,172],[50,52,55,61,67,75,156,168,169,171,172],[50,61,62,63,64,67,71,72,74,76,78,94,156,165,166,168,170,173,174,175,176,177,178,179,180,182,183,184,186,203],[52,61,156,166,169,181],[50,52,61,62,67,71,156],[50,52,61,75,156,172],[50,51,52,55,76,156,166,168,169],[57,156],[89,156],[86,87,88,89,156],[59,60,156],[59,156],[58,156],[80,156],[56,156],[56,82,156],[82,156],[83,156],[60,81,82,83,84,85,156],[56,57,58,59,80,156],[56,57,58,156],[156,234,235,236,237],[156,235],[156,235,236],[104,156],[98,156],[98,104,156],[65,98,156],[98,99,100,101,102,103,156],[156,308],[91,156],[86,90,156],[56,60,78,94,95,96,156,217,219,220,221,222,226,249,251,252,262,265,266],[56,60,78,94,97,156,217,219,267],[50,60,94,96,97,156,222,232,233,238,239,240,248],[50,60,79,95,96,97,156,217,218,223,224,225],[86,87,156,222,232,243,246,247],[92,94,156,250],[60,97,156,221],[60,97,156,250,296],[92,156,222,301],[87,156,204,219,222,243,262,265,274,280,289,295,296,297,298],[60,94,156,204,219,222,262,265,274,280,289,295],[156,204,219,222,262,265,274,280,289,295,301,302],[60,87,156,204,219,222,262,265,274,280,289,295,296,305],[60,87,96,97,156,217,226,249,252,262,265,274,296,305,308,309,310],[60,95,97,156,217],[50,60,61,78,79,94,95,96,156,218],[50,60,95,156],[78,94,96,219,222,226],[56,60,78,94,97,217,219],[60,94,96,97,222],[50,60,79,95,96,97,217,218,224],[222],[94],[60,97],[222,301]],"referencedMap":[[377,1],[378,2],[382,3],[376,4],[387,5],[383,6],[386,7],[384,6],[381,8],[391,9],[392,6],[393,10],[385,6],[394,6],[415,11],[400,12],[406,13],[404,6],[403,14],[405,15],[414,16],[409,17],[411,18],[412,19],[413,20],[407,6],[408,20],[410,20],[402,20],[401,6],[396,6],[395,6],[398,12],[399,21],[397,12],[389,22],[388,23],[416,6],[380,6],[379,6],[417,6],[420,24],[421,6],[419,6],[422,25],[390,26],[423,4],[424,6],[425,27],[275,28],[418,6],[181,6],[281,6],[285,29],[283,30],[286,31],[288,32],[289,33],[287,34],[284,35],[282,36],[292,37],[291,6],[295,38],[294,39],[293,40],[290,6],[297,41],[298,42],[243,43],[241,44],[242,45],[169,46],[175,47],[174,48],[172,49],[70,50],[68,6],[72,51],[64,52],[77,53],[78,54],[76,55],[63,56],[61,57],[62,58],[71,59],[67,60],[74,61],[66,62],[75,63],[165,64],[166,65],[51,6],[50,6],[52,6],[180,66],[266,6],[190,67],[189,68],[187,68],[188,68],[280,69],[54,70],[55,71],[53,70],[315,72],[269,73],[273,73],[271,73],[268,6],[317,74],[318,6],[313,6],[319,6],[320,6],[321,6],[322,75],[324,76],[325,6],[326,6],[327,6],[316,6],[110,77],[111,77],[113,78],[114,79],[115,80],[116,81],[117,82],[118,83],[119,84],[120,85],[121,86],[122,87],[123,87],[125,88],[124,89],[126,88],[127,90],[128,91],[112,92],[162,6],[129,93],[130,94],[131,95],[163,96],[132,97],[133,98],[134,99],[135,100],[136,101],[137,102],[138,103],[139,104],[140,105],[141,106],[142,106],[143,107],[144,108],[146,109],[145,110],[147,111],[148,112],[149,6],[150,113],[151,114],[152,115],[153,116],[154,117],[155,118],[156,119],[157,120],[158,121],[159,122],[160,123],[161,124],[328,6],[329,6],[314,125],[330,6],[355,126],[356,127],[331,128],[334,128],[353,126],[354,126],[344,126],[343,129],[341,126],[336,126],[349,126],[347,126],[351,126],[335,126],[348,126],[352,126],[337,126],[338,126],[350,126],[332,126],[339,126],[340,126],[342,126],[346,126],[357,130],[345,126],[333,126],[370,131],[369,6],[364,130],[366,132],[365,130],[358,130],[359,130],[361,130],[363,130],[367,132],[368,132],[360,132],[362,132],[308,133],[307,6],[371,6],[372,6],[323,6],[373,6],[374,134],[375,135],[106,6],[274,136],[263,137],[265,138],[264,139],[232,140],[229,141],[228,6],[230,142],[231,143],[245,142],[244,144],[246,145],[227,6],[272,73],[270,146],[255,147],[253,6],[262,148],[257,149],[256,150],[259,151],[261,152],[254,153],[258,149],[260,151],[310,6],[234,6],[97,154],[94,155],[93,156],[79,6],[214,157],[212,158],[209,159],[211,160],[217,161],[108,162],[109,163],[105,36],[216,164],[213,165],[205,166],[164,167],[210,6],[208,168],[207,169],[107,170],[206,171],[215,172],[305,6],[252,6],[223,6],[225,6],[198,173],[196,174],[194,173],[197,175],[73,6],[195,176],[69,6],[279,177],[278,178],[277,179],[276,180],[312,88],[183,181],[178,182],[203,183],[191,36],[193,184],[199,185],[192,186],[201,187],[202,188],[200,189],[179,190],[186,191],[185,192],[177,193],[173,194],[171,36],[204,195],[182,196],[184,197],[176,198],[170,199],[168,172],[167,6],[224,6],[89,200],[233,201],[247,201],[57,6],[90,202],[58,203],[85,6],[60,204],[80,205],[88,206],[87,206],[82,207],[83,208],[220,209],[56,6],[221,210],[86,211],[81,212],[59,213],[84,6],[240,6],[238,214],[236,215],[237,216],[235,6],[95,6],[98,217],[101,218],[102,219],[99,220],[100,218],[104,221],[103,217],[309,222],[9,6],[10,6],[13,6],[12,6],[2,6],[14,6],[15,6],[16,6],[17,6],[18,6],[19,6],[20,6],[21,6],[3,6],[4,6],[25,6],[22,6],[23,6],[24,6],[26,6],[27,6],[28,6],[5,6],[29,6],[30,6],[31,6],[32,6],[6,6],[36,6],[33,6],[34,6],[35,6],[37,6],[7,6],[38,6],[43,6],[44,6],[39,6],[40,6],[41,6],[42,6],[8,6],[48,6],[45,6],[46,6],[47,6],[1,6],[49,6],[11,6],[65,6],[239,6],[250,223],[92,223],[91,224],[267,225],[222,226],[249,227],[226,228],[248,229],[251,230],[296,231],[301,232],[302,233],[299,234],[300,235],[303,236],[304,236],[306,237],[311,238],[218,239],[219,240],[96,241]],"exportedModulesMap":[[377,1],[378,2],[382,3],[376,4],[387,5],[383,6],[386,7],[384,6],[381,8],[391,9],[392,6],[393,10],[385,6],[394,6],[415,11],[400,12],[406,13],[404,6],[403,14],[405,15],[414,16],[409,17],[411,18],[412,19],[413,20],[407,6],[408,20],[410,20],[402,20],[401,6],[396,6],[395,6],[398,12],[399,21],[397,12],[389,22],[388,23],[416,6],[380,6],[379,6],[417,6],[420,24],[421,6],[419,6],[422,25],[390,26],[423,4],[424,6],[425,27],[275,28],[418,6],[181,6],[281,6],[285,29],[283,30],[286,31],[288,32],[289,33],[287,34],[284,35],[282,36],[292,37],[291,6],[295,38],[294,39],[293,40],[290,6],[297,41],[298,42],[243,43],[241,44],[242,45],[169,46],[175,47],[174,48],[172,49],[70,50],[68,6],[72,51],[64,52],[77,53],[78,54],[76,55],[63,56],[61,57],[62,58],[71,59],[67,60],[74,61],[66,62],[75,63],[165,64],[166,65],[51,6],[50,6],[52,6],[180,66],[266,6],[190,67],[189,68],[187,68],[188,68],[280,69],[54,70],[55,71],[53,70],[315,72],[269,73],[273,73],[271,73],[268,6],[317,74],[318,6],[313,6],[319,6],[320,6],[321,6],[322,75],[324,76],[325,6],[326,6],[327,6],[316,6],[110,77],[111,77],[113,78],[114,79],[115,80],[116,81],[117,82],[118,83],[119,84],[120,85],[121,86],[122,87],[123,87],[125,88],[124,89],[126,88],[127,90],[128,91],[112,92],[162,6],[129,93],[130,94],[131,95],[163,96],[132,97],[133,98],[134,99],[135,100],[136,101],[137,102],[138,103],[139,104],[140,105],[141,106],[142,106],[143,107],[144,108],[146,109],[145,110],[147,111],[148,112],[149,6],[150,113],[151,114],[152,115],[153,116],[154,117],[155,118],[156,119],[157,120],[158,121],[159,122],[160,123],[161,124],[328,6],[329,6],[314,125],[330,6],[355,126],[356,127],[331,128],[334,128],[353,126],[354,126],[344,126],[343,129],[341,126],[336,126],[349,126],[347,126],[351,126],[335,126],[348,126],[352,126],[337,126],[338,126],[350,126],[332,126],[339,126],[340,126],[342,126],[346,126],[357,130],[345,126],[333,126],[370,131],[369,6],[364,130],[366,132],[365,130],[358,130],[359,130],[361,130],[363,130],[367,132],[368,132],[360,132],[362,132],[308,133],[307,6],[371,6],[372,6],[323,6],[373,6],[374,134],[375,135],[106,6],[274,136],[263,137],[265,138],[264,139],[232,140],[229,141],[228,6],[230,142],[231,143],[245,142],[244,144],[246,145],[227,6],[272,73],[270,146],[255,147],[253,6],[262,148],[257,149],[256,150],[259,151],[261,152],[254,153],[258,149],[260,151],[310,6],[234,6],[97,154],[94,155],[93,156],[79,6],[214,157],[212,158],[209,159],[211,160],[217,161],[108,162],[109,163],[105,36],[216,164],[213,165],[205,166],[164,167],[210,6],[208,168],[207,169],[107,170],[206,171],[215,172],[305,6],[252,6],[223,6],[225,6],[198,173],[196,174],[194,173],[197,175],[73,6],[195,176],[69,6],[279,177],[278,178],[277,179],[276,180],[312,88],[183,181],[178,182],[203,183],[191,36],[193,184],[199,185],[192,186],[201,187],[202,188],[200,189],[179,190],[186,191],[185,192],[177,193],[173,194],[171,36],[204,195],[182,196],[184,197],[176,198],[170,199],[168,172],[167,6],[224,6],[89,200],[233,201],[247,201],[57,6],[90,202],[58,203],[85,6],[60,204],[80,205],[88,206],[87,206],[82,207],[83,208],[220,209],[56,6],[221,210],[86,211],[81,212],[59,213],[84,6],[240,6],[238,214],[236,215],[237,216],[235,6],[95,6],[98,217],[101,218],[102,219],[99,220],[100,218],[104,221],[103,217],[309,222],[9,6],[10,6],[13,6],[12,6],[2,6],[14,6],[15,6],[16,6],[17,6],[18,6],[19,6],[20,6],[21,6],[3,6],[4,6],[25,6],[22,6],[23,6],[24,6],[26,6],[27,6],[28,6],[5,6],[29,6],[30,6],[31,6],[32,6],[6,6],[36,6],[33,6],[34,6],[35,6],[37,6],[7,6],[38,6],[43,6],[44,6],[39,6],[40,6],[41,6],[42,6],[8,6],[48,6],[45,6],[46,6],[47,6],[1,6],[49,6],[11,6],[65,6],[239,6],[250,223],[92,223],[91,224],[267,242],[222,243],[249,244],[226,245],[248,246],[251,247],[296,248],[301,248],[302,249],[218,239],[219,240],[96,241]],"semanticDiagnosticsPerFile":[377,378,382,376,387,383,386,384,381,391,392,393,385,394,415,400,406,404,403,405,414,409,411,412,413,407,408,410,402,401,396,395,398,399,397,389,388,416,380,379,417,420,421,419,422,390,423,424,425,275,418,181,281,285,283,286,288,289,287,284,282,292,291,295,294,293,290,297,298,243,241,242,169,175,174,172,70,68,72,64,77,78,76,63,61,62,71,67,74,66,75,165,166,51,50,52,180,266,190,189,187,188,280,54,55,53,315,269,273,271,268,317,318,313,319,320,321,322,324,325,326,327,316,110,111,113,114,115,116,117,118,119,120,121,122,123,125,124,126,127,128,112,162,129,130,131,163,132,133,134,135,136,137,138,139,140,141,142,143,144,146,145,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,328,329,314,330,355,356,331,334,353,354,344,343,341,336,349,347,351,335,348,352,337,338,350,332,339,340,342,346,357,345,333,370,369,364,366,365,358,359,361,363,367,368,360,362,308,307,371,372,323,373,374,375,106,274,263,265,264,232,229,228,230,231,245,244,246,227,272,270,255,253,262,257,256,259,261,254,258,260,310,234,97,94,93,79,214,212,209,211,217,108,109,105,216,213,205,164,210,208,207,107,206,215,305,252,223,225,198,196,194,197,73,195,69,279,278,277,276,312,183,178,203,191,193,199,192,201,202,200,179,186,185,177,173,171,204,182,184,176,170,168,167,224,89,233,247,57,90,58,85,60,80,88,87,82,83,220,56,221,86,81,59,84,240,238,236,237,235,95,98,101,102,99,100,104,103,309,9,10,13,12,2,14,15,16,17,18,19,20,21,3,4,25,22,23,24,26,27,28,5,29,30,31,32,6,36,33,34,35,37,7,38,43,44,39,40,41,42,8,48,45,46,47,1,49,11,65,239,250,92,91,267,222,249,226,248,251,296,301,302,299,300,303,304,306,311,218,219,96],"latestChangedDtsFile":"./test/storage.spec.d.ts"},"version":"4.9.5"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/index.min.js b/node_modules/helia/dist/index.min.js
index 8da0d0a..4226b25 100644
--- a/node_modules/helia/dist/index.min.js
+++ b/node_modules/helia/dist/index.min.js
@@ -1,3 +1,3 @@
 (function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Helia = factory()}(typeof self !== 'undefined' ? self : this, function () {
-"use strict";var Helia=(()=>{var Ku=Object.create;var gr=Object.defineProperty;var Xu=Object.getOwnPropertyDescriptor;var Ju=Object.getOwnPropertyNames;var Zu=Object.getPrototypeOf,Yu=Object.prototype.hasOwnProperty;var S=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),V=(r,e)=>{for(var t in e)gr(r,t,{get:e[t],enumerable:!0})},xo=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ju(e))!Yu.call(r,i)&&i!==t&&gr(r,i,{get:()=>e[i],enumerable:!(n=Xu(e,i))||n.enumerable});return r};var U=(r,e,t)=>(t=r!=null?Ku(Zu(r)):{},xo(e||!r||!r.__esModule?gr(t,"default",{value:r,enumerable:!0}):t,r)),el=r=>xo(gr({},"__esModule",{value:!0}),r);var Ho=S((bp,Wo)=>{Wo.exports=$o;var zo=128,zl=127,$l=~zl,Wl=Math.pow(2,31);function $o(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Wl;)e[t++]=r&255|zo,r/=128;for(;r&$l;)e[t++]=r&255|zo,r>>>=7;return e[t]=r|0,$o.bytes=t-n+1,e}});var jo=S((_p,Vo)=>{Vo.exports=jn;var Hl=128,qo=127;function jn(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw jn.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&qo)<<i:(s&qo)*Math.pow(2,i),i+=7}while(s>=Hl);return jn.bytes=o-n,t}});var Qo=S((vp,Go)=>{var ql=Math.pow(2,7),Vl=Math.pow(2,14),jl=Math.pow(2,21),Gl=Math.pow(2,28),Ql=Math.pow(2,35),Kl=Math.pow(2,42),Xl=Math.pow(2,49),Jl=Math.pow(2,56),Zl=Math.pow(2,63);Go.exports=function(r){return r<ql?1:r<Vl?2:r<jl?3:r<Gl?4:r<Ql?5:r<Kl?6:r<Xl?7:r<Jl?8:r<Zl?9:10}});var Xo=S((xp,Ko)=>{Ko.exports={encode:Ho(),decode:jo(),encodingLength:Qo()}});var Yo=S((kp,Zo)=>{"use strict";var Jo=Xo();Zo.exports=r=>{if(!(r instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;r.length>0;){let t=Jo.decode(r);e.push(t),r=r.slice(Jo.decode.bytes)}return e}});var rs=S((Ep,ts)=>{ts.exports=Gn;var es=128,Yl=127,ef=~Yl,tf=Math.pow(2,31);function Gn(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw Gn.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var n=t;r>=tf;)e[t++]=r&255|es,r/=128;for(;r&ef;)e[t++]=r&255|es,r>>>=7;return e[t]=r|0,Gn.bytes=t-n+1,e}});var os=S((Sp,is)=>{is.exports=Qn;var rf=128,ns=127;function Qn(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a||i>49)throw Qn.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&ns)<<i:(s&ns)*Math.pow(2,i),i+=7}while(s>=rf);return Qn.bytes=o-n,t}});var as=S((Tp,ss)=>{var nf=Math.pow(2,7),of=Math.pow(2,14),sf=Math.pow(2,21),af=Math.pow(2,28),cf=Math.pow(2,35),uf=Math.pow(2,42),lf=Math.pow(2,49),ff=Math.pow(2,56),hf=Math.pow(2,63);ss.exports=function(r){return r<nf?1:r<of?2:r<sf?3:r<af?4:r<cf?5:r<uf?6:r<lf?7:r<ff?8:r<hf?9:10}});var us=S((Ap,cs)=>{cs.exports={encode:rs(),decode:os(),encodingLength:as()}});var hs=S((Cp,fs)=>{var mt=1e3,yt=mt*60,gt=yt*60,Ge=gt*24,pf=Ge*7,mf=Ge*365.25;fs.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return yf(r);if(t==="number"&&isFinite(r))return e.long?wf(r):gf(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function yf(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*mf;case"weeks":case"week":case"w":return t*pf;case"days":case"day":case"d":return t*Ge;case"hours":case"hour":case"hrs":case"hr":case"h":return t*gt;case"minutes":case"minute":case"mins":case"min":case"m":return t*yt;case"seconds":case"second":case"secs":case"sec":case"s":return t*mt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function gf(r){var e=Math.abs(r);return e>=Ge?Math.round(r/Ge)+"d":e>=gt?Math.round(r/gt)+"h":e>=yt?Math.round(r/yt)+"m":e>=mt?Math.round(r/mt)+"s":r+"ms"}function wf(r){var e=Math.abs(r);return e>=Ge?_r(r,e,Ge,"day"):e>=gt?_r(r,e,gt,"hour"):e>=yt?_r(r,e,yt,"minute"):e>=mt?_r(r,e,mt,"second"):r+" ms"}function _r(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}});var ps=S((Lp,ds)=>{function bf(r){t.debug=t,t.default=t,t.coerce=c,t.disable=o,t.enable=i,t.enabled=s,t.humanize=hs(),t.destroy=u,Object.keys(r).forEach(l=>{t[l]=r[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let h=0;for(let d=0;d<l.length;d++)h=(h<<5)-h+l.charCodeAt(d),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(l){let h,d=null,v,y;function g(...k){if(!g.enabled)return;let I=g,O=Number(new Date),ne=O-(h||O);I.diff=ne,I.prev=h,I.curr=O,h=O,k[0]=t.coerce(k[0]),typeof k[0]!="string"&&k.unshift("%O");let $=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,(ie,Q)=>{if(ie==="%%")return"%";$++;let oe=t.formatters[Q];if(typeof oe=="function"){let ut=k[$];ie=oe.call(I,ut),k.splice($,1),$--}return ie}),t.formatArgs.call(I,k),(I.log||t.log).apply(I,k)}return g.namespace=l,g.useColors=t.useColors(),g.color=t.selectColor(l),g.extend=n,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(v!==t.namespaces&&(v=t.namespaces,y=t.enabled(l)),y),set:k=>{d=k}}),typeof t.init=="function"&&t.init(g),g}function n(l,h){let d=t(this.namespace+(typeof h>"u"?":":h)+l);return d.log=this.log,d}function i(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let h,d=(typeof l=="string"?l:"").split(/[\s,]+/),v=d.length;for(h=0;h<v;h++)d[h]&&(l=d[h].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.slice(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function o(){let l=[...t.names.map(a),...t.skips.map(a).map(h=>"-"+h)].join(",");return t.enable(""),l}function s(l){if(l[l.length-1]==="*")return!0;let h,d;for(h=0,d=t.skips.length;h<d;h++)if(t.skips[h].test(l))return!1;for(h=0,d=t.names.length;h<d;h++)if(t.names[h].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}ds.exports=bf});var ms=S((K,vr)=>{K.formatArgs=vf;K.save=xf;K.load=kf;K.useColors=_f;K.storage=Ef();K.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();K.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function _f(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function vf(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+vr.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(n=t))}),r.splice(n,0,e)}K.log=console.debug||console.log||(()=>{});function xf(r){try{r?K.storage.setItem("debug",r):K.storage.removeItem("debug")}catch{}}function kf(){let r;try{r=K.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function Ef(){try{return localStorage}catch{}}vr.exports=ps()(K);var{formatters:Sf}=vr.exports;Sf.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var gs=S((jp,ys)=>{"use strict";ys.exports=Lf;function Lf(r,e){for(var t=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)t[n++]=arguments[i++];return new Promise(function(a,c){t[n]=function(l){if(o)if(o=!1,l)c(l);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];a.apply(null,h)}};try{r.apply(e||null,t)}catch(u){o&&(o=!1,c(u))}})}});var vs=S(_s=>{"use strict";var kr=_s;kr.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&e.charAt(t)==="=";)++n;return Math.ceil(e.length*3)/4-n};var bt=new Array(64),bs=new Array(123);for(he=0;he<64;)bs[bt[he]=he<26?he+65:he<52?he+71:he<62?he-4:he-59|43]=he++;var he;kr.encode=function(e,t,n){for(var i=null,o=[],s=0,a=0,c;t<n;){var u=e[t++];switch(a){case 0:o[s++]=bt[u>>2],c=(u&3)<<4,a=1;break;case 1:o[s++]=bt[c|u>>4],c=(u&15)<<2,a=2;break;case 2:o[s++]=bt[c|u>>6],o[s++]=bt[u&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=bt[c],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var ws="invalid encoding";kr.decode=function(e,t,n){for(var i=n,o=0,s,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&o>1)break;if((c=bs[c])===void 0)throw Error(ws);switch(o){case 0:s=c,o=1;break;case 1:t[n++]=s<<2|(c&48)>>4,s=c,o=2;break;case 2:t[n++]=(s&15)<<4|(c&60)>>2,s=c,o=3;break;case 3:t[n++]=(s&3)<<6|c,o=0;break}}if(o===1)throw Error(ws);return n-i};kr.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var ks=S((Qp,xs)=>{"use strict";xs.exports=Er;function Er(){this._listeners={}}Er.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this};Er.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this};Er.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}});var Ls=S((Kp,Cs)=>{"use strict";Cs.exports=Es(Es);function Es(r){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),n=t[3]===128;function i(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3]}function o(c,u,l){e[0]=c,u[l]=t[3],u[l+1]=t[2],u[l+2]=t[1],u[l+3]=t[0]}r.writeFloatLE=n?i:o,r.writeFloatBE=n?o:i;function s(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],e[0]}function a(c,u){return t[3]=c[u],t[2]=c[u+1],t[1]=c[u+2],t[0]=c[u+3],e[0]}r.readFloatLE=n?s:a,r.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,o,s)}}r.writeFloatLE=e.bind(null,Ss),r.writeFloatBE=e.bind(null,Ts);function t(n,i,o){var s=n(i,o),a=(s>>31)*2+1,c=s>>>23&255,u=s&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}r.readFloatLE=t.bind(null,As),r.readFloatBE=t.bind(null,Bs)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),n=t[7]===128;function i(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3],u[l+4]=t[4],u[l+5]=t[5],u[l+6]=t[6],u[l+7]=t[7]}function o(c,u,l){e[0]=c,u[l]=t[7],u[l+1]=t[6],u[l+2]=t[5],u[l+3]=t[4],u[l+4]=t[3],u[l+5]=t[2],u[l+6]=t[1],u[l+7]=t[0]}r.writeDoubleLE=n?i:o,r.writeDoubleBE=n?o:i;function s(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],t[4]=c[u+4],t[5]=c[u+5],t[6]=c[u+6],t[7]=c[u+7],e[0]}function a(c,u){return t[7]=c[u],t[6]=c[u+1],t[5]=c[u+2],t[4]=c[u+3],t[3]=c[u+4],t[2]=c[u+5],t[1]=c[u+6],t[0]=c[u+7],e[0]}r.readDoubleLE=n?s:a,r.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,c){var u=s<0?1:0;if(u&&(s=-s),s===0)n(0,a,c+i),n(1/s>0?0:2147483648,a,c+o);else if(isNaN(s))n(0,a,c+i),n(2146959360,a,c+o);else if(s>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+o);else{var l;if(s<22250738585072014e-324)l=s/5e-324,n(l>>>0,a,c+i),n((u<<31|l/4294967296)>>>0,a,c+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),l=s*Math.pow(2,-h),n(l*4503599627370496>>>0,a,c+i),n((u<<31|h+1023<<20|l*1048576&1048575)>>>0,a,c+o)}}}r.writeDoubleLE=e.bind(null,Ss,0,4),r.writeDoubleBE=e.bind(null,Ts,4,0);function t(n,i,o,s,a){var c=n(s,a+i),u=n(s,a+o),l=(u>>31)*2+1,h=u>>>20&2047,d=4294967296*(u&1048575)+c;return h===2047?d?NaN:l*(1/0):h===0?l*5e-324*d:l*Math.pow(2,h-1075)*(d+4503599627370496)}r.readDoubleLE=t.bind(null,As,0,4),r.readDoubleBE=t.bind(null,Bs,4,0)}(),r}function Ss(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function Ts(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function As(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function Bs(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var Ps=S((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Ns=S(Is=>{"use strict";var Xn=Is;Xn.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?t+=1:n<2048?t+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};Xn.read=function(e,t,n){var i=n-t;if(i<1)return"";for(var o=null,s=[],a=0,c;t<n;)c=e[t++],c<128?s[a++]=c:c>191&&c<224?s[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[a++]=55296+(c>>10),s[a++]=56320+(c&1023)):s[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Xn.write=function(e,t,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128);return n-i}});var Ms=S((Jp,Ds)=>{"use strict";Ds.exports=Pf;function Pf(r,e,t){var n=t||8192,i=n>>>1,o=null,s=n;return function(c){if(c<1||c>i)return r(c);s+c>n&&(o=r(n),s=0);var u=e.call(o,s,s+=c);return s&7&&(s=(s|7)+1),u}}});var Os=S((Zp,Fs)=>{"use strict";Fs.exports=R;var Ht=Je();function R(r,e){this.lo=r>>>0,this.hi=e>>>0}var Xe=R.zero=new R(0,0);Xe.toNumber=function(){return 0};Xe.zzEncode=Xe.zzDecode=function(){return this};Xe.length=function(){return 1};var If=R.zeroHash="\0\0\0\0\0\0\0\0";R.fromNumber=function(e){if(e===0)return Xe;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new R(n,i)};R.from=function(e){if(typeof e=="number")return R.fromNumber(e);if(Ht.isString(e))if(Ht.Long)e=Ht.Long.fromString(e);else return R.fromNumber(parseInt(e,10));return e.low||e.high?new R(e.low>>>0,e.high>>>0):Xe};R.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+n*4294967296)}return this.lo+this.hi*4294967296};R.prototype.toLong=function(e){return Ht.Long?new Ht.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Me=String.prototype.charCodeAt;R.fromHash=function(e){return e===If?Xe:new R((Me.call(e,0)|Me.call(e,1)<<8|Me.call(e,2)<<16|Me.call(e,3)<<24)>>>0,(Me.call(e,4)|Me.call(e,5)<<8|Me.call(e,6)<<16|Me.call(e,7)<<24)>>>0)};R.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};R.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};R.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};R.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}});var Je=S(Jn=>{"use strict";var _=Jn;_.asPromise=gs();_.base64=vs();_.EventEmitter=ks();_.float=Ls();_.inquire=Ps();_.utf8=Ns();_.pool=Ms();_.LongBits=Os();_.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);_.global=_.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Jn;_.emptyArray=Object.freeze?Object.freeze([]):[];_.emptyObject=Object.freeze?Object.freeze({}):{};_.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};_.isString=function(e){return typeof e=="string"||e instanceof String};_.isObject=function(e){return e&&typeof e=="object"};_.isset=_.isSet=function(e,t){var n=e[t];return n!=null&&e.hasOwnProperty(t)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};_.Buffer=function(){try{var r=_.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();_._Buffer_from=null;_._Buffer_allocUnsafe=null;_.newBuffer=function(e){return typeof e=="number"?_.Buffer?_._Buffer_allocUnsafe(e):new _.Array(e):_.Buffer?_._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};_.Array=typeof Uint8Array<"u"?Uint8Array:Array;_.Long=_.global.dcodeIO&&_.global.dcodeIO.Long||_.global.Long||_.inquire("long");_.key2Re=/^true|false|0|1$/;_.key32Re=/^-?(?:0|[1-9][0-9]*)$/;_.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;_.longToHash=function(e){return e?_.LongBits.from(e).toHash():_.LongBits.zeroHash};_.longFromHash=function(e,t){var n=_.LongBits.fromHash(e);return _.Long?_.Long.fromBits(n.lo,n.hi,t):n.toNumber(!!t)};function Us(r,e,t){for(var n=Object.keys(e),i=0;i<n.length;++i)(r[n[i]]===void 0||!t)&&(r[n[i]]=e[n[i]]);return r}_.merge=Us;_.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Rs(r){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Us(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}_.newError=Rs;_.ProtocolError=Rs("ProtocolError");_.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(t[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};_.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}};_.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};_._configure=function(){var r=_.Buffer;if(!r){_._Buffer_from=_._Buffer_allocUnsafe=null;return}_._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,n){return new r(t,n)},_._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var ei=S((em,qs)=>{"use strict";qs.exports=M;var we=Je(),Yn,Ws=we.LongBits,Nf=we.utf8;function de(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function M(r){this.buf=r,this.pos=0,this.len=r.length}var zs=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new M(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new M(e);throw Error("illegal buffer")},Hs=function(){return we.Buffer?function(t){return(M.create=function(i){return we.Buffer.isBuffer(i)?new Yn(i):zs(i)})(t)}:zs};M.create=Hs();M.prototype._slice=we.Array.prototype.subarray||we.Array.prototype.slice;M.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,de(this,10);return e}}();M.prototype.int32=function(){return this.uint32()|0};M.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Zn(){var r=new Ws(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw de(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw de(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}M.prototype.bool=function(){return this.uint32()!==0};function Sr(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}M.prototype.fixed32=function(){if(this.pos+4>this.len)throw de(this,4);return Sr(this.buf,this.pos+=4)};M.prototype.sfixed32=function(){if(this.pos+4>this.len)throw de(this,4);return Sr(this.buf,this.pos+=4)|0};function $s(){if(this.pos+8>this.len)throw de(this,8);return new Ws(Sr(this.buf,this.pos+=4),Sr(this.buf,this.pos+=4))}M.prototype.float=function(){if(this.pos+4>this.len)throw de(this,4);var e=we.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};M.prototype.double=function(){if(this.pos+8>this.len)throw de(this,4);var e=we.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};M.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw de(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)};M.prototype.string=function(){var e=this.bytes();return Nf.read(e,0,e.length)};M.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw de(this,e);this.pos+=e}else do if(this.pos>=this.len)throw de(this);while(this.buf[this.pos++]&128);return this};M.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};M._configure=function(r){Yn=r,M.create=Hs(),Yn._configure();var e=we.Long?"toLong":"toNumber";we.merge(M.prototype,{int64:function(){return Zn.call(this)[e](!1)},uint64:function(){return Zn.call(this)[e](!0)},sint64:function(){return Zn.call(this).zzDecode()[e](!1)},fixed64:function(){return $s.call(this)[e](!0)},sfixed64:function(){return $s.call(this)[e](!1)}})}});var Qs=S((tm,Gs)=>{"use strict";Gs.exports=Ze;var js=ei();(Ze.prototype=Object.create(js.prototype)).constructor=Ze;var Vs=Je();function Ze(r){js.call(this,r)}Ze._configure=function(){Vs.Buffer&&(Ze.prototype._slice=Vs.Buffer.prototype.slice)};Ze.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ze._configure()});var ai=S((rm,Zs)=>{"use strict";Zs.exports=T;var ce=Je(),ti,Tr=ce.LongBits,Ks=ce.base64,Xs=ce.utf8;function qt(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function ni(){}function Df(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function T(){this.len=0,this.head=new qt(ni,0,0),this.tail=this.head,this.states=null}var Js=function(){return ce.Buffer?function(){return(T.create=function(){return new ti})()}:function(){return new T}};T.create=Js();T.alloc=function(e){return new ce.Array(e)};ce.Array!==Array&&(T.alloc=ce.pool(T.alloc,ce.Array.prototype.subarray));T.prototype._push=function(e,t,n){return this.tail=this.tail.next=new qt(e,t,n),this.len+=t,this};function ii(r,e,t){e[t]=r&255}function Mf(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function oi(r,e){this.len=r,this.next=void 0,this.val=e}oi.prototype=Object.create(qt.prototype);oi.prototype.fn=Mf;T.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new oi((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};T.prototype.int32=function(e){return e<0?this._push(si,10,Tr.fromNumber(e)):this.uint32(e)};T.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function si(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}T.prototype.uint64=function(e){var t=Tr.from(e);return this._push(si,t.length(),t)};T.prototype.int64=T.prototype.uint64;T.prototype.sint64=function(e){var t=Tr.from(e).zzEncode();return this._push(si,t.length(),t)};T.prototype.bool=function(e){return this._push(ii,1,e?1:0)};function ri(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}T.prototype.fixed32=function(e){return this._push(ri,4,e>>>0)};T.prototype.sfixed32=T.prototype.fixed32;T.prototype.fixed64=function(e){var t=Tr.from(e);return this._push(ri,4,t.lo)._push(ri,4,t.hi)};T.prototype.sfixed64=T.prototype.fixed64;T.prototype.float=function(e){return this._push(ce.float.writeFloatLE,4,e)};T.prototype.double=function(e){return this._push(ce.float.writeDoubleLE,8,e)};var Ff=ce.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};T.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(ii,1,0);if(ce.isString(e)){var n=T.alloc(t=Ks.length(e));Ks.decode(e,n,0),e=n}return this.uint32(t)._push(Ff,t,e)};T.prototype.string=function(e){var t=Xs.length(e);return t?this.uint32(t)._push(Xs.write,t,e):this._push(ii,1,0)};T.prototype.fork=function(){return this.states=new Df(this),this.head=this.tail=new qt(ni,0,0),this.len=0,this};T.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new qt(ni,0,0),this.len=0),this};T.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this};T.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t};T._configure=function(r){ti=r,T.create=Js(),ti._configure()}});var ta=S((nm,ea)=>{"use strict";ea.exports=be;var Ys=ai();(be.prototype=Object.create(Ys.prototype)).constructor=be;var Fe=Je();function be(){Ys.call(this)}be._configure=function(){be.alloc=Fe._Buffer_allocUnsafe,be.writeBytesBuffer=Fe.Buffer&&Fe.Buffer.prototype instanceof Uint8Array&&Fe.Buffer.prototype.set.name==="set"?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}};be.prototype.bytes=function(e){Fe.isString(e)&&(e=Fe._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(be.writeBytesBuffer,t,e),this};function Of(r,e,t){r.length<40?Fe.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}be.prototype.string=function(e){var t=Fe.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Of,t,e),this};be._configure()});var Or=S((by,ya)=>{"use strict";function ma(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Yf(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return ma(r,t)}catch{t.message=r.message,t.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),ma(new i,t)}}ya.exports=Yf});var xa=S((Oy,va)=>{"use strict";va.exports=function(){return Date.now()}});var Ea=S((Uy,ka)=>{"use strict";var zr=xa(),_i=class{constructor(e,t,n){let i=this;this._started=zr(),this._rescheduled=0,this._scheduled=t,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(zr()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=zr();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=zr(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function ch(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new _i(arguments[0],arguments[1],r)}ka.exports=ch});var Aa=S((Ry,Ta)=>{"use strict";var{AbortController:uh}=globalThis,Sa=Ea(),jt=class extends uh{constructor(e){super(),this._ms=e,this._timer=Sa(()=>this.abort(),e),Object.setPrototypeOf(this,jt.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=Sa(()=>this.abort(),this._ms)}};Ta.exports={TimeoutController:jt}});var Qr=S((kg,Ti)=>{"use strict";var Tt=typeof Reflect=="object"?Reflect:null,Na=Tt&&typeof Tt.apply=="function"?Tt.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},jr;Tt&&typeof Tt.ownKeys=="function"?jr=Tt.ownKeys:Object.getOwnPropertySymbols?jr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:jr=function(e){return Object.getOwnPropertyNames(e)};function Eh(r){console&&console.warn&&console.warn(r)}var Ma=Number.isNaN||function(e){return e!==e};function L(){L.init.call(this)}Ti.exports=L;Ti.exports.once=Bh;L.EventEmitter=L;L.prototype._events=void 0;L.prototype._eventsCount=0;L.prototype._maxListeners=void 0;var Da=10;function Gr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(L,"defaultMaxListeners",{enumerable:!0,get:function(){return Da},set:function(r){if(typeof r!="number"||r<0||Ma(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Da=r}});L.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};L.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Ma(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Fa(r){return r._maxListeners===void 0?L.defaultMaxListeners:r._maxListeners}L.prototype.getMaxListeners=function(){return Fa(this)};L.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")Na(c,this,t);else for(var u=c.length,l=$a(c,u),n=0;n<u;++n)Na(l[n],this,t);return!0};function Oa(r,e,t,n){var i,o,s;if(Gr(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=Fa(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,Eh(a)}return r}L.prototype.addListener=function(e,t){return Oa(this,e,t,!1)};L.prototype.on=L.prototype.addListener;L.prototype.prependListener=function(e,t){return Oa(this,e,t,!0)};function Sh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ua(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Sh.bind(n);return i.listener=t,n.wrapFn=i,i}L.prototype.once=function(e,t){return Gr(t),this.on(e,Ua(this,e,t)),this};L.prototype.prependOnceListener=function(e,t){return Gr(t),this.prependListener(e,Ua(this,e,t)),this};L.prototype.removeListener=function(e,t){var n,i,o,s,a;if(Gr(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():Th(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};L.prototype.off=L.prototype.removeListener;L.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Ra(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Ah(i):$a(i,i.length)}L.prototype.listeners=function(e){return Ra(this,e,!0)};L.prototype.rawListeners=function(e){return Ra(this,e,!1)};L.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):za.call(r,e)};L.prototype.listenerCount=za;function za(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}L.prototype.eventNames=function(){return this._eventsCount>0?jr(this._events):[]};function $a(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Th(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ah(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Bh(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Wa(r,e,o,{once:!0}),e!=="error"&&Ch(r,i,{once:!0})})}function Ch(r,e,t){typeof r.on=="function"&&Wa(r,"error",e,t)}function Wa(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var Ja=S((Ka,Xa)=>{"use strict";var qh=Math.exp;Ka=Xa.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,n=0,i=0,o=0,s,a={};function c(u,l){return 1-qh(-(u-l)/e)}return a.push=function(l,h){if(s){let d=c(l,s),v=h-t,y=d*v;t=d*h+(1-d)*t,n=(1-d)*(n+v*y),i=Math.sqrt(n),o=t+d*v}else t=h;s=l},a.movingAverage=function(){return t},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return o},a}});var rc=S((ew,Ui)=>{function tc(r){let e=new globalThis.AbortController;function t(){e.abort();for(let n of r)!n||!n.removeEventListener||n.removeEventListener("abort",t)}for(let n of r)if(!(!n||!n.addEventListener)){if(n.aborted){t();break}n.addEventListener("abort",t)}return e.signal}Ui.exports=tc;Ui.exports.anySignal=tc});var sc=S((yw,Ri)=>{"use strict";var Zh=Object.prototype.hasOwnProperty,q="~";function Zt(){}Object.create&&(Zt.prototype=Object.create(null),new Zt().__proto__||(q=!1));function Yh(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function oc(r,e,t,n,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new Yh(t,n||r,i),s=q?q+e:e;return r._events[s]?r._events[s].fn?r._events[s]=[r._events[s],o]:r._events[s].push(o):(r._events[s]=o,r._eventsCount++),r}function en(r,e){--r._eventsCount===0?r._events=new Zt:delete r._events[e]}function H(){this._events=new Zt,this._eventsCount=0}H.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)Zh.call(t,n)&&e.push(q?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};H.prototype.listeners=function(e){var t=q?q+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s};H.prototype.listenerCount=function(e){var t=q?q+e:e,n=this._events[t];return n?n.fn?1:n.length:0};H.prototype.emit=function(e,t,n,i,o,s){var a=q?q+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,s),!0}for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var d=c.length,v;for(h=0;h<d;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,n);break;case 4:c[h].fn.call(c[h].context,t,n,i);break;default:if(!l)for(v=1,l=new Array(u-1);v<u;v++)l[v-1]=arguments[v];c[h].fn.apply(c[h].context,l)}}return!0};H.prototype.on=function(e,t,n){return oc(this,e,t,n,!1)};H.prototype.once=function(e,t,n){return oc(this,e,t,n,!0)};H.prototype.removeListener=function(e,t,n,i){var o=q?q+e:e;if(!this._events[o])return this;if(!t)return en(this,o),this;var s=this._events[o];if(s.fn)s.fn===t&&(!i||s.once)&&(!n||s.context===n)&&en(this,o);else{for(var a=0,c=[],u=s.length;a<u;a++)(s[a].fn!==t||i&&!s[a].once||n&&s[a].context!==n)&&c.push(s[a]);c.length?this._events[o]=c.length===1?c[0]:c:en(this,o)}return this};H.prototype.removeAllListeners=function(e){var t;return e?(t=q?q+e:e,this._events[t]&&en(this,t)):(this._events=new Zt,this._eventsCount=0),this};H.prototype.off=H.prototype.removeListener;H.prototype.addListener=H.prototype.on;H.prefixed=q;H.EventEmitter=H;typeof Ri<"u"&&(Ri.exports=H)});var ep={};V(ep,{createHelia:()=>Yd});var Dn={};V(Dn,{identity:()=>Nn});var rp=new Uint8Array(0);var ko=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},ke=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var Eo=r=>new TextEncoder().encode(r),So=r=>new TextDecoder().decode(r);var tl=Co,Ao=128,rl=127,nl=~rl,il=Math.pow(2,31);function Co(r,e,t){e=e||[],t=t||0;for(var n=t;r>=il;)e[t++]=r&255|Ao,r/=128;for(;r&nl;)e[t++]=r&255|Ao,r>>>=7;return e[t]=r|0,Co.bytes=t-n+1,e}var ol=In,sl=128,Bo=127;function In(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw In.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&Bo)<<i:(s&Bo)*Math.pow(2,i),i+=7}while(s>=sl);return In.bytes=o-n,t}var al=Math.pow(2,7),cl=Math.pow(2,14),ul=Math.pow(2,21),ll=Math.pow(2,28),fl=Math.pow(2,35),hl=Math.pow(2,42),dl=Math.pow(2,49),pl=Math.pow(2,56),ml=Math.pow(2,63),yl=function(r){return r<al?1:r<cl?2:r<ul?3:r<ll?4:r<fl?5:r<hl?6:r<dl?7:r<pl?8:r<ml?9:10},gl={encode:tl,decode:ol,encodingLength:yl},wl=gl,Ut=wl;var Rt=(r,e=0)=>[Ut.decode(r,e),Ut.decode.bytes],lt=(r,e,t=0)=>(Ut.encode(r,e,t),e),ft=r=>Ut.encodingLength(r);var Ve=(r,e)=>{let t=e.byteLength,n=ft(r),i=n+ft(t),o=new Uint8Array(i+t);return lt(r,o,0),lt(t,o,n),o.set(e,i),new ht(r,t,e,o)},br=r=>{let e=ke(r),[t,n]=Rt(e),[i,o]=Rt(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ht(t,i,s,e)},Lo=(r,e)=>{if(r===e)return!0;{let t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&ko(r.bytes,t.bytes)}},ht=class{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}};var Po=0,bl="identity",Io=ke,_l=r=>Ve(Po,Io(r)),Nn={code:Po,name:bl,encode:Io,digest:_l};var Un={};V(Un,{sha256:()=>je,sha512:()=>On});var Fn=({name:r,code:e,encode:t})=>new Mn(r,e,t),Mn=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Ve(this.code,t):t.then(n=>Ve(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Do=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),je=Fn({name:"sha2-256",code:18,encode:Do("SHA-256")}),On=Fn({name:"sha2-512",code:19,encode:Do("SHA-512")});var Hn={};V(Hn,{base58btc:()=>E,base58flickr:()=>Tl});function vl(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,k=0,I=0,O=y.length;I!==O&&y[I]===0;)I++,g++;for(var ne=(O-I)*l+1>>>0,$=new Uint8Array(ne);I!==O;){for(var fe=y[I],ie=0,Q=ne-1;(fe!==0||ie<k)&&Q!==-1;Q--,ie++)fe+=256*$[Q]>>>0,$[Q]=fe%a>>>0,fe=fe/a>>>0;if(fe!==0)throw new Error("Non-zero carry");k=ie,I++}for(var oe=ne-k;oe!==ne&&$[oe]===0;)oe++;for(var ut=c.repeat(g);oe<ne;++oe)ut+=r.charAt($[oe]);return ut}function d(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var k=0,I=0;y[g]===c;)k++,g++;for(var O=(y.length-g)*u+1>>>0,ne=new Uint8Array(O);y[g];){var $=t[y.charCodeAt(g)];if($===255)return;for(var fe=0,ie=O-1;($!==0||fe<I)&&ie!==-1;ie--,fe++)$+=a*ne[ie]>>>0,ne[ie]=$%256>>>0,$=$/256>>>0;if($!==0)throw new Error("Non-zero carry");I=fe,g++}if(y[g]!==" "){for(var Q=O-I;Q!==O&&ne[Q]===0;)Q++;for(var oe=new Uint8Array(k+(O-Q)),ut=k;Q!==O;)oe[ut++]=ne[Q++];return oe}}}function v(y){var g=d(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:v}}var xl=vl,kl=xl,Mo=kl;var Rn=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},zn=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Fo(this,e)}},$n=class{constructor(e){this.decoders=e}or(e){return Fo(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Fo=(r,e)=>new $n({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Wn=class{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new Rn(e,t,n),this.decoder=new zn(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},pt=({name:r,prefix:e,encode:t,decode:n})=>new Wn(r,e,t,n),Ne=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:i}=Mo(t,e);return pt({prefix:r,name:e,encode:n,decode:o=>ke(i(o))})},El=(r,e,t,n)=>{let i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*t/8|0),a=0,c=0,u=0;for(let l=0;l<o;++l){let h=i[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},Sl=(r,e,t)=>{let n=e[e.length-1]==="=",i=(1<<t)-1,o="",s=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s&&(o+=e[i&a<<t-s]),n)for(;o.length*t&7;)o+="=";return o},D=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>pt({prefix:e,name:r,encode(i){return Sl(i,n,t)},decode(i){return El(i,n,t,r)}});var E=Ne({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Tl=Ne({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var qn={};V(qn,{base32:()=>j,base32hex:()=>Ll,base32hexpad:()=>Il,base32hexpadupper:()=>Nl,base32hexupper:()=>Pl,base32pad:()=>Bl,base32padupper:()=>Cl,base32upper:()=>Al,base32z:()=>Dl});var j=D({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Al=D({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bl=D({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Cl=D({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ll=D({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pl=D({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Il=D({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Nl=D({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dl=D({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Oo=(r,e)=>{let{bytes:t,version:n}=r;switch(n){case 0:return Fl(t,Vn(r),e||E.encoder);default:return Ol(t,Vn(r),e||j.encoder)}};var Uo=new WeakMap,Vn=r=>{let e=Uo.get(r);if(e==null){let t=new Map;return Uo.set(r,t),t}return e},x=class{constructor(e,t,n,i){this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:t}=this;if(e!==zt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ul)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return x.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=Ve(e,t);return x.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return x.equals(this,e)}static equals(e,t){let n=t;return n&&e.code===n.code&&e.version===n.version&&Lo(e.multihash,n.multihash)}toString(e){return Oo(this,e)}toJSON(){return{"/":Oo(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let t=e;if(t instanceof x)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:i,multihash:o,bytes:s}=t;return new x(n,i,o,s||Ro(n,i,o.bytes))}else if(t[Rl]===!0){let{version:n,multihash:i,code:o}=t,s=br(i);return x.create(n,o,s)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==zt)throw new Error(`Version 0 CID must use dag-pb (code: ${zt}) block encoding`);return new x(e,t,n,n.bytes)}case 1:{let i=Ro(e,t,n.bytes);return new x(e,t,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return x.create(0,zt,e)}static createV1(e,t){return x.create(1,e,t)}static decode(e){let[t,n]=x.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=x.inspectBytes(e),n=t.size-t.multihashSize,i=ke(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=i.subarray(t.multihashSize-t.digestSize),s=new ht(t.multihashCode,t.digestSize,o,i);return[t.version===0?x.createV0(s):x.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[h,d]=Rt(e.subarray(t));return t+=d,h},i=n(),o=zt;if(i===18?(i=0,t=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=t,a=n(),c=n(),u=t+c,l=u-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,t){let[n,i]=Ml(e,t),o=x.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Vn(o).set(n,e),o}},Ml=(r,e)=>{switch(r[0]){case"Q":{let t=e||E;return[E.prefix,t.decode(`${E.prefix}${r}`)]}case E.prefix:{let t=e||E;return[E.prefix,t.decode(r)]}case j.prefix:{let t=e||j;return[j.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},Fl=(r,e,t)=>{let{prefix:n}=t;if(n!==E.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let i=e.get(n);if(i==null){let o=t.encode(r).slice(1);return e.set(n,o),o}else return i},Ol=(r,e,t)=>{let{prefix:n}=t,i=e.get(n);if(i==null){let o=t.encode(r);return e.set(n,o),o}else return i},zt=112,Ul=18,Ro=(r,e,t)=>{let n=ft(r),i=n+ft(e),o=new Uint8Array(i+t.byteLength);return lt(r,o,0),lt(e,o,n),o.set(t,i),o},Rl=Symbol.for("@ipld/js-cid/CID");var sa=U(Yo(),1);var $t=U(us(),1);function df(r){let e=new Uint8Array(r.reduce((n,i)=>n+$t.default.encodingLength(i),0)),t=0;for(let n of r)e=$t.encode(n,e,t),t+=$t.default.encodingLength(n);return e}var ls=df;var se=U(ms(),1);var Kn={};V(Kn,{base64:()=>Wt,base64pad:()=>Tf,base64url:()=>Af,base64urlpad:()=>Bf});var Wt=D({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Tf=D({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Af=D({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bf=D({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});se.default.formatters.b=r=>r==null?"undefined":E.baseEncode(r);se.default.formatters.t=r=>r==null?"undefined":j.baseEncode(r);se.default.formatters.m=r=>r==null?"undefined":Wt.baseEncode(r);se.default.formatters.p=r=>r==null?"undefined":r.toString();se.default.formatters.c=r=>r==null?"undefined":r.toString();se.default.formatters.k=r=>r==null?"undefined":r.toString();function Cf(r){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=r,e.destroy=()=>!0,e.extend=()=>e,e}function wt(r){let e=Cf(`${r}:trace`);return se.default.enabled(`${r}:trace`)&&se.default.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(e=(0,se.default)(`${r}:trace`)),Object.assign((0,se.default)(r),{error:(0,se.default)(`${r}:error`),trace:e})}function Qe(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var Ke=class{constructor(e,t,n){this._refCounter=1,this.cid=e,this.priority=t??1,this.wantType=n}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(E)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};var De=class{constructor(e,t,n,i,o){this.entry=new Ke(e,t,n),this.cancel=!!i,this.sendDontHave=!!o}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(E)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}};var ae=(r,e)=>{let t=["bitswap"];return e!=null&&t.push(e),r!=null&&t.push(`${r.toString().slice(0,8)}`),wt(t.join(":"))};var xr=(r,e)=>{if(r.size!==e.size)return!1;for(let[t,n]of r){let i=e.get(t);if(i===void 0||n instanceof Uint8Array&&i instanceof Uint8Array&&!Qe(n,i)||n instanceof De&&i instanceof De&&!n.equals(i))return!1}return!0};var ci=U(ei(),1),ra=U(Qs(),1),na=U(Je(),1),ui=U(ai(),1),ia=U(ta(),1);function Uf(){na.default._configure(),ci.default._configure(ra.default),ui.default._configure(ia.default)}Uf();var oa=["uint64","int64","sint64","fixed64","sfixed64"];function Rf(r){for(let e of oa){if(r[e]==null)continue;let t=r[e];r[e]=function(){return BigInt(t.call(this).toString())}}return r}function li(r){return Rf(new ci.default(r))}function zf(r){for(let e of oa){if(r[e]==null)continue;let t=r[e];r[e]=function(n){return t.call(this,n.toString())}}return r}function fi(){return zf(ui.default.create())}function Ye(r,e){let t=li(r instanceof Uint8Array?r:r.subarray());return e.decode(t)}function et(r,e){let t=fi();return e.encode(r,t,{lengthDelimited:!1}),t.finish()}var _t;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(_t||(_t={}));function Ar(r,e,t,n){return{name:r,type:e,encode:t,decode:n}}function Br(r){function e(i){if(r[i.toString()]==null)throw new Error("Invalid enum value");return r[i]}let t=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return Ar("enum",_t.VARINT,t,n)}function tt(r,e){return Ar("message",_t.LENGTH_DELIMITED,r,e)}var G;(function(r){let e;(function(a){let c;(function(d){d.Block="Block",d.Have="Have"})(c=a.WantType||(a.WantType={}));let u;(function(d){d[d.Block=0]="Block",d[d.Have=1]="Have"})(u||(u={})),function(d){d.codec=()=>Br(u)}(c=a.WantType||(a.WantType={}));let l;(function(d){let v;d.codec=()=>(v==null&&(v=tt((y,g,k={})=>{k.lengthDelimited!==!1&&g.fork(),y.block!=null&&y.block.byteLength>0&&(g.uint32(10),g.bytes(y.block)),y.priority!=null&&y.priority!==0&&(g.uint32(16),g.int32(y.priority)),y.cancel!=null&&y.cancel!==!1&&(g.uint32(24),g.bool(y.cancel)),y.wantType!=null&&u[y.wantType]!==0&&(g.uint32(32),r.Wantlist.WantType.codec().encode(y.wantType,g)),y.sendDontHave!=null&&y.sendDontHave!==!1&&(g.uint32(40),g.bool(y.sendDontHave)),k.lengthDelimited!==!1&&g.ldelim()},(y,g)=>{let k={block:new Uint8Array(0),priority:0,cancel:!1,wantType:c.Block,sendDontHave:!1},I=g==null?y.len:y.pos+g;for(;y.pos<I;){let O=y.uint32();switch(O>>>3){case 1:k.block=y.bytes();break;case 2:k.priority=y.int32();break;case 3:k.cancel=y.bool();break;case 4:k.wantType=r.Wantlist.WantType.codec().decode(y);break;case 5:k.sendDontHave=y.bool();break;default:y.skipType(O&7);break}}return k})),v),d.encode=y=>et(y,d.codec()),d.decode=y=>Ye(y,d.codec())})(l=a.Entry||(a.Entry={}));let h;a.codec=()=>(h==null&&(h=tt((d,v,y={})=>{if(y.lengthDelimited!==!1&&v.fork(),d.entries!=null)for(let g of d.entries)v.uint32(10),r.Wantlist.Entry.codec().encode(g,v);d.full!=null&&d.full!==!1&&(v.uint32(16),v.bool(d.full)),y.lengthDelimited!==!1&&v.ldelim()},(d,v)=>{let y={entries:[],full:!1},g=v==null?d.len:d.pos+v;for(;d.pos<g;){let k=d.uint32();switch(k>>>3){case 1:y.entries.push(r.Wantlist.Entry.codec().decode(d,d.uint32()));break;case 2:y.full=d.bool();break;default:d.skipType(k&7);break}}return y})),h),a.encode=d=>et(d,a.codec()),a.decode=d=>Ye(d,a.codec())})(e=r.Wantlist||(r.Wantlist={}));let t;(function(a){let c;a.codec=()=>(c==null&&(c=tt((u,l,h={})=>{h.lengthDelimited!==!1&&l.fork(),u.prefix!=null&&u.prefix.byteLength>0&&(l.uint32(10),l.bytes(u.prefix)),u.data!=null&&u.data.byteLength>0&&(l.uint32(18),l.bytes(u.data)),h.lengthDelimited!==!1&&l.ldelim()},(u,l)=>{let h={prefix:new Uint8Array(0),data:new Uint8Array(0)},d=l==null?u.len:u.pos+l;for(;u.pos<d;){let v=u.uint32();switch(v>>>3){case 1:h.prefix=u.bytes();break;case 2:h.data=u.bytes();break;default:u.skipType(v&7);break}}return h})),c),a.encode=u=>et(u,a.codec()),a.decode=u=>Ye(u,a.codec())})(t=r.Block||(r.Block={}));let n;(function(a){a.Have="Have",a.DontHave="DontHave"})(n=r.BlockPresenceType||(r.BlockPresenceType={}));let i;(function(a){a[a.Have=0]="Have",a[a.DontHave=1]="DontHave"})(i||(i={})),function(a){a.codec=()=>Br(i)}(n=r.BlockPresenceType||(r.BlockPresenceType={}));let o;(function(a){let c;a.codec=()=>(c==null&&(c=tt((u,l,h={})=>{h.lengthDelimited!==!1&&l.fork(),u.cid!=null&&u.cid.byteLength>0&&(l.uint32(10),l.bytes(u.cid)),u.type!=null&&i[u.type]!==0&&(l.uint32(16),r.BlockPresenceType.codec().encode(u.type,l)),h.lengthDelimited!==!1&&l.ldelim()},(u,l)=>{let h={cid:new Uint8Array(0),type:n.Have},d=l==null?u.len:u.pos+l;for(;u.pos<d;){let v=u.uint32();switch(v>>>3){case 1:h.cid=u.bytes();break;case 2:h.type=r.BlockPresenceType.codec().decode(u);break;default:u.skipType(v&7);break}}return h})),c),a.encode=u=>et(u,a.codec()),a.decode=u=>Ye(u,a.codec())})(o=r.BlockPresence||(r.BlockPresence={}));let s;r.codec=()=>(s==null&&(s=tt((a,c,u={})=>{if(u.lengthDelimited!==!1&&c.fork(),a.wantlist!=null&&(c.uint32(10),r.Wantlist.codec().encode(a.wantlist,c)),a.blocks!=null)for(let l of a.blocks)c.uint32(18),c.bytes(l);if(a.payload!=null)for(let l of a.payload)c.uint32(26),r.Block.codec().encode(l,c);if(a.blockPresences!=null)for(let l of a.blockPresences)c.uint32(34),r.BlockPresence.codec().encode(l,c);a.pendingBytes!=null&&a.pendingBytes!==0&&(c.uint32(40),c.int32(a.pendingBytes)),u.lengthDelimited!==!1&&c.ldelim()},(a,c)=>{let u={blocks:[],payload:[],blockPresences:[],pendingBytes:0},l=c==null?a.len:a.pos+c;for(;a.pos<l;){let h=a.uint32();switch(h>>>3){case 1:u.wantlist=r.Wantlist.codec().decode(a,a.uint32());break;case 2:u.blocks.push(a.bytes());break;case 3:u.payload.push(r.Block.codec().decode(a,a.uint32()));break;case 4:u.blockPresences.push(r.BlockPresence.codec().decode(a,a.uint32()));break;case 5:u.pendingBytes=a.int32();break;default:a.skipType(h&7);break}}return u})),s),r.encode=a=>et(a,r.codec()),r.decode=a=>Ye(a,r.codec())})(G||(G={}));var Cr=class extends Error{constructor(e,t,n){super(e),this.code=t,this.name=n?.name??"CodeError",this.props=n??{}}};var $f,B=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,n,i,o){n==null&&(n=B.WantType.Block);let s=e.toString(E),a=this.wantlist.get(s);a!=null?(a.wantType===n&&(a.priority=t),i===!0&&(a.cancel=!!i),o===!0&&(a.sendDontHave=!!o),n===B.WantType.Block&&a.wantType===B.WantType.Have&&(a.wantType=n)):this.wantlist.set(s,new De(e,t,n,i,o))}addBlock(e,t){let n=e.toString(E);this.blocks.set(n,t)}addHave(e){let t=e.toString(E);this.blockPresences.has(t)||this.blockPresences.set(t,B.BlockPresenceType.Have)}addDontHave(e){let t=e.toString(E);this.blockPresences.has(t)||this.blockPresences.set(t,B.BlockPresenceType.DontHave)}cancel(e){let t=e.toString(E);this.wantlist.delete(t),this.addEntry(e,0,B.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){return G.encode({wantlist:{entries:Array.from(this.wantlist.values()).map(e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:!!e.cancel,wantType:G.Wantlist.WantType.Block,sendDontHave:!1})),full:!!this.full},blocks:Array.from(this.blocks.values())})}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:!!t.cancel,sendDontHave:!!t.sendDontHave})),full:!!this.full},blockPresences:[],payload:[],pendingBytes:this.pendingBytes,blocks:[]};for(let[t,n]of this.blocks.entries()){let i=x.parse(t),o=i.version,s=i.code,a=i.multihash.code,c=i.multihash.digest.length,u=ls([o,s,a,c]);e.payload.push({prefix:u,data:n})}for(let[t,n]of this.blockPresences)e.blockPresences.push({cid:x.parse(t).bytes,type:n});return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),G.encode(e)}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!xr(this.wantlist,e.wantlist)||!xr(this.blocks,e.blocks)||!xr(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};$f=B;B.Entry=De;B.WantType={Block:G.Wantlist.WantType.Block,Have:G.Wantlist.WantType.Have};B.BlockPresenceType={Have:G.BlockPresenceType.Have,DontHave:G.BlockPresenceType.DontHave};B.deserialize=async(r,e)=>{let t=G.decode(r),n=t.wantlist?.full===!0,i=new B(n);return t.wantlist?.entries.forEach(o=>{if(o.block==null)return;let s=x.decode(o.block);i.addEntry(s,o.priority??0,o.wantType,!!o.cancel,!!o.sendDontHave)}),t.blockPresences.forEach(o=>{if(o.cid==null)return;let s=x.decode(o.cid);o.type===B.BlockPresenceType.Have?i.addHave(s):i.addDontHave(s)}),t.blocks.length>0?(await Promise.all(t.blocks.map(async o=>{let s=await je.digest(o),a=x.createV0(s);i.addBlock(a,o)})),i):(t.payload.length>0&&(await Promise.all(t.payload.map(async o=>{if(o.prefix==null||o.data==null)return;let s=(0,sa.default)(o.prefix),a=s[0],c=s[1],u=s[2],l=u===je.code?je:await e?.getHasher(u);if(l==null)throw new Cr("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");let h=await l.digest(o.data),d=x.create(a,c,h);i.addBlock(d,o.data)})),i.setPendingBytes(t.pendingBytes)),i)};B.blockPresenceSize=r=>r.bytes.length+1;var hi=class extends Map{constructor(e){super();let{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){let t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}};function Oe(r){let{name:e,metrics:t}=r,n;return t!=null?n=new hi({name:e,metrics:t}):n=new Map,n}var aa={Block:G.Wantlist.WantType.Block,Have:G.Wantlist.WantType.Have},Wf=(r,e)=>Array.prototype.slice.call(e,0).sort((t,n)=>{let i=r(t),o=r(n);return i<o?-1:i>o?1:0}),Ee=class{constructor(e,t){this.set=t!=null?Oe({name:"ipfs_bitswap_wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,n){let i=e.toString(E),o=this.set.get(i);o!=null?(o.inc(),o.priority=t,o.wantType===aa.Have&&n===aa.Block&&(o.wantType=n)):(this.set.set(i,new Ke(e,t,n)),this._stats!=null&&this._stats.push(void 0,"wantListSize",1))}remove(e){let t=e.toString(E),n=this.set.get(t);n!=null&&(n.dec(),!n.hasRefs()&&(this.set.delete(t),this._stats!=null&&this._stats.push(void 0,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(Wf(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString(E);return this.set.has(t)}get(e){let t=e.toString(E);return this.set.get(t)}};Ee.Entry=Ke;var ca=Math.pow(2,31)-1,ua=1e3,la=1;var fa=Hf;function Hf(r,e,t){var n=null,i=null,o=function(){n&&(clearTimeout(n),i=null,n=null)},s=function(){var c=i;o(),c&&c()},a=function(){if(!e)return r.apply(this,arguments);var c=this,u=arguments,l=t&&!n;if(o(),i=function(){r.apply(c,u)},n=setTimeout(function(){if(n=null,!l){var h=i;return i=null,h()}},e),l)return i()};return a.cancel=o,a.flush=s,a}var Lr=class{constructor(e,t,n){this.peerId=t,this.network=n,this.refcnt=1,this._entries=[],this._log=ae(e,"msgqueue"),this.sendEntries=fa(this.sendEntries.bind(this),la)}addMessage(e,t={}){e.empty||this.send(e,t)}addEntries(e,t={}){this._entries=this._entries.concat(e),this.sendEntries(t)}sendEntries(e={}){if(this._entries.length===0)return;let t=new B(!1);this._entries.forEach(n=>{n.cancel===!0?t.cancel(n.cid):t.addEntry(n.cid,n.priority)}),this._entries=[],this.addMessage(t,e)}async send(e,t={}){try{await this.network.connectTo(this.peerId,t)}catch(n){this._log.error("cant connect to peer %p: %s",this.peerId,n.message);return}this._log("sending message to peer %p",this.peerId),this.network.sendMessage(this.peerId,e,t).catch(n=>{this._log.error("send error",n)})}};var Pr=class{constructor(e,t,n,i){this.peers=Oe({name:"ipfs_bitswap_want_manager_peers",metrics:i.metrics}),this.wantlist=new Ee(n,i),this.network=t,this._peerId=e,this._log=ae(e,"want")}_addEntries(e,t,n,i={}){let o=e.map((s,a)=>new B.Entry(s,ca-a,B.WantType.Block,t));o.forEach(s=>{s.cancel?n===!0?this.wantlist.removeForce(s.cid.toString(E)):this.wantlist.remove(s.cid):(this._log("adding to wantlist"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(o,i)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t!=null){t.refcnt++;return}t=new Lr(this._peerId,e,this.network);let n=new B(!0);for(let i of this.wantlist.entries())n.addEntry(i[1].cid,i[1].priority);return t.addMessage(n),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toString());t!=null&&(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1,!1,t),t.signal?.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>{this.disconnected(e.peerId)})}};function rt(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Se(r=0){return globalThis.Buffer?.alloc!=null?rt(globalThis.Buffer.alloc(r)):new Uint8Array(r)}function pe(r=0){return globalThis.Buffer?.allocUnsafe!=null?rt(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function pi(r,e){e==null&&(e=r.reduce((i,o)=>i+o.length,0));let t=pe(e),n=0;for(let i of r)t.set(i,n),n+=i.length;return rt(t)}var da=Symbol.for("@achingbrain/uint8arraylist");function ha(r,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let t=0;for(let n of r){let i=t+n.byteLength;if(e<i)return{buf:n,index:e-t};t=i}throw new RangeError("index is out of bounds")}function Ir(r){return!!r?.[da]}var _e=class{constructor(...e){Object.defineProperty(this,da,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(let n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else if(Ir(n))t+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(let n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else if(Ir(n))t+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}get(e){let t=ha(this.bufs,e);return t.buf[t.index]}set(e,t){let n=ha(this.bufs,e);n.buf[n.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else if(Ir(e))for(let n=0;n<e.length;n++)this.set(t+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,t){let{bufs:n,length:i}=this._subList(e,t);return pi(n,i)}subarray(e,t){let{bufs:n,length:i}=this._subList(e,t);return n.length===1?n[0]:pi(n,i)}sublist(e,t){let{bufs:n,length:i}=this._subList(e,t),o=new _e;return o.length=i,o.bufs=n,o}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(e===0&&t===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],a=i,c=a+s.byteLength;if(i=c,e>=c)continue;let u=e>=a&&e<c,l=t>a&&t<=c;if(u&&l){if(e===a&&t===c){n.push(s);break}let h=e-a;n.push(s.subarray(h,h+(t-e)));break}if(u){if(e===0){n.push(s);continue}n.push(s.subarray(e-a));continue}if(l){if(t===c){n.push(s);break}n.push(s.subarray(0,t-a));break}n.push(s)}return{bufs:n,length:t-e}}indexOf(e,t=0){if(!Ir(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),e.length===0)return t>this.length?this.length:t;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let h=0;h<o;h++)s[h]=-1;for(let h=0;h<i;h++)s[n[h]]=h;let a=s,c=this.byteLength-n.byteLength,u=n.byteLength-1,l;for(let h=t;h<=c;h+=l){l=0;for(let d=u;d>=0;d--){let v=this.get(h+d);if(n[d]!==v){l=Math.max(1,d-a[v]);break}}if(l===0)return h}return-1}getInt8(e){let t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,t),this.write(n,e)}getInt16(e,t){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,t)}setInt16(e,t,n){let i=Se(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,t,n),this.write(i,e)}getInt32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,t)}setInt32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,t,n),this.write(i,e)}getBigInt64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,t)}setBigInt64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,t,n),this.write(i,e)}getUint8(e){let t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,t),this.write(n,e)}getUint16(e,t){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,t)}setUint16(e,t,n){let i=Se(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,t,n),this.write(i,e)}getUint32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,t)}setUint32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,t,n),this.write(i,e)}getBigUint64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,t)}setBigUint64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,t,n),this.write(i,e)}getFloat32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,t)}setFloat32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,t,n),this.write(i,e)}getFloat64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,t)}setFloat64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,t,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof _e)||e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!Qe(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){let n=new _e;return n.bufs=e,t==null&&(t=e.reduce((i,o)=>i+o.byteLength,0)),n.length=t,n}};function Nr(r){return r instanceof Uint8Array?{get(e){return r[e]},set(e,t){r[e]=t}}:{get(e){return r.get(e)},set(e,t){r.set(e,t)}}}var pa=4294967296,X=class{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let t=~this.lo+1>>>0,n=~this.hi>>>0;return t===0&&(n=n+1>>>0),-(BigInt(t)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),t=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new X(n,t)}zzEncode(){let e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new X(t,n)}toBytes(e,t=0){let n=Nr(e);for(;this.hi>0;)n.set(t++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(t++,this.lo&127|128),this.lo=this.lo>>>7;n.set(t++,this.lo)}static fromBigInt(e){if(e===0n)return new X;let t=e<0;t&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return t&&(n=~n>>>0,i=~i>>>0,++i>pa&&(i=0,++n>pa&&(n=0))),new X(n,i)}static fromNumber(e){if(e===0)return new X;let t=e<0;t&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new X(i,n)}static fromBytes(e,t=0){let n=Nr(e),i=new X,o=0;if(e.length-t>4){for(;o<4;++o)if(i.lo=(i.lo|(n.get(t)&127)<<o*7)>>>0,n.get(t++)<128)return i;if(i.lo=(i.lo|(n.get(t)&127)<<28)>>>0,i.hi=(i.hi|(n.get(t)&127)>>4)>>>0,n.get(t++)<128)return i;o=0}else for(;o<4;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(i.lo=(i.lo|(n.get(t)&127)<<o*7)>>>0,n.get(t++)<128)return i}if(e.length-t>4){for(;o<5;++o)if(i.hi=(i.hi|(n.get(t)&127)<<o*7+3)>>>0,n.get(t++)<128)return i}else if(t<e.byteLength)for(;o<5;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(i.hi=(i.hi|(n.get(t)&127)<<o*7+3)>>>0,n.get(t++)<128)return i}throw RangeError("invalid varint encoding")}};var qf=Math.pow(2,7),Vf=Math.pow(2,14),jf=Math.pow(2,21),Gf=Math.pow(2,28),Qf=Math.pow(2,35),Kf=Math.pow(2,42),Xf=Math.pow(2,49),Jf=Math.pow(2,56),Zf=Math.pow(2,63),nt={encodingLength(r){return r<qf?1:r<Vf?2:r<jf?3:r<Gf?4:r<Qf?5:r<Kf?6:r<Xf?7:r<Jf?8:r<Zf?9:10},encode(r,e,t=0){if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=pe(nt.encodingLength(r))),X.fromNumber(r).toBytes(e,t),e},decode(r,e=0){return X.fromBytes(r,e).toNumber(!0)}};function Dr(r){return r[Symbol.asyncIterator]!=null}var Mr=r=>{let e=nt.encodingLength(r),t=pe(e);return nt.encode(r,t),Mr.bytes=e,t};Mr.bytes=0;function Fr(r,e){e=e??{};let t=e.lengthEncoder??Mr;function*n(i){let o=t(i.byteLength);o instanceof Uint8Array?yield o:yield*o,i instanceof Uint8Array?yield i:yield*i}return Dr(r)?async function*(){for await(let i of r)yield*n(i)}():function*(){for(let i of r)yield*n(i)}()}Fr.single=(r,e)=>{e=e??{};let t=e.lengthEncoder??Mr;return new _e(t(r.byteLength),r)};var vt=U(Or(),1);var eh=8,th=1024*1024*4,it;(function(r){r[r.LENGTH=0]="LENGTH",r[r.DATA=1]="DATA"})(it||(it={}));var mi=r=>{let e=nt.decode(r);return mi.bytes=nt.encodingLength(e),e};mi.bytes=0;function Vt(r,e){let t=new _e,n=it.LENGTH,i=-1,o=e?.lengthDecoder??mi,s=e?.maxLengthLength??eh,a=e?.maxDataLength??th;function*c(){for(;t.byteLength>0;){if(n===it.LENGTH)try{if(i=o(t),i<0)throw(0,vt.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,vt.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=o.bytes;t.consume(u),e?.onLength!=null&&e.onLength(i),n=it.DATA}catch(u){if(u instanceof RangeError){if(t.byteLength>s)throw(0,vt.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(n===it.DATA){if(t.byteLength<i)break;let u=t.sublist(0,i);t.consume(i),e?.onData!=null&&e.onData(u),yield u,n=it.LENGTH}}}return Dr(r)?async function*(){for await(let u of r)t.append(u),yield*c();if(t.byteLength>0)throw(0,vt.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let u of r)t.append(u),yield*c();if(t.byteLength>0)throw(0,vt.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Vt.fromReader=(r,e)=>{let t=1,n=async function*(){for(;;)try{let{done:o,value:s}=await r.next(t);if(o===!0)return;s!=null&&(yield s)}catch(o){if(o.code==="ERR_UNDER_READ")return{done:!0,value:null};throw o}finally{t=1}}();return Vt(n,{...e??{},onLength:o=>{t=o}})};var Ur=class{constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},xt=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Ur(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new Ur(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function kt(r={}){return nh(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function nh(r,e){e=e??{};let t=e.onEnd,n=new xt,i,o,s,a=async()=>n.isEmpty()?s?{done:!0}:await new Promise((g,k)=>{o=I=>{o=null,n.push(I);try{g(r(n))}catch(O){k(O)}return i}}):r(n),c=g=>o!=null?o(g):(n.push(g),i),u=g=>(n=new xt,o!=null?o({error:g}):(n.push({error:g}),i)),l=g=>{if(s)return i;if(e?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:g})},h=g=>s?i:(s=!0,g!=null?u(g):c({done:!0})),d=()=>(n=new xt,h(),{done:!0}),v=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:d,throw:v,push:l,end:h,get readableLength(){return n.size}},t==null)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),t!=null&&(t(g),t=void 0),{done:!0}},return(){return y.return(),t!=null&&(t(),t=void 0),{done:!0}},push:l,end(g){return y.end(g),t!=null&&(t(g),t=void 0),i},get readableLength(){return y.readableLength}},i}function ih(r){return r[Symbol.asyncIterator]!=null}function oh(...r){let e=[];for(let t of r)ih(t)||e.push(t);return e.length===r.length?function*(){for(let t of e)yield*t}():async function*(){let t=kt({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(r.map(async n=>{for await(let i of n)t.push(i)})),t.end()}catch(n){t.end(n)}}),yield*t}()}var Rr=oh;function gi(r,...e){if(r==null)throw new Error("Empty pipeline");if(yi(r)){let n=r;r=()=>n.source}else if(wa(r)||ga(r)){let n=r;r=()=>n}let t=[r,...e];if(t.length>1&&yi(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)yi(t[n])&&(t[n]=ah(t[n]));return sh(...t)}var sh=(...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e},ga=r=>r?.[Symbol.asyncIterator]!=null,wa=r=>r?.[Symbol.iterator]!=null,yi=r=>r==null?!1:r.sink!=null&&r.source!=null,ah=r=>e=>{let t=r.sink(e);if(t?.then!=null){let n=kt({objectMode:!0});t.then(()=>{n.end()},s=>{n.end(s)});let i,o=r.source;if(ga(o))i=async function*(){yield*o,n.end()};else if(wa(o))i=function*(){yield*o,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return Rr(n,i())}return r.source};var wi=Symbol.for("@libp2p/topology");var ba=()=>{},bi=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??ba,this.onDisconnect=e.onDisconnect??ba}get[Symbol.toStringTag](){return wi.toString()}get[wi](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function _a(r){return new bi(r)}var La=U(Aa(),1);var Gt=class extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}};function Ba(r){if(r!=null){if(typeof r[Symbol.iterator]=="function")return r[Symbol.iterator]();if(typeof r[Symbol.asyncIterator]=="function")return r[Symbol.asyncIterator]();if(typeof r.next=="function")return r}throw new Error("argument is not an iterator or iterable")}function Ca(r,e,t){let n=t??{},i=Ba(r);async function*o(){let s,a=()=>{s?.()};for(e.addEventListener("abort",a);;){let c;try{if(e.aborted){let{abortMessage:l,abortCode:h}=n;throw new Gt(l,h)}let u=new Promise((l,h)=>{s=()=>{let{abortMessage:d,abortCode:v}=n;h(new Gt(d,v))}});c=await Promise.race([u,i.next()]),s=null}catch(u){e.removeEventListener("abort",a);let l=u.type==="aborted"&&e.aborted;if(l&&n.onAbort!=null&&await n.onAbort(r),typeof i.return=="function")try{let h=i.return();h instanceof Promise&&h.catch(d=>{n.onReturnError!=null&&n.onReturnError(d)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(l&&n.returnOnAbort===!0)return;throw u}if(c.done===!0)break;yield c.value}e.removeEventListener("abort",a)}return o()}var C=class extends Event{constructor(e,t){super(e),this.detail=t}};function lh(r){return r[Symbol.asyncIterator]!=null}function fh(r,e){return lh(r)?async function*(){let t=0;if(!(e<1)){for await(let n of r)if(yield n,t++,t===e)return}}():function*(){let t=0;if(!(e<1)){for(let n of r)if(yield n,t++,t===e)return}}()}var Et=fh;function hh(r){return r[Symbol.asyncIterator]!=null}function dh(r){if(hh(r))return(async()=>{for await(let e of r);})();for(let e of r);}var Ue=dh;function ph(r){let[e,t]=r[Symbol.asyncIterator]!=null?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:i=>{n.push(i)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[t](){return this}}}var St=ph;function mh(r){return r[Symbol.asyncIterator]!=null}function yh(r,e){if(mh(r))return async function*(){for await(let a of r)yield e(a)}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();let o=e(n);if(typeof o.then=="function")return async function*(){yield await o;for await(let a of t)yield e(a)}();let s=e;return function*(){yield o;for(let a of t)yield s(a)}()}var vi=yh;var xi="/ipfs/bitswap/1.0.0",ki="/ipfs/bitswap/1.1.0",Ei="/ipfs/bitswap/1.2.0",wh=32,bh=128,_h=3e4,$r=class{constructor(e,t,n,i={}){this._log=ae(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[xi],i.b100Only!==!0&&(this._protocols.unshift(ki),this._protocols.unshift(Ei)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=i.hashLoader??{async getHasher(){throw new Error("Not implemented")}},this._maxInboundStreams=i.maxInboundStreams??wh,this._maxOutboundStreams=i.maxOutboundStreams??bh,this._incomingStreamTimeout=i.incomingStreamTimeout??_h}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});let e=_a({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(let t of this._protocols)this._registrarIds.push(await this._libp2p.register(t,e));this._libp2p.getConnections().forEach(t=>{this._onPeerConnect(t.remotePeer)})}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarIds!=null){for(let e of this._registrarIds)this._libp2p.unregister(e);this._registrarIds=[]}}_onConnection(e){if(!this._running)return;let{stream:t,connection:n}=e,i=new La.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then(async()=>{this._log("incoming new bitswap %s connection from %p",t.stat.protocol,n.remotePeer),await gi(Ca(t.source,i.signal),o=>Vt(o),async o=>{for await(let s of o){try{let a=await B.deserialize(s.subarray(),this._hashLoader);await this._bitswap._receiveMessage(n.remotePeer,a)}catch(a){this._bitswap._receiveError(a);break}i.reset()}})}).catch(o=>{this._log(o),t.abort(o)}).finally(()=>{i.clear(),t.close()})}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return t.onProgress?.(new C("bitswap:network:find-providers",e)),this._libp2p.contentRouting.findProviders(e,t)}async findAndConnect(e,t){await Ue(Et(vi(this.findProviders(e,t),async n=>await this.connectTo(n.id,t).catch(i=>{this._log.error(i)})),3)).catch(n=>{this._log.error(n)})}async provide(e,t={}){t.onProgress?.(new C("bitswap:network:provide",e)),await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t,n={}){if(!this._running)throw new Error("network isn't running");let i=e.toString();this._log("sendMessage to %s",i,t),n.onProgress?.(new C("bitswap:network:send-wantlist",e)),await this._writeMessage(e,t,n),this._updateSentStats(e,t.blocks)}async connectTo(e,t={}){if(!this._running)throw new Error("network isn't running");return t.onProgress?.(new C("bitswap:network:dial",e)),await this._libp2p.dial(e,t)}_updateSentStats(e,t){let n=e.toString();if(this._stats!=null){for(let i of t.values())this._stats.push(n,"dataSent",i.length);this._stats.push(n,"blocksSent",t.size)}}async _writeMessage(e,t,n={}){let i=await this._libp2p.dialProtocol(e,[Ei,ki,xi]);try{let o;switch(i.stat.protocol){case xi:o=t.serializeToBitswap100();break;case ki:case Ei:o=t.serializeToBitswap110();break;default:throw new Error(`Unknown protocol: ${i.stat.protocol}`)}await gi([o],s=>Fr(s),i)}catch(o){n.onProgress?.(new C("bitswap:network:send-wantlist:error",{peer:e,error:o})),this._log(o)}finally{i.close()}}};var Wr=class{constructor(e){this.partner=e,this.wantlist=new Ee,this.exchangeCount=0,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,n){this.wantlist.add(e,t,n)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};var Qt=class extends Map{constructor(e,t){super(),this._cmp=t??this._defaultSort,this._keys=[];for(let[n,i]of e??[])this.set(n,i)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let n=this._find(t);this._keys.splice(n,0,t)}set(e,t){if(this.has(e)){let i=this.indexOf(e);this._keys.splice(i,1)}super.set(e,t);let n=this._find(e);return this._keys.splice(n,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let n=1;n<this._keys.length;n++){if(this._keys[t+n]===e)return t+n;if(this._keys[t-n]===e)return t-n}return-1}_find(e){let t=0,n=this._keys.length;for(;t<n;){let i=t+n>>>1,o=this._kCmp(this._keys[i],e);if(o<0)t=i+1;else if(o>0)n=i;else return i}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t=this){if(e!=null)for(let n of this._keys){let i=this.get(n);if(i==null)throw new Error("Value cannot be undefined");e.apply(t,[[n,i]])}}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}};var vh={hasNewInfo(){return!1},merge(){}},Hr=class{constructor(e=vh){this._taskMerger=e,this._byPeer=new Qt([],qr.compare)}pushTasks(e,t){let n=this._byPeer.get(e.toString());n==null&&(n=new qr(e,this._taskMerger)),n.pushTasks(t),this._byPeer.set(e.toString(),n)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:n,pendingSize:i}=t.popTasks(e);if(n.length===0)return{tasks:n,pendingSize:i};let o=t.peerId;return t.isIdle()?this._byPeer.delete(o.toString()):this._byPeer.update(0),{peerId:o,tasks:n,pendingSize:i}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){this._byPeer.get(t.toString())?.remove(e)}tasksDone(e,t){let n=this._byPeer.get(e.toString());if(n==null)return;let i=this._byPeer.indexOf(e.toString());for(let o of t)n.taskDone(o);this._byPeer.update(i)}},qr=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new Si,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t!=null){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let n of this._active)n.topic===e.topic&&t.push(n);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,n=[],i=this._pending.tasks();for(let o=0;o<i.length&&t<e;o++){let s=i[o];n.push(s),t+=s.size,this._pending.delete(s.topic),this._activeTotalSize+=s.size,this._active.add(s)}return{tasks:n,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},Si=class{constructor(){this._tasks=new Qt([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return this._tasks?.get(e)?.task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let n=this._tasks.get(e);if(n==null)return;let i=this._tasks.indexOf(e);n.task.priority=t,this._tasks.update(i)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};var Pa={hasNewInfo(r,e){let t=!1,n=!1;for(let i of e)i.data.haveBlock&&(t=!0),i.data.isWantBlock&&(n=!0);return!!(!n&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){let t=r.data,n=e.data;!n.haveBlock&&t.haveBlock&&(n.haveBlock=t.haveBlock,n.blockSize=t.blockSize),!n.isWantBlock&&t.isWantBlock&&(n.isWantBlock=!0,(!n.haveBlock||t.haveBlock)&&(n.haveBlock=t.haveBlock,e.size=r.size)),n.isWantBlock&&n.haveBlock&&(e.size=n.blockSize)}};var Ia=B.WantType,xh=16*1024,kh=1024,Vr=class{constructor(e,t,n,i,o,s={}){this._log=ae(e,"engine"),this.blockstore=t,this.network=n,this._stats=i,this._opts=this._processOpts(s),this.ledgerMap=Oe({name:"ipfs_bitswap_ledger_map",metrics:o.metrics}),this._running=!1,this._requestQueue=new Hr(Pa)}_processOpts(e){return{maxSizeReplaceHasWithBlock:kh,targetMessageSize:xh,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks().catch(e=>{this._log.error("error processing stats",e)})})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:n}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let i=new B(!1);i.setPendingBytes(n);let o=[],s=new Map;for(let c of t){let u=x.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(o.push(u),s.set(c.topic,c.data)):i.addHave(u):i.addDontHave(u)}let a=await this._getBlocks(o);for(let[c,u]of s){let l=x.parse(c),h=a.get(c);h!=null?i.addBlock(l,h):u.sendDontHave&&i.addDontHave(l)}if(i.empty){e!=null&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e!=null&&await this.network.sendMessage(e,i);for(let[c,u]of a.entries())e!=null&&this.messageSent(e,x.parse(c),u)}catch(c){this._log.error(c)}e!=null&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toString(),n=this.ledgerMap.get(t);return n!=null?n.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toString(),n=this.ledgerMap.get(t);if(n!=null)return{peer:n.partner,value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(e.length!==0){for(let t of this.ledgerMap.values())for(let{cid:n,block:i}of e){let o=t.wantlistContains(n);if(o==null)continue;let s=i.length,a=this._sendAsBlock(o.wantType,s),c=s;a||(c=B.blockPresenceSize(o.cid)),this._requestQueue.pushTasks(t.partner,[{topic:o.cid.toString(E),priority:o.priority,size:c,data:{blockSize:s,isWantBlock:a,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){let n=this._findOrCreate(e);if(t.empty)return;if(t.full&&(n.wantlist=new Ee),this._updateBlockAccounting(t.blocks,n),t.wantlist.size===0){this._scheduleProcessTasks();return}let i=[],o=[];t.wantlist.forEach(s=>{s.cancel?(n.cancelWant(s.cid),i.push(s.cid)):(n.wants(s.cid,s.priority,s.wantType),o.push(s))}),this._cancelWants(e,i),await this._addWants(e,o),this._scheduleProcessTasks()}_cancelWants(e,t){for(let n of t)this._requestQueue.remove(n.toString(E),e)}async _addWants(e,t){let n=await this._getBlockSizes(t.map(o=>o.cid)),i=[];for(let o of t){let s=o.cid.toString(E),a=n.get(s);if(a==null)o.sendDontHave&&i.push({topic:s,priority:o.priority,size:B.blockPresenceSize(o.cid),data:{isWantBlock:o.wantType===Ia.Block,blockSize:0,haveBlock:!1,sendDontHave:o.sendDontHave}});else{let c=this._sendAsBlock(o.wantType,a),u=a;c||(u=B.blockPresenceSize(o.cid)),i.push({topic:s,priority:o.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:o.sendDontHave}})}this._requestQueue.pushTasks(e,i)}}_sendAsBlock(e,t){return e===Ia.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([n,i])=>[n,i.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async n=>{try{let i=await this.blockstore.get(n);t.set(n.toString(E),i)}catch(i){i.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",n,i)}})),t}_updateBlockAccounting(e,t){for(let n of e.values())this._log("got block (%s bytes)",n.length),t.receivedBytes(n.length)}messageSent(e,t,n){let i=this._findOrCreate(e);i.sentBytes(n.length),i.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){let t=e.toString(),n=this.ledgerMap.get(t);if(n!=null)return n;let i=new Wr(e);return this.ledgerMap.set(t,i),this._stats!=null&&this._stats.push(t,"peerCount",1),i}start(){this._running=!0}stop(){this._running=!1}};var Qa=U(Qr(),1);var Ai={};V(Ai,{identity:()=>Lh});var Lh=pt({prefix:"\0",name:"identity",encode:r=>So(r),decode:r=>Eo(r)});var Bi={};V(Bi,{base2:()=>Ph});var Ph=D({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ci={};V(Ci,{base8:()=>Ih});var Ih=D({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Li={};V(Li,{base10:()=>Nh});var Nh=Ne({prefix:"9",name:"base10",alphabet:"0123456789"});var Pi={};V(Pi,{base16:()=>Dh,base16upper:()=>Mh});var Dh=D({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mh=D({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ii={};V(Ii,{base36:()=>Kt,base36upper:()=>Fh});var Kt=Ne({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Fh=Ne({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ni={};V(Ni,{base256emoji:()=>$h});var Ha=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Oh=Ha.reduce((r,e,t)=>(r[t]=e,r),[]),Uh=Ha.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Rh(r){return r.reduce((e,t)=>(e+=Oh[t],e),"")}function zh(r){let e=[];for(let t of r){let n=Uh[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}var $h=pt({prefix:"\u{1F680}",name:"base256emoji",encode:Rh,decode:zh});var Kr=85;var Ng=new TextEncoder,Dg=new TextDecoder;var Mi={...Ai,...Bi,...Ci,...Li,...Pi,...qn,...Ii,...Hn,...Kn,...Ni},Rg={...Un,...Dn};function Va(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var qa=Va("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Fi=Va("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=pe(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Hh={utf8:qa,"utf-8":qa,hex:Mi.base16,latin1:Fi,ascii:Fi,binary:Fi,...Mi},Xr=Hh;function ot(r,e="utf8"){let t=Xr[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var ja=r=>`unwant:${ot(r.multihash.bytes,"base64")}`,Ga=r=>`block:${ot(r.multihash.bytes,"base64")}`,Jr=class extends Qa.EventEmitter{constructor(e){super(),this.setMaxListeners(ua),this._log=ae(e,"notif")}hasBlock(e,t){let n=Ga(e);this._log(n),this.emit(n,t)}async wantBlock(e,t={}){if(e==null)throw new Error("Not a valid cid");let n=Ga(e),i=ja(e);return this._log(`wantBlock:${e}`),await new Promise((o,s)=>{let a=()=>{this.removeListener(n,c),t.onProgress?.(new C("bitswap:want-block:unwant",e)),s(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(i,a),t.onProgress?.(new C("bitswap:want-block:block",e)),o(u)};this.once(i,a),this.once(n,c),t.signal?.addEventListener("abort",()=>{this.removeListener(n,c),this.removeListener(i,a),s(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=ja(e);this._log(t),this.emit(t)}};var ec=U(Qr(),1);var Za=U(Qr(),1),Oi=U(Ja(),1),Xt=class extends Za.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(n=>{this._stats[n]=BigInt(0),this._movingAverages[n]={},this._options.movingAverageIntervals.forEach(i=>{(this._movingAverages[n][i]=(0,Oi.default)(i)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._enabled=!1}stop(){this._timeout!=null&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout!=null&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=void 0,this._queue.length>0){let e;for(;this._queue.length>0;){let t=e=this._queue.shift();t!=null&&this._applyOp(t)}e!=null&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t>0&&Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,n){let i=this._frequencyAccumulators[e]??0;this._frequencyAccumulators[e]=0;let o=i/t*1e3,s=this._movingAverages[e];s==null&&(s=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=s[a];c==null&&(c=s[a]=(0,Oi.default)(a)),c.push(n,o)})}_applyOp(e){let t=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(n),this._frequencyAccumulators[t]==null&&(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=n}};var Ya={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},Zr=class extends ec.EventEmitter{constructor(e,t=[],n=Ya){super();let i=Object.assign({},Ya,n);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=i,this._enabled=this._options.enabled,this._global=new Xt(t,i),this._global.on("update",o=>this.emit("update",o)),this._peers=Oe({name:"ipfs_bitswap_stats_peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=e.toString();return this._peers.get(t)}push(e,t,n){if(this._enabled&&(this._global.push(t,n),e!=null)){let i=this._peers.get(e);i==null&&(i=new Xt(this._initialCounters,this._options),this._peers.set(e,i)),i.push(t,n)}}disconnected(e){let t=e.toString(),n=this._peers.get(t);n!=null&&(n.stop(),this._peers.delete(t))}};var nc=U(rc(),1);function Vh(r){return r[Symbol.asyncIterator]!=null}function jh(r,e){if(Vh(r))return async function*(){for await(let a of r)await e(a),yield a}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();if(typeof e(n)?.then=="function")return async function*(){yield n;for await(let a of t)await e(a),yield a}();let s=e;return function*(){yield n;for(let a of t)s(a),yield a}()}var Jt=jh;var Gh={async getHasher(){throw new Error("Not implemented")}},Qh={maxInboundStreams:32,maxOutboundStreams:128,incomingStreamTimeout:3e4,hashLoader:Gh,statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},Kh=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],Yr=class{constructor(e,t,n={}){this._libp2p=e,this._log=ae(this.peerId),this._options=Object.assign({},Qh,n),this.stats=new Zr(e,Kh,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new $r(e,this,this.stats,{hashLoader:n.hashLoader,maxInboundStreams:n.maxInboundStreams,maxOutboundStreams:n.maxOutboundStreams,incomingStreamTimeout:n.incomingStreamTimeout}),this.blockstore=t,this.engine=new Vr(this.peerId,t,this.network,this.stats,e),this.wm=new Pr(this.peerId,this.network,this.stats,e),this.notifications=new Jr(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch{this._log("failed to receive message",t)}if(t.blocks.size===0)return;let n=[];for(let[i,o]of t.blocks.entries()){let s=x.parse(i);n.push({wasWanted:this.wm.wantlist.contains(s),cid:s,data:o})}this.wm.cancelWants(n.filter(({wasWanted:i})=>i).map(({cid:i})=>i)),await Promise.all(n.map(async({cid:i,wasWanted:o,data:s})=>{await this._handleReceivedBlock(e,i,s,o)}))}async _handleReceivedBlock(e,t,n,i){this._log("received block");let o=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,n,o),i&&await this.put(t,n)}_updateReceiveCounters(e,t,n,i){this.stats.push(e,"blocksReceived",1),this.stats.push(e,"dataReceived",n.length),i&&(this.stats.push(e,"dupBlksReceived",1),this.stats.push(e,"dupDataReceived",n.length))}_receiveError(e){this._log.error("ReceiveError",e)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this.stats.disconnected(e)}enableStats(){this.stats.enable()}disableStats(){this.stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async want(e,t={}){let n=async(c,u)=>(this.wm.wantBlocks([c],u),await this.notifications.wantBlock(c,u)),i=!1,o=async(c,u)=>{try{return await this.blockstore.get(c,u)}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l;return i||(i=!0,this.network.findAndConnect(c,u).catch(h=>{this._log.error(h)})),await n(c,u)}},s=new AbortController,a=t.signal!=null?(0,nc.anySignal)([t.signal,s.signal]):s.signal;try{return await Promise.race([this.notifications.wantBlock(e,{...t,signal:a}),o(e,{...t,signal:a})])}finally{s.abort()}}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(n=>{this.notifications.unwantBlock(n)})}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,n){await this.blockstore.put(e,t),this.notify(e,t)}async*putMany(e,t){yield*this.blockstore.putMany(Jt(e,({cid:n,block:i})=>{this.notify(n,i)}),t)}notify(e,t,n={}){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,block:t}]),this.network.provide(e,n).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}get peers(){return this.engine.peers()}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this.stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}};var ic=(r,e,t={})=>new Yr(r,e,t);function Xh(r){return r[Symbol.asyncIterator]!=null}function Jh(r,e){if(Xh(r))return async function*(){for await(let a of r)await e(a)&&(yield a)}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();let o=e(n);if(typeof o.then=="function")return async function*(){await o&&(yield n);for await(let a of t)await e(a)&&(yield a)}();let s=e;return function*(){o===!0&&(yield n);for(let a of t)s(a)&&(yield a)}()}var ve=Jh;var mc=U(sc(),1);var Yt=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},zi=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},ac=r=>globalThis.DOMException===void 0?new zi(r):new DOMException(r),cc=r=>{let e=r.reason===void 0?ac("This operation was aborted."):r.reason;return e instanceof Error?e:ac(e)};function $i(r,e,t,n){let i,o=new Promise((s,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(r);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:c}=n;c.aborted&&a(cc(c)),c.addEventListener("abort",()=>{a(cc(c))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{s(t())}catch(l){a(l)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,u=t instanceof Error?t:new Yt(c);typeof r.cancel=="function"&&r.cancel(),a(u)},e),(async()=>{try{s(await r)}catch(c){a(c)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return o.clear=()=>{clearTimeout(i),i=void 0},o}function Wi(r,e,t){let n=0,i=r.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;t(r[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var st=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Te,er=class{constructor(){Te.set(this,[])}enqueue(e,t){t={priority:0,...t};let n={priority:t.priority,run:e};if(this.size&&st(this,Te,"f")[this.size-1].priority>=t.priority){st(this,Te,"f").push(n);return}let i=Wi(st(this,Te,"f"),n,(o,s)=>s.priority-o.priority);st(this,Te,"f").splice(i,0,n)}dequeue(){let e=st(this,Te,"f").shift();return e?.run}filter(e){return st(this,Te,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return st(this,Te,"f").length}};Te=new WeakMap;var N=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},b=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},F,rr,nr,ze,an,ir,tn,me,tr,J,rn,Z,or,Re,nn,uc,lc,dc,fc,hc,on,Hi,qi,cn,pc,sn,un=class extends Error{},Ae=class extends mc.default{constructor(e){var t,n,i,o;if(super(),F.add(this),rr.set(this,void 0),nr.set(this,void 0),ze.set(this,0),an.set(this,void 0),ir.set(this,void 0),tn.set(this,0),me.set(this,void 0),tr.set(this,void 0),J.set(this,void 0),rn.set(this,void 0),Z.set(this,0),or.set(this,void 0),Re.set(this,void 0),nn.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:er,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);N(this,rr,e.carryoverConcurrencyCount,"f"),N(this,nr,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),N(this,an,e.intervalCap,"f"),N(this,ir,e.interval,"f"),N(this,J,new e.queueClass,"f"),N(this,rn,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,N(this,nn,e.throwOnTimeout===!0,"f"),N(this,Re,e.autoStart===!1,"f")}get concurrency(){return b(this,or,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);N(this,or,e,"f"),b(this,F,"m",cn).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:b(this,nn,"f"),...t},new Promise((n,i)=>{b(this,J,"f").enqueue(async()=>{var o,s,a;N(this,Z,(s=b(this,Z,"f"),s++,s),"f"),N(this,ze,(a=b(this,ze,"f"),a++,a),"f");try{if(!((o=t.signal)===null||o===void 0)&&o.aborted)throw new un("The task was aborted.");let c=e({signal:t.signal});t.timeout&&(c=$i(Promise.resolve(c),t.timeout)),t.signal&&(c=Promise.race([c,b(this,F,"m",pc).call(this,t.signal)]));let u=await c;n(u),this.emit("completed",u)}catch(c){if(c instanceof Yt&&!t.throwOnTimeout){n();return}i(c),this.emit("error",c)}finally{b(this,F,"m",dc).call(this)}},t),this.emit("add"),b(this,F,"m",on).call(this)})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return b(this,Re,"f")?(N(this,Re,!1,"f"),b(this,F,"m",cn).call(this),this):this}pause(){N(this,Re,!0,"f")}clear(){N(this,J,new(b(this,rn,"f")),"f")}async onEmpty(){b(this,J,"f").size!==0&&await b(this,F,"m",sn).call(this,"empty")}async onSizeLessThan(e){b(this,J,"f").size<e||await b(this,F,"m",sn).call(this,"next",()=>b(this,J,"f").size<e)}async onIdle(){b(this,Z,"f")===0&&b(this,J,"f").size===0||await b(this,F,"m",sn).call(this,"idle")}get size(){return b(this,J,"f").size}sizeBy(e){return b(this,J,"f").filter(e).length}get pending(){return b(this,Z,"f")}get isPaused(){return b(this,Re,"f")}};rr=new WeakMap,nr=new WeakMap,ze=new WeakMap,an=new WeakMap,ir=new WeakMap,tn=new WeakMap,me=new WeakMap,tr=new WeakMap,J=new WeakMap,rn=new WeakMap,Z=new WeakMap,or=new WeakMap,Re=new WeakMap,nn=new WeakMap,F=new WeakSet,uc=function(){return b(this,nr,"f")||b(this,ze,"f")<b(this,an,"f")},lc=function(){return b(this,Z,"f")<b(this,or,"f")},dc=function(){var e;N(this,Z,(e=b(this,Z,"f"),e--,e),"f"),b(this,F,"m",on).call(this),this.emit("next")},fc=function(){b(this,F,"m",qi).call(this),b(this,F,"m",Hi).call(this),N(this,tr,void 0,"f")},hc=function(){let e=Date.now();if(b(this,me,"f")===void 0){let t=b(this,tn,"f")-e;if(t<0)N(this,ze,b(this,rr,"f")?b(this,Z,"f"):0,"f");else return b(this,tr,"f")===void 0&&N(this,tr,setTimeout(()=>{b(this,F,"m",fc).call(this)},t),"f"),!0}return!1},on=function(){if(b(this,J,"f").size===0)return b(this,me,"f")&&clearInterval(b(this,me,"f")),N(this,me,void 0,"f"),this.emit("empty"),b(this,Z,"f")===0&&this.emit("idle"),!1;if(!b(this,Re,"f")){let e=!b(this,F,"a",hc);if(b(this,F,"a",uc)&&b(this,F,"a",lc)){let t=b(this,J,"f").dequeue();return t?(this.emit("active"),t(),e&&b(this,F,"m",Hi).call(this),!0):!1}}return!1},Hi=function(){b(this,nr,"f")||b(this,me,"f")!==void 0||(N(this,me,setInterval(()=>{b(this,F,"m",qi).call(this)},b(this,ir,"f")),"f"),N(this,tn,Date.now()+b(this,ir,"f"),"f"))},qi=function(){b(this,ze,"f")===0&&b(this,Z,"f")===0&&b(this,me,"f")&&(clearInterval(b(this,me,"f")),N(this,me,void 0,"f")),N(this,ze,b(this,rr,"f")?b(this,Z,"f"):0,"f"),b(this,F,"m",cn).call(this)},cn=function(){for(;b(this,F,"m",on).call(this););},pc=async function(e){return new Promise((t,n)=>{e.addEventListener("abort",()=>{n(new un("The task was aborted."))},{once:!0})})},sn=async function(e,t){return new Promise(n=>{let i=()=>{t&&!t()||(this.off(e,i),n())};this.on(e,i)})};var Vi=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},ji=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},yc=r=>globalThis.DOMException===void 0?new ji(r):new DOMException(r),gc=r=>{let e=r.reason===void 0?yc("This operation was aborted."):r.reason;return e instanceof Error?e:yc(e)};function Gi(r,e){let{milliseconds:t,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=e,s,a=new Promise((c,u)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){c(r);return}if(e.signal){let{signal:h}=e;h.aborted&&u(gc(h)),h.addEventListener("abort",()=>{u(gc(h))})}let l=new Vi;s=o.setTimeout.call(void 0,()=>{if(n){try{c(n())}catch(h){u(h)}return}typeof r.cancel=="function"&&r.cancel(),i===!1?c():i instanceof Error?u(i):(l.message=i??`Promise timed out after ${t} milliseconds`,u(l))},t),(async()=>{try{c(await r)}catch(h){u(h)}finally{o.clearTimeout.call(void 0,s)}})()});return a.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},a}var wc=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");var Qi="lock:worker:request-read",Ki="lock:worker:release-read",Xi="lock:master:grant-read",Ji="lock:worker:request-write",Zi="lock:worker:release-write",Yi="lock:master:grant-write";var $e={},At=r=>{r.addEventListener("message",e=>{At.dispatchEvent("message",r,e)}),r.port!=null&&r.port.addEventListener("message",e=>{At.dispatchEvent("message",r,e)})};At.addEventListener=(r,e)=>{$e[r]==null&&($e[r]=[]),$e[r].push(e)};At.removeEventListener=(r,e)=>{$e[r]!=null&&($e[r]=$e[r].filter(t=>t===e))};At.dispatchEvent=function(r,e,t){$e[r]!=null&&$e[r].forEach(n=>n(e,t))};var eo=At;var bc=(r,e,t,n,i)=>(o,s)=>{if(s.data.type!==t)return;let a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};r.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:async()=>(o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise(c=>{let u=l=>{if(l==null||l.data==null)return;let h={type:l.data.type,name:l.data.name,identifier:l.data.identifier};h.type===n&&h.identifier===a.identifier&&(o.removeEventListener("message",u),c())};o.addEventListener("message",u)}))}}))},_c=(r,e,t,n)=>async()=>{let i=wc();return globalThis.postMessage({type:e,identifier:i,name:r}),await new Promise(o=>{let s=a=>{if(a==null||a.data==null)return;let c={type:a.data.type,identifier:a.data.identifier};c.type===t&&c.identifier===i&&(globalThis.removeEventListener("message",s),o(()=>{globalThis.postMessage({type:n,identifier:i,name:r})}))};globalThis.addEventListener("message",s)})},ed={singleProcess:!1},vc=r=>{if(r=Object.assign({},ed,r),!!globalThis.document||r.singleProcess){let t=new EventTarget;return eo.addEventListener("message",bc(t,"requestReadLock",Qi,Ki,Xi)),eo.addEventListener("message",bc(t,"requestWriteLock",Ji,Zi,Yi)),t}return{isWorker:!0,readLock:t=>_c(t,Qi,Xi,Ki),writeLock:t=>_c(t,Ji,Yi,Zi)}};var at={},We;async function to(r,e){let t,n=new Promise(i=>{t=i});return r.add(async()=>await Gi((async()=>await new Promise(i=>{t(()=>{i()})}))(),{milliseconds:e.timeout})),await n}var td=(r,e)=>{if(We.isWorker===!0)return{readLock:We.readLock(r,e),writeLock:We.writeLock(r,e)};let t=new Ae({concurrency:1}),n;return{async readLock(){if(n!=null)return await to(n,e);n=new Ae({concurrency:e.concurrency,autoStart:!1});let i=n,o=to(n,e);return t.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await o},async writeLock(){return n=null,await to(t,e)}}},rd={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function ro(r){let e=Object.assign({},rd,r);return We==null&&(We=vc(e),We.isWorker!==!0&&(We.addEventListener("requestReadLock",t=>{at[t.data.name]!=null&&at[t.data.name].readLock().then(async n=>await t.data.handler().finally(()=>n()))}),We.addEventListener("requestWriteLock",async t=>{at[t.data.name]!=null&&at[t.data.name].writeLock().then(async n=>await t.data.handler().finally(()=>n()))}))),at[e.name]==null&&(at[e.name]=td(e.name,e)),at[e.name]}var ln=class{constructor(e,t,n={}){this.child=e,this.bitswap=n.bitswap,this.pins=t,this.lock=ro({singleProcess:n.holdGcLock})}unwrap(){return this.child}async put(e,t,n={}){let i=await this.lock.readLock();try{return await this.child.has(e)?(n.onProgress?.(new C("blocks:put:duplicate",e)),e):(this.bitswap?.isStarted()===!0&&(n.onProgress?.(new C("blocks:put:bitswap:notify",e)),this.bitswap.notify(e,t,n)),n.onProgress?.(new C("blocks:put:blockstore:put",e)),await this.child.put(e,t,n))}finally{i()}}async*putMany(e,t={}){let n=await this.lock.readLock();try{let i=ve(e,async({cid:s})=>{let a=await this.child.has(s);return a&&t.onProgress?.(new C("blocks:put-many:duplicate",s)),!a}),o=Jt(i,({cid:s,block:a})=>{t.onProgress?.(new C("blocks:put-many:bitswap:notify",s)),this.bitswap?.notify(s,a,t)});t.onProgress?.(new C("blocks:put-many:blockstore:put-many")),yield*this.child.putMany(o,t)}finally{n()}}async get(e,t={}){let n=await this.lock.readLock();try{if(this.bitswap?.isStarted()!=null&&!await this.child.has(e)){t.onProgress?.(new C("blocks:get:bitswap:get",e));let i=await this.bitswap.want(e,t);return t.onProgress?.(new C("blocks:get:blockstore:put",e)),await this.child.put(e,i,t),i}return t.onProgress?.(new C("blocks:get:blockstore:get",e)),await this.child.get(e,t)}finally{n()}}async*getMany(e,t={}){let n=await this.lock.readLock();try{t.onProgress?.(new C("blocks:get-many:blockstore:get-many")),yield*this.child.getMany(Jt(e,async i=>{if(this.bitswap?.isStarted()===!0&&!await this.child.has(i)){t.onProgress?.(new C("blocks:get-many:bitswap:get",i));let o=await this.bitswap.want(i,t);t.onProgress?.(new C("blocks:get-many:blockstore:put",i)),await this.child.put(i,o,t)}}))}finally{n()}}async delete(e,t={}){let n=await this.lock.writeLock();try{if(await this.pins.isPinned(e))throw new Error("CID was pinned");t.onProgress?.(new C("blocks:delete:blockstore:delete",e)),await this.child.delete(e,t)}finally{n()}}async*deleteMany(e,t={}){let n=await this.lock.writeLock();try{let i=this;t.onProgress?.(new C("blocks:delete-many:blockstore:delete-many")),yield*this.child.deleteMany(async function*(){for await(let o of e){if(await i.pins.isPinned(o))throw new Error("CID was pinned");yield o}}(),t)}finally{n()}}async has(e,t={}){let n=await this.lock.readLock();try{return await this.child.has(e,t)}finally{n()}}async*getAll(e={}){let t=await this.lock.readLock();try{e.onProgress?.(new C("blocks:get-all:blockstore:get-many")),yield*this.child.getAll(e)}finally{t()}}};var xc=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");function fn(r,e="utf8"){let t=Xr[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rt(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}var Be="/",kc=new TextEncoder().encode(Be),hn=kc[0],P=class{constructor(e,t){if(typeof e=="string")this._buf=fn(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==hn)throw new Error("Invalid key")}toString(e="utf8"){return ot(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new P(e.join(Be))}static random(){return new P(xc().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new P(e):typeof e.uint8Array=="function"?new P(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=kc),this._buf[0]!==hn){let e=new Uint8Array(this._buf.byteLength+1);e.fill(hn,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===hn;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return P.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Be).slice(1)}type(){return nd(this.baseNamespace())}name(){return id(this.baseNamespace())}instance(e){return new P(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Be)||(e+=Be),e+=this.type(),new P(e)}parent(){let e=this.list();return e.length===1?new P(Be):new P(e.slice(0,-1).join(Be))}child(e){return this.toString()===Be?e:e.toString()===Be?this:new P(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return P.withNamespaces([...this.namespaces(),...od(e.map(t=>t.namespaces()))])}};function nd(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function id(r){let e=r.split(":");return e[e.length-1]}function od(r){return[].concat(...r)}var sd=["string","number","bigint","symbol"],ad=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Ec(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(sd.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(cd(r))return"Buffer";let t=ud(r);return t||"Object"}function cd(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function ud(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(ad.includes(e))return e}var f=class{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};f.uint=new f(0,"uint",!0);f.negint=new f(1,"negint",!0);f.bytes=new f(2,"bytes",!0);f.string=new f(3,"string",!0);f.array=new f(4,"array",!1);f.map=new f(5,"map",!1);f.tag=new f(6,"tag",!1);f.float=new f(7,"float",!0);f.false=new f(7,"false",!0);f.true=new f(7,"true",!0);f.null=new f(7,"null",!0);f.undefined=new f(7,"undefined",!0);f.break=new f(7,"break",!0);var p=class{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var Bt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",ld=new TextDecoder,fd=new TextEncoder;function dn(r){return Bt&&globalThis.Buffer.isBuffer(r)}function sr(r){return r instanceof Uint8Array?dn(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}var Bc=Bt?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):Tc(r,e,t):(r,e,t)=>t-e>64?ld.decode(r.subarray(e,t)):Tc(r,e,t),pn=Bt?r=>r.length>64?globalThis.Buffer.from(r):Sc(r):r=>r.length>64?fd.encode(r):Sc(r),xe=r=>Uint8Array.from(r),Ct=Bt?(r,e,t)=>dn(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),Cc=Bt?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),sr(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),n=0;for(let i of r)n+i.length>t.length&&(i=i.subarray(0,t.length-n)),t.set(i,n),n+=i.length;return t},Lc=Bt?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);function Pc(r,e){if(dn(r)&&dn(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function Sc(r,e=1/0){let t,n=r.length,i=null,o=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Tc(r,e,t){let n=[];for(;e<t;){let i=r[e],o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=t){let a,c,u,l;switch(s){case 1:i<128&&(o=i);break;case 2:a=r[e+1],(a&192)===128&&(l=(i&31)<<6|a&63,l>127&&(o=l));break;case 3:a=r[e+1],c=r[e+2],(a&192)===128&&(c&192)===128&&(l=(i&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:a=r[e+1],c=r[e+2],u=r[e+3],(a&192)===128&&(c&192)===128&&(u&192)===128&&(l=(i&15)<<18|(a&63)<<12|(c&63)<<6|u&63,l>65535&&l<1114112&&(o=l))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),e+=s}return no(n)}var Ac=4096;function no(r){let e=r.length;if(e<=Ac)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=Ac));return t}var hd=256,ar=class{constructor(e=hd){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let i=t.length-(this.maxCursor-this.cursor)-1;t.set(e,i)}else{if(t){let i=t.length-(this.maxCursor-this.cursor)-1;i<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,i),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=Lc(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ct(n,0,this.cursor)}else t=Cc(this.chunks,this.cursor);return e&&this.reset(),t}};var w="CBOR decode error:",Lt="CBOR encode error:",cr=[];cr[23]=1;cr[24]=2;cr[25]=3;cr[26]=5;cr[27]=9;function Ce(r,e,t){if(r.length-e<t)throw new Error(`${w} not enough data for type`)}var z=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Y(r,e,t){Ce(r,e,1);let n=r[e];if(t.strict===!0&&n<z[0])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function ee(r,e,t){Ce(r,e,2);let n=r[e]<<8|r[e+1];if(t.strict===!0&&n<z[1])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function te(r,e,t){Ce(r,e,4);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&n<z[2])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function re(r,e,t){Ce(r,e,8);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],i=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(t.strict===!0&&o<z[3])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(t.allowBigInt===!0)return o;throw new Error(`${w} integers outside of the safe integer range are not supported`)}function Ic(r,e,t,n){return new p(f.uint,Y(r,e+1,n),2)}function Nc(r,e,t,n){return new p(f.uint,ee(r,e+1,n),3)}function Dc(r,e,t,n){return new p(f.uint,te(r,e+1,n),5)}function Mc(r,e,t,n){return new p(f.uint,re(r,e+1,n),9)}function ue(r,e){return W(r,0,e.value)}function W(r,e,t){if(t<z[0]){let n=Number(t);r.push([e|n])}else if(t<z[1]){let n=Number(t);r.push([e|24,n])}else if(t<z[2]){let n=Number(t);r.push([e|25,n>>>8,n&255])}else if(t<z[3]){let n=Number(t);r.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(t);if(n<z[4]){let i=[e|27,0,0,0,0,0,0,0],o=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=o&255,o=o>>8,i[7]=o&255,o=o>>8,i[6]=o&255,o=o>>8,i[5]=o&255,i[4]=s&255,s=s>>8,i[3]=s&255,s=s>>8,i[2]=s&255,s=s>>8,i[1]=s&255,r.push(i)}else throw new Error(`${w} encountered BigInt larger than allowable range`)}}ue.encodedSize=function(e){return W.encodedSize(e.value)};W.encodedSize=function(e){return e<z[0]?1:e<z[1]?2:e<z[2]?3:e<z[3]?5:9};ue.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function Fc(r,e,t,n){return new p(f.negint,-1-Y(r,e+1,n),2)}function Oc(r,e,t,n){return new p(f.negint,-1-ee(r,e+1,n),3)}function Uc(r,e,t,n){return new p(f.negint,-1-te(r,e+1,n),5)}var io=BigInt(-1),Rc=BigInt(1);function zc(r,e,t,n){let i=re(r,e+1,n);if(typeof i!="bigint"){let o=-1-i;if(o>=Number.MIN_SAFE_INTEGER)return new p(f.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${w} integers outside of the safe integer range are not supported`);return new p(f.negint,io-BigInt(i),9)}function mn(r,e){let t=e.value,n=typeof t=="bigint"?t*io-Rc:t*-1-1;W(r,e.type.majorEncoded,n)}mn.encodedSize=function(e){let t=e.value,n=typeof t=="bigint"?t*io-Rc:t*-1-1;return n<z[0]?1:n<z[1]?2:n<z[2]?3:n<z[3]?5:9};mn.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function ur(r,e,t,n){Ce(r,e,t+n);let i=Ct(r,e+t,e+t+n);return new p(f.bytes,i,t+n)}function $c(r,e,t,n){return ur(r,e,1,t)}function Wc(r,e,t,n){return ur(r,e,2,Y(r,e+1,n))}function Hc(r,e,t,n){return ur(r,e,3,ee(r,e+1,n))}function qc(r,e,t,n){return ur(r,e,5,te(r,e+1,n))}function Vc(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer bytes lengths not supported`);return ur(r,e,9,i)}function yn(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===f.string?pn(r.value):r.value),r.encodedBytes}function Pt(r,e){let t=yn(e);W(r,e.type.majorEncoded,t.length),r.push(t)}Pt.encodedSize=function(e){let t=yn(e);return W.encodedSize(t.length)+t.length};Pt.compareTokens=function(e,t){return pd(yn(e),yn(t))};function pd(r,e){return r.length<e.length?-1:r.length>e.length?1:Pc(r,e)}function lr(r,e,t,n,i){let o=t+n;Ce(r,e,o);let s=new p(f.string,Bc(r,e+t,e+o),o);return i.retainStringBytes===!0&&(s.byteValue=Ct(r,e+t,e+o)),s}function jc(r,e,t,n){return lr(r,e,1,t,n)}function Gc(r,e,t,n){return lr(r,e,2,Y(r,e+1,n),n)}function Qc(r,e,t,n){return lr(r,e,3,ee(r,e+1,n),n)}function Kc(r,e,t,n){return lr(r,e,5,te(r,e+1,n),n)}function Xc(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer string lengths not supported`);return lr(r,e,9,i,n)}var Jc=Pt;function It(r,e,t,n){return new p(f.array,n,t)}function Zc(r,e,t,n){return It(r,e,1,t)}function Yc(r,e,t,n){return It(r,e,2,Y(r,e+1,n))}function eu(r,e,t,n){return It(r,e,3,ee(r,e+1,n))}function tu(r,e,t,n){return It(r,e,5,te(r,e+1,n))}function ru(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer array lengths not supported`);return It(r,e,9,i)}function nu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return It(r,e,1,1/0)}function gn(r,e){W(r,f.array.majorEncoded,e.value)}gn.compareTokens=ue.compareTokens;gn.encodedSize=function(e){return W.encodedSize(e.value)};function Nt(r,e,t,n){return new p(f.map,n,t)}function iu(r,e,t,n){return Nt(r,e,1,t)}function ou(r,e,t,n){return Nt(r,e,2,Y(r,e+1,n))}function su(r,e,t,n){return Nt(r,e,3,ee(r,e+1,n))}function au(r,e,t,n){return Nt(r,e,5,te(r,e+1,n))}function cu(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer map lengths not supported`);return Nt(r,e,9,i)}function uu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return Nt(r,e,1,1/0)}function wn(r,e){W(r,f.map.majorEncoded,e.value)}wn.compareTokens=ue.compareTokens;wn.encodedSize=function(e){return W.encodedSize(e.value)};function lu(r,e,t,n){return new p(f.tag,t,1)}function fu(r,e,t,n){return new p(f.tag,Y(r,e+1,n),2)}function hu(r,e,t,n){return new p(f.tag,ee(r,e+1,n),3)}function du(r,e,t,n){return new p(f.tag,te(r,e+1,n),5)}function pu(r,e,t,n){return new p(f.tag,re(r,e+1,n),9)}function bn(r,e){W(r,f.tag.majorEncoded,e.value)}bn.compareTokens=ue.compareTokens;bn.encodedSize=function(e){return W.encodedSize(e.value)};var _d=20,vd=21,xd=22,kd=23;function mu(r,e,t,n){if(n.allowUndefined===!1)throw new Error(`${w} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new p(f.null,null,1):new p(f.undefined,void 0,1)}function yu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return new p(f.break,void 0,1)}function oo(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${w} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${w} Infinity values are not supported`)}return new p(f.float,r,e)}function gu(r,e,t,n){return oo(so(r,e+1),3,n)}function wu(r,e,t,n){return oo(ao(r,e+1),5,n)}function bu(r,e,t,n){return oo(ku(r,e+1),9,n)}function _n(r,e,t){let n=e.value;if(n===!1)r.push([f.float.majorEncoded|_d]);else if(n===!0)r.push([f.float.majorEncoded|vd]);else if(n===null)r.push([f.float.majorEncoded|xd]);else if(n===void 0)r.push([f.float.majorEncoded|kd]);else{let i,o=!1;(!t||t.float64!==!0)&&(vu(n),i=so(ye,1),n===i||Number.isNaN(n)?(ye[0]=249,r.push(ye.slice(0,3)),o=!0):(xu(n),i=ao(ye,1),n===i&&(ye[0]=250,r.push(ye.slice(0,5)),o=!0))),o||(Ed(n),i=ku(ye,1),ye[0]=251,r.push(ye.slice(0,9)))}}_n.encodedSize=function(e,t){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){vu(n);let i=so(ye,1);if(n===i||Number.isNaN(n))return 3;if(xu(n),i=ao(ye,1),n===i)return 5}return 9};var _u=new ArrayBuffer(9),le=new DataView(_u,1),ye=new Uint8Array(_u,0);function vu(r){if(r===1/0)le.setUint16(0,31744,!1);else if(r===-1/0)le.setUint16(0,64512,!1);else if(Number.isNaN(r))le.setUint16(0,32256,!1);else{le.setFloat32(0,r);let e=le.getUint32(0),t=(e&2139095040)>>23,n=e&8388607;if(t===255)le.setUint16(0,31744,!1);else if(t===0)le.setUint16(0,(r&2147483648)>>16|n>>13,!1);else{let i=t-127;i<-24?le.setUint16(0,0):i<-14?le.setUint16(0,(e&2147483648)>>16|1<<24+i,!1):le.setUint16(0,(e&2147483648)>>16|i+15<<10|n>>13,!1)}}}function so(r,e){if(r.length-e<2)throw new Error(`${w} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let n=t>>10&31,i=t&1023,o;return n===0?o=i*2**-24:n!==31?o=(i+1024)*2**(n-25):o=i===0?1/0:NaN,t&32768?-o:o}function xu(r){le.setFloat32(0,r,!1)}function ao(r,e){if(r.length-e<4)throw new Error(`${w} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function Ed(r){le.setFloat64(0,r,!1)}function ku(r,e){if(r.length-e<8)throw new Error(`${w} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}_n.compareTokens=ue.compareTokens;function A(r,e,t){throw new Error(`${w} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function vn(r){return()=>{throw new Error(`${w} ${r}`)}}var m=[];for(let r=0;r<=23;r++)m[r]=A;m[24]=Ic;m[25]=Nc;m[26]=Dc;m[27]=Mc;m[28]=A;m[29]=A;m[30]=A;m[31]=A;for(let r=32;r<=55;r++)m[r]=A;m[56]=Fc;m[57]=Oc;m[58]=Uc;m[59]=zc;m[60]=A;m[61]=A;m[62]=A;m[63]=A;for(let r=64;r<=87;r++)m[r]=$c;m[88]=Wc;m[89]=Hc;m[90]=qc;m[91]=Vc;m[92]=A;m[93]=A;m[94]=A;m[95]=vn("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)m[r]=jc;m[120]=Gc;m[121]=Qc;m[122]=Kc;m[123]=Xc;m[124]=A;m[125]=A;m[126]=A;m[127]=vn("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)m[r]=Zc;m[152]=Yc;m[153]=eu;m[154]=tu;m[155]=ru;m[156]=A;m[157]=A;m[158]=A;m[159]=nu;for(let r=160;r<=183;r++)m[r]=iu;m[184]=ou;m[185]=su;m[186]=au;m[187]=cu;m[188]=A;m[189]=A;m[190]=A;m[191]=uu;for(let r=192;r<=215;r++)m[r]=lu;m[216]=fu;m[217]=hu;m[218]=du;m[219]=pu;m[220]=A;m[221]=A;m[222]=A;m[223]=A;for(let r=224;r<=243;r++)m[r]=vn("simple values are not supported");m[244]=A;m[245]=A;m[246]=A;m[247]=mu;m[248]=vn("simple values are not supported");m[249]=gu;m[250]=wu;m[251]=bu;m[252]=A;m[253]=A;m[254]=A;m[255]=yu;var ge=[];for(let r=0;r<24;r++)ge[r]=new p(f.uint,r,1);for(let r=-1;r>=-24;r--)ge[31-r]=new p(f.negint,r,1);ge[64]=new p(f.bytes,new Uint8Array(0),1);ge[96]=new p(f.string,"",1);ge[128]=new p(f.array,0,1);ge[160]=new p(f.map,0,1);ge[244]=new p(f.false,!1,1);ge[245]=new p(f.true,!0,1);ge[246]=new p(f.null,null,1);function Eu(r){switch(r.type){case f.false:return xe([244]);case f.true:return xe([245]);case f.null:return xe([246]);case f.bytes:return r.value.length?void 0:xe([64]);case f.string:return r.value===""?xe([96]):void 0;case f.array:return r.value===0?xe([128]):void 0;case f.map:return r.value===0?xe([160]):void 0;case f.uint:return r.value<24?xe([Number(r.value)]):void 0;case f.negint:if(r.value>=-24)return xe([31-Number(r.value)])}}var Td={float64:!1,mapSorter:Cd,quickEncodeToken:Eu};function Ad(){let r=[];return r[f.uint.major]=ue,r[f.negint.major]=mn,r[f.bytes.major]=Pt,r[f.string.major]=Jc,r[f.array.major]=gn,r[f.map.major]=wn,r[f.tag.major]=bn,r[f.float.major]=_n,r}var Su=Ad(),co=new ar,Dt=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Lt} object contains circular references`);return new Dt(t,e)}},He={null:new p(f.null,null),undefined:new p(f.undefined,void 0),true:new p(f.true,!0),false:new p(f.false,!1),emptyArray:new p(f.array,0),emptyMap:new p(f.map,0)},qe={number(r,e,t,n){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new p(f.float,r):r>=0?new p(f.uint,r):new p(f.negint,r)},bigint(r,e,t,n){return r>=BigInt(0)?new p(f.uint,r):new p(f.negint,r)},Uint8Array(r,e,t,n){return new p(f.bytes,r)},string(r,e,t,n){return new p(f.string,r)},boolean(r,e,t,n){return r?He.true:He.false},null(r,e,t,n){return He.null},undefined(r,e,t,n){return He.undefined},ArrayBuffer(r,e,t,n){return new p(f.bytes,new Uint8Array(r))},DataView(r,e,t,n){return new p(f.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,n){if(!r.length)return t.addBreakTokens===!0?[He.emptyArray,new p(f.break)]:He.emptyArray;n=Dt.createCheck(n,r);let i=[],o=0;for(let s of r)i[o++]=xn(s,t,n);return t.addBreakTokens?[new p(f.array,r.length),i,new p(f.break)]:[new p(f.array,r.length),i]},Object(r,e,t,n){let i=e!=="Object",o=i?r.keys():Object.keys(r),s=i?r.size:o.length;if(!s)return t.addBreakTokens===!0?[He.emptyMap,new p(f.break)]:He.emptyMap;n=Dt.createCheck(n,r);let a=[],c=0;for(let u of o)a[c++]=[xn(u,t,n),xn(i?r.get(u):r[u],t,n)];return Bd(a,t),t.addBreakTokens?[new p(f.map,s),a,new p(f.break)]:[new p(f.map,s),a]}};qe.Map=qe.Object;qe.Buffer=qe.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))qe[`${r}Array`]=qe.DataView;function xn(r,e={},t){let n=Ec(r),i=e&&e.typeEncoders&&e.typeEncoders[n]||qe[n];if(typeof i=="function"){let s=i(r,n,e,t);if(s!=null)return s}let o=qe[n];if(!o)throw new Error(`${Lt} unsupported type: ${n}`);return o(r,n,e,t)}function Bd(r,e){e.mapSorter&&r.sort(e.mapSorter)}function Cd(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==n.type)return t.type.compare(n.type);let i=t.type.major,o=Su[i].compareTokens(t,n);return o===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function Tu(r,e,t,n){if(Array.isArray(e))for(let i of e)Tu(r,i,t,n);else t[e.type.major](r,e,n)}function Au(r,e,t){let n=xn(r,t);if(!Array.isArray(n)&&t.quickEncodeToken){let i=t.quickEncodeToken(n);if(i)return i;let o=e[n.type.major];if(o.encodedSize){let s=o.encodedSize(n,t),a=new ar(s);if(o(a,n,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return sr(a.chunks[0])}}return co.reset(),Tu(co,n,e,t),co.toBytes(!0)}function kn(r,e){return e=Object.assign({},Td,e),Au(r,Su,e)}var Ld={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},uo=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=ge[e];if(t===void 0){let n=m[e];if(!n)throw new Error(`${w} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;t=n(this.data,this.pos,i,this.options)}return this.pos+=t.encodedLength,t}},fr=Symbol.for("DONE"),En=Symbol.for("BREAK");function Pd(r,e,t){let n=[];for(let i=0;i<r.value;i++){let o=hr(e,t);if(o===En){if(r.value===1/0)break;throw new Error(`${w} got unexpected break to lengthed array`)}if(o===fr)throw new Error(`${w} found array but not enough entries (got ${i}, expected ${r.value})`);n[i]=o}return n}function Id(r,e,t){let n=t.useMaps===!0,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<r.value;s++){let a=hr(e,t);if(a===En){if(r.value===1/0)break;throw new Error(`${w} got unexpected break to lengthed map`)}if(a===fr)throw new Error(`${w} found map but not enough entries (got ${s} [no key], expected ${r.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${w} non-string keys not supported (got ${typeof a})`);if(t.rejectDuplicateMapKeys===!0&&(n&&o.has(a)||!n&&a in i))throw new Error(`${w} found repeat map key "${a}"`);let c=hr(e,t);if(c===fr)throw new Error(`${w} found map but not enough entries (got ${s} [no value], expected ${r.value})`);n?o.set(a,c):i[a]=c}return n?o:i}function hr(r,e){if(r.done())return fr;let t=r.next();if(t.type===f.break)return En;if(t.type.terminal)return t.value;if(t.type===f.array)return Pd(t,r,e);if(t.type===f.map)return Id(t,r,e);if(t.type===f.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let n=hr(r,e);return e.tags[t.value](n)}throw new Error(`${w} tag not supported (${t.value})`)}throw new Error("unsupported")}function Le(r,e){if(!(r instanceof Uint8Array))throw new Error(`${w} data to decode must be a Uint8Array`);e=Object.assign({},Ld,e);let t=e.tokenizer||new uo(r,e),n=hr(t,e);if(n===fr)throw new Error(`${w} did not find any content to decode`);if(n===En)throw new Error(`${w} got unexpected break`);if(!t.done())throw new Error(`${w} too many terminals, data makes no sense`);return n}function lo(){let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r}var Nd=new TextDecoder;function fo(r,e){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let i=r[e++];if(t+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[t,e]}function Sn(r,e){let t;[t,e]=fo(r,e);let n=e+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,n),n]}function Cu(r,e){let t;return[t,e]=fo(r,e),[t&7,t>>3,e]}function Dd(r){let e={},t=r.length,n=0;for(;n<t;){let i,o;if([i,o,n]=Cu(r,n),o===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Sn(r,n)}else if(o===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Sn(r,n),e.Name=Nd.decode(s)}else if(o===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[e.Tsize,n]=fo(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function Lu(r){let e=r.length,t=0,n,i=!1,o;for(;t<e;){let a,c;if([a,c,t]=Cu(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,t]=Sn(r,t),n&&(i=!0)}else if(c===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let u;[u,t]=Sn(r,t),n.push(Dd(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}var Xb=new TextEncoder,Jb=2**32,Zb=2**31;var t0=new TextEncoder;var Pu=112;function Iu(r){let e=Lu(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(n=>{let i={};try{i.Hash=x.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),t}var Nu=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){let t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===f.array&&(t.elements++,t.elements!==1&&e.push([44])),t.type===f.map&&(t.elements++,t.elements!==1&&(t.elements%2===1?e.push([44]):e.push([58]))))}[f.uint.major](e,t){this.prefix(e);let n=String(t.value),i=[];for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o);e.push(i)}[f.negint.major](e,t){this[f.uint.major](e,t)}[f.bytes.major](e,t){throw new Error(`${Lt} unsupported type: Uint8Array`)}[f.string.major](e,t){this.prefix(e);let n=pn(JSON.stringify(t.value));e.push(n.length>32?sr(n):n)}[f.array.major](e,t){this.prefix(e),this.inRecursive.push({type:f.array,elements:0}),e.push([91])}[f.map.major](e,t){this.prefix(e),this.inRecursive.push({type:f.map,elements:0}),e.push([123])}[f.tag.major](e,t){}[f.float.major](e,t){if(t.type.name==="break"){let s=this.inRecursive.pop();if(s){if(s.type===f.array)e.push([93]);else if(s.type===f.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${Lt} unsupported type: undefined`);if(this.prefix(e),t.type.name==="true"){e.push([116,114,117,101]);return}else if(t.type.name==="false"){e.push([102,97,108,115,101]);return}else if(t.type.name==="null"){e.push([110,117,108,108]);return}let n=String(t.value),i=[],o=!1;for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s),!o&&(i[s]===46||i[s]===101||i[s]===69)&&(o=!0);o||(i.push(46),i.push(48)),e.push(i)}};var Mt=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${w} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${w} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this.pos,t=!1,n=!1,i=a=>{for(;!this.done();){let c=this.ch();if(a.includes(c))this.pos++;else break}};if(this.ch()===45&&(t=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,n=!0;else return new p(f.uint,0,this.pos-e);if(i([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${w} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${w} unexpected token at position ${this.pos}`);n=!0,this.pos++,i([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,i([48,49,50,51,52,53,54,55,56,57]));let o=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),s=parseFloat(o);return n?new p(f.float,s,this.pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(s)?new p(s>=0?f.uint:f.negint,s,this.pos-e):new p(s>=0?f.uint:f.negint,BigInt(o),this.pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${w} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let o=this.pos,s=0;o<this.data.length&&s<65536;o++,s++){let a=this.data[o];if(a===92||a<32||a>=128)break;if(a===34){let c=String.fromCharCode.apply(null,this.data.subarray(this.pos,o));return this.pos=o+1,new p(f.string,c,s)}}let e=this.pos,t=[],n=()=>{if(this.pos+4>=this.data.length)throw new Error(`${w} unexpected end of unicode escape sequence at position ${this.pos}`);let o=0;for(let s=0;s<4;s++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${w} unexpected unicode escape character at position ${this.pos}`);o=o*16+a,this.pos++}return o},i=()=>{let o=this.ch(),s=null,a=o>239?4:o>223?3:o>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${w} unexpected unicode sequence at position ${this.pos}`);let c,u,l,h;switch(a){case 1:o<128&&(s=o);break;case 2:c=this.data[this.pos+1],(c&192)===128&&(h=(o&31)<<6|c&63,h>127&&(s=h));break;case 3:c=this.data[this.pos+1],u=this.data[this.pos+2],(c&192)===128&&(u&192)===128&&(h=(o&15)<<12|(c&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:c=this.data[this.pos+1],u=this.data[this.pos+2],l=this.data[this.pos+3],(c&192)===128&&(u&192)===128&&(l&192)===128&&(h=(o&15)<<18|(c&63)<<12|(u&63)<<6|l&63,h>65535&&h<1114112&&(s=h))}s===null?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|s&1023),t.push(s),this.pos+=a};for(;!this.done();){let o=this.ch(),s;switch(o){case 92:if(this.pos++,this.done())throw new Error(`${w} unexpected string termination at position ${this.pos}`);switch(s=this.ch(),this.pos++,s){case 34:case 39:case 92:case 47:t.push(s);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error(`${w} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new p(f.string,no(t),this.pos-e);default:if(o<32)throw new Error(`${w} invalid control character at position ${this.pos}`);o<128?(t.push(o),this.pos++):i()}}throw new Error(`${w} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new p(f.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new p(f.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new p(f.null,null,4);case 102:return this.expect([102,97,108,115,101]),new p(f.false,!1,5);case 116:return this.expect([116,114,117,101]),new p(f.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${w} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);if(this.ch()!==44)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new p(f.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);if(this.ch()!==44)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${w} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}};function ho(r,e){return e=Object.assign({tokenizer:new Mt(r,e)},e),Le(r,e)}var Du={codec:Pu,async*walk(r){yield*Iu(r).Links.map(t=>t.Hash)}},Mu={codec:Kr,async*walk(){}},Fu=42,Ou={codec:113,async*walk(r){let e=[],t=[];t[Fu]=n=>{if(n[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");let i=x.decode(n.subarray(1));return e.push(i),i},Le(r,{tags:t}),yield*e}},po=class extends Mt{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===f.map){let t=this._next();if(t.type===f.string&&t.value==="/"){let n=this._next();if(n.type===f.string){if(this._next().type!==f.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new p(f.tag,42,0)}if(n.type===f.map){let i=this._next();if(i.type===f.string&&i.value==="bytes"){let o=this._next();if(o.type===f.string){for(let a=0;a<2;a++)if(this._next().type!==f.break)throw new Error("Invalid encoded Bytes form");let s=Wt.decode(`m${o.value}`);return new p(f.bytes,s,o.value.length)}this.tokenBuffer.push(o)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(t)}return e}},Uu={codec:297,async*walk(r){let e=[],t=[];t[Fu]=n=>{let i=x.parse(n);return e.push(i),i},ho(r,{tags:t,tokenizer:new po(r,{tags:t,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})}),yield*e}};var Tn=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ft,mo,Ru,Od=[Mu,Du,Ou,Uu],Wu="/pin/",Hu="/pinned-block/",yo=Kt,zu=1;function $u(r){return r.version===0&&(r=r.toV1()),new P(`${Wu}${r.toString(yo)}`)}var An=class{constructor(e,t,n){Ft.add(this),this.datastore=e,this.blockstore=t,this.dagWalkers={},[...Od,...n].forEach(i=>{this.dagWalkers[i.codec]=i})}async add(e,t={}){let n=$u(e);if(await this.datastore.has(n))throw new Error("Already pinned");let i=Math.round(t.depth??1/0);if(i<0)throw new Error("Depth must be greater than or equal to 0");let o=new Ae({concurrency:zu});o.add(async()=>{await Tn(this,Ft,"m",mo).call(this,e,o,c=>{c.pinnedBy.find(u=>Qe(u,e.bytes))==null&&(c.pinCount++,c.pinnedBy.push(e.bytes))},{...t,depth:i})});let s=lo();o.on("error",c=>{o.clear(),s.reject(c)}),await Promise.race([o.onIdle(),s.promise]);let a={depth:i,metadata:t.metadata??{}};return await this.datastore.put(n,kn(a),t),{cid:e,...a}}async rm(e,t={}){let n=$u(e),i=await this.datastore.get(n,t),o=Le(i);await this.datastore.delete(n,t);let s=new Ae({concurrency:zu});return s.add(async()=>{await Tn(this,Ft,"m",mo).call(this,e,s,a=>{a.pinCount--,a.pinnedBy=a.pinnedBy.filter(c=>Qe(c,e.bytes))},{...t,depth:o.depth})}),await s.onIdle(),{cid:e,...o}}async*ls(e={}){for await(let{key:t,value:n}of this.datastore.query({prefix:Wu+(e.cid!=null?`${e.cid.toString(Kt)}`:"")},e)){let i=x.parse(t.toString().substring(5),Kt),o=Le(n);yield{cid:i,...o}}}async isPinned(e,t={}){let n=new P(`${Hu}${yo.encode(e.multihash.bytes)}`);return await this.datastore.has(n,t)}};Ft=new WeakSet,mo=async function r(e,t,n,i){if(i.depth===-1)return;let o=this.dagWalkers[e.code];if(o==null)throw new Error(`No dag walker found for cid codec ${e.code}`);let s=await this.blockstore.get(e);await Tn(this,Ft,"m",Ru).call(this,e,n,i);for await(let a of o.walk(s))t.add(async()=>{await Tn(this,Ft,"m",r).call(this,a,t,n,{...i,depth:i.depth-1})})},Ru=async function(e,t,n){let i=new P(`${Hu}${yo.encode(e.multihash.bytes)}`),o={pinCount:0,pinnedBy:[]};try{o=Le(await this.datastore.get(i,n))}catch(s){if(s.code!=="ERR_NOT_FOUND")throw s}if(t(o),o.pinCount===0&&await this.datastore.has(i)){await this.datastore.delete(i);return}await this.datastore.put(i,kn(o),n)};var go=new P("/version"),qu=1;async function Vu(r){if(!await r.has(go)){await r.put(go,fn(`${qu}`));return}let e=await r.get(go),t=ot(e);if(parseInt(t,10)!==qu)throw new Error("Unknown datastore version, a datastore migration may be required")}var ju=U(Or(),1);function Bn(r){return r=r??new Error("Not Found"),(0,ju.default)(r,"ERR_NOT_FOUND")}var Gu="SHARDING";function Rd(r){return r[Symbol.asyncIterator]!=null}function zd(r){if(Rd(r))return(async()=>{let t=[];for await(let n of r)t.push(n);return t})();let e=[];for(let t of r)e.push(t);return e}var wo=zd;function $d(r){return r[Symbol.asyncIterator]!=null}function Wd(r,e){return $d(r)?async function*(){yield*(await wo(r)).sort(e)}():function*(){yield*wo(r).sort(e)}()}var Cn=Wd;var Pe=class{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:n,value:i}of e)await this.put(n,i,t),yield n}async*getMany(e,t={}){for await(let n of e)yield{key:n,value:await this.get(n,t)}}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(n,i){e.push({key:n,value:i})},delete(n){t.push(n)},commit:async n=>{await Ue(this.putMany(e,n)),e=[],await Ue(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(e.prefix!=null){let i=e.prefix;n=ve(n,o=>o.key.toString().startsWith(i))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>ve(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>Cn(i,o),n)),e.offset!=null){let i=0,o=e.offset;n=ve(n,()=>i++>=o)}return e.limit!=null&&(n=Et(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(e.prefix!=null){let i=e.prefix;n=ve(n,o=>o.toString().startsWith(i))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>ve(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>Cn(i,o),n)),e.offset!=null){let i=e.offset,o=0;n=ve(n,()=>o++>=i)}return e.limit!=null&&(n=Et(n,e.limit)),n}};var pr=class extends Pe{constructor(){super(),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){let t=this.data.get(e.toString());if(t==null)throw Bn();return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(let[e,t]of this.data.entries())yield{key:new P(e),value:t}}*_allKeys(){for(let e of this.data.keys())yield new P(e)}};var d1=new P(Gu);var S1=wt("datastore:core:tiered");var Ln={};V(Ln,{abortedError:()=>Jd,closeFailedError:()=>jd,deleteFailedError:()=>Kd,getFailedError:()=>Qd,hasFailedError:()=>Xd,notFoundError:()=>bo,openFailedError:()=>Vd,putFailedError:()=>Gd});var Ie=U(Or(),1);function Vd(r){return r=r??new Error("Open failed"),(0,Ie.default)(r,"ERR_OPEN_FAILED")}function jd(r){return r=r??new Error("Close failed"),(0,Ie.default)(r,"ERR_CLOSE_FAILED")}function Gd(r){return r=r??new Error("Put failed"),(0,Ie.default)(r,"ERR_PUT_FAILED")}function Qd(r){return r=r??new Error("Get failed"),(0,Ie.default)(r,"ERR_GET_FAILED")}function Kd(r){return r=r??new Error("Delete failed"),(0,Ie.default)(r,"ERR_DELETE_FAILED")}function Xd(r){return r=r??new Error("Has failed"),(0,Ie.default)(r,"ERR_HAS_FAILED")}function bo(r){return r=r??new Error("Not Found"),(0,Ie.default)(r,"ERR_NOT_FOUND")}function Jd(r){return r=r??new Error("Aborted"),(0,Ie.default)(r,"ERR_ABORTED")}var mr=class{has(e,t){return Promise.reject(new Error(".has is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}async*putMany(e,t){for await(let{cid:n,block:i}of e)await this.put(n,i,t),yield n}get(e,t){return Promise.reject(new Error(".get is not implemented"))}async*getMany(e,t){for await(let n of e)yield{cid:n,block:await this.get(n,t)}}async delete(e,t){await Promise.reject(new Error(".delete is not implemented"))}async*deleteMany(e,t){for await(let n of e)await this.delete(n,t),yield n}async*getAll(e){throw new Error(".getAll is not implemented")}};var yr=class extends mr{constructor(){super(),this.data=new Map}put(e,t){return this.data.set(j.encode(e.multihash.bytes),t),e}get(e){let t=this.data.get(j.encode(e.multihash.bytes));if(t==null)throw bo();return t}has(e){return this.data.has(j.encode(e.multihash.bytes))}async delete(e){this.data.delete(j.encode(e.multihash.bytes))}async*getAll(){for(let[e,t]of this.data.entries())yield{cid:x.createV1(Kr,br(j.decode(e))),block:t}}};var G1={...Ln};var Zd=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},_o=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ot,vo=wt("helia"),Pn=class{constructor(e){Ot.set(this,void 0);let t=[je,On,Nn,...e.hashers??[]],n=e.datastore??new pr,i=e.blockstore??new yr,o=e.libp2p??new Proxy({},{get(s,a){let c=()=>{};if(["start","stop"].includes(a.toString()))return c;if(a==="isProxy")return!0;throw new Error("Please configure Helia with a libp2p instance")},set(){throw new Error("Please configure Helia with a libp2p instance")}});e.libp2p!=null&&Zd(this,Ot,ic(o,i,{hashLoader:{getHasher:async s=>{let a=t.find(c=>c.code===s||c.name===s);if(a!=null)return await Promise.resolve(a);throw new Error(`Could not load hasher for code/name "${s}"`)}}}),"f"),this.pins=new An(n,i,e.dagWalkers??[]),this.libp2p=o,this.blockstore=new ln(i,this.pins,{bitswap:_o(this,Ot,"f"),holdGcLock:e.holdGcLock}),this.datastore=n}async start(){await Vu(this.datastore),await _o(this,Ot,"f")?.start(),await this.libp2p.start()}async stop(){await this.libp2p.stop(),await _o(this,Ot,"f")?.stop()}async gc(e={}){let t=await this.blockstore.lock.writeLock();try{let n=this,i=this.blockstore.unwrap();vo("gc start"),await Ue(i.deleteMany(async function*(){for await(let{cid:o}of i.getAll())try{if(await n.pins.isPinned(o,e))continue;yield o,e.onProgress?.(new C("helia:gc:deleted",o))}catch(s){vo.error("Error during gc",s),e.onProgress?.(new C("helia:gc:error",s))}}()))}finally{t()}vo("gc finished")}};Ot=new WeakMap;async function Yd(r={}){let e=new Pn(r);return r.start!==!1&&await e.start(),e}return el(ep);})();
+"use strict";var Helia=(()=>{var Ku=Object.create;var gr=Object.defineProperty;var Xu=Object.getOwnPropertyDescriptor;var Ju=Object.getOwnPropertyNames;var Zu=Object.getPrototypeOf,Yu=Object.prototype.hasOwnProperty;var S=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),V=(r,e)=>{for(var t in e)gr(r,t,{get:e[t],enumerable:!0})},xo=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ju(e))!Yu.call(r,i)&&i!==t&&gr(r,i,{get:()=>e[i],enumerable:!(n=Xu(e,i))||n.enumerable});return r};var U=(r,e,t)=>(t=r!=null?Ku(Zu(r)):{},xo(e||!r||!r.__esModule?gr(t,"default",{value:r,enumerable:!0}):t,r)),el=r=>xo(gr({},"__esModule",{value:!0}),r);var Ho=S((bp,Wo)=>{Wo.exports=$o;var zo=128,zl=127,$l=~zl,Wl=Math.pow(2,31);function $o(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Wl;)e[t++]=r&255|zo,r/=128;for(;r&$l;)e[t++]=r&255|zo,r>>>=7;return e[t]=r|0,$o.bytes=t-n+1,e}});var jo=S((_p,Vo)=>{Vo.exports=jn;var Hl=128,qo=127;function jn(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw jn.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&qo)<<i:(s&qo)*Math.pow(2,i),i+=7}while(s>=Hl);return jn.bytes=o-n,t}});var Qo=S((vp,Go)=>{var ql=Math.pow(2,7),Vl=Math.pow(2,14),jl=Math.pow(2,21),Gl=Math.pow(2,28),Ql=Math.pow(2,35),Kl=Math.pow(2,42),Xl=Math.pow(2,49),Jl=Math.pow(2,56),Zl=Math.pow(2,63);Go.exports=function(r){return r<ql?1:r<Vl?2:r<jl?3:r<Gl?4:r<Ql?5:r<Kl?6:r<Xl?7:r<Jl?8:r<Zl?9:10}});var Xo=S((xp,Ko)=>{Ko.exports={encode:Ho(),decode:jo(),encodingLength:Qo()}});var Yo=S((kp,Zo)=>{"use strict";var Jo=Xo();Zo.exports=r=>{if(!(r instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;r.length>0;){let t=Jo.decode(r);e.push(t),r=r.slice(Jo.decode.bytes)}return e}});var rs=S((Ep,ts)=>{ts.exports=Gn;var es=128,Yl=127,ef=~Yl,tf=Math.pow(2,31);function Gn(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw Gn.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var n=t;r>=tf;)e[t++]=r&255|es,r/=128;for(;r&ef;)e[t++]=r&255|es,r>>>=7;return e[t]=r|0,Gn.bytes=t-n+1,e}});var os=S((Sp,is)=>{is.exports=Qn;var rf=128,ns=127;function Qn(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a||i>49)throw Qn.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&ns)<<i:(s&ns)*Math.pow(2,i),i+=7}while(s>=rf);return Qn.bytes=o-n,t}});var as=S((Tp,ss)=>{var nf=Math.pow(2,7),of=Math.pow(2,14),sf=Math.pow(2,21),af=Math.pow(2,28),cf=Math.pow(2,35),uf=Math.pow(2,42),lf=Math.pow(2,49),ff=Math.pow(2,56),hf=Math.pow(2,63);ss.exports=function(r){return r<nf?1:r<of?2:r<sf?3:r<af?4:r<cf?5:r<uf?6:r<lf?7:r<ff?8:r<hf?9:10}});var us=S((Ap,cs)=>{cs.exports={encode:rs(),decode:os(),encodingLength:as()}});var hs=S((Cp,fs)=>{var mt=1e3,yt=mt*60,gt=yt*60,Ge=gt*24,pf=Ge*7,mf=Ge*365.25;fs.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return yf(r);if(t==="number"&&isFinite(r))return e.long?wf(r):gf(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function yf(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*mf;case"weeks":case"week":case"w":return t*pf;case"days":case"day":case"d":return t*Ge;case"hours":case"hour":case"hrs":case"hr":case"h":return t*gt;case"minutes":case"minute":case"mins":case"min":case"m":return t*yt;case"seconds":case"second":case"secs":case"sec":case"s":return t*mt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function gf(r){var e=Math.abs(r);return e>=Ge?Math.round(r/Ge)+"d":e>=gt?Math.round(r/gt)+"h":e>=yt?Math.round(r/yt)+"m":e>=mt?Math.round(r/mt)+"s":r+"ms"}function wf(r){var e=Math.abs(r);return e>=Ge?_r(r,e,Ge,"day"):e>=gt?_r(r,e,gt,"hour"):e>=yt?_r(r,e,yt,"minute"):e>=mt?_r(r,e,mt,"second"):r+" ms"}function _r(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}});var ps=S((Lp,ds)=>{function bf(r){t.debug=t,t.default=t,t.coerce=c,t.disable=o,t.enable=i,t.enabled=s,t.humanize=hs(),t.destroy=u,Object.keys(r).forEach(l=>{t[l]=r[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let h=0;for(let d=0;d<l.length;d++)h=(h<<5)-h+l.charCodeAt(d),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(l){let h,d=null,v,y;function g(...k){if(!g.enabled)return;let I=g,O=Number(new Date),ne=O-(h||O);I.diff=ne,I.prev=h,I.curr=O,h=O,k[0]=t.coerce(k[0]),typeof k[0]!="string"&&k.unshift("%O");let $=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,(ie,Q)=>{if(ie==="%%")return"%";$++;let oe=t.formatters[Q];if(typeof oe=="function"){let ut=k[$];ie=oe.call(I,ut),k.splice($,1),$--}return ie}),t.formatArgs.call(I,k),(I.log||t.log).apply(I,k)}return g.namespace=l,g.useColors=t.useColors(),g.color=t.selectColor(l),g.extend=n,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(v!==t.namespaces&&(v=t.namespaces,y=t.enabled(l)),y),set:k=>{d=k}}),typeof t.init=="function"&&t.init(g),g}function n(l,h){let d=t(this.namespace+(typeof h>"u"?":":h)+l);return d.log=this.log,d}function i(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let h,d=(typeof l=="string"?l:"").split(/[\s,]+/),v=d.length;for(h=0;h<v;h++)d[h]&&(l=d[h].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.slice(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function o(){let l=[...t.names.map(a),...t.skips.map(a).map(h=>"-"+h)].join(",");return t.enable(""),l}function s(l){if(l[l.length-1]==="*")return!0;let h,d;for(h=0,d=t.skips.length;h<d;h++)if(t.skips[h].test(l))return!1;for(h=0,d=t.names.length;h<d;h++)if(t.names[h].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}ds.exports=bf});var ms=S((K,vr)=>{K.formatArgs=vf;K.save=xf;K.load=kf;K.useColors=_f;K.storage=Ef();K.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();K.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function _f(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function vf(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+vr.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(n=t))}),r.splice(n,0,e)}K.log=console.debug||console.log||(()=>{});function xf(r){try{r?K.storage.setItem("debug",r):K.storage.removeItem("debug")}catch{}}function kf(){let r;try{r=K.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function Ef(){try{return localStorage}catch{}}vr.exports=ps()(K);var{formatters:Sf}=vr.exports;Sf.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var gs=S((jp,ys)=>{"use strict";ys.exports=Lf;function Lf(r,e){for(var t=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)t[n++]=arguments[i++];return new Promise(function(a,c){t[n]=function(l){if(o)if(o=!1,l)c(l);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];a.apply(null,h)}};try{r.apply(e||null,t)}catch(u){o&&(o=!1,c(u))}})}});var vs=S(_s=>{"use strict";var kr=_s;kr.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&e.charAt(t)==="=";)++n;return Math.ceil(e.length*3)/4-n};var bt=new Array(64),bs=new Array(123);for(he=0;he<64;)bs[bt[he]=he<26?he+65:he<52?he+71:he<62?he-4:he-59|43]=he++;var he;kr.encode=function(e,t,n){for(var i=null,o=[],s=0,a=0,c;t<n;){var u=e[t++];switch(a){case 0:o[s++]=bt[u>>2],c=(u&3)<<4,a=1;break;case 1:o[s++]=bt[c|u>>4],c=(u&15)<<2,a=2;break;case 2:o[s++]=bt[c|u>>6],o[s++]=bt[u&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=bt[c],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var ws="invalid encoding";kr.decode=function(e,t,n){for(var i=n,o=0,s,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&o>1)break;if((c=bs[c])===void 0)throw Error(ws);switch(o){case 0:s=c,o=1;break;case 1:t[n++]=s<<2|(c&48)>>4,s=c,o=2;break;case 2:t[n++]=(s&15)<<4|(c&60)>>2,s=c,o=3;break;case 3:t[n++]=(s&3)<<6|c,o=0;break}}if(o===1)throw Error(ws);return n-i};kr.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var ks=S((Qp,xs)=>{"use strict";xs.exports=Er;function Er(){this._listeners={}}Er.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this};Er.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this};Er.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}});var Ls=S((Kp,Cs)=>{"use strict";Cs.exports=Es(Es);function Es(r){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),n=t[3]===128;function i(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3]}function o(c,u,l){e[0]=c,u[l]=t[3],u[l+1]=t[2],u[l+2]=t[1],u[l+3]=t[0]}r.writeFloatLE=n?i:o,r.writeFloatBE=n?o:i;function s(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],e[0]}function a(c,u){return t[3]=c[u],t[2]=c[u+1],t[1]=c[u+2],t[0]=c[u+3],e[0]}r.readFloatLE=n?s:a,r.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,o,s)}}r.writeFloatLE=e.bind(null,Ss),r.writeFloatBE=e.bind(null,Ts);function t(n,i,o){var s=n(i,o),a=(s>>31)*2+1,c=s>>>23&255,u=s&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}r.readFloatLE=t.bind(null,As),r.readFloatBE=t.bind(null,Bs)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),n=t[7]===128;function i(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3],u[l+4]=t[4],u[l+5]=t[5],u[l+6]=t[6],u[l+7]=t[7]}function o(c,u,l){e[0]=c,u[l]=t[7],u[l+1]=t[6],u[l+2]=t[5],u[l+3]=t[4],u[l+4]=t[3],u[l+5]=t[2],u[l+6]=t[1],u[l+7]=t[0]}r.writeDoubleLE=n?i:o,r.writeDoubleBE=n?o:i;function s(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],t[4]=c[u+4],t[5]=c[u+5],t[6]=c[u+6],t[7]=c[u+7],e[0]}function a(c,u){return t[7]=c[u],t[6]=c[u+1],t[5]=c[u+2],t[4]=c[u+3],t[3]=c[u+4],t[2]=c[u+5],t[1]=c[u+6],t[0]=c[u+7],e[0]}r.readDoubleLE=n?s:a,r.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,c){var u=s<0?1:0;if(u&&(s=-s),s===0)n(0,a,c+i),n(1/s>0?0:2147483648,a,c+o);else if(isNaN(s))n(0,a,c+i),n(2146959360,a,c+o);else if(s>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+o);else{var l;if(s<22250738585072014e-324)l=s/5e-324,n(l>>>0,a,c+i),n((u<<31|l/4294967296)>>>0,a,c+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),l=s*Math.pow(2,-h),n(l*4503599627370496>>>0,a,c+i),n((u<<31|h+1023<<20|l*1048576&1048575)>>>0,a,c+o)}}}r.writeDoubleLE=e.bind(null,Ss,0,4),r.writeDoubleBE=e.bind(null,Ts,4,0);function t(n,i,o,s,a){var c=n(s,a+i),u=n(s,a+o),l=(u>>31)*2+1,h=u>>>20&2047,d=4294967296*(u&1048575)+c;return h===2047?d?NaN:l*(1/0):h===0?l*5e-324*d:l*Math.pow(2,h-1075)*(d+4503599627370496)}r.readDoubleLE=t.bind(null,As,0,4),r.readDoubleBE=t.bind(null,Bs,4,0)}(),r}function Ss(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function Ts(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function As(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function Bs(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var Ps=S((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Ns=S(Is=>{"use strict";var Xn=Is;Xn.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?t+=1:n<2048?t+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};Xn.read=function(e,t,n){var i=n-t;if(i<1)return"";for(var o=null,s=[],a=0,c;t<n;)c=e[t++],c<128?s[a++]=c:c>191&&c<224?s[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[a++]=55296+(c>>10),s[a++]=56320+(c&1023)):s[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Xn.write=function(e,t,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128);return n-i}});var Ms=S((Jp,Ds)=>{"use strict";Ds.exports=Pf;function Pf(r,e,t){var n=t||8192,i=n>>>1,o=null,s=n;return function(c){if(c<1||c>i)return r(c);s+c>n&&(o=r(n),s=0);var u=e.call(o,s,s+=c);return s&7&&(s=(s|7)+1),u}}});var Os=S((Zp,Fs)=>{"use strict";Fs.exports=R;var Ht=Je();function R(r,e){this.lo=r>>>0,this.hi=e>>>0}var Xe=R.zero=new R(0,0);Xe.toNumber=function(){return 0};Xe.zzEncode=Xe.zzDecode=function(){return this};Xe.length=function(){return 1};var If=R.zeroHash="\0\0\0\0\0\0\0\0";R.fromNumber=function(e){if(e===0)return Xe;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new R(n,i)};R.from=function(e){if(typeof e=="number")return R.fromNumber(e);if(Ht.isString(e))if(Ht.Long)e=Ht.Long.fromString(e);else return R.fromNumber(parseInt(e,10));return e.low||e.high?new R(e.low>>>0,e.high>>>0):Xe};R.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+n*4294967296)}return this.lo+this.hi*4294967296};R.prototype.toLong=function(e){return Ht.Long?new Ht.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Me=String.prototype.charCodeAt;R.fromHash=function(e){return e===If?Xe:new R((Me.call(e,0)|Me.call(e,1)<<8|Me.call(e,2)<<16|Me.call(e,3)<<24)>>>0,(Me.call(e,4)|Me.call(e,5)<<8|Me.call(e,6)<<16|Me.call(e,7)<<24)>>>0)};R.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};R.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};R.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};R.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}});var Je=S(Jn=>{"use strict";var _=Jn;_.asPromise=gs();_.base64=vs();_.EventEmitter=ks();_.float=Ls();_.inquire=Ps();_.utf8=Ns();_.pool=Ms();_.LongBits=Os();_.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);_.global=_.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Jn;_.emptyArray=Object.freeze?Object.freeze([]):[];_.emptyObject=Object.freeze?Object.freeze({}):{};_.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};_.isString=function(e){return typeof e=="string"||e instanceof String};_.isObject=function(e){return e&&typeof e=="object"};_.isset=_.isSet=function(e,t){var n=e[t];return n!=null&&e.hasOwnProperty(t)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};_.Buffer=function(){try{var r=_.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();_._Buffer_from=null;_._Buffer_allocUnsafe=null;_.newBuffer=function(e){return typeof e=="number"?_.Buffer?_._Buffer_allocUnsafe(e):new _.Array(e):_.Buffer?_._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};_.Array=typeof Uint8Array<"u"?Uint8Array:Array;_.Long=_.global.dcodeIO&&_.global.dcodeIO.Long||_.global.Long||_.inquire("long");_.key2Re=/^true|false|0|1$/;_.key32Re=/^-?(?:0|[1-9][0-9]*)$/;_.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;_.longToHash=function(e){return e?_.LongBits.from(e).toHash():_.LongBits.zeroHash};_.longFromHash=function(e,t){var n=_.LongBits.fromHash(e);return _.Long?_.Long.fromBits(n.lo,n.hi,t):n.toNumber(!!t)};function Us(r,e,t){for(var n=Object.keys(e),i=0;i<n.length;++i)(r[n[i]]===void 0||!t)&&(r[n[i]]=e[n[i]]);return r}_.merge=Us;_.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Rs(r){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Us(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}_.newError=Rs;_.ProtocolError=Rs("ProtocolError");_.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(t[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};_.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}};_.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};_._configure=function(){var r=_.Buffer;if(!r){_._Buffer_from=_._Buffer_allocUnsafe=null;return}_._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,n){return new r(t,n)},_._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var ei=S((em,qs)=>{"use strict";qs.exports=M;var we=Je(),Yn,Ws=we.LongBits,Nf=we.utf8;function de(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function M(r){this.buf=r,this.pos=0,this.len=r.length}var zs=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new M(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new M(e);throw Error("illegal buffer")},Hs=function(){return we.Buffer?function(t){return(M.create=function(i){return we.Buffer.isBuffer(i)?new Yn(i):zs(i)})(t)}:zs};M.create=Hs();M.prototype._slice=we.Array.prototype.subarray||we.Array.prototype.slice;M.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,de(this,10);return e}}();M.prototype.int32=function(){return this.uint32()|0};M.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Zn(){var r=new Ws(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw de(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw de(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}M.prototype.bool=function(){return this.uint32()!==0};function Sr(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}M.prototype.fixed32=function(){if(this.pos+4>this.len)throw de(this,4);return Sr(this.buf,this.pos+=4)};M.prototype.sfixed32=function(){if(this.pos+4>this.len)throw de(this,4);return Sr(this.buf,this.pos+=4)|0};function $s(){if(this.pos+8>this.len)throw de(this,8);return new Ws(Sr(this.buf,this.pos+=4),Sr(this.buf,this.pos+=4))}M.prototype.float=function(){if(this.pos+4>this.len)throw de(this,4);var e=we.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};M.prototype.double=function(){if(this.pos+8>this.len)throw de(this,4);var e=we.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};M.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw de(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)};M.prototype.string=function(){var e=this.bytes();return Nf.read(e,0,e.length)};M.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw de(this,e);this.pos+=e}else do if(this.pos>=this.len)throw de(this);while(this.buf[this.pos++]&128);return this};M.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};M._configure=function(r){Yn=r,M.create=Hs(),Yn._configure();var e=we.Long?"toLong":"toNumber";we.merge(M.prototype,{int64:function(){return Zn.call(this)[e](!1)},uint64:function(){return Zn.call(this)[e](!0)},sint64:function(){return Zn.call(this).zzDecode()[e](!1)},fixed64:function(){return $s.call(this)[e](!0)},sfixed64:function(){return $s.call(this)[e](!1)}})}});var Qs=S((tm,Gs)=>{"use strict";Gs.exports=Ze;var js=ei();(Ze.prototype=Object.create(js.prototype)).constructor=Ze;var Vs=Je();function Ze(r){js.call(this,r)}Ze._configure=function(){Vs.Buffer&&(Ze.prototype._slice=Vs.Buffer.prototype.slice)};Ze.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ze._configure()});var ai=S((rm,Zs)=>{"use strict";Zs.exports=T;var ce=Je(),ti,Tr=ce.LongBits,Ks=ce.base64,Xs=ce.utf8;function qt(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function ni(){}function Df(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function T(){this.len=0,this.head=new qt(ni,0,0),this.tail=this.head,this.states=null}var Js=function(){return ce.Buffer?function(){return(T.create=function(){return new ti})()}:function(){return new T}};T.create=Js();T.alloc=function(e){return new ce.Array(e)};ce.Array!==Array&&(T.alloc=ce.pool(T.alloc,ce.Array.prototype.subarray));T.prototype._push=function(e,t,n){return this.tail=this.tail.next=new qt(e,t,n),this.len+=t,this};function ii(r,e,t){e[t]=r&255}function Mf(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function oi(r,e){this.len=r,this.next=void 0,this.val=e}oi.prototype=Object.create(qt.prototype);oi.prototype.fn=Mf;T.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new oi((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};T.prototype.int32=function(e){return e<0?this._push(si,10,Tr.fromNumber(e)):this.uint32(e)};T.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function si(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}T.prototype.uint64=function(e){var t=Tr.from(e);return this._push(si,t.length(),t)};T.prototype.int64=T.prototype.uint64;T.prototype.sint64=function(e){var t=Tr.from(e).zzEncode();return this._push(si,t.length(),t)};T.prototype.bool=function(e){return this._push(ii,1,e?1:0)};function ri(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}T.prototype.fixed32=function(e){return this._push(ri,4,e>>>0)};T.prototype.sfixed32=T.prototype.fixed32;T.prototype.fixed64=function(e){var t=Tr.from(e);return this._push(ri,4,t.lo)._push(ri,4,t.hi)};T.prototype.sfixed64=T.prototype.fixed64;T.prototype.float=function(e){return this._push(ce.float.writeFloatLE,4,e)};T.prototype.double=function(e){return this._push(ce.float.writeDoubleLE,8,e)};var Ff=ce.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};T.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(ii,1,0);if(ce.isString(e)){var n=T.alloc(t=Ks.length(e));Ks.decode(e,n,0),e=n}return this.uint32(t)._push(Ff,t,e)};T.prototype.string=function(e){var t=Xs.length(e);return t?this.uint32(t)._push(Xs.write,t,e):this._push(ii,1,0)};T.prototype.fork=function(){return this.states=new Df(this),this.head=this.tail=new qt(ni,0,0),this.len=0,this};T.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new qt(ni,0,0),this.len=0),this};T.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this};T.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t};T._configure=function(r){ti=r,T.create=Js(),ti._configure()}});var ta=S((nm,ea)=>{"use strict";ea.exports=be;var Ys=ai();(be.prototype=Object.create(Ys.prototype)).constructor=be;var Fe=Je();function be(){Ys.call(this)}be._configure=function(){be.alloc=Fe._Buffer_allocUnsafe,be.writeBytesBuffer=Fe.Buffer&&Fe.Buffer.prototype instanceof Uint8Array&&Fe.Buffer.prototype.set.name==="set"?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}};be.prototype.bytes=function(e){Fe.isString(e)&&(e=Fe._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(be.writeBytesBuffer,t,e),this};function Of(r,e,t){r.length<40?Fe.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}be.prototype.string=function(e){var t=Fe.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Of,t,e),this};be._configure()});var Or=S((by,ya)=>{"use strict";function ma(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Yf(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return ma(r,t)}catch{t.message=r.message,t.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),ma(new i,t)}}ya.exports=Yf});var xa=S((Oy,va)=>{"use strict";va.exports=function(){return Date.now()}});var Ea=S((Uy,ka)=>{"use strict";var zr=xa(),_i=class{constructor(e,t,n){let i=this;this._started=zr(),this._rescheduled=0,this._scheduled=t,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(zr()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=zr();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=zr(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function ch(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new _i(arguments[0],arguments[1],r)}ka.exports=ch});var Aa=S((Ry,Ta)=>{"use strict";var{AbortController:uh}=globalThis,Sa=Ea(),jt=class extends uh{constructor(e){super(),this._ms=e,this._timer=Sa(()=>this.abort(),e),Object.setPrototypeOf(this,jt.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=Sa(()=>this.abort(),this._ms)}};Ta.exports={TimeoutController:jt}});var Qr=S((kg,Ti)=>{"use strict";var Tt=typeof Reflect=="object"?Reflect:null,Na=Tt&&typeof Tt.apply=="function"?Tt.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},jr;Tt&&typeof Tt.ownKeys=="function"?jr=Tt.ownKeys:Object.getOwnPropertySymbols?jr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:jr=function(e){return Object.getOwnPropertyNames(e)};function Eh(r){console&&console.warn&&console.warn(r)}var Ma=Number.isNaN||function(e){return e!==e};function L(){L.init.call(this)}Ti.exports=L;Ti.exports.once=Bh;L.EventEmitter=L;L.prototype._events=void 0;L.prototype._eventsCount=0;L.prototype._maxListeners=void 0;var Da=10;function Gr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(L,"defaultMaxListeners",{enumerable:!0,get:function(){return Da},set:function(r){if(typeof r!="number"||r<0||Ma(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Da=r}});L.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};L.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Ma(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Fa(r){return r._maxListeners===void 0?L.defaultMaxListeners:r._maxListeners}L.prototype.getMaxListeners=function(){return Fa(this)};L.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")Na(c,this,t);else for(var u=c.length,l=$a(c,u),n=0;n<u;++n)Na(l[n],this,t);return!0};function Oa(r,e,t,n){var i,o,s;if(Gr(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=Fa(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,Eh(a)}return r}L.prototype.addListener=function(e,t){return Oa(this,e,t,!1)};L.prototype.on=L.prototype.addListener;L.prototype.prependListener=function(e,t){return Oa(this,e,t,!0)};function Sh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ua(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Sh.bind(n);return i.listener=t,n.wrapFn=i,i}L.prototype.once=function(e,t){return Gr(t),this.on(e,Ua(this,e,t)),this};L.prototype.prependOnceListener=function(e,t){return Gr(t),this.prependListener(e,Ua(this,e,t)),this};L.prototype.removeListener=function(e,t){var n,i,o,s,a;if(Gr(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():Th(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};L.prototype.off=L.prototype.removeListener;L.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Ra(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Ah(i):$a(i,i.length)}L.prototype.listeners=function(e){return Ra(this,e,!0)};L.prototype.rawListeners=function(e){return Ra(this,e,!1)};L.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):za.call(r,e)};L.prototype.listenerCount=za;function za(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}L.prototype.eventNames=function(){return this._eventsCount>0?jr(this._events):[]};function $a(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Th(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ah(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Bh(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Wa(r,e,o,{once:!0}),e!=="error"&&Ch(r,i,{once:!0})})}function Ch(r,e,t){typeof r.on=="function"&&Wa(r,"error",e,t)}function Wa(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var Ja=S((Ka,Xa)=>{"use strict";var qh=Math.exp;Ka=Xa.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,n=0,i=0,o=0,s,a={};function c(u,l){return 1-qh(-(u-l)/e)}return a.push=function(l,h){if(s){let d=c(l,s),v=h-t,y=d*v;t=d*h+(1-d)*t,n=(1-d)*(n+v*y),i=Math.sqrt(n),o=t+d*v}else t=h;s=l},a.movingAverage=function(){return t},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return o},a}});var rc=S((ew,Ui)=>{function tc(r){let e=new globalThis.AbortController;function t(){e.abort();for(let n of r)!n||!n.removeEventListener||n.removeEventListener("abort",t)}for(let n of r)if(!(!n||!n.addEventListener)){if(n.aborted){t();break}n.addEventListener("abort",t)}return e.signal}Ui.exports=tc;Ui.exports.anySignal=tc});var sc=S((yw,Ri)=>{"use strict";var Zh=Object.prototype.hasOwnProperty,q="~";function Zt(){}Object.create&&(Zt.prototype=Object.create(null),new Zt().__proto__||(q=!1));function Yh(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function oc(r,e,t,n,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new Yh(t,n||r,i),s=q?q+e:e;return r._events[s]?r._events[s].fn?r._events[s]=[r._events[s],o]:r._events[s].push(o):(r._events[s]=o,r._eventsCount++),r}function en(r,e){--r._eventsCount===0?r._events=new Zt:delete r._events[e]}function H(){this._events=new Zt,this._eventsCount=0}H.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)Zh.call(t,n)&&e.push(q?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};H.prototype.listeners=function(e){var t=q?q+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s};H.prototype.listenerCount=function(e){var t=q?q+e:e,n=this._events[t];return n?n.fn?1:n.length:0};H.prototype.emit=function(e,t,n,i,o,s){var a=q?q+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,s),!0}for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var d=c.length,v;for(h=0;h<d;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,n);break;case 4:c[h].fn.call(c[h].context,t,n,i);break;default:if(!l)for(v=1,l=new Array(u-1);v<u;v++)l[v-1]=arguments[v];c[h].fn.apply(c[h].context,l)}}return!0};H.prototype.on=function(e,t,n){return oc(this,e,t,n,!1)};H.prototype.once=function(e,t,n){return oc(this,e,t,n,!0)};H.prototype.removeListener=function(e,t,n,i){var o=q?q+e:e;if(!this._events[o])return this;if(!t)return en(this,o),this;var s=this._events[o];if(s.fn)s.fn===t&&(!i||s.once)&&(!n||s.context===n)&&en(this,o);else{for(var a=0,c=[],u=s.length;a<u;a++)(s[a].fn!==t||i&&!s[a].once||n&&s[a].context!==n)&&c.push(s[a]);c.length?this._events[o]=c.length===1?c[0]:c:en(this,o)}return this};H.prototype.removeAllListeners=function(e){var t;return e?(t=q?q+e:e,this._events[t]&&en(this,t)):(this._events=new Zt,this._eventsCount=0),this};H.prototype.off=H.prototype.removeListener;H.prototype.addListener=H.prototype.on;H.prefixed=q;H.EventEmitter=H;typeof Ri<"u"&&(Ri.exports=H)});var ep={};V(ep,{createHelia:()=>Yd});var Dn={};V(Dn,{identity:()=>Nn});var rp=new Uint8Array(0);var ko=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},ke=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var Eo=r=>new TextEncoder().encode(r),So=r=>new TextDecoder().decode(r);var tl=Co,Ao=128,rl=127,nl=~rl,il=Math.pow(2,31);function Co(r,e,t){e=e||[],t=t||0;for(var n=t;r>=il;)e[t++]=r&255|Ao,r/=128;for(;r&nl;)e[t++]=r&255|Ao,r>>>=7;return e[t]=r|0,Co.bytes=t-n+1,e}var ol=In,sl=128,Bo=127;function In(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw In.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&Bo)<<i:(s&Bo)*Math.pow(2,i),i+=7}while(s>=sl);return In.bytes=o-n,t}var al=Math.pow(2,7),cl=Math.pow(2,14),ul=Math.pow(2,21),ll=Math.pow(2,28),fl=Math.pow(2,35),hl=Math.pow(2,42),dl=Math.pow(2,49),pl=Math.pow(2,56),ml=Math.pow(2,63),yl=function(r){return r<al?1:r<cl?2:r<ul?3:r<ll?4:r<fl?5:r<hl?6:r<dl?7:r<pl?8:r<ml?9:10},gl={encode:tl,decode:ol,encodingLength:yl},wl=gl,Ut=wl;var Rt=(r,e=0)=>[Ut.decode(r,e),Ut.decode.bytes],lt=(r,e,t=0)=>(Ut.encode(r,e,t),e),ft=r=>Ut.encodingLength(r);var Ve=(r,e)=>{let t=e.byteLength,n=ft(r),i=n+ft(t),o=new Uint8Array(i+t);return lt(r,o,0),lt(t,o,n),o.set(e,i),new ht(r,t,e,o)},br=r=>{let e=ke(r),[t,n]=Rt(e),[i,o]=Rt(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ht(t,i,s,e)},Lo=(r,e)=>{if(r===e)return!0;{let t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&ko(r.bytes,t.bytes)}},ht=class{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}};var Po=0,bl="identity",Io=ke,_l=r=>Ve(Po,Io(r)),Nn={code:Po,name:bl,encode:Io,digest:_l};var Un={};V(Un,{sha256:()=>je,sha512:()=>On});var Fn=({name:r,code:e,encode:t})=>new Mn(r,e,t),Mn=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Ve(this.code,t):t.then(n=>Ve(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Do=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),je=Fn({name:"sha2-256",code:18,encode:Do("SHA-256")}),On=Fn({name:"sha2-512",code:19,encode:Do("SHA-512")});var Hn={};V(Hn,{base58btc:()=>E,base58flickr:()=>Tl});function vl(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,k=0,I=0,O=y.length;I!==O&&y[I]===0;)I++,g++;for(var ne=(O-I)*l+1>>>0,$=new Uint8Array(ne);I!==O;){for(var fe=y[I],ie=0,Q=ne-1;(fe!==0||ie<k)&&Q!==-1;Q--,ie++)fe+=256*$[Q]>>>0,$[Q]=fe%a>>>0,fe=fe/a>>>0;if(fe!==0)throw new Error("Non-zero carry");k=ie,I++}for(var oe=ne-k;oe!==ne&&$[oe]===0;)oe++;for(var ut=c.repeat(g);oe<ne;++oe)ut+=r.charAt($[oe]);return ut}function d(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var k=0,I=0;y[g]===c;)k++,g++;for(var O=(y.length-g)*u+1>>>0,ne=new Uint8Array(O);y[g];){var $=t[y.charCodeAt(g)];if($===255)return;for(var fe=0,ie=O-1;($!==0||fe<I)&&ie!==-1;ie--,fe++)$+=a*ne[ie]>>>0,ne[ie]=$%256>>>0,$=$/256>>>0;if($!==0)throw new Error("Non-zero carry");I=fe,g++}if(y[g]!==" "){for(var Q=O-I;Q!==O&&ne[Q]===0;)Q++;for(var oe=new Uint8Array(k+(O-Q)),ut=k;Q!==O;)oe[ut++]=ne[Q++];return oe}}}function v(y){var g=d(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:v}}var xl=vl,kl=xl,Mo=kl;var Rn=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},zn=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Fo(this,e)}},$n=class{constructor(e){this.decoders=e}or(e){return Fo(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Fo=(r,e)=>new $n({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Wn=class{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new Rn(e,t,n),this.decoder=new zn(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},pt=({name:r,prefix:e,encode:t,decode:n})=>new Wn(r,e,t,n),Ne=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:i}=Mo(t,e);return pt({prefix:r,name:e,encode:n,decode:o=>ke(i(o))})},El=(r,e,t,n)=>{let i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*t/8|0),a=0,c=0,u=0;for(let l=0;l<o;++l){let h=i[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},Sl=(r,e,t)=>{let n=e[e.length-1]==="=",i=(1<<t)-1,o="",s=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s&&(o+=e[i&a<<t-s]),n)for(;o.length*t&7;)o+="=";return o},D=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>pt({prefix:e,name:r,encode(i){return Sl(i,n,t)},decode(i){return El(i,n,t,r)}});var E=Ne({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Tl=Ne({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var qn={};V(qn,{base32:()=>j,base32hex:()=>Ll,base32hexpad:()=>Il,base32hexpadupper:()=>Nl,base32hexupper:()=>Pl,base32pad:()=>Bl,base32padupper:()=>Cl,base32upper:()=>Al,base32z:()=>Dl});var j=D({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Al=D({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bl=D({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Cl=D({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ll=D({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pl=D({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Il=D({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Nl=D({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dl=D({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Oo=(r,e)=>{let{bytes:t,version:n}=r;switch(n){case 0:return Fl(t,Vn(r),e||E.encoder);default:return Ol(t,Vn(r),e||j.encoder)}};var Uo=new WeakMap,Vn=r=>{let e=Uo.get(r);if(e==null){let t=new Map;return Uo.set(r,t),t}return e},x=class{constructor(e,t,n,i){this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:t}=this;if(e!==zt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ul)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return x.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=Ve(e,t);return x.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return x.equals(this,e)}static equals(e,t){let n=t;return n&&e.code===n.code&&e.version===n.version&&Lo(e.multihash,n.multihash)}toString(e){return Oo(this,e)}toJSON(){return{"/":Oo(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let t=e;if(t instanceof x)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:i,multihash:o,bytes:s}=t;return new x(n,i,o,s||Ro(n,i,o.bytes))}else if(t[Rl]===!0){let{version:n,multihash:i,code:o}=t,s=br(i);return x.create(n,o,s)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==zt)throw new Error(`Version 0 CID must use dag-pb (code: ${zt}) block encoding`);return new x(e,t,n,n.bytes)}case 1:{let i=Ro(e,t,n.bytes);return new x(e,t,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return x.create(0,zt,e)}static createV1(e,t){return x.create(1,e,t)}static decode(e){let[t,n]=x.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=x.inspectBytes(e),n=t.size-t.multihashSize,i=ke(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=i.subarray(t.multihashSize-t.digestSize),s=new ht(t.multihashCode,t.digestSize,o,i);return[t.version===0?x.createV0(s):x.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[h,d]=Rt(e.subarray(t));return t+=d,h},i=n(),o=zt;if(i===18?(i=0,t=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=t,a=n(),c=n(),u=t+c,l=u-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,t){let[n,i]=Ml(e,t),o=x.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Vn(o).set(n,e),o}},Ml=(r,e)=>{switch(r[0]){case"Q":{let t=e||E;return[E.prefix,t.decode(`${E.prefix}${r}`)]}case E.prefix:{let t=e||E;return[E.prefix,t.decode(r)]}case j.prefix:{let t=e||j;return[j.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},Fl=(r,e,t)=>{let{prefix:n}=t;if(n!==E.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let i=e.get(n);if(i==null){let o=t.encode(r).slice(1);return e.set(n,o),o}else return i},Ol=(r,e,t)=>{let{prefix:n}=t,i=e.get(n);if(i==null){let o=t.encode(r);return e.set(n,o),o}else return i},zt=112,Ul=18,Ro=(r,e,t)=>{let n=ft(r),i=n+ft(e),o=new Uint8Array(i+t.byteLength);return lt(r,o,0),lt(e,o,n),o.set(t,i),o},Rl=Symbol.for("@ipld/js-cid/CID");var sa=U(Yo(),1);var $t=U(us(),1);function df(r){let e=new Uint8Array(r.reduce((n,i)=>n+$t.default.encodingLength(i),0)),t=0;for(let n of r)e=$t.encode(n,e,t),t+=$t.default.encodingLength(n);return e}var ls=df;var se=U(ms(),1);var Kn={};V(Kn,{base64:()=>Wt,base64pad:()=>Tf,base64url:()=>Af,base64urlpad:()=>Bf});var Wt=D({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Tf=D({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Af=D({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bf=D({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});se.default.formatters.b=r=>r==null?"undefined":E.baseEncode(r);se.default.formatters.t=r=>r==null?"undefined":j.baseEncode(r);se.default.formatters.m=r=>r==null?"undefined":Wt.baseEncode(r);se.default.formatters.p=r=>r==null?"undefined":r.toString();se.default.formatters.c=r=>r==null?"undefined":r.toString();se.default.formatters.k=r=>r==null?"undefined":r.toString();function Cf(r){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=r,e.destroy=()=>!0,e.extend=()=>e,e}function wt(r){let e=Cf(`${r}:trace`);return se.default.enabled(`${r}:trace`)&&se.default.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(e=(0,se.default)(`${r}:trace`)),Object.assign((0,se.default)(r),{error:(0,se.default)(`${r}:error`),trace:e})}function Qe(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var Ke=class{constructor(e,t,n){this._refCounter=1,this.cid=e,this.priority=t??1,this.wantType=n}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(E)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};var De=class{constructor(e,t,n,i,o){this.entry=new Ke(e,t,n),this.cancel=!!i,this.sendDontHave=!!o}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(E)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}};var ae=(r,e)=>{let t=["bitswap"];return e!=null&&t.push(e),r!=null&&t.push(`${r.toString().slice(0,8)}`),wt(t.join(":"))};var xr=(r,e)=>{if(r.size!==e.size)return!1;for(let[t,n]of r){let i=e.get(t);if(i===void 0||n instanceof Uint8Array&&i instanceof Uint8Array&&!Qe(n,i)||n instanceof De&&i instanceof De&&!n.equals(i))return!1}return!0};var ci=U(ei(),1),ra=U(Qs(),1),na=U(Je(),1),ui=U(ai(),1),ia=U(ta(),1);function Uf(){na.default._configure(),ci.default._configure(ra.default),ui.default._configure(ia.default)}Uf();var oa=["uint64","int64","sint64","fixed64","sfixed64"];function Rf(r){for(let e of oa){if(r[e]==null)continue;let t=r[e];r[e]=function(){return BigInt(t.call(this).toString())}}return r}function li(r){return Rf(new ci.default(r))}function zf(r){for(let e of oa){if(r[e]==null)continue;let t=r[e];r[e]=function(n){return t.call(this,n.toString())}}return r}function fi(){return zf(ui.default.create())}function Ye(r,e){let t=li(r instanceof Uint8Array?r:r.subarray());return e.decode(t)}function et(r,e){let t=fi();return e.encode(r,t,{lengthDelimited:!1}),t.finish()}var _t;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(_t||(_t={}));function Ar(r,e,t,n){return{name:r,type:e,encode:t,decode:n}}function Br(r){function e(i){if(r[i.toString()]==null)throw new Error("Invalid enum value");return r[i]}let t=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return Ar("enum",_t.VARINT,t,n)}function tt(r,e){return Ar("message",_t.LENGTH_DELIMITED,r,e)}var G;(function(r){let e;(function(a){let c;(function(d){d.Block="Block",d.Have="Have"})(c=a.WantType||(a.WantType={}));let u;(function(d){d[d.Block=0]="Block",d[d.Have=1]="Have"})(u||(u={})),function(d){d.codec=()=>Br(u)}(c=a.WantType||(a.WantType={}));let l;(function(d){let v;d.codec=()=>(v==null&&(v=tt((y,g,k={})=>{k.lengthDelimited!==!1&&g.fork(),y.block!=null&&y.block.byteLength>0&&(g.uint32(10),g.bytes(y.block)),y.priority!=null&&y.priority!==0&&(g.uint32(16),g.int32(y.priority)),y.cancel!=null&&y.cancel!==!1&&(g.uint32(24),g.bool(y.cancel)),y.wantType!=null&&u[y.wantType]!==0&&(g.uint32(32),r.Wantlist.WantType.codec().encode(y.wantType,g)),y.sendDontHave!=null&&y.sendDontHave!==!1&&(g.uint32(40),g.bool(y.sendDontHave)),k.lengthDelimited!==!1&&g.ldelim()},(y,g)=>{let k={block:new Uint8Array(0),priority:0,cancel:!1,wantType:c.Block,sendDontHave:!1},I=g==null?y.len:y.pos+g;for(;y.pos<I;){let O=y.uint32();switch(O>>>3){case 1:k.block=y.bytes();break;case 2:k.priority=y.int32();break;case 3:k.cancel=y.bool();break;case 4:k.wantType=r.Wantlist.WantType.codec().decode(y);break;case 5:k.sendDontHave=y.bool();break;default:y.skipType(O&7);break}}return k})),v),d.encode=y=>et(y,d.codec()),d.decode=y=>Ye(y,d.codec())})(l=a.Entry||(a.Entry={}));let h;a.codec=()=>(h==null&&(h=tt((d,v,y={})=>{if(y.lengthDelimited!==!1&&v.fork(),d.entries!=null)for(let g of d.entries)v.uint32(10),r.Wantlist.Entry.codec().encode(g,v);d.full!=null&&d.full!==!1&&(v.uint32(16),v.bool(d.full)),y.lengthDelimited!==!1&&v.ldelim()},(d,v)=>{let y={entries:[],full:!1},g=v==null?d.len:d.pos+v;for(;d.pos<g;){let k=d.uint32();switch(k>>>3){case 1:y.entries.push(r.Wantlist.Entry.codec().decode(d,d.uint32()));break;case 2:y.full=d.bool();break;default:d.skipType(k&7);break}}return y})),h),a.encode=d=>et(d,a.codec()),a.decode=d=>Ye(d,a.codec())})(e=r.Wantlist||(r.Wantlist={}));let t;(function(a){let c;a.codec=()=>(c==null&&(c=tt((u,l,h={})=>{h.lengthDelimited!==!1&&l.fork(),u.prefix!=null&&u.prefix.byteLength>0&&(l.uint32(10),l.bytes(u.prefix)),u.data!=null&&u.data.byteLength>0&&(l.uint32(18),l.bytes(u.data)),h.lengthDelimited!==!1&&l.ldelim()},(u,l)=>{let h={prefix:new Uint8Array(0),data:new Uint8Array(0)},d=l==null?u.len:u.pos+l;for(;u.pos<d;){let v=u.uint32();switch(v>>>3){case 1:h.prefix=u.bytes();break;case 2:h.data=u.bytes();break;default:u.skipType(v&7);break}}return h})),c),a.encode=u=>et(u,a.codec()),a.decode=u=>Ye(u,a.codec())})(t=r.Block||(r.Block={}));let n;(function(a){a.Have="Have",a.DontHave="DontHave"})(n=r.BlockPresenceType||(r.BlockPresenceType={}));let i;(function(a){a[a.Have=0]="Have",a[a.DontHave=1]="DontHave"})(i||(i={})),function(a){a.codec=()=>Br(i)}(n=r.BlockPresenceType||(r.BlockPresenceType={}));let o;(function(a){let c;a.codec=()=>(c==null&&(c=tt((u,l,h={})=>{h.lengthDelimited!==!1&&l.fork(),u.cid!=null&&u.cid.byteLength>0&&(l.uint32(10),l.bytes(u.cid)),u.type!=null&&i[u.type]!==0&&(l.uint32(16),r.BlockPresenceType.codec().encode(u.type,l)),h.lengthDelimited!==!1&&l.ldelim()},(u,l)=>{let h={cid:new Uint8Array(0),type:n.Have},d=l==null?u.len:u.pos+l;for(;u.pos<d;){let v=u.uint32();switch(v>>>3){case 1:h.cid=u.bytes();break;case 2:h.type=r.BlockPresenceType.codec().decode(u);break;default:u.skipType(v&7);break}}return h})),c),a.encode=u=>et(u,a.codec()),a.decode=u=>Ye(u,a.codec())})(o=r.BlockPresence||(r.BlockPresence={}));let s;r.codec=()=>(s==null&&(s=tt((a,c,u={})=>{if(u.lengthDelimited!==!1&&c.fork(),a.wantlist!=null&&(c.uint32(10),r.Wantlist.codec().encode(a.wantlist,c)),a.blocks!=null)for(let l of a.blocks)c.uint32(18),c.bytes(l);if(a.payload!=null)for(let l of a.payload)c.uint32(26),r.Block.codec().encode(l,c);if(a.blockPresences!=null)for(let l of a.blockPresences)c.uint32(34),r.BlockPresence.codec().encode(l,c);a.pendingBytes!=null&&a.pendingBytes!==0&&(c.uint32(40),c.int32(a.pendingBytes)),u.lengthDelimited!==!1&&c.ldelim()},(a,c)=>{let u={blocks:[],payload:[],blockPresences:[],pendingBytes:0},l=c==null?a.len:a.pos+c;for(;a.pos<l;){let h=a.uint32();switch(h>>>3){case 1:u.wantlist=r.Wantlist.codec().decode(a,a.uint32());break;case 2:u.blocks.push(a.bytes());break;case 3:u.payload.push(r.Block.codec().decode(a,a.uint32()));break;case 4:u.blockPresences.push(r.BlockPresence.codec().decode(a,a.uint32()));break;case 5:u.pendingBytes=a.int32();break;default:a.skipType(h&7);break}}return u})),s),r.encode=a=>et(a,r.codec()),r.decode=a=>Ye(a,r.codec())})(G||(G={}));var Cr=class extends Error{constructor(e,t,n){super(e),this.code=t,this.name=n?.name??"CodeError",this.props=n??{}}};var $f,B=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,n,i,o){n==null&&(n=B.WantType.Block);let s=e.toString(E),a=this.wantlist.get(s);a!=null?(a.wantType===n&&(a.priority=t),i===!0&&(a.cancel=!!i),o===!0&&(a.sendDontHave=!!o),n===B.WantType.Block&&a.wantType===B.WantType.Have&&(a.wantType=n)):this.wantlist.set(s,new De(e,t,n,i,o))}addBlock(e,t){let n=e.toString(E);this.blocks.set(n,t)}addHave(e){let t=e.toString(E);this.blockPresences.has(t)||this.blockPresences.set(t,B.BlockPresenceType.Have)}addDontHave(e){let t=e.toString(E);this.blockPresences.has(t)||this.blockPresences.set(t,B.BlockPresenceType.DontHave)}cancel(e){let t=e.toString(E);this.wantlist.delete(t),this.addEntry(e,0,B.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){return G.encode({wantlist:{entries:Array.from(this.wantlist.values()).map(e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:!!e.cancel,wantType:G.Wantlist.WantType.Block,sendDontHave:!1})),full:!!this.full},blocks:Array.from(this.blocks.values())})}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:!!t.cancel,sendDontHave:!!t.sendDontHave})),full:!!this.full},blockPresences:[],payload:[],pendingBytes:this.pendingBytes,blocks:[]};for(let[t,n]of this.blocks.entries()){let i=x.parse(t),o=i.version,s=i.code,a=i.multihash.code,c=i.multihash.digest.length,u=ls([o,s,a,c]);e.payload.push({prefix:u,data:n})}for(let[t,n]of this.blockPresences)e.blockPresences.push({cid:x.parse(t).bytes,type:n});return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),G.encode(e)}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!xr(this.wantlist,e.wantlist)||!xr(this.blocks,e.blocks)||!xr(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};$f=B;B.Entry=De;B.WantType={Block:G.Wantlist.WantType.Block,Have:G.Wantlist.WantType.Have};B.BlockPresenceType={Have:G.BlockPresenceType.Have,DontHave:G.BlockPresenceType.DontHave};B.deserialize=async(r,e)=>{let t=G.decode(r),n=t.wantlist?.full===!0,i=new B(n);return t.wantlist?.entries.forEach(o=>{if(o.block==null)return;let s=x.decode(o.block);i.addEntry(s,o.priority??0,o.wantType,!!o.cancel,!!o.sendDontHave)}),t.blockPresences.forEach(o=>{if(o.cid==null)return;let s=x.decode(o.cid);o.type===B.BlockPresenceType.Have?i.addHave(s):i.addDontHave(s)}),t.blocks.length>0?(await Promise.all(t.blocks.map(async o=>{let s=await je.digest(o),a=x.createV0(s);i.addBlock(a,o)})),i):(t.payload.length>0&&(await Promise.all(t.payload.map(async o=>{if(o.prefix==null||o.data==null)return;let s=(0,sa.default)(o.prefix),a=s[0],c=s[1],u=s[2],l=u===je.code?je:await e?.getHasher(u);if(l==null)throw new Cr("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");let h=await l.digest(o.data),d=x.create(a,c,h);i.addBlock(d,o.data)})),i.setPendingBytes(t.pendingBytes)),i)};B.blockPresenceSize=r=>r.bytes.length+1;var hi=class extends Map{constructor(e){super();let{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){let t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}};function Oe(r){let{name:e,metrics:t}=r,n;return t!=null?n=new hi({name:e,metrics:t}):n=new Map,n}var aa={Block:G.Wantlist.WantType.Block,Have:G.Wantlist.WantType.Have},Wf=(r,e)=>Array.prototype.slice.call(e,0).sort((t,n)=>{let i=r(t),o=r(n);return i<o?-1:i>o?1:0}),Ee=class{constructor(e,t){this.set=t!=null?Oe({name:"ipfs_bitswap_wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,n){let i=e.toString(E),o=this.set.get(i);o!=null?(o.inc(),o.priority=t,o.wantType===aa.Have&&n===aa.Block&&(o.wantType=n)):(this.set.set(i,new Ke(e,t,n)),this._stats!=null&&this._stats.push(void 0,"wantListSize",1))}remove(e){let t=e.toString(E),n=this.set.get(t);n!=null&&(n.dec(),!n.hasRefs()&&(this.set.delete(t),this._stats!=null&&this._stats.push(void 0,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(Wf(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString(E);return this.set.has(t)}get(e){let t=e.toString(E);return this.set.get(t)}};Ee.Entry=Ke;var ca=Math.pow(2,31)-1,ua=1e3,la=1;var fa=Hf;function Hf(r,e,t){var n=null,i=null,o=function(){n&&(clearTimeout(n),i=null,n=null)},s=function(){var c=i;o(),c&&c()},a=function(){if(!e)return r.apply(this,arguments);var c=this,u=arguments,l=t&&!n;if(o(),i=function(){r.apply(c,u)},n=setTimeout(function(){if(n=null,!l){var h=i;return i=null,h()}},e),l)return i()};return a.cancel=o,a.flush=s,a}var Lr=class{constructor(e,t,n){this.peerId=t,this.network=n,this.refcnt=1,this._entries=[],this._log=ae(e,"msgqueue"),this.sendEntries=fa(this.sendEntries.bind(this),la)}addMessage(e,t={}){e.empty||this.send(e,t)}addEntries(e,t={}){this._entries=this._entries.concat(e),this.sendEntries(t)}sendEntries(e={}){if(this._entries.length===0)return;let t=new B(!1);this._entries.forEach(n=>{n.cancel===!0?t.cancel(n.cid):t.addEntry(n.cid,n.priority)}),this._entries=[],this.addMessage(t,e)}async send(e,t={}){try{await this.network.connectTo(this.peerId,t)}catch(n){this._log.error("cant connect to peer %p: %s",this.peerId,n.message);return}this._log("sending message to peer %p",this.peerId),this.network.sendMessage(this.peerId,e,t).catch(n=>{this._log.error("send error",n)})}};var Pr=class{constructor(e,t,n,i){this.peers=Oe({name:"ipfs_bitswap_want_manager_peers",metrics:i.metrics}),this.wantlist=new Ee(n,i),this.network=t,this._peerId=e,this._log=ae(e,"want")}_addEntries(e,t,n,i={}){let o=e.map((s,a)=>new B.Entry(s,ca-a,B.WantType.Block,t));o.forEach(s=>{s.cancel?n===!0?this.wantlist.removeForce(s.cid.toString(E)):this.wantlist.remove(s.cid):(this._log("adding to wantlist"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(o,i)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t!=null){t.refcnt++;return}t=new Lr(this._peerId,e,this.network);let n=new B(!0);for(let i of this.wantlist.entries())n.addEntry(i[1].cid,i[1].priority);return t.addMessage(n),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toString());t!=null&&(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1,!1,t),t.signal?.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>{this.disconnected(e.peerId)})}};function rt(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Se(r=0){return globalThis.Buffer?.alloc!=null?rt(globalThis.Buffer.alloc(r)):new Uint8Array(r)}function pe(r=0){return globalThis.Buffer?.allocUnsafe!=null?rt(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function pi(r,e){e==null&&(e=r.reduce((i,o)=>i+o.length,0));let t=pe(e),n=0;for(let i of r)t.set(i,n),n+=i.length;return rt(t)}var da=Symbol.for("@achingbrain/uint8arraylist");function ha(r,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let t=0;for(let n of r){let i=t+n.byteLength;if(e<i)return{buf:n,index:e-t};t=i}throw new RangeError("index is out of bounds")}function Ir(r){return!!r?.[da]}var _e=class{constructor(...e){Object.defineProperty(this,da,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(let n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else if(Ir(n))t+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(let n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else if(Ir(n))t+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}get(e){let t=ha(this.bufs,e);return t.buf[t.index]}set(e,t){let n=ha(this.bufs,e);n.buf[n.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else if(Ir(e))for(let n=0;n<e.length;n++)this.set(t+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,t){let{bufs:n,length:i}=this._subList(e,t);return pi(n,i)}subarray(e,t){let{bufs:n,length:i}=this._subList(e,t);return n.length===1?n[0]:pi(n,i)}sublist(e,t){let{bufs:n,length:i}=this._subList(e,t),o=new _e;return o.length=i,o.bufs=n,o}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(e===0&&t===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],a=i,c=a+s.byteLength;if(i=c,e>=c)continue;let u=e>=a&&e<c,l=t>a&&t<=c;if(u&&l){if(e===a&&t===c){n.push(s);break}let h=e-a;n.push(s.subarray(h,h+(t-e)));break}if(u){if(e===0){n.push(s);continue}n.push(s.subarray(e-a));continue}if(l){if(t===c){n.push(s);break}n.push(s.subarray(0,t-a));break}n.push(s)}return{bufs:n,length:t-e}}indexOf(e,t=0){if(!Ir(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),e.length===0)return t>this.length?this.length:t;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let h=0;h<o;h++)s[h]=-1;for(let h=0;h<i;h++)s[n[h]]=h;let a=s,c=this.byteLength-n.byteLength,u=n.byteLength-1,l;for(let h=t;h<=c;h+=l){l=0;for(let d=u;d>=0;d--){let v=this.get(h+d);if(n[d]!==v){l=Math.max(1,d-a[v]);break}}if(l===0)return h}return-1}getInt8(e){let t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,t),this.write(n,e)}getInt16(e,t){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,t)}setInt16(e,t,n){let i=Se(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,t,n),this.write(i,e)}getInt32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,t)}setInt32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,t,n),this.write(i,e)}getBigInt64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,t)}setBigInt64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,t,n),this.write(i,e)}getUint8(e){let t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,t),this.write(n,e)}getUint16(e,t){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,t)}setUint16(e,t,n){let i=Se(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,t,n),this.write(i,e)}getUint32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,t)}setUint32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,t,n),this.write(i,e)}getBigUint64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,t)}setBigUint64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,t,n),this.write(i,e)}getFloat32(e,t){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,t)}setFloat32(e,t,n){let i=Se(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,t,n),this.write(i,e)}getFloat64(e,t){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,t)}setFloat64(e,t,n){let i=Se(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,t,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof _e)||e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!Qe(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){let n=new _e;return n.bufs=e,t==null&&(t=e.reduce((i,o)=>i+o.byteLength,0)),n.length=t,n}};function Nr(r){return r instanceof Uint8Array?{get(e){return r[e]},set(e,t){r[e]=t}}:{get(e){return r.get(e)},set(e,t){r.set(e,t)}}}var pa=4294967296,X=class{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let t=~this.lo+1>>>0,n=~this.hi>>>0;return t===0&&(n=n+1>>>0),-(BigInt(t)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),t=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new X(n,t)}zzEncode(){let e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new X(t,n)}toBytes(e,t=0){let n=Nr(e);for(;this.hi>0;)n.set(t++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(t++,this.lo&127|128),this.lo=this.lo>>>7;n.set(t++,this.lo)}static fromBigInt(e){if(e===0n)return new X;let t=e<0;t&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return t&&(n=~n>>>0,i=~i>>>0,++i>pa&&(i=0,++n>pa&&(n=0))),new X(n,i)}static fromNumber(e){if(e===0)return new X;let t=e<0;t&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new X(i,n)}static fromBytes(e,t=0){let n=Nr(e),i=new X,o=0;if(e.length-t>4){for(;o<4;++o)if(i.lo=(i.lo|(n.get(t)&127)<<o*7)>>>0,n.get(t++)<128)return i;if(i.lo=(i.lo|(n.get(t)&127)<<28)>>>0,i.hi=(i.hi|(n.get(t)&127)>>4)>>>0,n.get(t++)<128)return i;o=0}else for(;o<4;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(i.lo=(i.lo|(n.get(t)&127)<<o*7)>>>0,n.get(t++)<128)return i}if(e.length-t>4){for(;o<5;++o)if(i.hi=(i.hi|(n.get(t)&127)<<o*7+3)>>>0,n.get(t++)<128)return i}else if(t<e.byteLength)for(;o<5;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(i.hi=(i.hi|(n.get(t)&127)<<o*7+3)>>>0,n.get(t++)<128)return i}throw RangeError("invalid varint encoding")}};var qf=Math.pow(2,7),Vf=Math.pow(2,14),jf=Math.pow(2,21),Gf=Math.pow(2,28),Qf=Math.pow(2,35),Kf=Math.pow(2,42),Xf=Math.pow(2,49),Jf=Math.pow(2,56),Zf=Math.pow(2,63),nt={encodingLength(r){return r<qf?1:r<Vf?2:r<jf?3:r<Gf?4:r<Qf?5:r<Kf?6:r<Xf?7:r<Jf?8:r<Zf?9:10},encode(r,e,t=0){if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=pe(nt.encodingLength(r))),X.fromNumber(r).toBytes(e,t),e},decode(r,e=0){return X.fromBytes(r,e).toNumber(!0)}};function Dr(r){return r[Symbol.asyncIterator]!=null}var Mr=r=>{let e=nt.encodingLength(r),t=pe(e);return nt.encode(r,t),Mr.bytes=e,t};Mr.bytes=0;function Fr(r,e){e=e??{};let t=e.lengthEncoder??Mr;function*n(i){let o=t(i.byteLength);o instanceof Uint8Array?yield o:yield*o,i instanceof Uint8Array?yield i:yield*i}return Dr(r)?async function*(){for await(let i of r)yield*n(i)}():function*(){for(let i of r)yield*n(i)}()}Fr.single=(r,e)=>{e=e??{};let t=e.lengthEncoder??Mr;return new _e(t(r.byteLength),r)};var vt=U(Or(),1);var eh=8,th=1024*1024*4,it;(function(r){r[r.LENGTH=0]="LENGTH",r[r.DATA=1]="DATA"})(it||(it={}));var mi=r=>{let e=nt.decode(r);return mi.bytes=nt.encodingLength(e),e};mi.bytes=0;function Vt(r,e){let t=new _e,n=it.LENGTH,i=-1,o=e?.lengthDecoder??mi,s=e?.maxLengthLength??eh,a=e?.maxDataLength??th;function*c(){for(;t.byteLength>0;){if(n===it.LENGTH)try{if(i=o(t),i<0)throw(0,vt.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,vt.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=o.bytes;t.consume(u),e?.onLength!=null&&e.onLength(i),n=it.DATA}catch(u){if(u instanceof RangeError){if(t.byteLength>s)throw(0,vt.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(n===it.DATA){if(t.byteLength<i)break;let u=t.sublist(0,i);t.consume(i),e?.onData!=null&&e.onData(u),yield u,n=it.LENGTH}}}return Dr(r)?async function*(){for await(let u of r)t.append(u),yield*c();if(t.byteLength>0)throw(0,vt.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let u of r)t.append(u),yield*c();if(t.byteLength>0)throw(0,vt.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Vt.fromReader=(r,e)=>{let t=1,n=async function*(){for(;;)try{let{done:o,value:s}=await r.next(t);if(o===!0)return;s!=null&&(yield s)}catch(o){if(o.code==="ERR_UNDER_READ")return{done:!0,value:null};throw o}finally{t=1}}();return Vt(n,{...e??{},onLength:o=>{t=o}})};var Ur=class{constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},xt=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Ur(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new Ur(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function kt(r={}){return nh(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function nh(r,e){e=e??{};let t=e.onEnd,n=new xt,i,o,s,a=async()=>n.isEmpty()?s?{done:!0}:await new Promise((g,k)=>{o=I=>{o=null,n.push(I);try{g(r(n))}catch(O){k(O)}return i}}):r(n),c=g=>o!=null?o(g):(n.push(g),i),u=g=>(n=new xt,o!=null?o({error:g}):(n.push({error:g}),i)),l=g=>{if(s)return i;if(e?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:g})},h=g=>s?i:(s=!0,g!=null?u(g):c({done:!0})),d=()=>(n=new xt,h(),{done:!0}),v=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:d,throw:v,push:l,end:h,get readableLength(){return n.size}},t==null)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),t!=null&&(t(g),t=void 0),{done:!0}},return(){return y.return(),t!=null&&(t(),t=void 0),{done:!0}},push:l,end(g){return y.end(g),t!=null&&(t(g),t=void 0),i},get readableLength(){return y.readableLength}},i}function ih(r){return r[Symbol.asyncIterator]!=null}function oh(...r){let e=[];for(let t of r)ih(t)||e.push(t);return e.length===r.length?function*(){for(let t of e)yield*t}():async function*(){let t=kt({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(r.map(async n=>{for await(let i of n)t.push(i)})),t.end()}catch(n){t.end(n)}}),yield*t}()}var Rr=oh;function gi(r,...e){if(r==null)throw new Error("Empty pipeline");if(yi(r)){let n=r;r=()=>n.source}else if(wa(r)||ga(r)){let n=r;r=()=>n}let t=[r,...e];if(t.length>1&&yi(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)yi(t[n])&&(t[n]=ah(t[n]));return sh(...t)}var sh=(...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e},ga=r=>r?.[Symbol.asyncIterator]!=null,wa=r=>r?.[Symbol.iterator]!=null,yi=r=>r==null?!1:r.sink!=null&&r.source!=null,ah=r=>e=>{let t=r.sink(e);if(t?.then!=null){let n=kt({objectMode:!0});t.then(()=>{n.end()},s=>{n.end(s)});let i,o=r.source;if(ga(o))i=async function*(){yield*o,n.end()};else if(wa(o))i=function*(){yield*o,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return Rr(n,i())}return r.source};var wi=Symbol.for("@libp2p/topology");var ba=()=>{},bi=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??ba,this.onDisconnect=e.onDisconnect??ba}get[Symbol.toStringTag](){return wi.toString()}get[wi](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function _a(r){return new bi(r)}var La=U(Aa(),1);var Gt=class extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}};function Ba(r){if(r!=null){if(typeof r[Symbol.iterator]=="function")return r[Symbol.iterator]();if(typeof r[Symbol.asyncIterator]=="function")return r[Symbol.asyncIterator]();if(typeof r.next=="function")return r}throw new Error("argument is not an iterator or iterable")}function Ca(r,e,t){let n=t??{},i=Ba(r);async function*o(){let s,a=()=>{s?.()};for(e.addEventListener("abort",a);;){let c;try{if(e.aborted){let{abortMessage:l,abortCode:h}=n;throw new Gt(l,h)}let u=new Promise((l,h)=>{s=()=>{let{abortMessage:d,abortCode:v}=n;h(new Gt(d,v))}});c=await Promise.race([u,i.next()]),s=null}catch(u){e.removeEventListener("abort",a);let l=u.type==="aborted"&&e.aborted;if(l&&n.onAbort!=null&&await n.onAbort(r),typeof i.return=="function")try{let h=i.return();h instanceof Promise&&h.catch(d=>{n.onReturnError!=null&&n.onReturnError(d)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(l&&n.returnOnAbort===!0)return;throw u}if(c.done===!0)break;yield c.value}e.removeEventListener("abort",a)}return o()}var C=class extends Event{constructor(e,t){super(e),this.detail=t}};function lh(r){return r[Symbol.asyncIterator]!=null}function fh(r,e){return lh(r)?async function*(){let t=0;if(!(e<1)){for await(let n of r)if(yield n,t++,t===e)return}}():function*(){let t=0;if(!(e<1)){for(let n of r)if(yield n,t++,t===e)return}}()}var Et=fh;function hh(r){return r[Symbol.asyncIterator]!=null}function dh(r){if(hh(r))return(async()=>{for await(let e of r);})();for(let e of r);}var Ue=dh;function ph(r){let[e,t]=r[Symbol.asyncIterator]!=null?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:i=>{n.push(i)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[t](){return this}}}var St=ph;function mh(r){return r[Symbol.asyncIterator]!=null}function yh(r,e){if(mh(r))return async function*(){for await(let a of r)yield e(a)}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();let o=e(n);if(typeof o.then=="function")return async function*(){yield await o;for await(let a of t)yield e(a)}();let s=e;return function*(){yield o;for(let a of t)yield s(a)}()}var vi=yh;var xi="/ipfs/bitswap/1.0.0",ki="/ipfs/bitswap/1.1.0",Ei="/ipfs/bitswap/1.2.0",wh=1024,bh=1024,_h=3e4,$r=class{constructor(e,t,n,i={}){this._log=ae(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[xi],i.b100Only!==!0&&(this._protocols.unshift(ki),this._protocols.unshift(Ei)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=i.hashLoader??{async getHasher(){throw new Error("Not implemented")}},this._maxInboundStreams=i.maxInboundStreams??wh,this._maxOutboundStreams=i.maxOutboundStreams??bh,this._incomingStreamTimeout=i.incomingStreamTimeout??_h}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});let e=_a({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(let t of this._protocols)this._registrarIds.push(await this._libp2p.register(t,e));this._libp2p.getConnections().forEach(t=>{this._onPeerConnect(t.remotePeer)})}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarIds!=null){for(let e of this._registrarIds)this._libp2p.unregister(e);this._registrarIds=[]}}_onConnection(e){if(!this._running)return;let{stream:t,connection:n}=e,i=new La.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then(async()=>{this._log("incoming new bitswap %s connection from %p",t.stat.protocol,n.remotePeer),await gi(Ca(t.source,i.signal),o=>Vt(o),async o=>{for await(let s of o){try{let a=await B.deserialize(s.subarray(),this._hashLoader);await this._bitswap._receiveMessage(n.remotePeer,a)}catch(a){this._bitswap._receiveError(a);break}i.reset()}})}).catch(o=>{this._log(o),t.abort(o)}).finally(()=>{i.clear(),t.close()})}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return t.onProgress?.(new C("bitswap:network:find-providers",e)),this._libp2p.contentRouting.findProviders(e,t)}async findAndConnect(e,t){await Ue(Et(vi(this.findProviders(e,t),async n=>await this.connectTo(n.id,t).catch(i=>{this._log.error(i)})),3)).catch(n=>{this._log.error(n)})}async provide(e,t={}){t.onProgress?.(new C("bitswap:network:provide",e)),await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t,n={}){if(!this._running)throw new Error("network isn't running");let i=e.toString();this._log("sendMessage to %s",i,t),n.onProgress?.(new C("bitswap:network:send-wantlist",e)),await this._writeMessage(e,t,n),this._updateSentStats(e,t.blocks)}async connectTo(e,t={}){if(!this._running)throw new Error("network isn't running");return t.onProgress?.(new C("bitswap:network:dial",e)),await this._libp2p.dial(e,t)}_updateSentStats(e,t){let n=e.toString();if(this._stats!=null){for(let i of t.values())this._stats.push(n,"dataSent",i.length);this._stats.push(n,"blocksSent",t.size)}}async _writeMessage(e,t,n={}){let i=await this._libp2p.dialProtocol(e,[Ei,ki,xi]);try{let o;switch(i.stat.protocol){case xi:o=t.serializeToBitswap100();break;case ki:case Ei:o=t.serializeToBitswap110();break;default:throw new Error(`Unknown protocol: ${i.stat.protocol}`)}await gi([o],s=>Fr(s),i)}catch(o){n.onProgress?.(new C("bitswap:network:send-wantlist:error",{peer:e,error:o})),this._log(o)}finally{i.close()}}};var Wr=class{constructor(e){this.partner=e,this.wantlist=new Ee,this.exchangeCount=0,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,n){this.wantlist.add(e,t,n)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};var Qt=class extends Map{constructor(e,t){super(),this._cmp=t??this._defaultSort,this._keys=[];for(let[n,i]of e??[])this.set(n,i)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let n=this._find(t);this._keys.splice(n,0,t)}set(e,t){if(this.has(e)){let i=this.indexOf(e);this._keys.splice(i,1)}super.set(e,t);let n=this._find(e);return this._keys.splice(n,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let n=1;n<this._keys.length;n++){if(this._keys[t+n]===e)return t+n;if(this._keys[t-n]===e)return t-n}return-1}_find(e){let t=0,n=this._keys.length;for(;t<n;){let i=t+n>>>1,o=this._kCmp(this._keys[i],e);if(o<0)t=i+1;else if(o>0)n=i;else return i}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t=this){if(e!=null)for(let n of this._keys){let i=this.get(n);if(i==null)throw new Error("Value cannot be undefined");e.apply(t,[[n,i]])}}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}};var vh={hasNewInfo(){return!1},merge(){}},Hr=class{constructor(e=vh){this._taskMerger=e,this._byPeer=new Qt([],qr.compare)}pushTasks(e,t){let n=this._byPeer.get(e.toString());n==null&&(n=new qr(e,this._taskMerger)),n.pushTasks(t),this._byPeer.set(e.toString(),n)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:n,pendingSize:i}=t.popTasks(e);if(n.length===0)return{tasks:n,pendingSize:i};let o=t.peerId;return t.isIdle()?this._byPeer.delete(o.toString()):this._byPeer.update(0),{peerId:o,tasks:n,pendingSize:i}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){this._byPeer.get(t.toString())?.remove(e)}tasksDone(e,t){let n=this._byPeer.get(e.toString());if(n==null)return;let i=this._byPeer.indexOf(e.toString());for(let o of t)n.taskDone(o);this._byPeer.update(i)}},qr=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new Si,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t!=null){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let n of this._active)n.topic===e.topic&&t.push(n);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,n=[],i=this._pending.tasks();for(let o=0;o<i.length&&t<e;o++){let s=i[o];n.push(s),t+=s.size,this._pending.delete(s.topic),this._activeTotalSize+=s.size,this._active.add(s)}return{tasks:n,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},Si=class{constructor(){this._tasks=new Qt([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return this._tasks?.get(e)?.task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let n=this._tasks.get(e);if(n==null)return;let i=this._tasks.indexOf(e);n.task.priority=t,this._tasks.update(i)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};var Pa={hasNewInfo(r,e){let t=!1,n=!1;for(let i of e)i.data.haveBlock&&(t=!0),i.data.isWantBlock&&(n=!0);return!!(!n&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){let t=r.data,n=e.data;!n.haveBlock&&t.haveBlock&&(n.haveBlock=t.haveBlock,n.blockSize=t.blockSize),!n.isWantBlock&&t.isWantBlock&&(n.isWantBlock=!0,(!n.haveBlock||t.haveBlock)&&(n.haveBlock=t.haveBlock,e.size=r.size)),n.isWantBlock&&n.haveBlock&&(e.size=n.blockSize)}};var Ia=B.WantType,xh=16*1024,kh=1024,Vr=class{constructor(e,t,n,i,o,s={}){this._log=ae(e,"engine"),this.blockstore=t,this.network=n,this._stats=i,this._opts=this._processOpts(s),this.ledgerMap=Oe({name:"ipfs_bitswap_ledger_map",metrics:o.metrics}),this._running=!1,this._requestQueue=new Hr(Pa)}_processOpts(e){return{maxSizeReplaceHasWithBlock:kh,targetMessageSize:xh,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks().catch(e=>{this._log.error("error processing stats",e)})})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:n}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let i=new B(!1);i.setPendingBytes(n);let o=[],s=new Map;for(let c of t){let u=x.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(o.push(u),s.set(c.topic,c.data)):i.addHave(u):i.addDontHave(u)}let a=await this._getBlocks(o);for(let[c,u]of s){let l=x.parse(c),h=a.get(c);h!=null?i.addBlock(l,h):u.sendDontHave&&i.addDontHave(l)}if(i.empty){e!=null&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e!=null&&await this.network.sendMessage(e,i);for(let[c,u]of a.entries())e!=null&&this.messageSent(e,x.parse(c),u)}catch(c){this._log.error(c)}e!=null&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toString(),n=this.ledgerMap.get(t);return n!=null?n.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toString(),n=this.ledgerMap.get(t);if(n!=null)return{peer:n.partner,value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(e.length!==0){for(let t of this.ledgerMap.values())for(let{cid:n,block:i}of e){let o=t.wantlistContains(n);if(o==null)continue;let s=i.length,a=this._sendAsBlock(o.wantType,s),c=s;a||(c=B.blockPresenceSize(o.cid)),this._requestQueue.pushTasks(t.partner,[{topic:o.cid.toString(E),priority:o.priority,size:c,data:{blockSize:s,isWantBlock:a,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){let n=this._findOrCreate(e);if(t.empty)return;if(t.full&&(n.wantlist=new Ee),this._updateBlockAccounting(t.blocks,n),t.wantlist.size===0){this._scheduleProcessTasks();return}let i=[],o=[];t.wantlist.forEach(s=>{s.cancel?(n.cancelWant(s.cid),i.push(s.cid)):(n.wants(s.cid,s.priority,s.wantType),o.push(s))}),this._cancelWants(e,i),await this._addWants(e,o),this._scheduleProcessTasks()}_cancelWants(e,t){for(let n of t)this._requestQueue.remove(n.toString(E),e)}async _addWants(e,t){let n=await this._getBlockSizes(t.map(o=>o.cid)),i=[];for(let o of t){let s=o.cid.toString(E),a=n.get(s);if(a==null)o.sendDontHave&&i.push({topic:s,priority:o.priority,size:B.blockPresenceSize(o.cid),data:{isWantBlock:o.wantType===Ia.Block,blockSize:0,haveBlock:!1,sendDontHave:o.sendDontHave}});else{let c=this._sendAsBlock(o.wantType,a),u=a;c||(u=B.blockPresenceSize(o.cid)),i.push({topic:s,priority:o.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:o.sendDontHave}})}this._requestQueue.pushTasks(e,i)}}_sendAsBlock(e,t){return e===Ia.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([n,i])=>[n,i.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async n=>{try{let i=await this.blockstore.get(n);t.set(n.toString(E),i)}catch(i){i.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",n,i)}})),t}_updateBlockAccounting(e,t){for(let n of e.values())this._log("got block (%s bytes)",n.length),t.receivedBytes(n.length)}messageSent(e,t,n){let i=this._findOrCreate(e);i.sentBytes(n.length),i.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){let t=e.toString(),n=this.ledgerMap.get(t);if(n!=null)return n;let i=new Wr(e);return this.ledgerMap.set(t,i),this._stats!=null&&this._stats.push(t,"peerCount",1),i}start(){this._running=!0}stop(){this._running=!1}};var Qa=U(Qr(),1);var Ai={};V(Ai,{identity:()=>Lh});var Lh=pt({prefix:"\0",name:"identity",encode:r=>So(r),decode:r=>Eo(r)});var Bi={};V(Bi,{base2:()=>Ph});var Ph=D({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ci={};V(Ci,{base8:()=>Ih});var Ih=D({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Li={};V(Li,{base10:()=>Nh});var Nh=Ne({prefix:"9",name:"base10",alphabet:"0123456789"});var Pi={};V(Pi,{base16:()=>Dh,base16upper:()=>Mh});var Dh=D({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mh=D({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ii={};V(Ii,{base36:()=>Kt,base36upper:()=>Fh});var Kt=Ne({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Fh=Ne({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ni={};V(Ni,{base256emoji:()=>$h});var Ha=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Oh=Ha.reduce((r,e,t)=>(r[t]=e,r),[]),Uh=Ha.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Rh(r){return r.reduce((e,t)=>(e+=Oh[t],e),"")}function zh(r){let e=[];for(let t of r){let n=Uh[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}var $h=pt({prefix:"\u{1F680}",name:"base256emoji",encode:Rh,decode:zh});var Kr=85;var Ng=new TextEncoder,Dg=new TextDecoder;var Mi={...Ai,...Bi,...Ci,...Li,...Pi,...qn,...Ii,...Hn,...Kn,...Ni},Rg={...Un,...Dn};function Va(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var qa=Va("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Fi=Va("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=pe(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Hh={utf8:qa,"utf-8":qa,hex:Mi.base16,latin1:Fi,ascii:Fi,binary:Fi,...Mi},Xr=Hh;function ot(r,e="utf8"){let t=Xr[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var ja=r=>`unwant:${ot(r.multihash.bytes,"base64")}`,Ga=r=>`block:${ot(r.multihash.bytes,"base64")}`,Jr=class extends Qa.EventEmitter{constructor(e){super(),this.setMaxListeners(ua),this._log=ae(e,"notif")}hasBlock(e,t){let n=Ga(e);this._log(n),this.emit(n,t)}async wantBlock(e,t={}){if(e==null)throw new Error("Not a valid cid");let n=Ga(e),i=ja(e);return this._log(`wantBlock:${e}`),await new Promise((o,s)=>{let a=()=>{this.removeListener(n,c),t.onProgress?.(new C("bitswap:want-block:unwant",e)),s(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(i,a),t.onProgress?.(new C("bitswap:want-block:block",e)),o(u)};this.once(i,a),this.once(n,c),t.signal?.addEventListener("abort",()=>{this.removeListener(n,c),this.removeListener(i,a),s(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=ja(e);this._log(t),this.emit(t)}};var ec=U(Qr(),1);var Za=U(Qr(),1),Oi=U(Ja(),1),Xt=class extends Za.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(n=>{this._stats[n]=BigInt(0),this._movingAverages[n]={},this._options.movingAverageIntervals.forEach(i=>{(this._movingAverages[n][i]=(0,Oi.default)(i)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._enabled=!1}stop(){this._timeout!=null&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout!=null&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=void 0,this._queue.length>0){let e;for(;this._queue.length>0;){let t=e=this._queue.shift();t!=null&&this._applyOp(t)}e!=null&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t>0&&Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,n){let i=this._frequencyAccumulators[e]??0;this._frequencyAccumulators[e]=0;let o=i/t*1e3,s=this._movingAverages[e];s==null&&(s=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=s[a];c==null&&(c=s[a]=(0,Oi.default)(a)),c.push(n,o)})}_applyOp(e){let t=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(n),this._frequencyAccumulators[t]==null&&(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=n}};var Ya={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},Zr=class extends ec.EventEmitter{constructor(e,t=[],n=Ya){super();let i=Object.assign({},Ya,n);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=i,this._enabled=this._options.enabled,this._global=new Xt(t,i),this._global.on("update",o=>this.emit("update",o)),this._peers=Oe({name:"ipfs_bitswap_stats_peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=e.toString();return this._peers.get(t)}push(e,t,n){if(this._enabled&&(this._global.push(t,n),e!=null)){let i=this._peers.get(e);i==null&&(i=new Xt(this._initialCounters,this._options),this._peers.set(e,i)),i.push(t,n)}}disconnected(e){let t=e.toString(),n=this._peers.get(t);n!=null&&(n.stop(),this._peers.delete(t))}};var nc=U(rc(),1);function Vh(r){return r[Symbol.asyncIterator]!=null}function jh(r,e){if(Vh(r))return async function*(){for await(let a of r)await e(a),yield a}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();if(typeof e(n)?.then=="function")return async function*(){yield n;for await(let a of t)await e(a),yield a}();let s=e;return function*(){yield n;for(let a of t)s(a),yield a}()}var Jt=jh;var Gh={async getHasher(){throw new Error("Not implemented")}},Qh={maxInboundStreams:1024,maxOutboundStreams:1024,incomingStreamTimeout:3e4,hashLoader:Gh,statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},Kh=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],Yr=class{constructor(e,t,n={}){this._libp2p=e,this._log=ae(this.peerId),n=Object.assign({},Qh,n),this.stats=new Zr(e,Kh,{enabled:n.statsEnabled,computeThrottleTimeout:n.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:n.statsComputeThrottleMaxQueueSize}),this.network=new $r(e,this,this.stats,{hashLoader:n.hashLoader,maxInboundStreams:n.maxInboundStreams,maxOutboundStreams:n.maxOutboundStreams,incomingStreamTimeout:n.incomingStreamTimeout}),this.blockstore=t,this.engine=new Vr(this.peerId,t,this.network,this.stats,e),this.wm=new Pr(this.peerId,this.network,this.stats,e),this.notifications=new Jr(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch{this._log("failed to receive message",t)}if(t.blocks.size===0)return;let n=[];for(let[i,o]of t.blocks.entries()){let s=x.parse(i);n.push({wasWanted:this.wm.wantlist.contains(s),cid:s,data:o})}this.wm.cancelWants(n.filter(({wasWanted:i})=>i).map(({cid:i})=>i)),await Promise.all(n.map(async({cid:i,wasWanted:o,data:s})=>{await this._handleReceivedBlock(e,i,s,o)}))}async _handleReceivedBlock(e,t,n,i){this._log("received block");let o=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,n,o),i&&await this.put(t,n)}_updateReceiveCounters(e,t,n,i){this.stats.push(e,"blocksReceived",1),this.stats.push(e,"dataReceived",n.length),i&&(this.stats.push(e,"dupBlksReceived",1),this.stats.push(e,"dupDataReceived",n.length))}_receiveError(e){this._log.error("ReceiveError",e)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this.stats.disconnected(e)}enableStats(){this.stats.enable()}disableStats(){this.stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async want(e,t={}){let n=async(c,u)=>(this.wm.wantBlocks([c],u),await this.notifications.wantBlock(c,u)),i=!1,o=async(c,u)=>{try{return await this.blockstore.get(c,u)}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l;return i||(i=!0,this.network.findAndConnect(c,u).catch(h=>{this._log.error(h)})),await n(c,u)}},s=new AbortController,a=t.signal!=null?(0,nc.anySignal)([t.signal,s.signal]):s.signal;try{return await Promise.race([this.notifications.wantBlock(e,{...t,signal:a}),o(e,{...t,signal:a})])}finally{s.abort()}}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(n=>{this.notifications.unwantBlock(n)})}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,n){await this.blockstore.put(e,t),this.notify(e,t)}async*putMany(e,t){yield*this.blockstore.putMany(Jt(e,({cid:n,block:i})=>{this.notify(n,i)}),t)}notify(e,t,n={}){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,block:t}]),this.network.provide(e,n).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}get peers(){return this.engine.peers()}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this.stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}};var ic=(r,e,t={})=>new Yr(r,e,t);function Xh(r){return r[Symbol.asyncIterator]!=null}function Jh(r,e){if(Xh(r))return async function*(){for await(let a of r)await e(a)&&(yield a)}();let t=St(r),{value:n,done:i}=t.next();if(i===!0)return function*(){}();let o=e(n);if(typeof o.then=="function")return async function*(){await o&&(yield n);for await(let a of t)await e(a)&&(yield a)}();let s=e;return function*(){o===!0&&(yield n);for(let a of t)s(a)&&(yield a)}()}var ve=Jh;var mc=U(sc(),1);var Yt=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},zi=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},ac=r=>globalThis.DOMException===void 0?new zi(r):new DOMException(r),cc=r=>{let e=r.reason===void 0?ac("This operation was aborted."):r.reason;return e instanceof Error?e:ac(e)};function $i(r,e,t,n){let i,o=new Promise((s,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(r);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:c}=n;c.aborted&&a(cc(c)),c.addEventListener("abort",()=>{a(cc(c))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{s(t())}catch(l){a(l)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,u=t instanceof Error?t:new Yt(c);typeof r.cancel=="function"&&r.cancel(),a(u)},e),(async()=>{try{s(await r)}catch(c){a(c)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return o.clear=()=>{clearTimeout(i),i=void 0},o}function Wi(r,e,t){let n=0,i=r.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;t(r[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var st=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Te,er=class{constructor(){Te.set(this,[])}enqueue(e,t){t={priority:0,...t};let n={priority:t.priority,run:e};if(this.size&&st(this,Te,"f")[this.size-1].priority>=t.priority){st(this,Te,"f").push(n);return}let i=Wi(st(this,Te,"f"),n,(o,s)=>s.priority-o.priority);st(this,Te,"f").splice(i,0,n)}dequeue(){let e=st(this,Te,"f").shift();return e?.run}filter(e){return st(this,Te,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return st(this,Te,"f").length}};Te=new WeakMap;var N=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},b=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},F,rr,nr,ze,an,ir,tn,me,tr,J,rn,Z,or,Re,nn,uc,lc,dc,fc,hc,on,Hi,qi,cn,pc,sn,un=class extends Error{},Ae=class extends mc.default{constructor(e){var t,n,i,o;if(super(),F.add(this),rr.set(this,void 0),nr.set(this,void 0),ze.set(this,0),an.set(this,void 0),ir.set(this,void 0),tn.set(this,0),me.set(this,void 0),tr.set(this,void 0),J.set(this,void 0),rn.set(this,void 0),Z.set(this,0),or.set(this,void 0),Re.set(this,void 0),nn.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:er,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);N(this,rr,e.carryoverConcurrencyCount,"f"),N(this,nr,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),N(this,an,e.intervalCap,"f"),N(this,ir,e.interval,"f"),N(this,J,new e.queueClass,"f"),N(this,rn,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,N(this,nn,e.throwOnTimeout===!0,"f"),N(this,Re,e.autoStart===!1,"f")}get concurrency(){return b(this,or,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);N(this,or,e,"f"),b(this,F,"m",cn).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:b(this,nn,"f"),...t},new Promise((n,i)=>{b(this,J,"f").enqueue(async()=>{var o,s,a;N(this,Z,(s=b(this,Z,"f"),s++,s),"f"),N(this,ze,(a=b(this,ze,"f"),a++,a),"f");try{if(!((o=t.signal)===null||o===void 0)&&o.aborted)throw new un("The task was aborted.");let c=e({signal:t.signal});t.timeout&&(c=$i(Promise.resolve(c),t.timeout)),t.signal&&(c=Promise.race([c,b(this,F,"m",pc).call(this,t.signal)]));let u=await c;n(u),this.emit("completed",u)}catch(c){if(c instanceof Yt&&!t.throwOnTimeout){n();return}i(c),this.emit("error",c)}finally{b(this,F,"m",dc).call(this)}},t),this.emit("add"),b(this,F,"m",on).call(this)})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return b(this,Re,"f")?(N(this,Re,!1,"f"),b(this,F,"m",cn).call(this),this):this}pause(){N(this,Re,!0,"f")}clear(){N(this,J,new(b(this,rn,"f")),"f")}async onEmpty(){b(this,J,"f").size!==0&&await b(this,F,"m",sn).call(this,"empty")}async onSizeLessThan(e){b(this,J,"f").size<e||await b(this,F,"m",sn).call(this,"next",()=>b(this,J,"f").size<e)}async onIdle(){b(this,Z,"f")===0&&b(this,J,"f").size===0||await b(this,F,"m",sn).call(this,"idle")}get size(){return b(this,J,"f").size}sizeBy(e){return b(this,J,"f").filter(e).length}get pending(){return b(this,Z,"f")}get isPaused(){return b(this,Re,"f")}};rr=new WeakMap,nr=new WeakMap,ze=new WeakMap,an=new WeakMap,ir=new WeakMap,tn=new WeakMap,me=new WeakMap,tr=new WeakMap,J=new WeakMap,rn=new WeakMap,Z=new WeakMap,or=new WeakMap,Re=new WeakMap,nn=new WeakMap,F=new WeakSet,uc=function(){return b(this,nr,"f")||b(this,ze,"f")<b(this,an,"f")},lc=function(){return b(this,Z,"f")<b(this,or,"f")},dc=function(){var e;N(this,Z,(e=b(this,Z,"f"),e--,e),"f"),b(this,F,"m",on).call(this),this.emit("next")},fc=function(){b(this,F,"m",qi).call(this),b(this,F,"m",Hi).call(this),N(this,tr,void 0,"f")},hc=function(){let e=Date.now();if(b(this,me,"f")===void 0){let t=b(this,tn,"f")-e;if(t<0)N(this,ze,b(this,rr,"f")?b(this,Z,"f"):0,"f");else return b(this,tr,"f")===void 0&&N(this,tr,setTimeout(()=>{b(this,F,"m",fc).call(this)},t),"f"),!0}return!1},on=function(){if(b(this,J,"f").size===0)return b(this,me,"f")&&clearInterval(b(this,me,"f")),N(this,me,void 0,"f"),this.emit("empty"),b(this,Z,"f")===0&&this.emit("idle"),!1;if(!b(this,Re,"f")){let e=!b(this,F,"a",hc);if(b(this,F,"a",uc)&&b(this,F,"a",lc)){let t=b(this,J,"f").dequeue();return t?(this.emit("active"),t(),e&&b(this,F,"m",Hi).call(this),!0):!1}}return!1},Hi=function(){b(this,nr,"f")||b(this,me,"f")!==void 0||(N(this,me,setInterval(()=>{b(this,F,"m",qi).call(this)},b(this,ir,"f")),"f"),N(this,tn,Date.now()+b(this,ir,"f"),"f"))},qi=function(){b(this,ze,"f")===0&&b(this,Z,"f")===0&&b(this,me,"f")&&(clearInterval(b(this,me,"f")),N(this,me,void 0,"f")),N(this,ze,b(this,rr,"f")?b(this,Z,"f"):0,"f"),b(this,F,"m",cn).call(this)},cn=function(){for(;b(this,F,"m",on).call(this););},pc=async function(e){return new Promise((t,n)=>{e.addEventListener("abort",()=>{n(new un("The task was aborted."))},{once:!0})})},sn=async function(e,t){return new Promise(n=>{let i=()=>{t&&!t()||(this.off(e,i),n())};this.on(e,i)})};var Vi=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},ji=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},yc=r=>globalThis.DOMException===void 0?new ji(r):new DOMException(r),gc=r=>{let e=r.reason===void 0?yc("This operation was aborted."):r.reason;return e instanceof Error?e:yc(e)};function Gi(r,e){let{milliseconds:t,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=e,s,a=new Promise((c,u)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){c(r);return}if(e.signal){let{signal:h}=e;h.aborted&&u(gc(h)),h.addEventListener("abort",()=>{u(gc(h))})}let l=new Vi;s=o.setTimeout.call(void 0,()=>{if(n){try{c(n())}catch(h){u(h)}return}typeof r.cancel=="function"&&r.cancel(),i===!1?c():i instanceof Error?u(i):(l.message=i??`Promise timed out after ${t} milliseconds`,u(l))},t),(async()=>{try{c(await r)}catch(h){u(h)}finally{o.clearTimeout.call(void 0,s)}})()});return a.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},a}var wc=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");var Qi="lock:worker:request-read",Ki="lock:worker:release-read",Xi="lock:master:grant-read",Ji="lock:worker:request-write",Zi="lock:worker:release-write",Yi="lock:master:grant-write";var $e={},At=r=>{r.addEventListener("message",e=>{At.dispatchEvent("message",r,e)}),r.port!=null&&r.port.addEventListener("message",e=>{At.dispatchEvent("message",r,e)})};At.addEventListener=(r,e)=>{$e[r]==null&&($e[r]=[]),$e[r].push(e)};At.removeEventListener=(r,e)=>{$e[r]!=null&&($e[r]=$e[r].filter(t=>t===e))};At.dispatchEvent=function(r,e,t){$e[r]!=null&&$e[r].forEach(n=>n(e,t))};var eo=At;var bc=(r,e,t,n,i)=>(o,s)=>{if(s.data.type!==t)return;let a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};r.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:async()=>(o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise(c=>{let u=l=>{if(l==null||l.data==null)return;let h={type:l.data.type,name:l.data.name,identifier:l.data.identifier};h.type===n&&h.identifier===a.identifier&&(o.removeEventListener("message",u),c())};o.addEventListener("message",u)}))}}))},_c=(r,e,t,n)=>async()=>{let i=wc();return globalThis.postMessage({type:e,identifier:i,name:r}),await new Promise(o=>{let s=a=>{if(a==null||a.data==null)return;let c={type:a.data.type,identifier:a.data.identifier};c.type===t&&c.identifier===i&&(globalThis.removeEventListener("message",s),o(()=>{globalThis.postMessage({type:n,identifier:i,name:r})}))};globalThis.addEventListener("message",s)})},ed={singleProcess:!1},vc=r=>{if(r=Object.assign({},ed,r),!!globalThis.document||r.singleProcess){let t=new EventTarget;return eo.addEventListener("message",bc(t,"requestReadLock",Qi,Ki,Xi)),eo.addEventListener("message",bc(t,"requestWriteLock",Ji,Zi,Yi)),t}return{isWorker:!0,readLock:t=>_c(t,Qi,Xi,Ki),writeLock:t=>_c(t,Ji,Yi,Zi)}};var at={},We;async function to(r,e){let t,n=new Promise(i=>{t=i});return r.add(async()=>await Gi((async()=>await new Promise(i=>{t(()=>{i()})}))(),{milliseconds:e.timeout})),await n}var td=(r,e)=>{if(We.isWorker===!0)return{readLock:We.readLock(r,e),writeLock:We.writeLock(r,e)};let t=new Ae({concurrency:1}),n;return{async readLock(){if(n!=null)return await to(n,e);n=new Ae({concurrency:e.concurrency,autoStart:!1});let i=n,o=to(n,e);return t.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await o},async writeLock(){return n=null,await to(t,e)}}},rd={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function ro(r){let e=Object.assign({},rd,r);return We==null&&(We=vc(e),We.isWorker!==!0&&(We.addEventListener("requestReadLock",t=>{at[t.data.name]!=null&&at[t.data.name].readLock().then(async n=>await t.data.handler().finally(()=>n()))}),We.addEventListener("requestWriteLock",async t=>{at[t.data.name]!=null&&at[t.data.name].writeLock().then(async n=>await t.data.handler().finally(()=>n()))}))),at[e.name]==null&&(at[e.name]=td(e.name,e)),at[e.name]}var ln=class{constructor(e,t,n={}){this.child=e,this.bitswap=n.bitswap,this.pins=t,this.lock=ro({singleProcess:n.holdGcLock})}unwrap(){return this.child}async put(e,t,n={}){let i=await this.lock.readLock();try{return await this.child.has(e)?(n.onProgress?.(new C("blocks:put:duplicate",e)),e):(this.bitswap?.isStarted()===!0&&(n.onProgress?.(new C("blocks:put:bitswap:notify",e)),this.bitswap.notify(e,t,n)),n.onProgress?.(new C("blocks:put:blockstore:put",e)),await this.child.put(e,t,n))}finally{i()}}async*putMany(e,t={}){let n=await this.lock.readLock();try{let i=ve(e,async({cid:s})=>{let a=await this.child.has(s);return a&&t.onProgress?.(new C("blocks:put-many:duplicate",s)),!a}),o=Jt(i,({cid:s,block:a})=>{t.onProgress?.(new C("blocks:put-many:bitswap:notify",s)),this.bitswap?.notify(s,a,t)});t.onProgress?.(new C("blocks:put-many:blockstore:put-many")),yield*this.child.putMany(o,t)}finally{n()}}async get(e,t={}){let n=await this.lock.readLock();try{if(this.bitswap?.isStarted()!=null&&!await this.child.has(e)){t.onProgress?.(new C("blocks:get:bitswap:get",e));let i=await this.bitswap.want(e,t);return t.onProgress?.(new C("blocks:get:blockstore:put",e)),await this.child.put(e,i,t),i}return t.onProgress?.(new C("blocks:get:blockstore:get",e)),await this.child.get(e,t)}finally{n()}}async*getMany(e,t={}){let n=await this.lock.readLock();try{t.onProgress?.(new C("blocks:get-many:blockstore:get-many")),yield*this.child.getMany(Jt(e,async i=>{if(this.bitswap?.isStarted()===!0&&!await this.child.has(i)){t.onProgress?.(new C("blocks:get-many:bitswap:get",i));let o=await this.bitswap.want(i,t);t.onProgress?.(new C("blocks:get-many:blockstore:put",i)),await this.child.put(i,o,t)}}))}finally{n()}}async delete(e,t={}){let n=await this.lock.writeLock();try{if(await this.pins.isPinned(e))throw new Error("CID was pinned");t.onProgress?.(new C("blocks:delete:blockstore:delete",e)),await this.child.delete(e,t)}finally{n()}}async*deleteMany(e,t={}){let n=await this.lock.writeLock();try{let i=this;t.onProgress?.(new C("blocks:delete-many:blockstore:delete-many")),yield*this.child.deleteMany(async function*(){for await(let o of e){if(await i.pins.isPinned(o))throw new Error("CID was pinned");yield o}}(),t)}finally{n()}}async has(e,t={}){let n=await this.lock.readLock();try{return await this.child.has(e,t)}finally{n()}}async*getAll(e={}){let t=await this.lock.readLock();try{e.onProgress?.(new C("blocks:get-all:blockstore:get-many")),yield*this.child.getAll(e)}finally{t()}}};var xc=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");function fn(r,e="utf8"){let t=Xr[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rt(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}var Be="/",kc=new TextEncoder().encode(Be),hn=kc[0],P=class{constructor(e,t){if(typeof e=="string")this._buf=fn(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==hn)throw new Error("Invalid key")}toString(e="utf8"){return ot(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new P(e.join(Be))}static random(){return new P(xc().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new P(e):typeof e.uint8Array=="function"?new P(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=kc),this._buf[0]!==hn){let e=new Uint8Array(this._buf.byteLength+1);e.fill(hn,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===hn;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return P.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Be).slice(1)}type(){return nd(this.baseNamespace())}name(){return id(this.baseNamespace())}instance(e){return new P(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Be)||(e+=Be),e+=this.type(),new P(e)}parent(){let e=this.list();return e.length===1?new P(Be):new P(e.slice(0,-1).join(Be))}child(e){return this.toString()===Be?e:e.toString()===Be?this:new P(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return P.withNamespaces([...this.namespaces(),...od(e.map(t=>t.namespaces()))])}};function nd(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function id(r){let e=r.split(":");return e[e.length-1]}function od(r){return[].concat(...r)}var sd=["string","number","bigint","symbol"],ad=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Ec(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(sd.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(cd(r))return"Buffer";let t=ud(r);return t||"Object"}function cd(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function ud(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(ad.includes(e))return e}var f=class{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};f.uint=new f(0,"uint",!0);f.negint=new f(1,"negint",!0);f.bytes=new f(2,"bytes",!0);f.string=new f(3,"string",!0);f.array=new f(4,"array",!1);f.map=new f(5,"map",!1);f.tag=new f(6,"tag",!1);f.float=new f(7,"float",!0);f.false=new f(7,"false",!0);f.true=new f(7,"true",!0);f.null=new f(7,"null",!0);f.undefined=new f(7,"undefined",!0);f.break=new f(7,"break",!0);var p=class{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var Bt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",ld=new TextDecoder,fd=new TextEncoder;function dn(r){return Bt&&globalThis.Buffer.isBuffer(r)}function sr(r){return r instanceof Uint8Array?dn(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}var Bc=Bt?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):Tc(r,e,t):(r,e,t)=>t-e>64?ld.decode(r.subarray(e,t)):Tc(r,e,t),pn=Bt?r=>r.length>64?globalThis.Buffer.from(r):Sc(r):r=>r.length>64?fd.encode(r):Sc(r),xe=r=>Uint8Array.from(r),Ct=Bt?(r,e,t)=>dn(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),Cc=Bt?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),sr(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),n=0;for(let i of r)n+i.length>t.length&&(i=i.subarray(0,t.length-n)),t.set(i,n),n+=i.length;return t},Lc=Bt?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);function Pc(r,e){if(dn(r)&&dn(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function Sc(r,e=1/0){let t,n=r.length,i=null,o=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Tc(r,e,t){let n=[];for(;e<t;){let i=r[e],o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=t){let a,c,u,l;switch(s){case 1:i<128&&(o=i);break;case 2:a=r[e+1],(a&192)===128&&(l=(i&31)<<6|a&63,l>127&&(o=l));break;case 3:a=r[e+1],c=r[e+2],(a&192)===128&&(c&192)===128&&(l=(i&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:a=r[e+1],c=r[e+2],u=r[e+3],(a&192)===128&&(c&192)===128&&(u&192)===128&&(l=(i&15)<<18|(a&63)<<12|(c&63)<<6|u&63,l>65535&&l<1114112&&(o=l))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),e+=s}return no(n)}var Ac=4096;function no(r){let e=r.length;if(e<=Ac)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=Ac));return t}var hd=256,ar=class{constructor(e=hd){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let i=t.length-(this.maxCursor-this.cursor)-1;t.set(e,i)}else{if(t){let i=t.length-(this.maxCursor-this.cursor)-1;i<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,i),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=Lc(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ct(n,0,this.cursor)}else t=Cc(this.chunks,this.cursor);return e&&this.reset(),t}};var w="CBOR decode error:",Lt="CBOR encode error:",cr=[];cr[23]=1;cr[24]=2;cr[25]=3;cr[26]=5;cr[27]=9;function Ce(r,e,t){if(r.length-e<t)throw new Error(`${w} not enough data for type`)}var z=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Y(r,e,t){Ce(r,e,1);let n=r[e];if(t.strict===!0&&n<z[0])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function ee(r,e,t){Ce(r,e,2);let n=r[e]<<8|r[e+1];if(t.strict===!0&&n<z[1])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function te(r,e,t){Ce(r,e,4);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&n<z[2])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function re(r,e,t){Ce(r,e,8);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],i=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(t.strict===!0&&o<z[3])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(t.allowBigInt===!0)return o;throw new Error(`${w} integers outside of the safe integer range are not supported`)}function Ic(r,e,t,n){return new p(f.uint,Y(r,e+1,n),2)}function Nc(r,e,t,n){return new p(f.uint,ee(r,e+1,n),3)}function Dc(r,e,t,n){return new p(f.uint,te(r,e+1,n),5)}function Mc(r,e,t,n){return new p(f.uint,re(r,e+1,n),9)}function ue(r,e){return W(r,0,e.value)}function W(r,e,t){if(t<z[0]){let n=Number(t);r.push([e|n])}else if(t<z[1]){let n=Number(t);r.push([e|24,n])}else if(t<z[2]){let n=Number(t);r.push([e|25,n>>>8,n&255])}else if(t<z[3]){let n=Number(t);r.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(t);if(n<z[4]){let i=[e|27,0,0,0,0,0,0,0],o=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=o&255,o=o>>8,i[7]=o&255,o=o>>8,i[6]=o&255,o=o>>8,i[5]=o&255,i[4]=s&255,s=s>>8,i[3]=s&255,s=s>>8,i[2]=s&255,s=s>>8,i[1]=s&255,r.push(i)}else throw new Error(`${w} encountered BigInt larger than allowable range`)}}ue.encodedSize=function(e){return W.encodedSize(e.value)};W.encodedSize=function(e){return e<z[0]?1:e<z[1]?2:e<z[2]?3:e<z[3]?5:9};ue.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function Fc(r,e,t,n){return new p(f.negint,-1-Y(r,e+1,n),2)}function Oc(r,e,t,n){return new p(f.negint,-1-ee(r,e+1,n),3)}function Uc(r,e,t,n){return new p(f.negint,-1-te(r,e+1,n),5)}var io=BigInt(-1),Rc=BigInt(1);function zc(r,e,t,n){let i=re(r,e+1,n);if(typeof i!="bigint"){let o=-1-i;if(o>=Number.MIN_SAFE_INTEGER)return new p(f.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${w} integers outside of the safe integer range are not supported`);return new p(f.negint,io-BigInt(i),9)}function mn(r,e){let t=e.value,n=typeof t=="bigint"?t*io-Rc:t*-1-1;W(r,e.type.majorEncoded,n)}mn.encodedSize=function(e){let t=e.value,n=typeof t=="bigint"?t*io-Rc:t*-1-1;return n<z[0]?1:n<z[1]?2:n<z[2]?3:n<z[3]?5:9};mn.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function ur(r,e,t,n){Ce(r,e,t+n);let i=Ct(r,e+t,e+t+n);return new p(f.bytes,i,t+n)}function $c(r,e,t,n){return ur(r,e,1,t)}function Wc(r,e,t,n){return ur(r,e,2,Y(r,e+1,n))}function Hc(r,e,t,n){return ur(r,e,3,ee(r,e+1,n))}function qc(r,e,t,n){return ur(r,e,5,te(r,e+1,n))}function Vc(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer bytes lengths not supported`);return ur(r,e,9,i)}function yn(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===f.string?pn(r.value):r.value),r.encodedBytes}function Pt(r,e){let t=yn(e);W(r,e.type.majorEncoded,t.length),r.push(t)}Pt.encodedSize=function(e){let t=yn(e);return W.encodedSize(t.length)+t.length};Pt.compareTokens=function(e,t){return pd(yn(e),yn(t))};function pd(r,e){return r.length<e.length?-1:r.length>e.length?1:Pc(r,e)}function lr(r,e,t,n,i){let o=t+n;Ce(r,e,o);let s=new p(f.string,Bc(r,e+t,e+o),o);return i.retainStringBytes===!0&&(s.byteValue=Ct(r,e+t,e+o)),s}function jc(r,e,t,n){return lr(r,e,1,t,n)}function Gc(r,e,t,n){return lr(r,e,2,Y(r,e+1,n),n)}function Qc(r,e,t,n){return lr(r,e,3,ee(r,e+1,n),n)}function Kc(r,e,t,n){return lr(r,e,5,te(r,e+1,n),n)}function Xc(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer string lengths not supported`);return lr(r,e,9,i,n)}var Jc=Pt;function It(r,e,t,n){return new p(f.array,n,t)}function Zc(r,e,t,n){return It(r,e,1,t)}function Yc(r,e,t,n){return It(r,e,2,Y(r,e+1,n))}function eu(r,e,t,n){return It(r,e,3,ee(r,e+1,n))}function tu(r,e,t,n){return It(r,e,5,te(r,e+1,n))}function ru(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer array lengths not supported`);return It(r,e,9,i)}function nu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return It(r,e,1,1/0)}function gn(r,e){W(r,f.array.majorEncoded,e.value)}gn.compareTokens=ue.compareTokens;gn.encodedSize=function(e){return W.encodedSize(e.value)};function Nt(r,e,t,n){return new p(f.map,n,t)}function iu(r,e,t,n){return Nt(r,e,1,t)}function ou(r,e,t,n){return Nt(r,e,2,Y(r,e+1,n))}function su(r,e,t,n){return Nt(r,e,3,ee(r,e+1,n))}function au(r,e,t,n){return Nt(r,e,5,te(r,e+1,n))}function cu(r,e,t,n){let i=re(r,e+1,n);if(typeof i=="bigint")throw new Error(`${w} 64-bit integer map lengths not supported`);return Nt(r,e,9,i)}function uu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return Nt(r,e,1,1/0)}function wn(r,e){W(r,f.map.majorEncoded,e.value)}wn.compareTokens=ue.compareTokens;wn.encodedSize=function(e){return W.encodedSize(e.value)};function lu(r,e,t,n){return new p(f.tag,t,1)}function fu(r,e,t,n){return new p(f.tag,Y(r,e+1,n),2)}function hu(r,e,t,n){return new p(f.tag,ee(r,e+1,n),3)}function du(r,e,t,n){return new p(f.tag,te(r,e+1,n),5)}function pu(r,e,t,n){return new p(f.tag,re(r,e+1,n),9)}function bn(r,e){W(r,f.tag.majorEncoded,e.value)}bn.compareTokens=ue.compareTokens;bn.encodedSize=function(e){return W.encodedSize(e.value)};var _d=20,vd=21,xd=22,kd=23;function mu(r,e,t,n){if(n.allowUndefined===!1)throw new Error(`${w} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new p(f.null,null,1):new p(f.undefined,void 0,1)}function yu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return new p(f.break,void 0,1)}function oo(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${w} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${w} Infinity values are not supported`)}return new p(f.float,r,e)}function gu(r,e,t,n){return oo(so(r,e+1),3,n)}function wu(r,e,t,n){return oo(ao(r,e+1),5,n)}function bu(r,e,t,n){return oo(ku(r,e+1),9,n)}function _n(r,e,t){let n=e.value;if(n===!1)r.push([f.float.majorEncoded|_d]);else if(n===!0)r.push([f.float.majorEncoded|vd]);else if(n===null)r.push([f.float.majorEncoded|xd]);else if(n===void 0)r.push([f.float.majorEncoded|kd]);else{let i,o=!1;(!t||t.float64!==!0)&&(vu(n),i=so(ye,1),n===i||Number.isNaN(n)?(ye[0]=249,r.push(ye.slice(0,3)),o=!0):(xu(n),i=ao(ye,1),n===i&&(ye[0]=250,r.push(ye.slice(0,5)),o=!0))),o||(Ed(n),i=ku(ye,1),ye[0]=251,r.push(ye.slice(0,9)))}}_n.encodedSize=function(e,t){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){vu(n);let i=so(ye,1);if(n===i||Number.isNaN(n))return 3;if(xu(n),i=ao(ye,1),n===i)return 5}return 9};var _u=new ArrayBuffer(9),le=new DataView(_u,1),ye=new Uint8Array(_u,0);function vu(r){if(r===1/0)le.setUint16(0,31744,!1);else if(r===-1/0)le.setUint16(0,64512,!1);else if(Number.isNaN(r))le.setUint16(0,32256,!1);else{le.setFloat32(0,r);let e=le.getUint32(0),t=(e&2139095040)>>23,n=e&8388607;if(t===255)le.setUint16(0,31744,!1);else if(t===0)le.setUint16(0,(r&2147483648)>>16|n>>13,!1);else{let i=t-127;i<-24?le.setUint16(0,0):i<-14?le.setUint16(0,(e&2147483648)>>16|1<<24+i,!1):le.setUint16(0,(e&2147483648)>>16|i+15<<10|n>>13,!1)}}}function so(r,e){if(r.length-e<2)throw new Error(`${w} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let n=t>>10&31,i=t&1023,o;return n===0?o=i*2**-24:n!==31?o=(i+1024)*2**(n-25):o=i===0?1/0:NaN,t&32768?-o:o}function xu(r){le.setFloat32(0,r,!1)}function ao(r,e){if(r.length-e<4)throw new Error(`${w} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function Ed(r){le.setFloat64(0,r,!1)}function ku(r,e){if(r.length-e<8)throw new Error(`${w} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}_n.compareTokens=ue.compareTokens;function A(r,e,t){throw new Error(`${w} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function vn(r){return()=>{throw new Error(`${w} ${r}`)}}var m=[];for(let r=0;r<=23;r++)m[r]=A;m[24]=Ic;m[25]=Nc;m[26]=Dc;m[27]=Mc;m[28]=A;m[29]=A;m[30]=A;m[31]=A;for(let r=32;r<=55;r++)m[r]=A;m[56]=Fc;m[57]=Oc;m[58]=Uc;m[59]=zc;m[60]=A;m[61]=A;m[62]=A;m[63]=A;for(let r=64;r<=87;r++)m[r]=$c;m[88]=Wc;m[89]=Hc;m[90]=qc;m[91]=Vc;m[92]=A;m[93]=A;m[94]=A;m[95]=vn("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)m[r]=jc;m[120]=Gc;m[121]=Qc;m[122]=Kc;m[123]=Xc;m[124]=A;m[125]=A;m[126]=A;m[127]=vn("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)m[r]=Zc;m[152]=Yc;m[153]=eu;m[154]=tu;m[155]=ru;m[156]=A;m[157]=A;m[158]=A;m[159]=nu;for(let r=160;r<=183;r++)m[r]=iu;m[184]=ou;m[185]=su;m[186]=au;m[187]=cu;m[188]=A;m[189]=A;m[190]=A;m[191]=uu;for(let r=192;r<=215;r++)m[r]=lu;m[216]=fu;m[217]=hu;m[218]=du;m[219]=pu;m[220]=A;m[221]=A;m[222]=A;m[223]=A;for(let r=224;r<=243;r++)m[r]=vn("simple values are not supported");m[244]=A;m[245]=A;m[246]=A;m[247]=mu;m[248]=vn("simple values are not supported");m[249]=gu;m[250]=wu;m[251]=bu;m[252]=A;m[253]=A;m[254]=A;m[255]=yu;var ge=[];for(let r=0;r<24;r++)ge[r]=new p(f.uint,r,1);for(let r=-1;r>=-24;r--)ge[31-r]=new p(f.negint,r,1);ge[64]=new p(f.bytes,new Uint8Array(0),1);ge[96]=new p(f.string,"",1);ge[128]=new p(f.array,0,1);ge[160]=new p(f.map,0,1);ge[244]=new p(f.false,!1,1);ge[245]=new p(f.true,!0,1);ge[246]=new p(f.null,null,1);function Eu(r){switch(r.type){case f.false:return xe([244]);case f.true:return xe([245]);case f.null:return xe([246]);case f.bytes:return r.value.length?void 0:xe([64]);case f.string:return r.value===""?xe([96]):void 0;case f.array:return r.value===0?xe([128]):void 0;case f.map:return r.value===0?xe([160]):void 0;case f.uint:return r.value<24?xe([Number(r.value)]):void 0;case f.negint:if(r.value>=-24)return xe([31-Number(r.value)])}}var Td={float64:!1,mapSorter:Cd,quickEncodeToken:Eu};function Ad(){let r=[];return r[f.uint.major]=ue,r[f.negint.major]=mn,r[f.bytes.major]=Pt,r[f.string.major]=Jc,r[f.array.major]=gn,r[f.map.major]=wn,r[f.tag.major]=bn,r[f.float.major]=_n,r}var Su=Ad(),co=new ar,Dt=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Lt} object contains circular references`);return new Dt(t,e)}},He={null:new p(f.null,null),undefined:new p(f.undefined,void 0),true:new p(f.true,!0),false:new p(f.false,!1),emptyArray:new p(f.array,0),emptyMap:new p(f.map,0)},qe={number(r,e,t,n){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new p(f.float,r):r>=0?new p(f.uint,r):new p(f.negint,r)},bigint(r,e,t,n){return r>=BigInt(0)?new p(f.uint,r):new p(f.negint,r)},Uint8Array(r,e,t,n){return new p(f.bytes,r)},string(r,e,t,n){return new p(f.string,r)},boolean(r,e,t,n){return r?He.true:He.false},null(r,e,t,n){return He.null},undefined(r,e,t,n){return He.undefined},ArrayBuffer(r,e,t,n){return new p(f.bytes,new Uint8Array(r))},DataView(r,e,t,n){return new p(f.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,n){if(!r.length)return t.addBreakTokens===!0?[He.emptyArray,new p(f.break)]:He.emptyArray;n=Dt.createCheck(n,r);let i=[],o=0;for(let s of r)i[o++]=xn(s,t,n);return t.addBreakTokens?[new p(f.array,r.length),i,new p(f.break)]:[new p(f.array,r.length),i]},Object(r,e,t,n){let i=e!=="Object",o=i?r.keys():Object.keys(r),s=i?r.size:o.length;if(!s)return t.addBreakTokens===!0?[He.emptyMap,new p(f.break)]:He.emptyMap;n=Dt.createCheck(n,r);let a=[],c=0;for(let u of o)a[c++]=[xn(u,t,n),xn(i?r.get(u):r[u],t,n)];return Bd(a,t),t.addBreakTokens?[new p(f.map,s),a,new p(f.break)]:[new p(f.map,s),a]}};qe.Map=qe.Object;qe.Buffer=qe.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))qe[`${r}Array`]=qe.DataView;function xn(r,e={},t){let n=Ec(r),i=e&&e.typeEncoders&&e.typeEncoders[n]||qe[n];if(typeof i=="function"){let s=i(r,n,e,t);if(s!=null)return s}let o=qe[n];if(!o)throw new Error(`${Lt} unsupported type: ${n}`);return o(r,n,e,t)}function Bd(r,e){e.mapSorter&&r.sort(e.mapSorter)}function Cd(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==n.type)return t.type.compare(n.type);let i=t.type.major,o=Su[i].compareTokens(t,n);return o===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function Tu(r,e,t,n){if(Array.isArray(e))for(let i of e)Tu(r,i,t,n);else t[e.type.major](r,e,n)}function Au(r,e,t){let n=xn(r,t);if(!Array.isArray(n)&&t.quickEncodeToken){let i=t.quickEncodeToken(n);if(i)return i;let o=e[n.type.major];if(o.encodedSize){let s=o.encodedSize(n,t),a=new ar(s);if(o(a,n,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return sr(a.chunks[0])}}return co.reset(),Tu(co,n,e,t),co.toBytes(!0)}function kn(r,e){return e=Object.assign({},Td,e),Au(r,Su,e)}var Ld={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},uo=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=ge[e];if(t===void 0){let n=m[e];if(!n)throw new Error(`${w} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;t=n(this.data,this.pos,i,this.options)}return this.pos+=t.encodedLength,t}},fr=Symbol.for("DONE"),En=Symbol.for("BREAK");function Pd(r,e,t){let n=[];for(let i=0;i<r.value;i++){let o=hr(e,t);if(o===En){if(r.value===1/0)break;throw new Error(`${w} got unexpected break to lengthed array`)}if(o===fr)throw new Error(`${w} found array but not enough entries (got ${i}, expected ${r.value})`);n[i]=o}return n}function Id(r,e,t){let n=t.useMaps===!0,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<r.value;s++){let a=hr(e,t);if(a===En){if(r.value===1/0)break;throw new Error(`${w} got unexpected break to lengthed map`)}if(a===fr)throw new Error(`${w} found map but not enough entries (got ${s} [no key], expected ${r.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${w} non-string keys not supported (got ${typeof a})`);if(t.rejectDuplicateMapKeys===!0&&(n&&o.has(a)||!n&&a in i))throw new Error(`${w} found repeat map key "${a}"`);let c=hr(e,t);if(c===fr)throw new Error(`${w} found map but not enough entries (got ${s} [no value], expected ${r.value})`);n?o.set(a,c):i[a]=c}return n?o:i}function hr(r,e){if(r.done())return fr;let t=r.next();if(t.type===f.break)return En;if(t.type.terminal)return t.value;if(t.type===f.array)return Pd(t,r,e);if(t.type===f.map)return Id(t,r,e);if(t.type===f.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let n=hr(r,e);return e.tags[t.value](n)}throw new Error(`${w} tag not supported (${t.value})`)}throw new Error("unsupported")}function Le(r,e){if(!(r instanceof Uint8Array))throw new Error(`${w} data to decode must be a Uint8Array`);e=Object.assign({},Ld,e);let t=e.tokenizer||new uo(r,e),n=hr(t,e);if(n===fr)throw new Error(`${w} did not find any content to decode`);if(n===En)throw new Error(`${w} got unexpected break`);if(!t.done())throw new Error(`${w} too many terminals, data makes no sense`);return n}function lo(){let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r}var Nd=new TextDecoder;function fo(r,e){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let i=r[e++];if(t+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[t,e]}function Sn(r,e){let t;[t,e]=fo(r,e);let n=e+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,n),n]}function Cu(r,e){let t;return[t,e]=fo(r,e),[t&7,t>>3,e]}function Dd(r){let e={},t=r.length,n=0;for(;n<t;){let i,o;if([i,o,n]=Cu(r,n),o===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Sn(r,n)}else if(o===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Sn(r,n),e.Name=Nd.decode(s)}else if(o===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[e.Tsize,n]=fo(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function Lu(r){let e=r.length,t=0,n,i=!1,o;for(;t<e;){let a,c;if([a,c,t]=Cu(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,t]=Sn(r,t),n&&(i=!0)}else if(c===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let u;[u,t]=Sn(r,t),n.push(Dd(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}var Xb=new TextEncoder,Jb=2**32,Zb=2**31;var t0=new TextEncoder;var Pu=112;function Iu(r){let e=Lu(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(n=>{let i={};try{i.Hash=x.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),t}var Nu=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){let t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===f.array&&(t.elements++,t.elements!==1&&e.push([44])),t.type===f.map&&(t.elements++,t.elements!==1&&(t.elements%2===1?e.push([44]):e.push([58]))))}[f.uint.major](e,t){this.prefix(e);let n=String(t.value),i=[];for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o);e.push(i)}[f.negint.major](e,t){this[f.uint.major](e,t)}[f.bytes.major](e,t){throw new Error(`${Lt} unsupported type: Uint8Array`)}[f.string.major](e,t){this.prefix(e);let n=pn(JSON.stringify(t.value));e.push(n.length>32?sr(n):n)}[f.array.major](e,t){this.prefix(e),this.inRecursive.push({type:f.array,elements:0}),e.push([91])}[f.map.major](e,t){this.prefix(e),this.inRecursive.push({type:f.map,elements:0}),e.push([123])}[f.tag.major](e,t){}[f.float.major](e,t){if(t.type.name==="break"){let s=this.inRecursive.pop();if(s){if(s.type===f.array)e.push([93]);else if(s.type===f.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${Lt} unsupported type: undefined`);if(this.prefix(e),t.type.name==="true"){e.push([116,114,117,101]);return}else if(t.type.name==="false"){e.push([102,97,108,115,101]);return}else if(t.type.name==="null"){e.push([110,117,108,108]);return}let n=String(t.value),i=[],o=!1;for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s),!o&&(i[s]===46||i[s]===101||i[s]===69)&&(o=!0);o||(i.push(46),i.push(48)),e.push(i)}};var Mt=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${w} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${w} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this.pos,t=!1,n=!1,i=a=>{for(;!this.done();){let c=this.ch();if(a.includes(c))this.pos++;else break}};if(this.ch()===45&&(t=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,n=!0;else return new p(f.uint,0,this.pos-e);if(i([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${w} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${w} unexpected token at position ${this.pos}`);n=!0,this.pos++,i([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,i([48,49,50,51,52,53,54,55,56,57]));let o=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),s=parseFloat(o);return n?new p(f.float,s,this.pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(s)?new p(s>=0?f.uint:f.negint,s,this.pos-e):new p(s>=0?f.uint:f.negint,BigInt(o),this.pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${w} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let o=this.pos,s=0;o<this.data.length&&s<65536;o++,s++){let a=this.data[o];if(a===92||a<32||a>=128)break;if(a===34){let c=String.fromCharCode.apply(null,this.data.subarray(this.pos,o));return this.pos=o+1,new p(f.string,c,s)}}let e=this.pos,t=[],n=()=>{if(this.pos+4>=this.data.length)throw new Error(`${w} unexpected end of unicode escape sequence at position ${this.pos}`);let o=0;for(let s=0;s<4;s++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${w} unexpected unicode escape character at position ${this.pos}`);o=o*16+a,this.pos++}return o},i=()=>{let o=this.ch(),s=null,a=o>239?4:o>223?3:o>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${w} unexpected unicode sequence at position ${this.pos}`);let c,u,l,h;switch(a){case 1:o<128&&(s=o);break;case 2:c=this.data[this.pos+1],(c&192)===128&&(h=(o&31)<<6|c&63,h>127&&(s=h));break;case 3:c=this.data[this.pos+1],u=this.data[this.pos+2],(c&192)===128&&(u&192)===128&&(h=(o&15)<<12|(c&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:c=this.data[this.pos+1],u=this.data[this.pos+2],l=this.data[this.pos+3],(c&192)===128&&(u&192)===128&&(l&192)===128&&(h=(o&15)<<18|(c&63)<<12|(u&63)<<6|l&63,h>65535&&h<1114112&&(s=h))}s===null?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|s&1023),t.push(s),this.pos+=a};for(;!this.done();){let o=this.ch(),s;switch(o){case 92:if(this.pos++,this.done())throw new Error(`${w} unexpected string termination at position ${this.pos}`);switch(s=this.ch(),this.pos++,s){case 34:case 39:case 92:case 47:t.push(s);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error(`${w} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new p(f.string,no(t),this.pos-e);default:if(o<32)throw new Error(`${w} invalid control character at position ${this.pos}`);o<128?(t.push(o),this.pos++):i()}}throw new Error(`${w} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new p(f.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new p(f.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new p(f.null,null,4);case 102:return this.expect([102,97,108,115,101]),new p(f.false,!1,5);case 116:return this.expect([116,114,117,101]),new p(f.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${w} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);if(this.ch()!==44)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new p(f.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);if(this.ch()!==44)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new p(f.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${w} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${w} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}};function ho(r,e){return e=Object.assign({tokenizer:new Mt(r,e)},e),Le(r,e)}var Du={codec:Pu,async*walk(r){yield*Iu(r).Links.map(t=>t.Hash)}},Mu={codec:Kr,async*walk(){}},Fu=42,Ou={codec:113,async*walk(r){let e=[],t=[];t[Fu]=n=>{if(n[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");let i=x.decode(n.subarray(1));return e.push(i),i},Le(r,{tags:t}),yield*e}},po=class extends Mt{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===f.map){let t=this._next();if(t.type===f.string&&t.value==="/"){let n=this._next();if(n.type===f.string){if(this._next().type!==f.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new p(f.tag,42,0)}if(n.type===f.map){let i=this._next();if(i.type===f.string&&i.value==="bytes"){let o=this._next();if(o.type===f.string){for(let a=0;a<2;a++)if(this._next().type!==f.break)throw new Error("Invalid encoded Bytes form");let s=Wt.decode(`m${o.value}`);return new p(f.bytes,s,o.value.length)}this.tokenBuffer.push(o)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(t)}return e}},Uu={codec:297,async*walk(r){let e=[],t=[];t[Fu]=n=>{let i=x.parse(n);return e.push(i),i},ho(r,{tags:t,tokenizer:new po(r,{tags:t,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})}),yield*e}};var Tn=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ft,mo,Ru,Od=[Mu,Du,Ou,Uu],Wu="/pin/",Hu="/pinned-block/",yo=Kt,zu=1;function $u(r){return r.version===0&&(r=r.toV1()),new P(`${Wu}${r.toString(yo)}`)}var An=class{constructor(e,t,n){Ft.add(this),this.datastore=e,this.blockstore=t,this.dagWalkers={},[...Od,...n].forEach(i=>{this.dagWalkers[i.codec]=i})}async add(e,t={}){let n=$u(e);if(await this.datastore.has(n))throw new Error("Already pinned");let i=Math.round(t.depth??1/0);if(i<0)throw new Error("Depth must be greater than or equal to 0");let o=new Ae({concurrency:zu});o.add(async()=>{await Tn(this,Ft,"m",mo).call(this,e,o,c=>{c.pinnedBy.find(u=>Qe(u,e.bytes))==null&&(c.pinCount++,c.pinnedBy.push(e.bytes))},{...t,depth:i})});let s=lo();o.on("error",c=>{o.clear(),s.reject(c)}),await Promise.race([o.onIdle(),s.promise]);let a={depth:i,metadata:t.metadata??{}};return await this.datastore.put(n,kn(a),t),{cid:e,...a}}async rm(e,t={}){let n=$u(e),i=await this.datastore.get(n,t),o=Le(i);await this.datastore.delete(n,t);let s=new Ae({concurrency:zu});return s.add(async()=>{await Tn(this,Ft,"m",mo).call(this,e,s,a=>{a.pinCount--,a.pinnedBy=a.pinnedBy.filter(c=>Qe(c,e.bytes))},{...t,depth:o.depth})}),await s.onIdle(),{cid:e,...o}}async*ls(e={}){for await(let{key:t,value:n}of this.datastore.query({prefix:Wu+(e.cid!=null?`${e.cid.toString(Kt)}`:"")},e)){let i=x.parse(t.toString().substring(5),Kt),o=Le(n);yield{cid:i,...o}}}async isPinned(e,t={}){let n=new P(`${Hu}${yo.encode(e.multihash.bytes)}`);return await this.datastore.has(n,t)}};Ft=new WeakSet,mo=async function r(e,t,n,i){if(i.depth===-1)return;let o=this.dagWalkers[e.code];if(o==null)throw new Error(`No dag walker found for cid codec ${e.code}`);let s=await this.blockstore.get(e);await Tn(this,Ft,"m",Ru).call(this,e,n,i);for await(let a of o.walk(s))t.add(async()=>{await Tn(this,Ft,"m",r).call(this,a,t,n,{...i,depth:i.depth-1})})},Ru=async function(e,t,n){let i=new P(`${Hu}${yo.encode(e.multihash.bytes)}`),o={pinCount:0,pinnedBy:[]};try{o=Le(await this.datastore.get(i,n))}catch(s){if(s.code!=="ERR_NOT_FOUND")throw s}if(t(o),o.pinCount===0&&await this.datastore.has(i)){await this.datastore.delete(i);return}await this.datastore.put(i,kn(o),n)};var go=new P("/version"),qu=1;async function Vu(r){if(!await r.has(go)){await r.put(go,fn(`${qu}`));return}let e=await r.get(go),t=ot(e);if(parseInt(t,10)!==qu)throw new Error("Unknown datastore version, a datastore migration may be required")}var ju=U(Or(),1);function Bn(r){return r=r??new Error("Not Found"),(0,ju.default)(r,"ERR_NOT_FOUND")}var Gu="SHARDING";function Rd(r){return r[Symbol.asyncIterator]!=null}function zd(r){if(Rd(r))return(async()=>{let t=[];for await(let n of r)t.push(n);return t})();let e=[];for(let t of r)e.push(t);return e}var wo=zd;function $d(r){return r[Symbol.asyncIterator]!=null}function Wd(r,e){return $d(r)?async function*(){yield*(await wo(r)).sort(e)}():function*(){yield*wo(r).sort(e)}()}var Cn=Wd;var Pe=class{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:n,value:i}of e)await this.put(n,i,t),yield n}async*getMany(e,t={}){for await(let n of e)yield{key:n,value:await this.get(n,t)}}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(n,i){e.push({key:n,value:i})},delete(n){t.push(n)},commit:async n=>{await Ue(this.putMany(e,n)),e=[],await Ue(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(e.prefix!=null){let i=e.prefix;n=ve(n,o=>o.key.toString().startsWith(i))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>ve(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>Cn(i,o),n)),e.offset!=null){let i=0,o=e.offset;n=ve(n,()=>i++>=o)}return e.limit!=null&&(n=Et(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(e.prefix!=null){let i=e.prefix;n=ve(n,o=>o.toString().startsWith(i))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>ve(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>Cn(i,o),n)),e.offset!=null){let i=e.offset,o=0;n=ve(n,()=>o++>=i)}return e.limit!=null&&(n=Et(n,e.limit)),n}};var pr=class extends Pe{constructor(){super(),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){let t=this.data.get(e.toString());if(t==null)throw Bn();return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(let[e,t]of this.data.entries())yield{key:new P(e),value:t}}*_allKeys(){for(let e of this.data.keys())yield new P(e)}};var d1=new P(Gu);var S1=wt("datastore:core:tiered");var Ln={};V(Ln,{abortedError:()=>Jd,closeFailedError:()=>jd,deleteFailedError:()=>Kd,getFailedError:()=>Qd,hasFailedError:()=>Xd,notFoundError:()=>bo,openFailedError:()=>Vd,putFailedError:()=>Gd});var Ie=U(Or(),1);function Vd(r){return r=r??new Error("Open failed"),(0,Ie.default)(r,"ERR_OPEN_FAILED")}function jd(r){return r=r??new Error("Close failed"),(0,Ie.default)(r,"ERR_CLOSE_FAILED")}function Gd(r){return r=r??new Error("Put failed"),(0,Ie.default)(r,"ERR_PUT_FAILED")}function Qd(r){return r=r??new Error("Get failed"),(0,Ie.default)(r,"ERR_GET_FAILED")}function Kd(r){return r=r??new Error("Delete failed"),(0,Ie.default)(r,"ERR_DELETE_FAILED")}function Xd(r){return r=r??new Error("Has failed"),(0,Ie.default)(r,"ERR_HAS_FAILED")}function bo(r){return r=r??new Error("Not Found"),(0,Ie.default)(r,"ERR_NOT_FOUND")}function Jd(r){return r=r??new Error("Aborted"),(0,Ie.default)(r,"ERR_ABORTED")}var mr=class{has(e,t){return Promise.reject(new Error(".has is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}async*putMany(e,t){for await(let{cid:n,block:i}of e)await this.put(n,i,t),yield n}get(e,t){return Promise.reject(new Error(".get is not implemented"))}async*getMany(e,t){for await(let n of e)yield{cid:n,block:await this.get(n,t)}}async delete(e,t){await Promise.reject(new Error(".delete is not implemented"))}async*deleteMany(e,t){for await(let n of e)await this.delete(n,t),yield n}async*getAll(e){throw new Error(".getAll is not implemented")}};var yr=class extends mr{constructor(){super(),this.data=new Map}put(e,t){return this.data.set(j.encode(e.multihash.bytes),t),e}get(e){let t=this.data.get(j.encode(e.multihash.bytes));if(t==null)throw bo();return t}has(e){return this.data.has(j.encode(e.multihash.bytes))}async delete(e){this.data.delete(j.encode(e.multihash.bytes))}async*getAll(){for(let[e,t]of this.data.entries())yield{cid:x.createV1(Kr,br(j.decode(e))),block:t}}};var G1={...Ln};var Zd=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},_o=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ot,vo=wt("helia"),Pn=class{constructor(e){Ot.set(this,void 0);let t=[je,On,Nn,...e.hashers??[]],n=e.datastore??new pr,i=e.blockstore??new yr,o=e.libp2p??new Proxy({},{get(s,a){let c=()=>{};if(["start","stop"].includes(a.toString()))return c;if(a==="isProxy")return!0;throw new Error("Please configure Helia with a libp2p instance")},set(){throw new Error("Please configure Helia with a libp2p instance")}});e.libp2p!=null&&Zd(this,Ot,e.bitswap??ic(o,i,{hashLoader:{getHasher:async s=>{let a=t.find(c=>c.code===s||c.name===s);if(a!=null)return await Promise.resolve(a);throw new Error(`Could not load hasher for code/name "${s}"`)}}}),"f"),this.pins=new An(n,i,e.dagWalkers??[]),this.libp2p=o,this.blockstore=new ln(i,this.pins,{bitswap:_o(this,Ot,"f"),holdGcLock:e.holdGcLock}),this.datastore=n}async start(){await Vu(this.datastore),await _o(this,Ot,"f")?.start(),await this.libp2p.start()}async stop(){await this.libp2p.stop(),await _o(this,Ot,"f")?.stop()}async gc(e={}){let t=await this.blockstore.lock.writeLock();try{let n=this,i=this.blockstore.unwrap();vo("gc start"),await Ue(i.deleteMany(async function*(){for await(let{cid:o}of i.getAll())try{if(await n.pins.isPinned(o,e))continue;yield o,e.onProgress?.(new C("helia:gc:deleted",o))}catch(s){vo.error("Error during gc",s),e.onProgress?.(new C("helia:gc:error",s))}}()))}finally{t()}vo("gc finished")}};Ot=new WeakMap;async function Yd(r={}){let e=new Pn(r);return r.start!==!1&&await e.start(),e}return el(ep);})();
 return Helia}));
diff --git a/node_modules/helia/dist/src/helia.js b/node_modules/helia/dist/src/helia.js
index d28c372..6af995c 100644
--- a/node_modules/helia/dist/src/helia.js
+++ b/node_modules/helia/dist/src/helia.js
@@ -51,7 +51,7 @@ export class HeliaImpl {
             }
         });
         if (init.libp2p != null) {
-            __classPrivateFieldSet(this, _HeliaImpl_bitswap, createBitswap(libp2p, blockstore, {
+            __classPrivateFieldSet(this, _HeliaImpl_bitswap, init.bitswap ?? createBitswap(libp2p, blockstore, {
                 hashLoader: {
                     getHasher: async (codecOrName) => {
                         const hasher = hashers.find(hasher => {
diff --git a/node_modules/helia/dist/src/helia.js.map b/node_modules/helia/dist/src/helia.js.map
index 15d2994..7838142 100644
--- a/node_modules/helia/dist/src/helia.js.map
+++ b/node_modules/helia/dist/src/helia.js.map
@@ -1 +1 @@
-{"version":3,"file":"helia.js","sourceRoot":"","sources":["../../src/helia.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"helia.js","sourceRoot":"","sources":["../../src/helia.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/src/index.d.ts b/node_modules/helia/dist/src/index.d.ts
index 855d824..34bf564 100644
--- a/node_modules/helia/dist/src/index.d.ts
+++ b/node_modules/helia/dist/src/index.d.ts
@@ -30,6 +30,7 @@ import type { Blockstore } from 'interface-blockstore';
 import type { Datastore } from 'interface-datastore';
 import type { CID } from 'multiformats/cid';
 import type { MultihashHasher } from 'multiformats/hashes/interface';
+import type { Bitswap } from 'ipfs-bitswap';
 /**
  * DAGWalkers take a block and yield CIDs encoded in that block
  */
@@ -45,6 +46,10 @@ export interface HeliaInit {
      * A libp2p node is required to perform network operations
      */
     libp2p?: Libp2p;
+    /**
+     * An optional custom bitswap implementation
+     */
+    bitswap?: Bitswap;
     /**
      * The blockstore is where blocks are stored
      */
diff --git a/node_modules/helia/dist/src/index.d.ts.map b/node_modules/helia/dist/src/index.d.ts.map
index 6d6b8c6..a10b3fe 100644
--- a/node_modules/helia/dist/src/index.d.ts.map
+++ b/node_modules/helia/dist/src/index.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"index.d.ts","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;GAyBG;AAEH,OAAO,KAAK,EAAE,KAAK,EAAE,MAAM,kBAAkB,CAAA;AAC7C,OAAO,KAAK,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAA;AACtD,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AACtD,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,qBAAqB,CAAA;AACpD,OAAO,KAAK,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AAC3C,OAAO,KAAK,EAAE,eAAe,EAAE,MAAM,+BAA+B,CAAA;AAGpE;;GAEG;AACH,MAAM,WAAW,SAAS;IACxB,KAAK,EAAE,MAAM,CAAA;IACb,IAAI,EAAE,CAAC,KAAK,EAAE,UAAU,KAAK,cAAc,CAAC,GAAG,EAAE,IAAI,EAAE,SAAS,CAAC,CAAA;CAClE;AAED;;GAEG;AACH,MAAM,WAAW,SAAS;IACxB;;OAEG;IACH,MAAM,CAAC,EAAE,MAAM,CAAA;IAEf;;OAEG;IACH,UAAU,CAAC,EAAE,UAAU,CAAA;IAEvB;;OAEG;IACH,SAAS,CAAC,EAAE,SAAS,CAAA;IAErB;;;;OAIG;IACH,OAAO,CAAC,EAAE,eAAe,EAAE,CAAA;IAE3B;;;;OAIG;IACH,UAAU,CAAC,EAAE,SAAS,EAAE,CAAA;IAExB;;OAEG;IACH,KAAK,CAAC,EAAE,OAAO,CAAA;IAEf;;;;;;;;;;;;;;OAcG;IACH,UAAU,CAAC,EAAE,OAAO,CAAA;CACrB;AAED;;GAEG;AACH,wBAAsB,WAAW,CAAE,IAAI,GAAE,SAAc,GAAG,OAAO,CAAC,KAAK,CAAC,CAQvE"}
\ No newline at end of file
+{"version":3,"file":"index.d.ts","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;GAyBG;AAEH,OAAO,KAAK,EAAE,KAAK,EAAE,MAAM,kBAAkB,CAAA;AAC7C,OAAO,KAAK,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAA;AACtD,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AACtD,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,qBAAqB,CAAA;AACpD,OAAO,KAAK,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AAC3C,OAAO,KAAK,EAAE,eAAe,EAAE,MAAM,+BAA+B,CAAA;AAEpE,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,cAAc,CAAA;AAE3C;;GAEG;AACH,MAAM,WAAW,SAAS;IACxB,KAAK,EAAE,MAAM,CAAA;IACb,IAAI,EAAE,CAAC,KAAK,EAAE,UAAU,KAAK,cAAc,CAAC,GAAG,EAAE,IAAI,EAAE,SAAS,CAAC,CAAA;CAClE;AAED;;GAEG;AACH,MAAM,WAAW,SAAS;IACxB;;OAEG;IACH,MAAM,CAAC,EAAE,MAAM,CAAA;IAEf;;OAEG;IACH,OAAO,CAAC,EAAE,OAAO,CAAA;IAEjB;;OAEG;IACH,UAAU,CAAC,EAAE,UAAU,CAAA;IAEvB;;OAEG;IACH,SAAS,CAAC,EAAE,SAAS,CAAA;IAErB;;;;OAIG;IACH,OAAO,CAAC,EAAE,eAAe,EAAE,CAAA;IAE3B;;;;OAIG;IACH,UAAU,CAAC,EAAE,SAAS,EAAE,CAAA;IAExB;;OAEG;IACH,KAAK,CAAC,EAAE,OAAO,CAAA;IAEf;;;;;;;;;;;;;;OAcG;IACH,UAAU,CAAC,EAAE,OAAO,CAAA;CACrB;AAED;;GAEG;AACH,wBAAsB,WAAW,CAAE,IAAI,GAAE,SAAc,GAAG,OAAO,CAAC,KAAK,CAAC,CAQvE"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/src/index.js.map b/node_modules/helia/dist/src/index.js.map
index dff42d6..8e18027 100644
--- a/node_modules/helia/dist/src/index.js.map
+++ b/node_modules/helia/dist/src/index.js.map
@@ -1 +1 @@
-{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;GAyBG;AAQH,OAAO,EAAE,SAAS,EAAE,MAAM,YAAY,CAAA;AAkEtC;;GAEG;AACH,MAAM,CAAC,KAAK,UAAU,WAAW,CAAE,OAAkB,EAAE;IACrD,MAAM,KAAK,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,CAAA;IAEjC,IAAI,IAAI,CAAC,KAAK,KAAK,KAAK,EAAE;QACxB,MAAM,KAAK,CAAC,KAAK,EAAE,CAAA;KACpB;IAED,OAAO,KAAK,CAAA;AACd,CAAC"}
\ No newline at end of file
+{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;GAyBG;AAQH,OAAO,EAAE,SAAS,EAAE,MAAM,YAAY,CAAA;AAwEtC;;GAEG;AACH,MAAM,CAAC,KAAK,UAAU,WAAW,CAAE,OAAkB,EAAE;IACrD,MAAM,KAAK,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,CAAA;IAEjC,IAAI,IAAI,CAAC,KAAK,KAAK,KAAK,EAAE;QACxB,MAAM,KAAK,CAAC,KAAK,EAAE,CAAA;KACpB;IAED,OAAO,KAAK,CAAA;AACd,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/create-block.d.ts b/node_modules/helia/dist/test/fixtures/create-block.d.ts
new file mode 100644
index 0000000..b812441
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/create-block.d.ts
@@ -0,0 +1,8 @@
+import type { Blockstore } from 'interface-blockstore';
+import { CID } from 'multiformats/cid';
+export declare function createBlock<Codec extends number>(codec: Codec, block: Uint8Array): Promise<{
+    cid: CID<unknown, Codec, 18>;
+    block: Uint8Array;
+}>;
+export declare function createAndPutBlock<Codec extends number>(codec: Codec, block: Uint8Array, blockstore: Blockstore): Promise<CID<unknown, Codec, 18>>;
+//# sourceMappingURL=create-block.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/create-block.d.ts.map b/node_modules/helia/dist/test/fixtures/create-block.d.ts.map
new file mode 100644
index 0000000..3992c04
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/create-block.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"create-block.d.ts","sourceRoot":"","sources":["../../../test/fixtures/create-block.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AACtD,OAAO,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AAGtC,wBAAsB,WAAW,CAAE,KAAK,SAAS,MAAM,EAAG,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,GAAG,OAAO,CAAC;IAAE,GAAG,EAAE,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;IAAC,KAAK,EAAE,UAAU,CAAA;CAAE,CAAC,CAKvJ;AAED,wBAAsB,iBAAiB,CAAE,KAAK,SAAS,MAAM,EAAG,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,GAAG,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAMzJ"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/create-block.js b/node_modules/helia/dist/test/fixtures/create-block.js
new file mode 100644
index 0000000..afc2553
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/create-block.js
@@ -0,0 +1,13 @@
+import { CID } from 'multiformats/cid';
+import { sha256 } from 'multiformats/hashes/sha2';
+export async function createBlock(codec, block) {
+    const mh = await sha256.digest(block);
+    const cid = CID.createV1(codec, mh);
+    return { cid, block };
+}
+export async function createAndPutBlock(codec, block, blockstore) {
+    const result = await createBlock(codec, block);
+    await blockstore.put(result.cid, block);
+    return result.cid;
+}
+//# sourceMappingURL=create-block.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/create-block.js.map b/node_modules/helia/dist/test/fixtures/create-block.js.map
new file mode 100644
index 0000000..5847390
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/create-block.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"create-block.js","sourceRoot":"","sources":["../../../test/fixtures/create-block.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AACtC,OAAO,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAA;AAEjD,MAAM,CAAC,KAAK,UAAU,WAAW,CAAyB,KAAY,EAAE,KAAiB;IACvF,MAAM,EAAE,GAAG,MAAM,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;IACrC,MAAM,GAAG,GAAG,GAAG,CAAC,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAA;IAEnC,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,CAAA;AACvB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,iBAAiB,CAAyB,KAAY,EAAE,KAAiB,EAAE,UAAsB;IACrH,MAAM,MAAM,GAAG,MAAM,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,CAAA;IAE9C,MAAM,UAAU,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAA;IAEvC,OAAO,MAAM,CAAC,GAAG,CAAA;AACnB,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/create-dag.d.ts b/node_modules/helia/dist/test/fixtures/create-dag.d.ts
new file mode 100644
index 0000000..b5375ab
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/create-dag.d.ts
@@ -0,0 +1,58 @@
+import type { Blockstore } from 'interface-blockstore';
+import type { CID } from 'multiformats/cid';
+export interface DAGNode {
+    cid: CID;
+    level: number;
+    links: CID[];
+}
+/**
+ * Creates a DAG for use with the dag walker
+ *
+ * E.g.
+ *
+ * ```
+ * createDag(..., 2, 3)
+ *
+ * // creates:
+ * {
+ *   'level-0': {
+ *     level: 0,
+ *     cid: CID(baedreibc6d3tr7glrwvflqkvsd7gszrb77kdmhgqukcwx5wnxdnydm3eia),
+ *     links: [
+ *       CID(baedreicvd6e5yvdg22elvqofvwjtnueennogk24zotw6sbrybrthme7bye),
+ *       CID(baedreicv6ufi5msnpsrqz4ziw2ekxgvopedluzhgpp74ukw6ncjtaypwlu),
+ *       CID(baedreifc4d4pzuzl6rmlf2vinsjcyfnuixogcqcabv65jqtgkbreu6czdm)
+ *     ]
+ *   },
+ *   'level-0-0': {
+ *     level: 1,
+ *     cid: CID(baedreicvd6e5yvdg22elvqofvwjtnueennogk24zotw6sbrybrthme7bye),
+ *     links: [
+ *       CID(baedreifcryimpj7cajld5znmpjis7z5gktwnsjbipbi6zkoe2y634sj5n4),
+ *       CID(baedreid375udk75eukd3xms5nqa7fq45uq2m5xddpf6reamgp3356dqvba),
+ *       CID(baedreig5ajzof2zotjqjaqloaqren2qc2ytuyalhsbf6e7qtpiwqzjyvsu)
+ *     ]
+ *   },
+ *   'level-0-1': {
+ *     level: 1,
+ *     cid: CID(baedreicv6ufi5msnpsrqz4ziw2ekxgvopedluzhgpp74ukw6ncjtaypwlu),
+ *     links: [
+ *       CID(baedreidqugkmpuyh3klk3ediwwltqfuapesi2dr65k2bkyokhrp4m5cuvq),
+ *       CID(baedreia75iubjvtv4ukrq2qxs6mwo5iyrmn4273hmkuvlbrsw3wwss2zwe),
+ *       CID(baedreibjyashtb6wj4inxvcfmsqbsfm5s375524fqo4liw3cshcmu2x7ma)
+ *     ]
+ *   },
+ *   'level-0-2': {
+ *     level: 1,
+ *     cid: CID(baedreifc4d4pzuzl6rmlf2vinsjcyfnuixogcqcabv65jqtgkbreu6czdm),
+ *     links: [
+ *       CID(baedreibfll7pocwwxysan5yprzywx277zzimmhwqdgrvs7bx3oujqd4xpa),
+ *       CID(baedreig5rrihh454f4qcef476m42aughuz5hf4rcc72damlz6okxdafpxe),
+ *       CID(baedreigytohidtspknvirjkslrox23g3qmye5mrx2wijn6ykrpthyg2kry)
+ *     ]
+ *   }
+ * }
+ * ```
+ */
+export declare function createDag(codec: number, blocks: Blockstore, depth: number, children: number): Promise<Record<string, DAGNode>>;
+//# sourceMappingURL=create-dag.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/create-dag.d.ts.map b/node_modules/helia/dist/test/fixtures/create-dag.d.ts.map
new file mode 100644
index 0000000..7596f7c
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/create-dag.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"create-dag.d.ts","sourceRoot":"","sources":["../../../test/fixtures/create-dag.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;AACtD,OAAO,KAAK,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AAI3C,MAAM,WAAW,OAAO;IACtB,GAAG,EAAE,GAAG,CAAA;IACR,KAAK,EAAE,MAAM,CAAA;IACb,KAAK,EAAE,GAAG,EAAE,CAAA;CACb;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAgDG;AACH,wBAAsB,SAAS,CAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAOrI"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/create-dag.js b/node_modules/helia/dist/test/fixtures/create-dag.js
new file mode 100644
index 0000000..072ba3f
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/create-dag.js
@@ -0,0 +1,74 @@
+import { fromString as uint8arrayFromString } from 'uint8arrays/from-string';
+import { createAndPutBlock } from './create-block.js';
+/**
+ * Creates a DAG for use with the dag walker
+ *
+ * E.g.
+ *
+ * ```
+ * createDag(..., 2, 3)
+ *
+ * // creates:
+ * {
+ *   'level-0': {
+ *     level: 0,
+ *     cid: CID(baedreibc6d3tr7glrwvflqkvsd7gszrb77kdmhgqukcwx5wnxdnydm3eia),
+ *     links: [
+ *       CID(baedreicvd6e5yvdg22elvqofvwjtnueennogk24zotw6sbrybrthme7bye),
+ *       CID(baedreicv6ufi5msnpsrqz4ziw2ekxgvopedluzhgpp74ukw6ncjtaypwlu),
+ *       CID(baedreifc4d4pzuzl6rmlf2vinsjcyfnuixogcqcabv65jqtgkbreu6czdm)
+ *     ]
+ *   },
+ *   'level-0-0': {
+ *     level: 1,
+ *     cid: CID(baedreicvd6e5yvdg22elvqofvwjtnueennogk24zotw6sbrybrthme7bye),
+ *     links: [
+ *       CID(baedreifcryimpj7cajld5znmpjis7z5gktwnsjbipbi6zkoe2y634sj5n4),
+ *       CID(baedreid375udk75eukd3xms5nqa7fq45uq2m5xddpf6reamgp3356dqvba),
+ *       CID(baedreig5ajzof2zotjqjaqloaqren2qc2ytuyalhsbf6e7qtpiwqzjyvsu)
+ *     ]
+ *   },
+ *   'level-0-1': {
+ *     level: 1,
+ *     cid: CID(baedreicv6ufi5msnpsrqz4ziw2ekxgvopedluzhgpp74ukw6ncjtaypwlu),
+ *     links: [
+ *       CID(baedreidqugkmpuyh3klk3ediwwltqfuapesi2dr65k2bkyokhrp4m5cuvq),
+ *       CID(baedreia75iubjvtv4ukrq2qxs6mwo5iyrmn4273hmkuvlbrsw3wwss2zwe),
+ *       CID(baedreibjyashtb6wj4inxvcfmsqbsfm5s375524fqo4liw3cshcmu2x7ma)
+ *     ]
+ *   },
+ *   'level-0-2': {
+ *     level: 1,
+ *     cid: CID(baedreifc4d4pzuzl6rmlf2vinsjcyfnuixogcqcabv65jqtgkbreu6czdm),
+ *     links: [
+ *       CID(baedreibfll7pocwwxysan5yprzywx277zzimmhwqdgrvs7bx3oujqd4xpa),
+ *       CID(baedreig5rrihh454f4qcef476m42aughuz5hf4rcc72damlz6okxdafpxe),
+ *       CID(baedreigytohidtspknvirjkslrox23g3qmye5mrx2wijn6ykrpthyg2kry)
+ *     ]
+ *   }
+ * }
+ * ```
+ */
+export async function createDag(codec, blocks, depth, children) {
+    const dag = {};
+    const root = await createAndPutBlock(codec, uint8arrayFromString('level-0'), blocks);
+    await addChildren(root, 'level', 0, 0, depth, children, dag, codec, blocks);
+    return dag;
+}
+async function addChildren(cid, name, level, index, depth, children, dag, codec, blocks) {
+    if (depth === 0) {
+        return;
+    }
+    name = `${name}-${index}`;
+    dag[name] = {
+        level,
+        cid,
+        links: []
+    };
+    for (let i = 0; i < children; i++) {
+        const subChild = await createAndPutBlock(codec, uint8arrayFromString(`${name}-${i}`), blocks);
+        dag[name].links.push(subChild);
+        await addChildren(subChild, name, level + 1, index + i, depth - 1, children, dag, codec, blocks);
+    }
+}
+//# sourceMappingURL=create-dag.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/create-dag.js.map b/node_modules/helia/dist/test/fixtures/create-dag.js.map
new file mode 100644
index 0000000..4f3a3ab
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/create-dag.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"create-dag.js","sourceRoot":"","sources":["../../../test/fixtures/create-dag.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,UAAU,IAAI,oBAAoB,EAAE,MAAM,yBAAyB,CAAA;AAC5E,OAAO,EAAE,iBAAiB,EAAE,MAAM,mBAAmB,CAAA;AAQrD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAgDG;AACH,MAAM,CAAC,KAAK,UAAU,SAAS,CAAE,KAAa,EAAE,MAAkB,EAAE,KAAa,EAAE,QAAgB;IACjG,MAAM,GAAG,GAA4B,EAAE,CAAA;IACvC,MAAM,IAAI,GAAG,MAAM,iBAAiB,CAAC,KAAK,EAAE,oBAAoB,CAAC,SAAS,CAAC,EAAE,MAAM,CAAC,CAAA;IAEpF,MAAM,WAAW,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,CAAC,CAAA;IAE3E,OAAO,GAAG,CAAA;AACZ,CAAC;AAED,KAAK,UAAU,WAAW,CAAE,GAAQ,EAAE,IAAY,EAAE,KAAa,EAAE,KAAa,EAAE,KAAa,EAAE,QAAgB,EAAE,GAA4B,EAAE,KAAa,EAAE,MAAkB;IAChL,IAAI,KAAK,KAAK,CAAC,EAAE;QACf,OAAM;KACP;IAED,IAAI,GAAG,GAAG,IAAI,IAAI,KAAK,EAAE,CAAA;IAEzB,GAAG,CAAC,IAAI,CAAC,GAAG;QACV,KAAK;QACL,GAAG;QACH,KAAK,EAAE,EAAE;KACV,CAAA;IAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,EAAE,EAAE;QACjC,MAAM,QAAQ,GAAG,MAAM,iBAAiB,CAAC,KAAK,EAAE,oBAAoB,CAAC,GAAG,IAAI,IAAI,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,CAAA;QAE7F,GAAG,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;QAE9B,MAAM,WAAW,CAAC,QAAQ,EAAE,IAAI,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,CAAC,CAAA;KACjG;AACH,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/dag-walker.d.ts b/node_modules/helia/dist/test/fixtures/dag-walker.d.ts
new file mode 100644
index 0000000..7b65463
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/dag-walker.d.ts
@@ -0,0 +1,4 @@
+import type { DAGWalker } from '../../src/index.js';
+import type { DAGNode } from './create-dag.js';
+export declare function dagWalker(codec: number, dag: Record<string, DAGNode>): DAGWalker;
+//# sourceMappingURL=dag-walker.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/dag-walker.d.ts.map b/node_modules/helia/dist/test/fixtures/dag-walker.d.ts.map
new file mode 100644
index 0000000..42813dd
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/dag-walker.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"dag-walker.d.ts","sourceRoot":"","sources":["../../../test/fixtures/dag-walker.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,oBAAoB,CAAA;AAEnD,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AAE9C,wBAAgB,SAAS,CAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CASjF"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/dag-walker.js b/node_modules/helia/dist/test/fixtures/dag-walker.js
new file mode 100644
index 0000000..4809f02
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/dag-walker.js
@@ -0,0 +1,11 @@
+import { toString as uint8ArrayToString } from 'uint8arrays/to-string';
+export function dagWalker(codec, dag) {
+    return {
+        codec,
+        async *walk(block) {
+            const node = dag[uint8ArrayToString(block)] ?? { links: [] };
+            yield* node.links;
+        }
+    };
+}
+//# sourceMappingURL=dag-walker.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/fixtures/dag-walker.js.map b/node_modules/helia/dist/test/fixtures/dag-walker.js.map
new file mode 100644
index 0000000..c812818
--- /dev/null
+++ b/node_modules/helia/dist/test/fixtures/dag-walker.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"dag-walker.js","sourceRoot":"","sources":["../../../test/fixtures/dag-walker.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,QAAQ,IAAI,kBAAkB,EAAE,MAAM,uBAAuB,CAAA;AAGtE,MAAM,UAAU,SAAS,CAAE,KAAa,EAAE,GAA4B;IACpE,OAAO;QACL,KAAK;QACL,KAAK,CAAC,CAAE,IAAI,CAAE,KAAK;YACjB,MAAM,IAAI,GAAG,GAAG,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,CAAA;YAE5D,KAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAA;QACpB,CAAC;KACF,CAAA;AACH,CAAC"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/gc.spec.d.ts b/node_modules/helia/dist/test/gc.spec.d.ts
new file mode 100644
index 0000000..7f33148
--- /dev/null
+++ b/node_modules/helia/dist/test/gc.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=gc.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/gc.spec.d.ts.map b/node_modules/helia/dist/test/gc.spec.d.ts.map
new file mode 100644
index 0000000..550d128
--- /dev/null
+++ b/node_modules/helia/dist/test/gc.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"gc.spec.d.ts","sourceRoot":"","sources":["../../test/gc.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/gc.spec.js b/node_modules/helia/dist/test/gc.spec.js
new file mode 100644
index 0000000..c6f0837
--- /dev/null
+++ b/node_modules/helia/dist/test/gc.spec.js
@@ -0,0 +1,159 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import * as raw from 'multiformats/codecs/raw';
+import { createAndPutBlock } from './fixtures/create-block.js';
+import * as dagPb from '@ipld/dag-pb';
+import * as dagCbor from '@ipld/dag-cbor';
+import * as dagJson from '@ipld/dag-json';
+describe('gc', () => {
+    let helia;
+    beforeEach(async () => {
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore: new MemoryBlockstore(),
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            })
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    it('pins a dag-pb node and does not garbage collect it or it\'s children', async () => {
+        const child1 = await createAndPutBlock(dagPb.code, dagPb.encode({
+            Data: Uint8Array.from([0, 1, 2, 3]),
+            Links: []
+        }), helia.blockstore);
+        const child2 = await createAndPutBlock(dagPb.code, dagPb.encode({
+            Data: Uint8Array.from([4, 5, 6, 7]),
+            Links: []
+        }), helia.blockstore);
+        const node = await createAndPutBlock(dagPb.code, dagPb.encode({
+            Links: [{
+                    Hash: child1,
+                    Name: 'child1'
+                }, {
+                    Hash: child2,
+                    Name: 'child2'
+                }]
+        }), helia.blockstore);
+        await helia.pins.add(node);
+        // this block will be garbage collected
+        const doomed = await createAndPutBlock(dagPb.code, dagPb.encode({
+            Data: Uint8Array.from([8, 9, 0, 1]),
+            Links: []
+        }), helia.blockstore);
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.true();
+        await helia.gc();
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.false();
+    });
+    it('pins a dag-cbor node and does not garbage collect it or it\'s children', async () => {
+        const child1 = await createAndPutBlock(dagCbor.code, dagCbor.encode({
+            foo: 'bar'
+        }), helia.blockstore);
+        const child2 = await createAndPutBlock(dagCbor.code, dagCbor.encode({
+            baz: 'qux'
+        }), helia.blockstore);
+        const node = await createAndPutBlock(dagCbor.code, dagCbor.encode({
+            children: [
+                child1,
+                child2
+            ]
+        }), helia.blockstore);
+        await helia.pins.add(node);
+        // this block will be garbage collected
+        const doomed = await createAndPutBlock(dagCbor.code, dagJson.encode({
+            quux: 'garply'
+        }), helia.blockstore);
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.true();
+        await helia.gc();
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.false();
+    });
+    it('pins a dag-json node and does not garbage collect it or it\'s children', async () => {
+        const child1 = await createAndPutBlock(dagJson.code, dagJson.encode({
+            foo: 'bar'
+        }), helia.blockstore);
+        const child2 = await createAndPutBlock(dagJson.code, dagJson.encode({
+            baz: 'qux'
+        }), helia.blockstore);
+        const node = await createAndPutBlock(dagJson.code, dagJson.encode({
+            children: [
+                child1,
+                child2
+            ]
+        }), helia.blockstore);
+        await helia.pins.add(node);
+        // this block will be garbage collected
+        const doomed = await createAndPutBlock(dagJson.code, dagJson.encode({
+            quux: 'garply'
+        }), helia.blockstore);
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.true();
+        await helia.gc();
+        await expect(helia.blockstore.has(child1)).to.eventually.be.true();
+        await expect(helia.blockstore.has(child2)).to.eventually.be.true();
+        await expect(helia.blockstore.has(node)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.false();
+    });
+    it('pins a raw node and does not garbage collect it', async () => {
+        const cid = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await helia.pins.add(cid);
+        // this block will be garbage collected
+        const doomed = await createAndPutBlock(raw.code, Uint8Array.from([4, 5, 6, 7]), helia.blockstore);
+        await expect(helia.blockstore.has(cid)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.true();
+        await helia.gc();
+        await expect(helia.blockstore.has(cid)).to.eventually.be.true();
+        await expect(helia.blockstore.has(doomed)).to.eventually.be.false();
+    });
+    it('can garbage collect around a CID that causes an error', async () => {
+        const cid = await createAndPutBlock(0x10, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await expect(helia.blockstore.has(cid)).to.eventually.be.true('did not have cid');
+        const events = [];
+        // make the datastore break in some way
+        helia.datastore.has = async () => {
+            throw new Error('Urk!');
+        };
+        await helia.gc({
+            onProgress: (evt) => {
+                events.push(evt);
+            }
+        });
+        await expect(helia.blockstore.has(cid)).to.eventually.be.true('did not keep cid');
+        const errorEvents = events.filter(e => e.type === 'helia:gc:error');
+        expect(errorEvents).to.have.lengthOf(1);
+        expect(errorEvents[0].detail.toString()).to.include('Urk!');
+    });
+});
+//# sourceMappingURL=gc.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/gc.spec.js.map b/node_modules/helia/dist/test/gc.spec.js.map
new file mode 100644
index 0000000..a997914
--- /dev/null
+++ b/node_modules/helia/dist/test/gc.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"gc.spec.js","sourceRoot":"","sources":["../../test/gc.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/index.spec.d.ts b/node_modules/helia/dist/test/index.spec.d.ts
new file mode 100644
index 0000000..b37c2d2
--- /dev/null
+++ b/node_modules/helia/dist/test/index.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=index.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/index.spec.d.ts.map b/node_modules/helia/dist/test/index.spec.d.ts.map
new file mode 100644
index 0000000..5c89780
--- /dev/null
+++ b/node_modules/helia/dist/test/index.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.spec.d.ts","sourceRoot":"","sources":["../../test/index.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/index.spec.js b/node_modules/helia/dist/test/index.spec.js
new file mode 100644
index 0000000..e606de6
--- /dev/null
+++ b/node_modules/helia/dist/test/index.spec.js
@@ -0,0 +1,84 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import { CID } from 'multiformats/cid';
+import { Key } from 'interface-datastore';
+describe('helia', () => {
+    let helia;
+    beforeEach(async () => {
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore: new MemoryBlockstore(),
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            })
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    it('stops and starts', async () => {
+        expect(helia.libp2p.isStarted()).to.be.true();
+        await helia.stop();
+        expect(helia.libp2p.isStarted()).to.be.false();
+    });
+    it('should have a blockstore', async () => {
+        expect(helia).to.have.property('blockstore').that.is.ok();
+    });
+    it('should have a datastore', async () => {
+        expect(helia).to.have.property('datastore').that.is.ok();
+    });
+    it('should have a libp2p', async () => {
+        expect(helia).to.have.property('libp2p').that.is.ok();
+    });
+    it('allows creating offline node', async () => {
+        const helia = await createHelia({
+            start: false,
+            datastore: new MemoryDatastore(),
+            blockstore: new MemoryBlockstore(),
+            libp2p: await createLibp2p({
+                start: false,
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            })
+        });
+        expect(helia.libp2p.isStarted()).to.be.false();
+    });
+    it('does not require any constructor args', async () => {
+        const helia = await createHelia();
+        const cid = CID.parse('QmaQwYWpchozXhFv8nvxprECWBSCEppN9dfd2VQiJfRo3F');
+        const block = Uint8Array.from([0, 1, 2, 3]);
+        await helia.blockstore.put(cid, block);
+        expect(await helia.blockstore.has(cid)).to.be.true();
+        const key = new Key(`/${cid.toString()}`);
+        await helia.datastore.put(key, block);
+        expect(await helia.datastore.has(key)).to.be.true();
+        expect(() => {
+            helia.libp2p.isStarted();
+        }).to.throw('Please configure Helia with a libp2p instance');
+    });
+});
+//# sourceMappingURL=index.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/index.spec.js.map b/node_modules/helia/dist/test/index.spec.js.map
new file mode 100644
index 0000000..c8efa6f
--- /dev/null
+++ b/node_modules/helia/dist/test/index.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.spec.js","sourceRoot":"","sources":["../../test/index.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.depth-limited.spec.d.ts b/node_modules/helia/dist/test/pins.depth-limited.spec.d.ts
new file mode 100644
index 0000000..4f714af
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.depth-limited.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=pins.depth-limited.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.depth-limited.spec.d.ts.map b/node_modules/helia/dist/test/pins.depth-limited.spec.d.ts.map
new file mode 100644
index 0000000..6758b48
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.depth-limited.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.depth-limited.spec.d.ts","sourceRoot":"","sources":["../../test/pins.depth-limited.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.depth-limited.spec.js b/node_modules/helia/dist/test/pins.depth-limited.spec.js
new file mode 100644
index 0000000..0f89cda
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.depth-limited.spec.js
@@ -0,0 +1,104 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import { dagWalker } from './fixtures/dag-walker.js';
+import { createDag } from './fixtures/create-dag.js';
+const MAX_DEPTH = 3;
+describe('pins (depth limited)', () => {
+    let helia;
+    let dag;
+    beforeEach(async () => {
+        const blockstore = new MemoryBlockstore();
+        // arbitrary CID codec value
+        const codec = 7;
+        // create a DAG, MAX_DEPTH levels deep with each level having three children
+        dag = await createDag(codec, blockstore, MAX_DEPTH, 3);
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore,
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            }),
+            dagWalkers: [
+                dagWalker(codec, dag)
+            ]
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    for (let i = 0; i < MAX_DEPTH; i++) {
+        describe(`depth ${i}`, () => {
+            it(`pins a block to depth ${i}`, async () => {
+                await helia.pins.add(dag['level-0'].cid, {
+                    depth: i
+                });
+                // only root block should be pinned
+                for (const [name, node] of Object.entries(dag)) {
+                    if (node.level <= i) {
+                        await expect(helia.pins.isPinned(node.cid)).to.eventually.be.true(`did not pin ${name}`);
+                    }
+                    else {
+                        await expect(helia.pins.isPinned(node.cid)).to.eventually.be.false(`pinned ${name}`);
+                    }
+                    if (node.level > i) {
+                        // no children of this node should be pinned
+                        for (const cid of node.links) {
+                            await expect(helia.pins.isPinned(cid)).to.eventually.be.false(`pinned ${name}`);
+                        }
+                    }
+                }
+            });
+            it(`unpins to depth ${i}`, async () => {
+                await helia.pins.add(dag['level-0'].cid, {
+                    depth: i
+                });
+                await helia.pins.rm(dag['level-0'].cid);
+                // no blocks should be pinned
+                for (const [name, node] of Object.entries(dag)) {
+                    for (const cid of node.links) {
+                        await expect(helia.pins.isPinned(cid)).to.eventually.be.false(`did not unpin ${name}`);
+                    }
+                }
+            });
+            it(`does not delete a pinned sub-block under level ${i}`, async () => {
+                await helia.pins.add(dag['level-0'].cid, {
+                    depth: i
+                });
+                // no sub blocks should be pinned
+                for (const [name, node] of Object.entries(dag)) {
+                    if (node.level <= i) {
+                        await expect(helia.blockstore.delete(node.cid)).to.eventually.be.rejected
+                            .with.property('message', 'CID was pinned', `allowed deleting pinned block ${name}`);
+                    }
+                    else {
+                        await expect(helia.blockstore.delete(node.cid)).to.eventually.be.undefined(`allowed deleting pinned block ${name}`);
+                    }
+                    if (node.level > i) {
+                        // no children of this node should be pinned
+                        for (const cid of node.links) {
+                            await expect(helia.blockstore.delete(cid)).to.eventually.be.undefined(`allowed deleting pinned block ${name}`);
+                        }
+                    }
+                }
+            });
+        });
+    }
+});
+//# sourceMappingURL=pins.depth-limited.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.depth-limited.spec.js.map b/node_modules/helia/dist/test/pins.depth-limited.spec.js.map
new file mode 100644
index 0000000..2c0d06b
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.depth-limited.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.depth-limited.spec.js","sourceRoot":"","sources":["../../test/pins.depth-limited.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.recursive.spec.d.ts b/node_modules/helia/dist/test/pins.recursive.spec.d.ts
new file mode 100644
index 0000000..7d5a4fe
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.recursive.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=pins.recursive.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.recursive.spec.d.ts.map b/node_modules/helia/dist/test/pins.recursive.spec.d.ts.map
new file mode 100644
index 0000000..9279192
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.recursive.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.recursive.spec.d.ts","sourceRoot":"","sources":["../../test/pins.recursive.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.recursive.spec.js b/node_modules/helia/dist/test/pins.recursive.spec.js
new file mode 100644
index 0000000..73cf5d2
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.recursive.spec.js
@@ -0,0 +1,75 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import { dagWalker } from './fixtures/dag-walker.js';
+import { createDag } from './fixtures/create-dag.js';
+describe('pins (recursive)', () => {
+    let helia;
+    let dag;
+    beforeEach(async () => {
+        const blockstore = new MemoryBlockstore();
+        // arbitrary CID codec value
+        const codec = 7;
+        // create a DAG, two levels deep with each level having three children
+        dag = await createDag(codec, blockstore, 2, 3);
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore,
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            }),
+            dagWalkers: [
+                dagWalker(codec, dag)
+            ]
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    it('pins a block recursively', async () => {
+        await helia.pins.add(dag['level-0'].cid);
+        // all sub blocks should be pinned
+        for (const [name, node] of Object.entries(dag)) {
+            for (const cid of node.links) {
+                await expect(helia.pins.isPinned(cid)).to.eventually.be.true(`did not pin ${name}`);
+            }
+        }
+    });
+    it('unpins recursively', async () => {
+        await helia.pins.add(dag['level-0'].cid);
+        await helia.pins.rm(dag['level-0'].cid);
+        // no sub blocks should be pinned
+        for (const [name, node] of Object.entries(dag)) {
+            for (const cid of node.links) {
+                await expect(helia.pins.isPinned(cid)).to.eventually.be.false(`did not unpin ${name}`);
+            }
+        }
+    });
+    it('does not delete a pinned sub-block', async () => {
+        await helia.pins.add(dag['level-0'].cid);
+        // no sub blocks should be pinned
+        for (const [name, node] of Object.entries(dag)) {
+            for (const cid of node.links) {
+                await expect(helia.blockstore.delete(cid)).to.eventually.be.rejected
+                    .with.property('message', 'CID was pinned', `allowed deleting pinned block ${name}`);
+            }
+        }
+    });
+});
+//# sourceMappingURL=pins.recursive.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.recursive.spec.js.map b/node_modules/helia/dist/test/pins.recursive.spec.js.map
new file mode 100644
index 0000000..a84a77a
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.recursive.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.recursive.spec.js","sourceRoot":"","sources":["../../test/pins.recursive.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.spec.d.ts b/node_modules/helia/dist/test/pins.spec.d.ts
new file mode 100644
index 0000000..39f04da
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=pins.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.spec.d.ts.map b/node_modules/helia/dist/test/pins.spec.d.ts.map
new file mode 100644
index 0000000..0162612
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.spec.d.ts","sourceRoot":"","sources":["../../test/pins.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.spec.js b/node_modules/helia/dist/test/pins.spec.js
new file mode 100644
index 0000000..f75c0a8
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.spec.js
@@ -0,0 +1,109 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { createLibp2p } from 'libp2p';
+import { webSockets } from '@libp2p/websockets';
+import { noise } from '@chainsafe/libp2p-noise';
+import { yamux } from '@chainsafe/libp2p-yamux';
+import { createHelia } from '../src/index.js';
+import { CID } from 'multiformats/cid';
+import * as raw from 'multiformats/codecs/raw';
+import { createAndPutBlock } from './fixtures/create-block.js';
+import all from 'it-all';
+describe('pins', () => {
+    let helia;
+    beforeEach(async () => {
+        helia = await createHelia({
+            datastore: new MemoryDatastore(),
+            blockstore: new MemoryBlockstore(),
+            libp2p: await createLibp2p({
+                transports: [
+                    webSockets()
+                ],
+                connectionEncryption: [
+                    noise()
+                ],
+                streamMuxers: [
+                    yamux()
+                ]
+            })
+        });
+    });
+    afterEach(async () => {
+        if (helia != null) {
+            await helia.stop();
+        }
+    });
+    it('pins a block', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        const cidV0 = CID.createV0(cidV1.multihash);
+        await helia.pins.add(cidV1);
+        await expect(helia.pins.isPinned(cidV1)).to.eventually.be.true('did not pin v1 CID');
+        await expect(helia.pins.isPinned(cidV0)).to.eventually.be.true('did not pin v0 CID');
+    });
+    it('unpins a block', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        const cidV0 = CID.createV0(cidV1.multihash);
+        await helia.pins.add(cidV1);
+        await expect(helia.pins.isPinned(cidV1)).to.eventually.be.true('did not pin v1 CID');
+        await expect(helia.pins.isPinned(cidV0)).to.eventually.be.true('did not pin v0 CID');
+        await helia.pins.rm(cidV1);
+        await expect(helia.pins.isPinned(cidV1)).to.eventually.be.false('did not unpin v1 CID');
+        await expect(helia.pins.isPinned(cidV0)).to.eventually.be.false('did not unpin v0 CID');
+    });
+    it('does not delete a pinned block', async () => {
+        const cid = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await helia.pins.add(cid);
+        await expect(helia.blockstore.delete(cid)).to.eventually.be.rejected
+            .with.property('message', 'CID was pinned');
+    });
+    it('lists pins created with default args', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await helia.pins.add(cidV1);
+        const pins = await all(helia.pins.ls());
+        expect(pins).to.have.lengthOf(1);
+        expect(pins).to.have.nested.property('[0].cid').that.eql(cidV1);
+        expect(pins).to.have.nested.property('[0].depth', Infinity);
+        expect(pins).to.have.nested.property('[0].metadata').that.eql({});
+    });
+    it('lists pins with depth', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        await helia.pins.add(cidV1, {
+            depth: 5
+        });
+        const pins = await all(helia.pins.ls());
+        expect(pins).to.have.lengthOf(1);
+        expect(pins).to.have.nested.property('[0].cid').that.eql(cidV1);
+        expect(pins).to.have.nested.property('[0].depth', 5);
+    });
+    it('lists pins with metadata', async () => {
+        const cidV1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        const metadata = {
+            foo: 'bar',
+            baz: 5,
+            qux: false
+        };
+        await helia.pins.add(cidV1, {
+            metadata
+        });
+        const pins = await all(helia.pins.ls());
+        expect(pins).to.have.lengthOf(1);
+        expect(pins).to.have.nested.property('[0].cid').that.eql(cidV1);
+        expect(pins).to.have.nested.property('[0].metadata').that.eql(metadata);
+    });
+    it('lists pins directly', async () => {
+        const cid1 = await createAndPutBlock(raw.code, Uint8Array.from([0, 1, 2, 3]), helia.blockstore);
+        const cid2 = await createAndPutBlock(raw.code, Uint8Array.from([4, 5, 6, 7]), helia.blockstore);
+        await helia.pins.add(cid1);
+        await helia.pins.add(cid2);
+        const pins = await all(helia.pins.ls({
+            cid: cid1
+        }));
+        expect(pins).to.have.lengthOf(1);
+        expect(pins).to.have.nested.property('[0].cid').that.eql(cid1);
+        expect(pins).to.have.nested.property('[0].depth', Infinity);
+        expect(pins).to.have.nested.property('[0].metadata').that.eql({});
+    });
+});
+//# sourceMappingURL=pins.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/pins.spec.js.map b/node_modules/helia/dist/test/pins.spec.js.map
new file mode 100644
index 0000000..5a457b1
--- /dev/null
+++ b/node_modules/helia/dist/test/pins.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"pins.spec.js","sourceRoot":"","sources":["../../test/pins.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/storage.spec.d.ts b/node_modules/helia/dist/test/storage.spec.d.ts
new file mode 100644
index 0000000..b87a365
--- /dev/null
+++ b/node_modules/helia/dist/test/storage.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=storage.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/storage.spec.d.ts.map b/node_modules/helia/dist/test/storage.spec.d.ts.map
new file mode 100644
index 0000000..375fbf0
--- /dev/null
+++ b/node_modules/helia/dist/test/storage.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"storage.spec.d.ts","sourceRoot":"","sources":["../../test/storage.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/storage.spec.js b/node_modules/helia/dist/test/storage.spec.js
new file mode 100644
index 0000000..6e36af4
--- /dev/null
+++ b/node_modules/helia/dist/test/storage.spec.js
@@ -0,0 +1,136 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { MemoryBlockstore } from 'blockstore-core';
+import { MemoryDatastore } from 'datastore-core';
+import { BlockStorage } from '../src/storage.js';
+import { stubInterface } from 'sinon-ts';
+import { PinsImpl } from '../src/pins.js';
+import { createBlock } from './fixtures/create-block.js';
+import * as raw from 'multiformats/codecs/raw';
+import all from 'it-all';
+import delay from 'delay';
+import drain from 'it-drain';
+import Sinon from 'sinon';
+describe('storage', () => {
+    let storage;
+    let blockstore;
+    let bitswap;
+    let pins;
+    let blocks;
+    beforeEach(async () => {
+        blocks = [];
+        for (let i = 0; i < 10; i++) {
+            blocks.push(await createBlock(raw.code, Uint8Array.from([0, 1, 2, i])));
+        }
+        const datastore = new MemoryDatastore();
+        blockstore = new MemoryBlockstore();
+        bitswap = stubInterface();
+        pins = new PinsImpl(datastore, blockstore, []);
+        storage = new BlockStorage(blockstore, pins, {
+            bitswap,
+            holdGcLock: true
+        });
+    });
+    it('gets a block from the blockstore', async () => {
+        const { cid, block } = blocks[0];
+        await blockstore.put(cid, block);
+        const retrieved = await storage.get(cid);
+        expect(retrieved).to.equalBytes(block);
+    });
+    it('gets a block from the blockstore with progress', async () => {
+        const { cid, block } = blocks[0];
+        await blockstore.put(cid, block);
+        const onProgress = Sinon.stub();
+        await storage.get(cid, {
+            onProgress
+        });
+        expect(onProgress.called).to.be.true();
+    });
+    it('gets many blocks from the blockstore', async () => {
+        const count = 5;
+        for (let i = 0; i < count; i++) {
+            const { cid, block } = blocks[i];
+            await blockstore.put(cid, block);
+        }
+        const retrieved = await all(storage.getMany(async function* () {
+            for (let i = 0; i < count; i++) {
+                yield blocks[i].cid;
+                await delay(10);
+            }
+        }()));
+        expect(retrieved).to.deep.equal(new Array(count).fill(0).map((_, i) => blocks[i]));
+    });
+    it('puts a block into the blockstore', async () => {
+        const { cid, block } = blocks[0];
+        await storage.put(cid, block);
+        const retrieved = await blockstore.get(cid);
+        expect(retrieved).to.equalBytes(block);
+    });
+    it('puts many blocks into the blockstore', async () => {
+        const count = 5;
+        await drain(storage.putMany(async function* () {
+            for (let i = 0; i < count; i++) {
+                yield { cid: blocks[i].cid, block: blocks[i].block };
+                await delay(10);
+            }
+        }()));
+        const retrieved = await all(blockstore.getMany(new Array(count).fill(0).map((_, i) => blocks[i].cid)));
+        expect(retrieved).to.deep.equal(retrieved);
+    });
+    it('gets a block from bitswap when it is not in the blockstore', async () => {
+        const { cid, block } = blocks[0];
+        bitswap.isStarted.returns(true);
+        bitswap.want.withArgs(cid).resolves(block);
+        expect(await blockstore.has(cid)).to.be.false();
+        const returned = await storage.get(cid);
+        expect(await blockstore.has(cid)).to.be.true();
+        expect(returned).to.equalBytes(block);
+        expect(bitswap.want.called).to.be.true();
+    });
+    it('gets many blocks from bitswap when they are not in the blockstore', async () => {
+        bitswap.isStarted.returns(true);
+        const count = 5;
+        for (let i = 0; i < count; i++) {
+            const { cid, block } = blocks[i];
+            bitswap.want.withArgs(cid).resolves(block);
+            expect(await blockstore.has(cid)).to.be.false();
+        }
+        const retrieved = await all(storage.getMany(async function* () {
+            for (let i = 0; i < count; i++) {
+                yield blocks[i].cid;
+                await delay(10);
+            }
+        }()));
+        expect(retrieved).to.deep.equal(new Array(count).fill(0).map((_, i) => blocks[i]));
+        for (let i = 0; i < count; i++) {
+            const { cid } = blocks[i];
+            expect(bitswap.want.calledWith(cid)).to.be.true();
+            expect(await blockstore.has(cid)).to.be.true();
+        }
+    });
+    it('gets some blocks from bitswap when they are not in the blockstore', async () => {
+        bitswap.isStarted.returns(true);
+        const count = 5;
+        // blocks 0,1,3,4 are in the blockstore
+        await blockstore.put(blocks[0].cid, blocks[0].block);
+        await blockstore.put(blocks[1].cid, blocks[1].block);
+        await blockstore.put(blocks[3].cid, blocks[3].block);
+        await blockstore.put(blocks[4].cid, blocks[4].block);
+        // block #2 comes from bitswap but slowly
+        bitswap.want.withArgs(blocks[2].cid).callsFake(async () => {
+            await delay(100);
+            return blocks[2].block;
+        });
+        const retrieved = await all(storage.getMany(async function* () {
+            for (let i = 0; i < count; i++) {
+                yield blocks[i].cid;
+                await delay(10);
+            }
+        }()));
+        expect(retrieved).to.deep.equal(new Array(count).fill(0).map((_, i) => blocks[i]));
+        for (let i = 0; i < count; i++) {
+            expect(await blockstore.has(blocks[i].cid)).to.be.true();
+        }
+    });
+});
+//# sourceMappingURL=storage.spec.js.map
\ No newline at end of file
diff --git a/node_modules/helia/dist/test/storage.spec.js.map b/node_modules/helia/dist/test/storage.spec.js.map
new file mode 100644
index 0000000..abe0c20
--- /dev/null
+++ b/node_modules/helia/dist/test/storage.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"storage.spec.js","sourceRoot":"","sources":["../../test/storage.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/helia/dist/tsconfig.tsbuildinfo b/node_modules/helia/dist/tsconfig.tsbuildinfo
new file mode 100644
index 0000000..a0f133d
--- /dev/null
+++ b/node_modules/helia/dist/tsconfig.tsbuildinfo
@@ -0,0 +1 @@
+{"program":{"fileNames":["../../../node_modules/typescript/lib/lib.es5.d.ts","../../../node_modules/typescript/lib/lib.es2015.d.ts","../../../node_modules/typescript/lib/lib.es2016.d.ts","../../../node_modules/typescript/lib/lib.es2017.d.ts","../../../node_modules/typescript/lib/lib.es2018.d.ts","../../../node_modules/typescript/lib/lib.es2019.d.ts","../../../node_modules/typescript/lib/lib.es2020.d.ts","../../../node_modules/typescript/lib/lib.es2021.d.ts","../../../node_modules/typescript/lib/lib.dom.d.ts","../../../node_modules/typescript/lib/lib.dom.iterable.d.ts","../../../node_modules/typescript/lib/lib.webworker.d.ts","../../../node_modules/typescript/lib/lib.es2015.core.d.ts","../../../node_modules/typescript/lib/lib.es2015.collection.d.ts","../../../node_modules/typescript/lib/lib.es2015.generator.d.ts","../../../node_modules/typescript/lib/lib.es2015.iterable.d.ts","../../../node_modules/typescript/lib/lib.es2015.promise.d.ts","../../../node_modules/typescript/lib/lib.es2015.proxy.d.ts","../../../node_modules/typescript/lib/lib.es2015.reflect.d.ts","../../../node_modules/typescript/lib/lib.es2015.symbol.d.ts","../../../node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","../../../node_modules/typescript/lib/lib.es2016.array.include.d.ts","../../../node_modules/typescript/lib/lib.es2017.object.d.ts","../../../node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","../../../node_modules/typescript/lib/lib.es2017.string.d.ts","../../../node_modules/typescript/lib/lib.es2017.intl.d.ts","../../../node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","../../../node_modules/typescript/lib/lib.es2018.asyncgenerator.d.ts","../../../node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","../../../node_modules/typescript/lib/lib.es2018.intl.d.ts","../../../node_modules/typescript/lib/lib.es2018.promise.d.ts","../../../node_modules/typescript/lib/lib.es2018.regexp.d.ts","../../../node_modules/typescript/lib/lib.es2019.array.d.ts","../../../node_modules/typescript/lib/lib.es2019.object.d.ts","../../../node_modules/typescript/lib/lib.es2019.string.d.ts","../../../node_modules/typescript/lib/lib.es2019.symbol.d.ts","../../../node_modules/typescript/lib/lib.es2019.intl.d.ts","../../../node_modules/typescript/lib/lib.es2020.bigint.d.ts","../../../node_modules/typescript/lib/lib.es2020.date.d.ts","../../../node_modules/typescript/lib/lib.es2020.promise.d.ts","../../../node_modules/typescript/lib/lib.es2020.sharedmemory.d.ts","../../../node_modules/typescript/lib/lib.es2020.string.d.ts","../../../node_modules/typescript/lib/lib.es2020.symbol.wellknown.d.ts","../../../node_modules/typescript/lib/lib.es2020.intl.d.ts","../../../node_modules/typescript/lib/lib.es2020.number.d.ts","../../../node_modules/typescript/lib/lib.es2021.promise.d.ts","../../../node_modules/typescript/lib/lib.es2021.string.d.ts","../../../node_modules/typescript/lib/lib.es2021.weakref.d.ts","../../../node_modules/typescript/lib/lib.es2021.intl.d.ts","../../../node_modules/typescript/lib/lib.esnext.intl.d.ts","../../../node_modules/@libp2p/interfaces/dist/src/index.d.ts","../../../node_modules/@libp2p/interfaces/dist/src/events.d.ts","../../../node_modules/@libp2p/interfaces/dist/src/startable.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/protocols-table.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/filter/multiaddr-filter.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/index.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/interface.d.ts","../../../node_modules/multiformats/dist/types/src/bases/interface.d.ts","../../../node_modules/multiformats/dist/types/src/block/interface.d.ts","../../../node_modules/multiformats/dist/types/src/link/interface.d.ts","../../../node_modules/multiformats/dist/types/src/cid.d.ts","../../../node_modules/@libp2p/interface-peer-id/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-peer-info/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-peer-discovery/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-dht/dist/src/index.d.ts","../../../node_modules/uint8arraylist/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-record/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-peer-store/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-connection/dist/src/status.d.ts","../../../node_modules/it-stream-types/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-connection/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-peer-routing/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-content-routing/dist/src/index.d.ts","../../../node_modules/it-pushable/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-pubsub/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-registrar/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-metrics/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-keychain/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-libp2p/dist/src/index.d.ts","../../../node_modules/interface-store/dist/src/index.d.ts","../../../node_modules/multiformats/dist/types/src/codecs/interface.d.ts","../../../node_modules/multiformats/dist/types/src/interface.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/digest.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/hasher.d.ts","../../../node_modules/multiformats/dist/types/src/varint.d.ts","../../../node_modules/multiformats/dist/types/src/bytes.d.ts","../../../node_modules/multiformats/dist/types/src/index.d.ts","../../../node_modules/multiformats/dist/types/src/codecs/raw.d.ts","../../../node_modules/multiformats/dist/types/src/codecs/json.d.ts","../../../node_modules/multiformats/dist/types/src/bases/base.d.ts","../../../node_modules/multiformats/dist/types/src/basics.d.ts","../../../node_modules/uint8arrays/dist/src/util/bases.d.ts","../../../node_modules/uint8arrays/dist/src/to-string.d.ts","../../../node_modules/interface-datastore/dist/src/key.d.ts","../../../node_modules/interface-datastore/dist/src/index.d.ts","../../../node_modules/progress-events/dist/src/index.d.ts","../../interface/dist/src/pins.d.ts","../../../node_modules/interface-blockstore/dist/src/index.d.ts","../../../node_modules/protons-runtime/dist/src/codec.d.ts","../../../node_modules/protons-runtime/dist/src/decode.d.ts","../../../node_modules/protons-runtime/dist/src/encode.d.ts","../../../node_modules/protons-runtime/dist/src/codecs/enum.d.ts","../../../node_modules/protons-runtime/dist/src/codecs/message.d.ts","../../../node_modules/protons-runtime/dist/src/utils.d.ts","../../../node_modules/protons-runtime/dist/src/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/message/message.d.ts","../../../node_modules/@vascosantos/moving-average/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/wantlist/entry.d.ts","../../../node_modules/ipfs-bitswap/dist/src/message/entry.d.ts","../../../node_modules/ipfs-bitswap/dist/src/message/index.d.ts","../../../node_modules/@types/node/assert.d.ts","../../../node_modules/@types/node/assert/strict.d.ts","../../../node_modules/@types/node/globals.d.ts","../../../node_modules/@types/node/async_hooks.d.ts","../../../node_modules/@types/node/buffer.d.ts","../../../node_modules/@types/node/child_process.d.ts","../../../node_modules/@types/node/cluster.d.ts","../../../node_modules/@types/node/console.d.ts","../../../node_modules/@types/node/constants.d.ts","../../../node_modules/@types/node/crypto.d.ts","../../../node_modules/@types/node/dgram.d.ts","../../../node_modules/@types/node/diagnostics_channel.d.ts","../../../node_modules/@types/node/dns.d.ts","../../../node_modules/@types/node/dns/promises.d.ts","../../../node_modules/@types/node/domain.d.ts","../../../node_modules/@types/node/dom-events.d.ts","../../../node_modules/@types/node/events.d.ts","../../../node_modules/@types/node/fs.d.ts","../../../node_modules/@types/node/fs/promises.d.ts","../../../node_modules/@types/node/http.d.ts","../../../node_modules/@types/node/http2.d.ts","../../../node_modules/@types/node/https.d.ts","../../../node_modules/@types/node/inspector.d.ts","../../../node_modules/@types/node/module.d.ts","../../../node_modules/@types/node/net.d.ts","../../../node_modules/@types/node/os.d.ts","../../../node_modules/@types/node/path.d.ts","../../../node_modules/@types/node/perf_hooks.d.ts","../../../node_modules/@types/node/process.d.ts","../../../node_modules/@types/node/punycode.d.ts","../../../node_modules/@types/node/querystring.d.ts","../../../node_modules/@types/node/readline.d.ts","../../../node_modules/@types/node/readline/promises.d.ts","../../../node_modules/@types/node/repl.d.ts","../../../node_modules/@types/node/stream.d.ts","../../../node_modules/@types/node/stream/promises.d.ts","../../../node_modules/@types/node/stream/consumers.d.ts","../../../node_modules/@types/node/stream/web.d.ts","../../../node_modules/@types/node/string_decoder.d.ts","../../../node_modules/@types/node/test.d.ts","../../../node_modules/@types/node/timers.d.ts","../../../node_modules/@types/node/timers/promises.d.ts","../../../node_modules/@types/node/tls.d.ts","../../../node_modules/@types/node/trace_events.d.ts","../../../node_modules/@types/node/tty.d.ts","../../../node_modules/@types/node/url.d.ts","../../../node_modules/@types/node/util.d.ts","../../../node_modules/@types/node/v8.d.ts","../../../node_modules/@types/node/vm.d.ts","../../../node_modules/@types/node/wasi.d.ts","../../../node_modules/@types/node/worker_threads.d.ts","../../../node_modules/@types/node/zlib.d.ts","../../../node_modules/@types/node/globals.global.d.ts","../../../node_modules/@types/node/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/stats/stat.d.ts","../../../node_modules/@libp2p/interface-stream-muxer/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-transport/dist/src/index.d.ts","../../../node_modules/libp2p/node_modules/@libp2p/interface-connection/dist/src/status.d.ts","../../../node_modules/libp2p/node_modules/@libp2p/interface-connection/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-address-manager/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/transport-manager.d.ts","../../../node_modules/libp2p/dist/src/identify/pb/message.d.ts","../../../node_modules/@libp2p/interface-connection-manager/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/identify/index.d.ts","../../../node_modules/@libp2p/interface-connection-gater/dist/src/index.d.ts","../../../node_modules/@libp2p/interface-connection-encrypter/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/ping/index.d.ts","../../../node_modules/libp2p/dist/src/fetch/index.d.ts","../../../node_modules/libp2p/dist/src/autonat/index.d.ts","../../../node_modules/libp2p/dist/src/components.d.ts","../../../node_modules/@libp2p/keychain/dist/src/index.d.ts","../../../node_modules/@achingbrain/nat-port-mapper/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/nat-manager.d.ts","../../../node_modules/libp2p/dist/src/address-manager/index.d.ts","../../../node_modules/libp2p/dist/src/peer-routing.d.ts","../../../node_modules/libp2p/dist/src/connection-manager/latency-monitor.d.ts","../../../node_modules/libp2p/dist/src/connection-manager/index.d.ts","../../../node_modules/@libp2p/peer-collections/dist/src/map.d.ts","../../../node_modules/@libp2p/peer-collections/dist/src/set.d.ts","../../../node_modules/@libp2p/peer-collections/dist/src/list.d.ts","../../../node_modules/@libp2p/peer-collections/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/pb/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/server/reservation-store.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/server/advert-service.d.ts","../../../node_modules/it-pb-stream/node_modules/it-length-prefixed/dist/src/encode.d.ts","../../../node_modules/it-reader/dist/src/index.d.ts","../../../node_modules/it-pb-stream/node_modules/it-length-prefixed/dist/src/decode.d.ts","../../../node_modules/it-pb-stream/node_modules/it-length-prefixed/dist/src/index.d.ts","../../../node_modules/it-pb-stream/dist/src/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/server/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/transport/reservation-store.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/transport/discovery.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/transport/index.d.ts","../../../node_modules/libp2p/dist/src/circuit-relay/index.d.ts","../../../node_modules/libp2p/dist/src/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/stats/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/wantlist/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/want-manager/msg-queue.d.ts","../../../node_modules/ipfs-bitswap/dist/src/want-manager/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/decision-engine/ledger.d.ts","../../../node_modules/ipfs-bitswap/dist/src/utils/sorted-map.d.ts","../../../node_modules/ipfs-bitswap/dist/src/decision-engine/req-queue.d.ts","../../../node_modules/ipfs-bitswap/dist/src/decision-engine/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/notifications.d.ts","../../../node_modules/ipfs-bitswap/dist/src/bitswap.d.ts","../../../node_modules/ipfs-bitswap/node_modules/@libp2p/interface-connection/dist/src/index.d.ts","../../../node_modules/ipfs-bitswap/dist/src/network.d.ts","../../../node_modules/ipfs-bitswap/dist/src/index.d.ts","../../interface/dist/src/blocks.d.ts","../../interface/dist/src/index.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/identity.d.ts","../../../node_modules/multiformats/dist/types/src/hashes/sha2.d.ts","../src/index.ts","../../../node_modules/it-filter/dist/src/index.d.ts","../../../node_modules/mortice/dist/src/index.d.ts","../../../node_modules/it-foreach/dist/src/index.d.ts","../src/storage.ts","../../../node_modules/cborg/types/lib/token.d.ts","../../../node_modules/cborg/types/lib/bl.d.ts","../../../node_modules/cborg/types/interface.d.ts","../../../node_modules/cborg/types/lib/decode.d.ts","../../../node_modules/cborg/types/lib/encode.d.ts","../../../node_modules/cborg/types/cborg.d.ts","../../../node_modules/multiformats/dist/types/src/bases/base36.d.ts","../../../node_modules/eventemitter3/index.d.ts","../../../node_modules/p-queue/dist/queue.d.ts","../../../node_modules/p-queue/dist/options.d.ts","../../../node_modules/p-queue/dist/priority-queue.d.ts","../../../node_modules/p-queue/dist/index.d.ts","../../../node_modules/uint8arrays/dist/src/equals.d.ts","../../../node_modules/p-defer/index.d.ts","../../../node_modules/@ipld/dag-pb/dist/src/interface.d.ts","../../../node_modules/@ipld/dag-pb/dist/src/util.d.ts","../../../node_modules/@ipld/dag-pb/dist/src/index.d.ts","../../../node_modules/cborg/types/lib/json/encode.d.ts","../../../node_modules/cborg/types/lib/json/decode.d.ts","../../../node_modules/cborg/types/lib/json/json.d.ts","../../../node_modules/multiformats/dist/types/src/bases/base64.d.ts","../src/utils/dag-walkers.ts","../src/pins.ts","../../../node_modules/uint8arrays/dist/src/from-string.d.ts","../src/utils/datastore-version.ts","../../../node_modules/it-drain/dist/src/index.d.ts","../../../node_modules/datastore-core/dist/src/errors.d.ts","../../../node_modules/datastore-core/dist/src/shard.d.ts","../../../node_modules/datastore-core/dist/src/base.d.ts","../../../node_modules/datastore-core/dist/src/memory.d.ts","../../../node_modules/datastore-core/dist/src/keytransform.d.ts","../../../node_modules/datastore-core/dist/src/sharding.d.ts","../../../node_modules/datastore-core/dist/src/mount.d.ts","../../../node_modules/datastore-core/dist/src/tiered.d.ts","../../../node_modules/datastore-core/dist/src/namespace.d.ts","../../../node_modules/datastore-core/dist/src/index.d.ts","../../../node_modules/blockstore-core/dist/src/base.d.ts","../../../node_modules/blockstore-core/dist/src/memory.d.ts","../../../node_modules/blockstore-core/dist/src/index.d.ts","../../../node_modules/@libp2p/logger/dist/src/index.d.ts","../src/helia.ts","../../../node_modules/@types/chai/index.d.ts","../../../node_modules/@types/chai-as-promised/index.d.ts","../../../node_modules/chai-parentheses/index.d.ts","../../../node_modules/@types/chai-subset/index.d.ts","../../../node_modules/chai-bites/index.d.ts","../../../node_modules/@types/chai-string/index.d.ts","../../../node_modules/aegir/dist/utils/chai.d.ts","../../../../../node_modules/@types/ws/index.d.ts","../../../node_modules/it-ws/dist/src/web-socket.d.ts","../../../node_modules/it-ws/dist/src/sink.d.ts","../../../node_modules/it-ws/dist/src/duplex.d.ts","../../../node_modules/it-ws/dist/src/client.d.ts","../../../node_modules/@libp2p/websockets/dist/src/index.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/@types/basic.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/proto/payload.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/@types/libp2p.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/nonce.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/@types/handshake.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/crypto.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/noise.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/crypto/stablelib.d.ts","../../../node_modules/@chainsafe/libp2p-noise/dist/src/index.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/node_modules/it-stream-types/dist/src/index.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/frame.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/config.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/stream.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/muxer.d.ts","../../../node_modules/@chainsafe/libp2p-yamux/dist/src/index.d.ts","../test/fixtures/create-block.ts","../../../node_modules/@ipld/dag-cbor/dist/src/index.d.ts","../../../node_modules/@ipld/dag-json/dist/src/index.d.ts","../test/gc.spec.ts","../test/index.spec.ts","../test/fixtures/create-dag.ts","../test/fixtures/dag-walker.ts","../test/pins.depth-limited.spec.ts","../test/pins.recursive.spec.ts","../../../node_modules/it-all/dist/src/index.d.ts","../test/pins.spec.ts","../../../node_modules/@types/sinonjs__fake-timers/index.d.ts","../../../node_modules/@types/sinon/index.d.ts","../../../node_modules/sinon-ts/dist/src/index.d.ts","../../../node_modules/delay/index.d.ts","../test/storage.spec.ts","../../../node_modules/keyv/src/index.d.ts","../../../node_modules/@types/http-cache-semantics/index.d.ts","../../../node_modules/@types/responselike/index.d.ts","../../../node_modules/@types/cacheable-request/index.d.ts","../../../node_modules/@types/ms/index.d.ts","../../../node_modules/@types/debug/index.d.ts","../../../node_modules/@types/extend/index.d.ts","../../../node_modules/@types/istanbul-lib-coverage/index.d.ts","../../../node_modules/@types/json-schema/index.d.ts","../../../node_modules/@types/json5/index.d.ts","../../../node_modules/@types/keyv/index.d.ts","../../../node_modules/@types/unist/index.d.ts","../../../node_modules/@types/mdast/index.d.ts","../../../node_modules/@types/minimatch/index.d.ts","../../../node_modules/@types/minimist/index.d.ts","../../../node_modules/@types/mocha/index.d.ts","../../../node_modules/@types/normalize-package-data/index.d.ts","../../../node_modules/@types/parse-json/index.d.ts","../../../node_modules/@types/retry/index.d.ts","../../../node_modules/@types/semver/classes/semver.d.ts","../../../node_modules/@types/semver/functions/parse.d.ts","../../../node_modules/@types/semver/functions/valid.d.ts","../../../node_modules/@types/semver/functions/clean.d.ts","../../../node_modules/@types/semver/functions/inc.d.ts","../../../node_modules/@types/semver/functions/diff.d.ts","../../../node_modules/@types/semver/functions/major.d.ts","../../../node_modules/@types/semver/functions/minor.d.ts","../../../node_modules/@types/semver/functions/patch.d.ts","../../../node_modules/@types/semver/functions/prerelease.d.ts","../../../node_modules/@types/semver/functions/compare.d.ts","../../../node_modules/@types/semver/functions/rcompare.d.ts","../../../node_modules/@types/semver/functions/compare-loose.d.ts","../../../node_modules/@types/semver/functions/compare-build.d.ts","../../../node_modules/@types/semver/functions/sort.d.ts","../../../node_modules/@types/semver/functions/rsort.d.ts","../../../node_modules/@types/semver/functions/gt.d.ts","../../../node_modules/@types/semver/functions/lt.d.ts","../../../node_modules/@types/semver/functions/eq.d.ts","../../../node_modules/@types/semver/functions/neq.d.ts","../../../node_modules/@types/semver/functions/gte.d.ts","../../../node_modules/@types/semver/functions/lte.d.ts","../../../node_modules/@types/semver/functions/cmp.d.ts","../../../node_modules/@types/semver/functions/coerce.d.ts","../../../node_modules/@types/semver/classes/comparator.d.ts","../../../node_modules/@types/semver/classes/range.d.ts","../../../node_modules/@types/semver/functions/satisfies.d.ts","../../../node_modules/@types/semver/ranges/max-satisfying.d.ts","../../../node_modules/@types/semver/ranges/min-satisfying.d.ts","../../../node_modules/@types/semver/ranges/to-comparators.d.ts","../../../node_modules/@types/semver/ranges/min-version.d.ts","../../../node_modules/@types/semver/ranges/valid.d.ts","../../../node_modules/@types/semver/ranges/outside.d.ts","../../../node_modules/@types/semver/ranges/gtr.d.ts","../../../node_modules/@types/semver/ranges/ltr.d.ts","../../../node_modules/@types/semver/ranges/intersects.d.ts","../../../node_modules/@types/semver/ranges/simplify.d.ts","../../../node_modules/@types/semver/ranges/subset.d.ts","../../../node_modules/@types/semver/internals/identifiers.d.ts","../../../node_modules/@types/semver/index.d.ts","../../../node_modules/@types/strip-bom/index.d.ts","../../../node_modules/@types/strip-json-comments/index.d.ts","../../../node_modules/@types/yargs-parser/index.d.ts","../../../node_modules/@types/yargs/index.d.ts","../../../node_modules/@types/yauzl/index.d.ts","../../../../../node_modules/@types/connect/index.d.ts","../../../../../node_modules/@types/body-parser/index.d.ts","../../../../../node_modules/@types/bonjour/index.d.ts","../../../../../node_modules/@types/range-parser/index.d.ts","../../../../../node_modules/@types/qs/index.d.ts","../../../../../node_modules/@types/express-serve-static-core/index.d.ts","../../../../../node_modules/@types/connect-history-api-fallback/index.d.ts","../../../../../node_modules/@types/eslint/helpers.d.ts","../../../../../node_modules/@types/estree/index.d.ts","../../../../../node_modules/@types/json-schema/index.d.ts","../../../../../node_modules/@types/eslint/index.d.ts","../../../../../node_modules/@types/eslint-scope/index.d.ts","../../../../../node_modules/@types/mime/mime.d.ts","../../../../../node_modules/@types/mime/index.d.ts","../../../../../node_modules/@types/serve-static/index.d.ts","../../../../../node_modules/@types/express/index.d.ts","../../../../../node_modules/@types/html-minifier-terser/index.d.ts","../../../../../node_modules/@types/http-proxy/index.d.ts","../../../../../node_modules/@types/prop-types/index.d.ts","../../../../../node_modules/@types/react/global.d.ts","../../../../../node_modules/csstype/index.d.ts","../../../../../node_modules/@types/scheduler/tracing.d.ts","../../../../../node_modules/@types/react/index.d.ts","../../../../../node_modules/@types/scheduler/index.d.ts","../../../../../node_modules/@types/serve-index/index.d.ts","../../../../../node_modules/@types/sockjs/index.d.ts"],"fileInfos":[{"version":"8730f4bf322026ff5229336391a18bcaa1f94d4f82416c8b2f3954e2ccaae2ba","affectsGlobalScope":true},"dc47c4fa66b9b9890cf076304de2a9c5201e94b740cffdf09f87296d877d71f6","7a387c58583dfca701b6c85e0adaf43fb17d590fb16d5b2dc0a2fbd89f35c467","8a12173c586e95f4433e0c6dc446bc88346be73ffe9ca6eec7aa63c8f3dca7f9","5f4e733ced4e129482ae2186aae29fde948ab7182844c3a5a51dd346182c7b06","4b421cbfb3a38a27c279dec1e9112c3d1da296f77a1a85ddadf7e7a425d45d18","1fc5ab7a764205c68fa10d381b08417795fc73111d6dd16b5b1ed36badb743d9","746d62152361558ea6d6115cf0da4dd10ede041d14882ede3568bce5dc4b4f1f",{"version":"3aafcb693fe5b5c3bd277bd4c3a617b53db474fe498fc5df067c5603b1eebde7","affectsGlobalScope":true},{"version":"f3d4da15233e593eacb3965cde7960f3fddf5878528d882bcedd5cbaba0193c7","affectsGlobalScope":true},{"version":"d3f4771304b6b07e5a2bb992e75af76ac060de78803b1b21f0475ffc5654d817","affectsGlobalScope":true},{"version":"adb996790133eb33b33aadb9c09f15c2c575e71fb57a62de8bf74dbf59ec7dfb","affectsGlobalScope":true},{"version":"8cc8c5a3bac513368b0157f3d8b31cfdcfe78b56d3724f30f80ed9715e404af8","affectsGlobalScope":true},{"version":"cdccba9a388c2ee3fd6ad4018c640a471a6c060e96f1232062223063b0a5ac6a","affectsGlobalScope":true},{"version":"c5c05907c02476e4bde6b7e76a79ffcd948aedd14b6a8f56e4674221b0417398","affectsGlobalScope":true},{"version":"5f406584aef28a331c36523df688ca3650288d14f39c5d2e555c95f0d2ff8f6f","affectsGlobalScope":true},{"version":"22f230e544b35349cfb3bd9110b6ef37b41c6d6c43c3314a31bd0d9652fcec72","affectsGlobalScope":true},{"version":"7ea0b55f6b315cf9ac2ad622b0a7813315bb6e97bf4bb3fbf8f8affbca7dc695","affectsGlobalScope":true},{"version":"3013574108c36fd3aaca79764002b3717da09725a36a6fc02eac386593110f93","affectsGlobalScope":true},{"version":"eb26de841c52236d8222f87e9e6a235332e0788af8c87a71e9e210314300410a","affectsGlobalScope":true},{"version":"3be5a1453daa63e031d266bf342f3943603873d890ab8b9ada95e22389389006","affectsGlobalScope":true},{"version":"17bb1fc99591b00515502d264fa55dc8370c45c5298f4a5c2083557dccba5a2a","affectsGlobalScope":true},{"version":"7ce9f0bde3307ca1f944119f6365f2d776d281a393b576a18a2f2893a2d75c98","affectsGlobalScope":true},{"version":"6a6b173e739a6a99629a8594bfb294cc7329bfb7b227f12e1f7c11bc163b8577","affectsGlobalScope":true},{"version":"81cac4cbc92c0c839c70f8ffb94eb61e2d32dc1c3cf6d95844ca099463cf37ea","affectsGlobalScope":true},{"version":"b0124885ef82641903d232172577f2ceb5d3e60aed4da1153bab4221e1f6dd4e","affectsGlobalScope":true},{"version":"0eb85d6c590b0d577919a79e0084fa1744c1beba6fd0d4e951432fa1ede5510a","affectsGlobalScope":true},{"version":"da233fc1c8a377ba9e0bed690a73c290d843c2c3d23a7bd7ec5cd3d7d73ba1e0","affectsGlobalScope":true},{"version":"d154ea5bb7f7f9001ed9153e876b2d5b8f5c2bb9ec02b3ae0d239ec769f1f2ae","affectsGlobalScope":true},{"version":"bb2d3fb05a1d2ffbca947cc7cbc95d23e1d053d6595391bd325deb265a18d36c","affectsGlobalScope":true},{"version":"c80df75850fea5caa2afe43b9949338ce4e2de086f91713e9af1a06f973872b8","affectsGlobalScope":true},{"version":"9d57b2b5d15838ed094aa9ff1299eecef40b190722eb619bac4616657a05f951","affectsGlobalScope":true},{"version":"6c51b5dd26a2c31dbf37f00cfc32b2aa6a92e19c995aefb5b97a3a64f1ac99de","affectsGlobalScope":true},{"version":"6e7997ef61de3132e4d4b2250e75343f487903ddf5370e7ce33cf1b9db9a63ed","affectsGlobalScope":true},{"version":"2ad234885a4240522efccd77de6c7d99eecf9b4de0914adb9a35c0c22433f993","affectsGlobalScope":true},{"version":"5e5e095c4470c8bab227dbbc61374878ecead104c74ab9960d3adcccfee23205","affectsGlobalScope":true},{"version":"09aa50414b80c023553090e2f53827f007a301bc34b0495bfb2c3c08ab9ad1eb","affectsGlobalScope":true},{"version":"d7f680a43f8cd12a6b6122c07c54ba40952b0c8aa140dcfcf32eb9e6cb028596","affectsGlobalScope":true},{"version":"3787b83e297de7c315d55d4a7c546ae28e5f6c0a361b7a1dcec1f1f50a54ef11","affectsGlobalScope":true},{"version":"e7e8e1d368290e9295ef18ca23f405cf40d5456fa9f20db6373a61ca45f75f40","affectsGlobalScope":true},{"version":"faf0221ae0465363c842ce6aa8a0cbda5d9296940a8e26c86e04cc4081eea21e","affectsGlobalScope":true},{"version":"06393d13ea207a1bfe08ec8d7be562549c5e2da8983f2ee074e00002629d1871","affectsGlobalScope":true},{"version":"2768ef564cfc0689a1b76106c421a2909bdff0acbe87da010785adab80efdd5c","affectsGlobalScope":true},{"version":"b248e32ca52e8f5571390a4142558ae4f203ae2f94d5bac38a3084d529ef4e58","affectsGlobalScope":true},{"version":"6c55633c733c8378db65ac3da7a767c3cf2cf3057f0565a9124a16a3a2019e87","affectsGlobalScope":true},{"version":"fb4416144c1bf0323ccbc9afb0ab289c07312214e8820ad17d709498c865a3fe","affectsGlobalScope":true},{"version":"5b0ca94ec819d68d33da516306c15297acec88efeb0ae9e2b39f71dbd9685ef7","affectsGlobalScope":true},{"version":"34c839eaaa6d78c8674ae2c37af2236dee6831b13db7b4ef4df3ec889a04d4f2","affectsGlobalScope":true},{"version":"52d1bb7ab7a3306fd0375c8bff560feed26ed676a5b0457fa8027b563aecb9a4","affectsGlobalScope":true},"a807c0a82557d68f6f0464d6af0a6566d1ef708f57c7d1d7dd8dde28879635bc","4a5612eb59f581a5b8e05d22e668b4199787751266a0291e3e07113fc52abf2a","16c594cd8a44be9f5398d3fc7dbc9575f0b67d91a6553f35bd3576136862b32b","5d055d8b54e2dec3fe4aa417f5f664658b78123e83e8735047285f99a1d24065","42b5333564fef3c9becbe8daf55b1ea124514cd86c2f8bed401d2a3f0037b3b1","109970171acb66c4c03fa6ba9d0a3bc2bf43c12540db2b0842d25d54fbe11f65","65da6f0b8f50b27e05ebf35c88a8757eb4308751cdf2b1064a0e310a2a485895","2e3dc1d28f2467b2af0c931a3b0d2c595746a2f21818fc3c7b5d050996ace788","237be372eeb9a7ce07c6b2a21358f22772cde924614d67de175a4ac0ba3eb486","862eacc247d6c92524d7879feac6da363f55428cc78270bce7b14f2d3d0b0cef","f55f3ab9485b5fd1a3ba3a5a53e680cb8d3acc3552816a5d58a1fa26324262d0","ee93f3313289b31afd1544da65086607942df227eb61aedf488b7c072aa1128f","edb50eace77052203c3bc6eb251fe31f44ab0107e2b6d949ec983a918726aaf4","70cbb43b1e838bb77b16e1085115494c8b6925a954edf7fbdd494ad56a88adb8","ad716342f559ff88871c01a351dbf89fe72c8313f329cd2a714f09f532c50eab","ea86fe238f679714f2b3662d9d932bc3b47a0500894985718243167043f2bda8","866f0c4f16380a56653adc6cbeac08c58c626dabb431f0fa6cc2ba07874836d8","e8c5b68c1182684e8cfc177430b80fef003976d1dbde326087c28f5125fe4b5d","6666d48a46dbfd565490e7f8789093e2392c5bdcc3a380dfdd91c77237e43101","a2023e18c62b1109f17241fb1f90a84e75fffcb3ee9265d2e9bc0fa40b6ede42","3ccf65e2230413ab1facbad92a2fb77b8e2bcd314618d0ebc12f6cb7aaa21619","9080b537cd4fa24273477f33faf5f983e5f10aa386c2de8fcb6de837c9cc9763","272cd5e6428b68d973ce707329c3f621ac6b3eb4bf5bd4421b1106299600ddde","d34a8917095f11006957bed03e1e60dacc0b82906f5d0ddc87b959e283fbb5cc","bffe8a5db9410d2f3320df7016f83e9de47328e377aa78b9aaed1fe6d5db9d66","14b8a1dd226271e6b045d91262602b15820ff871b3dab24510a15e6989d05a5d","0fc1e0effc8ea83ceca9a1ff36c2696489fefea040d33fc5cbe244111333fcd4","1217c84b164e559b2371aea1b8c11eea9f95e123dab98942c8a5a4aacc2ad252","28092d5b5aea82adc509a3d522d265d9d5a8a0ddf92f94c8fb336c5787893030","7735c3681e614d7e967a935f397210fedbd987243456206f697202cb7c266a41","8ad13afb5324460426b210f7c5040d3d19375accd24e22bb52a534c728aca73e","e1fe04ff1ffecfb18420f0895d0cd2652f98a27def5c33aae5ef328f186c905b","635e7c978a30ab2013a37c4d05d0d081e58e4ad867db46a009412ad24ee426d7","b27c2a28daf3e502ae6b631cbf51881247fffd3e0163520bc5904604f9e48096","87b44430497cae7542bbd5ac2fb6663df6a465dea7a46be58a49cd9416530439","32b67d761db3999f1e482d0add405b695d3ec5607e07ae4c963a96334c331814","8747571dae434deca4847b49e09b5421d7068b0956a1df841756812645d4e1ed","474ab86e676e0c1b664bfcd21b1e58bed351f3390ba1d892e8da703f371b7a4e","fb7a601066e19b5d0c173b564bd46b358cf00c9040e79fb6fd427b7aa223eed1","4a8ce4a308482d69bd9032ee59f895a9d91e28ac5324665b31ea3a374b45e686","8b097e48fdeabcee00e2aacd4d009dff135c2cd51675a272d74ec25dd853dfee","28235440c6b330eb66df3a7badfc11e32cf7e08fbdb17b518a6b775fb269170f","247a5bebf668df6d3bb7e0b297ed5a6b6913d9343dcfea5bf77ce4662ab102bf","531556008024c69163c0d120823a69e7a6a5be1279ea87fc725a63dc386278b7","e2e44effbf7b4b1fb5111ef7a4443a733aff4cace7875fafa86bc41130dfdb84","1104c3d427c1cd94c53b14c09dc27d342a1cc1b0070ef95423bc3732940360e0","8585273188f221f30b37b5d869eb57bee20aa7aa478fe3de632cc0a1cd25238d","9dffe4acb382f1232e9eaeda23ed7f07c934acb9ef06aa528f75799d12d35343","77411d10dad0e74a86ce28dd0f720cce2947421e42f3fb5d1849bc14520f9b5b","667c9ac7c2f61c4a36220c2fa02f848a170aa96d3a58be32a5831aad86330da2","eb15dfd1f8b6da5f546fe29a6a0f0de4ae6dbd4a5577af4eba4c8a54548ef0a2","01443e5da049881a99f223c72617d4bb1d8854930d03deceb628e4be83df1e4a","a380f922477db0b9b4a17cde7d29585e2280036fd62ac4564814d4844b64717a","a0263cc045540023e72c993a26fd1bef3adf8674b9719272009134c56ecfc336","df162b6f89985144d8aedccc36dfc366ab5e562ba8615125b2bfa25273f3006b","5c040fc4a38020743248e6a49d75dd0e0547960d89492b06a9cc0fb4247ff547","7f8f6d3576ead7698d78d3849b5cd55b79f923e5589e14a2cc5270b4d0c9fe96","98361c0bdf0a06c4d1f0d1df0a94ea45c01c2f8c31180f40bf44fce4eebe761f","1d29e7b02346845d12ce3a2d6e23baabe6b5ab84f62541824feef0ff4bfb58d8","e53930d95e52d39b90d130b2312f18669be0766393dff5a649829f318ac7df06","7e771891adaa85b690266bc37bd6eb43bc57eecc4b54693ead36467e7369952a","a69c09dbea52352f479d3e7ac949fde3d17b195abe90b045d619f747b38d6d1a",{"version":"57b6cb95756d1fe3bfeb20205de27b0c5406e4a86e130c6dfa6bd92af641e09d","affectsGlobalScope":true},"11e2d554398d2bd460e7d06b2fa5827a297c8acfbe00b4f894a224ac0862857f",{"version":"e193e634a99c9c1d71f1c6e4e1567a4a73584328d21ea02dd5cddbaad6693f61","affectsGlobalScope":true},"374ca798f244e464346f14301dc2a8b4b111af1a83b49fffef5906c338a1f922","5a94487653355b56018122d92392beb2e5f4a6c63ba5cef83bbe1c99775ef713",{"version":"d5135ad93b33adcce80b18f8065087934cdc1730d63db58562edcf017e1aad9b","affectsGlobalScope":true},"82408ed3e959ddc60d3e9904481b5a8dc16469928257af22a3f7d1a3bc7fd8c4","e596c9bb2f29a2699fdd4ae89139612652245192f67f45617c5a4b20832aaae9","bb9c4ffa5e6290c6980b63c815cdd1625876dadb2efaf77edbe82984be93e55e","1cdcfc1f624d6c08aa12c73935f6e13f095919cd99edf95752951796eb225729","216717f17c095cde1dc19375e1ab3af0a4a485355860c077a4f9d6ea59fab5b5","14b5aa23c5d0ae1907bc696ac7b6915d88f7d85799cc0dc2dcf98fbce2c5a67c","5c439dafdc09abe4d6c260a96b822fa0ba5be7203c71a63ab1f1423cd9e838ea",{"version":"6b526a5ec4a401ca7c26cfe6a48e641d8f30af76673bad3b06a1b4504594a960","affectsGlobalScope":true},{"version":"816ad2e607a96de5bcac7d437f843f5afd8957f1fa5eefa6bba8e4ed7ca8fd84","affectsGlobalScope":true},"80473bd0dd90ca1e166514c2dfead9d5803f9c51418864ca35abbeec6e6847e1","1c84b46267610a34028edfd0d035509341751262bac1062857f3c8df7aff7153","e6c86d83bd526c8bdb5d0bf935b8e72ce983763d600743f74d812fdf4abf4df6","a3d541d303ee505053f5dcbf9fafb65cac3d5631037501cd616195863a6c5740","8d3c583a07e0c37e876908c2d5da575019f689df8d9fa4c081d99119d53dba22","2c828a5405191d006115ab34e191b8474bc6c86ffdc401d1a9864b1b6e088a58",{"version":"e630e5528e899219ae319e83bef54bf3bcb91b01d76861ecf881e8e614b167f0","affectsGlobalScope":true},"bcebb922784739bdb34c18ee51095d25a92b560c78ccd2eaacd6bd00f7443d83","7ee6ed878c4528215c82b664fe0cfe80e8b4da6c0d4cc80869367868774db8b1","b0973c3cbcdc59b37bf477731d468696ecaf442593ec51bab497a613a580fe30",{"version":"4989e92ba5b69b182d2caaea6295af52b7dc73a4f7a2e336a676722884e7139d","affectsGlobalScope":true},{"version":"0715e4cd28ad471b2a93f3e552ff51a3ae423417a01a10aa1d3bc7c6b95059d6","affectsGlobalScope":true},"5153a2fd150e46ce57bb3f8db1318d33f6ad3261ed70ceeff92281c0608c74a3","210d54cd652ec0fec8c8916e4af59bb341065576ecda039842f9ffb2e908507c","36b03690b628eab08703d63f04eaa89c5df202e5f1edf3989f13ad389cd2c091","0effadd232a20498b11308058e334d3339cc5bf8c4c858393e38d9d4c0013dcf","25846d43937c672bab7e8195f3d881f93495df712ee901860effc109918938cc","7d55d78cd47cf5280643b53434b16c2d9d11d144126932759fbdd51da525eec4","1b952304137851e45bc009785de89ada562d9376177c97e37702e39e60c2f1ff","69ee23dd0d215b09907ad30d23f88b7790c93329d1faf31d7835552a10cf7cbf","44b8b584a338b190a59f4f6929d072431950c7bd92ec2694821c11bce180c8a5","23b89798789dffbd437c0c423f5d02d11f9736aea73d6abf16db4f812ff36eda","f69ff39996a61a0dd10f4bce73272b52e8024a4d58b13ab32bf4712909d0a2b7",{"version":"3c4ba1dd9b12ffa284b565063108f2f031d150ea15b8fafbdc17f5d2a07251f3","affectsGlobalScope":true},"e10177274a35a9d07c825615340b2fcde2f610f53f3fb40269fd196b4288dda6","c4577fb855ca259bdbf3ea663ca73988ce5f84251a92b4aef80a1f4122b6f98e","3c13ef48634e7b5012fcf7e8fce7496352c2d779a7201389ca96a2a81ee4314d","5d0a25ec910fa36595f85a67ac992d7a53dd4064a1ba6aea1c9f14ab73a023f2",{"version":"f0900cd5d00fe1263ff41201fb8073dbeb984397e4af3b8002a5c207a30bdc33","affectsGlobalScope":true},{"version":"ff07a9a03c65732ccc59b3c65bc584173da093bd563a6565411c01f5703bd3cb","affectsGlobalScope":true},"6de4a219df57d2b27274d59b67708f13c2cbf7ed211abe57d8f9ab8b25cde776","0fe8985a28f82c450a04a6edf1279d7181c0893f37da7d2a27f8efd4fd5edb03","e59a892d87e72733e2a9ca21611b9beb52977be2696c7ba4b216cbbb9a48f5aa",{"version":"da26af7362f53d122283bc69fed862b9a9fe27e01bc6a69d1d682e0e5a4df3e6","affectsGlobalScope":true},"8a300fa9b698845a1f9c41ecbe2c5966634582a8e2020d51abcace9b55aa959e",{"version":"ab9b9a36e5284fd8d3bf2f7d5fcbc60052f25f27e4d20954782099282c60d23e","affectsGlobalScope":true},"d8d555f3d607ecaa18d55de6995ea8f206342ecc93305919eac945c7c78c78c6","14df447cbd09928056c88fa3e8f3548715dd25437e4fad7ef1a7fb8ff8dbe6c6","4c5e54a2d502770a63859a00fbf77e8b91ce76b18080278f62866e7cdb582798","71dfda7df8d05d2d54627963af1c3c675ef99363d421b7ff42ae237d038db4ce","6666d48a46dbfd565490e7f8789093e2392c5bdcc3a380dfdd91c77237e43101","6377354dd753557d479933e0bec6ca6836f839c87394ecb071e85f062b708058","0dd67171a4a3fa82044faec51befa11ab96f9205fd8cc96be09de275b65d36ab","42570779c28480ae0d1fa0695974a888305ee2b2efd37bacdeb57204dec843db","dc35c5340756418041da9f388103218ead65f57397f40d5674672c216b008126","2596013e7e3f002455e29bad0a70e0ae1a1364cac8584d2590b73133e63d6073","b9f2a8333ccac1e6037afd66dbba82bdeea00f1ed011f741ce4f006ad4eb8b01","78599ccb7640bea7bc64e8fddf33e97b8cf512c1b2be2c8851655a66980e4268","cd5ab2f30a27d53001804b7ef51758a79b73e4ccb7716b8e2ab8e17d69a7183b","a9dc4418352bc4a8d1e9314aba1e29327b17d06c604b397c6140d6488c5b022a","6adcf362e079c177ea4730c8b7beb3e9848b3f970ef08b497a641e034b0a0ece","341331b97a90ac435664e68b81f116f1f622283f3de523c5425b67eb0a58cad1","5e76b98d51f23f9d9563ac7002139d43fd6543eb66646928bf2e9df6a468ace5","e0b109ec8368bbb8943bf7943af9fbcf0e895160d1363cf93dacd43bcc747794","f569da0d6f4c6fb153811dd6b7d34afb4511c7d85f5089e30a1db78004975ec1","537b1070107a0454a2fe365a633555700fff55a4b3e15d55520633b93dbf96d1","8571610b2e190937f6fcf0c626ad415ec9b02a4ff550d8881812d2b9efdd2847","8dac050016c78a797699221c95d569c47ea4176e403b47f9f5a2e95afe26cdd6","d8a63ecc9188f8ef5fce8c82ea2c691acce9a152b8bd07d75a6531c7d4c07df9","cf86d880d95988555dd6ac5d1d3c9aa99054df217f0a7ec1acf39b9d56f6445f","6426748248e4065207bda1892b18426f1c9072800edc015119d4c907f62af51d","4ce46cbc89a24ce3d0a00dec230826cefee2514181e790932230705db3f0849d","f7b2f9a0ffd520805cdf2440d48f45bd9074c905aea1a365b91de9170ccc9d58","8432e40770dd9f642c682661fea75226189e5b701b06189a98c6bcd3764d796b","8f0d013f819b91abf6b355e510e1bc039ff10699932d726ba7b3a4f447c031bc","4f7f48524408301ae348e9d310f9ca718210cc2ac1c2c6697eee1e0d487c7d00","34999b05c3aa15b73ab99dc1bd9a2d17b7f24cbf229a45b0850c7cd9e138ffe7","6c2d1a830c44b810afbc51d9c6e24acc69bba27bcd8f635142ebdfbe3e8512a3","86aa8428ca8e1061ca36c4d3d62add983e16b01c003b8644ad10e3baaa7fac22","975bbb148ebe1290081bb0f643d70aa4c5e4b09ef9121eb60dd78ec262042dac","d61d22e1b77ff3242e3ebdc209b1567edbf573fa619ef10841f282705124254c","91fe7b33847d945b1ad3a816c397ca4cddf5005dc36f5bea4ab11e1ca7b256f1","fe968d845c846a7b92645287133ba0b8e9f84fcfd31834993e77330a95e6e40c","a054d5318c7a96f630b21d0ecbbec6a5adf97f8d697f11dc1e7892f87be5ad02","a5e5b361a88c70f95156c17dadb55b39f658103e28f16d7a3158be79809b09fd","d40b8ae5d3a678fc5542430da94fc918f1c6859c214e899040c3df4c51742f2e","677634e24d8933e8820eac9ca51b590a63618d297f202cf0751777d2563c74c6","06d62ca3f63cc0a07f525f0df010713c02d0b3a12eff7e7c393641b36ec070cc","067a9f51aba2c72ba4edc53d3bd6824252fe04e2669ec94900f86ac4546df85d","f353277ba8d4cdeef520cb9b2f4783822905b2ce566a13164315169b3568ae5b","ae22d15cec861001bfbfb8c687a923d2e738cbc5c3d735efaf7c47f120b67f69","7358609d0e5b16530e1abd6733acc75563d256611acb3af8a4f972ac4c59939d","ab9167a9bbb00d296e4869ec2fb3eee2b21ff3499188fb4af34304a135d20bed","6260ecbf296c5b1c2ed8f1f0576be142dafbf40cbcdd8726dc3fa0613a886c17","2155af21eeb50fd776bb6bcebe3de578a147c8e8de31bb1ae109c677f506a12c","5439a1d73592e158c5b6cabb484c12d869201aa0858b81efcb36c07b876de05b","066ff6c630538b957b427d965491c943dbe09fb3b0d5f165c7d587650ab3743f","aeb0baac263e970354040d07ddc244e53df3c343dd4550cd6ce81728f508294a","6377354dd753557d479933e0bec6ca6836f839c87394ecb071e85f062b708058","f7aa4d992f548e3468050744e8a4ff8286655d381d4558ca21afa02333d4c462","3b5e6cad6e81d2989e658f1417cbae8fb8648edb8f2cedc7a254b55ae42b6f0f","4241fb087ba952bdd1efe05d7d842e7c717b2012cb0d8087b202109a9309921a","d40edaf951d4e5331a678c237c21f7068eece7171d77f3c4b5f62e2b90af7800","747d7c8ba669de2e9ddb908b14339990e432d081808cded290886ab06d82d15c","2f686fbec43c87bc9b9c3d0e237f780e0e822d2c3a9a25fc99a16030a294b764",{"version":"e6a01156a9c5e37d97bdda6d0766eda13db76b69fbf10c104730900ade424fa4","signature":"d6220b26516404238a39f13fc8dccce3b6d4488137f4792d1bc410d87fe1256d"},"b645e731f23a0f3900325f56e43c64355292d6648aaeccc52c1f15c74dec8b28","956106fa5b05d3c40eb69e9879e90e79e2ea0ae8c68a8c27bc7f6c49f166ce6a","d33ce9358de6447d71146be26bd735890a8c2b3f08a6f4dc2962d5d76ad308d5",{"version":"57ac950c9eee134a2d1a60bb101ccae812e1192fdb3e5f4389d1360b178f0d01","signature":"6a9de13549d27478f2b2070f3c4b8d593902895a9cf28ef769379121a21bf498"},"9020b97e51ba49623ce0cff9642a64539e87b3e8a60140976a6db1b8b619bf64","ba35c752e706209ad45d2b4c2d53fb3afac1f2a662165243e0d92676bd8dec97","eb88bd089559981e3550efbe72e14051643b7a440ee75f7624905f982c89aa36","2ea9917e07bebc215b2fbee3ceeab886ebe0c2b3b66b0716e1f3671ca9d64677","27a3b0deb06300567f3dca18081eadbb47fe8709df8836cd2068d01321fa3dcc","ca40d7f23f8e91cad30ebd788ab262c989921cc640b75f32a0f1cfae3ad7002f","0ad79a8c8111a71435f719197c80a96dddb64db990acf7e4f43c801cf6b728ab","b80c780c52524beb13488942543972c8b0e54400e8b59cee0169f38d0fabb968","a77fbecee25688f568e18b43f8f54195d6c278a2a9a687ada5ab3d2f726524eb","e29f2b3a93ca3392fe29fa8e7b93985e854b44fe28e2b5c113f08296095bd6b7","d27956c8b392088a06d882e1edb58aab4d5cf5ab1229b73f99329ab21f352147","90dab905b7ea5ab629b62ec5a4153b3f44469aff5b1f6132edb2802537e5d8a7","41faca5faa6859bbe93224fdd4007353393807527d2fb674fbd83b2edfd16af3","acd5d501223e3a7cdd229b501fce5fb071937b72bd05fa33e543eb21c8ee0aba","d685f99305de85b9acd7c1c829ad3da66f596b04f7c73aaa1a19ba98be38680a","ad71f9c46d418d0f9036cec85e25945cb144f4319f863fe7ea47562f79b55641","3ba21bde0811dc0a71ded3d7825224bf2f96cca6f961d5addfb535e7cb6a5871","88ff75494a7e218d56b9f5a56729b874c7b3db479030723f147bec7ebac75955","7a3765b6505614c9321bea7c2a1218f923a6151a4a85e18f30dd5aa56fc31749","5fff27268ff372b10164bc044abf011c2b52327d4be5fd7be90eb7b9b5183971","de3ba4fafdea18e37beed5924f34b180e32793e34669e311031ec39ded7b84fe",{"version":"beaea2d52d7e2f0c893a29f93030da4f1d4c4741704330d3afe759959926ce69","signature":"ea02d18c0b90e29e2057866146eff9be5b7a083bab50493a15a81da213bbd67d"},{"version":"36f6acdaf0086636777999b597def8d87a2a505e93880ea12d382fc6614f1819","signature":"a09fc0478ac838899435d672dd416edc9372bd6f24efb9a1b3c28b7d7c0f52ed"},"558b9c398ce6f03df00e76eca31d239960977a6c3f06c5fa067e7f176fd5e6be",{"version":"e2c0e5dd2454e739d21f67a1e8d7d7fb5638706499d33b0bf26dec69946c4ec4","signature":"68e5a5b380b050faca60039c764139f9372c684639224b822a03d99d3fdadb81"},"5fc52eff32c75afed919d4518e57e3e3c424f79b1a280c3c9f1d0cc5bd6ba7d9","69590a840434ba9f46be2f8d26bbe49813ead59588db2d71c05d716af1933693","6423f19283bea29983e02d03bd9783cadbd75fef30bc42bee711e05469e39621","f676094bcb50ef81359754116159ee65a1618ee42100f4f0168c252dafcc420d","1d53e16def3ea7211d7d0ef0b87aebacd185e21c75c742034e146cb1bfefb047","92a4c17860234795044e2f8f6a09da71f25566d7917940c6d8b059ef39130e20","a6a7cf3ee7811279f8309d82b5adbf7e39c8239fcdf8c057fed5199ecded0383","7b48a8adecc1dd870aa5c4891ad3afacc642c6bc1de9e5d1af34e6d05d042cd0","dfd7205c20d46b9b31082bd56f3d1c6937e95b2d1369c3edaafedf95f3b9cb3f","aee2b6f6d8dba73016b3356454492b9cba5f0a3f47409799a72a9aa7138b7743","3853b8248ae1d3e3e7bd6c14c9e5926d177918812ccd93486704c47f6823e487","89f3cdbbf9cb7b86ef859cefea8f2b669dbe0610d942a3a38e1fde983907a762","ed42a3b734edf70e551f833095d39fc7ec977e57408aa59639f88a5f97c096b4","60ae27564948e96266b3e1eb7b6762800c7c5deee3959443e1c48bffe709d7c4","b6d189963f04bd06137fe46fb8db1dca958aa65a15cc3aa210a3b2f9a2641c2a",{"version":"54badb0fb11fa68858e0f4071d5e9ff776dc8b27521663824c519a3a61a65d2b","signature":"499104eec27bf81b41b27a7e4c723c00e5f2e5bd45b24d81aebb0e8bd791c8dc"},{"version":"b9734142a4b241cfb505be4a2eb0261d211647df7c73043f817f4fdd8d96c846","affectsGlobalScope":true},{"version":"63e2182615c513e89bb8a3e749d08f7c379e86490fcdbf6d35f2c14b3507a6e8","affectsGlobalScope":true},{"version":"c1f79c6d85cd84518fd7349588b3c61bdc189f58e3866f925cbf4631c81e31f9","affectsGlobalScope":true},{"version":"f4c0db3a49cea9babd5d224ba14243a6a6119bf65a65198994033aaea3a60a71","affectsGlobalScope":true},{"version":"42f28f4cfca4a70bd89c1d55d76c7978275030b894f6793f36890265c11a83a4","affectsGlobalScope":true},{"version":"41071d2f1a39386d10bf36d1ba4712ad42a900047f16a109936df9e48f13673e","affectsGlobalScope":true},"961e669569be9491c20108cda7db74e91d9ceafde708d3db10603af69aef7e23","77c5c7f8578d139c74102a29384f5f4f0792a12d819ddcdcaf8307185ff2d45d","c77e66895200939e79d8f92626b2bf3f63fce26bec0595f627a75436e91f1a22","017febfe030b871299879422a871e5c35b56d892de5bc9b69f277a7953bf0c7b","118a93594fa1bc0778be39c1fe3b146665ac8d3e1cca0e7abbdce61fa0ef120d","192a3bb6b310dbf89e9c602a2eba1a249e71dc77610bd7f8b9e7a64cf8634b22","0f8cb712b156059593dbba6007ca600c9b8b7fd10d1000fd4dcca93736371461","634383ecece44671e25939c8a6710e8a9f1f02ea51424e9752c81c0c3f3ae6d5","594f11fc10f5fa50df7e09c3c7d3e925bf0bd5f10af78fa715b809a847cba718","63ad4205a06d0f4529ea385815c51ebb32ce68fc52ae4e650e51e866e5578ec5","ce8d5b83e00a61eb0b931ca091036266565ae8c730a0276c3687bf079f33b44b","25005fd1c08300ea0aced86760109ebc99ae29400f90163bbe1ee4a0fc57ed1d","c622790571b9723df8f1175ce4deb073728b55bef81f1c4c12ec4967249b53c6","c55719987df25500caf575194e75c0f249758f8a7cbc1eac25541faa49d18eab","6fe8555e7cff8fb4b1c4ee9c759e3ad0e205f1d20c302ccd47cd5c05dd3f67f5","940fd6ac43a78cbe1ed17db09ff8f93dcf7f9703cebaaea53071a6b448f25466","1738ee2a1396aff81a52e43d32ac60ffd203d20ffccab11418d116be2fc5b876","0ced1660cb3c37fdadc07c4643c95c30765fb0d444fd97801221cd3f676534ab","b87c7660d9b59a77ea1d98c3fd181d6ce749f33d98b76ae45286a8d9ca0f9975","24d3285154e14c9e6f598139aa3047fc43a6c26de1277e763d5b17a0a0b9b69a","a25d01e88b96b0168f3775f0f93f2fb68905671bc45d066eed57515097b7e4f4","968232cb9942a5ff67d7e85e961d8765b247f7fdf13aa0bd930cec89607734ab",{"version":"349bd3226884630f094bb940a93f07a545e160d82a89ee9816197cf07e89e473","signature":"501053edaaab7da4c9ac57663fb20190b11727fea93460859d4ebc75c95b3da0"},"1f88bf28e66030245be67bc6bc08a7dcf01ca25070ca3085dbb21bef3a502047","3a0019f4fa5bb4c995704a0cd8dbf46d7421ee92ba596091a7b81b45f0accafe",{"version":"20154fb90e94278940af6dfe8dc9a2b8bbc4d4f3e22222e535520500f4031a50","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"7cc871b0b4db0f4c737fc75bc6ca4484aea157b00f159e16abaa9be07a1ed8ca","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"736537dad078e5c2fa6c79bec21e0394b25cce00afd826d6c82479cbaddda7f2","signature":"4372cdc6246cb8f75075b638e7162f217c8ef1619440056a6a5a0756adae9353"},{"version":"6ffdac1e1e20bc96ab89d9165a598488225b9c30a17d30fdb851c0b6f9d3b9c1","signature":"d885e33554f5882f2b6ca0e27b558eb2e96b6748e1e8538478d0672499049520"},{"version":"aaba76758488bedf9d1c85bc89df8f234e3a191c0eb70453ad566189dc6fbb53","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"a4ff7a99e8a07d41fb8d16e3c2b7f9ec7d0713a4c3ac3198117698e23ce41dea","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},"7c09e89531304457acac5f7b76feb41ac616997ef367ea84868f2b244d2f2f4d",{"version":"61a7b0f1249c220c1e5019df52c39cbe791b8f425cea3bd8412cd53522fd6ed4","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},"f83b320cceccfc48457a818d18fc9a006ab18d0bdd727aa2c2e73dc1b4a45e98","354abbae08f72ea982b1a767a8908f1b3efe8bbe53955c64f9c0c249c8832d5d","3f3da7d825970e86514129ec0c3264c589def469dffd96a1c0f2a9495f7bcb33","4c7fb1f4c57f3cd9d571c5e4cae33503530273a45579fa0babaf36b64a776eaa",{"version":"1a51ab6073f3fa05b08bf6e52d006837a1ed3d5a8dda9b51d63a855030d65d66","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},"92edb6e257fa64d3baae647490e041912684f5dc1f243d0aedd60b4b383ff50b","cab425b5559edac18327eb2c3c0f47e7e9f71b667290b7689faafd28aac69eae","3cfb0cb51cc2c2e1b313d7c4df04dbf7e5bda0a133c6b309bf6af77cf614b971","f992cd6cc0bcbaa4e6c810468c90f2d8595f8c6c3cf050c806397d3de8585562","6a9c5127096b35264eb7cd21b2417bfc1d42cceca9ba4ce2bb0c3410b7816042","78828b06c0d3b586954015e9ebde5480b009e166c71244763bda328ec0920f41","80d50bca45b12deb542118e51aa1c5e6c779f2b387e589d475297c07de0b342d","8b06ac3faeacb8484d84ddb44571d8f410697f98d7bfa86c0fda60373a9f5215","f3e604694b624fa3f83f6684185452992088f5efb2cf136b62474aa106d6f1b6","96d14f21b7652903852eef49379d04dbda28c16ed36468f8c9fa08f7c14c9538","fec943fdb3275eb6e006b35e04a8e2e99e9adf3f4b969ddf15315ac7575a93e4","cddf5c26907c0b8378bc05543161c11637b830da9fadf59e02a11e675d11e180","5774751340e987a6a9e4a5dcc03ff68a6515adc2b91423e1af2f660fc8f30e81","8841e2aa774b89bd23302dede20663306dc1b9902431ac64b24be8b8d0e3f649","209e814e8e71aec74f69686a9506dd7610b97ab59dcee9446266446f72a76d05",{"version":"677646e2620795c98a539fb12fb531f10331c217cef1492132b2518f894fa92d","affectsGlobalScope":true},"6fa0008bf91a4cc9c8963bace4bba0bd6865cbfa29c3e3ccc461155660fb113a","2b8264b2fefd7367e0f20e2c04eed5d3038831fe00f5efbc110ff0131aab899b","58a3914b1cce4560d9ad6eee2b716caaa030eda0a90b21ca2457ea9e2783eaa3","2b93035328f7778d200252681c1d86285d501ed424825a18f81e4c3028aa51d9","2ac9c8332c5f8510b8bdd571f8271e0f39b0577714d5e95c1e79a12b2616f069","42c21aa963e7b86fa00801d96e88b36803188018d5ad91db2a9101bccd40b3ff","d31eb848cdebb4c55b4893b335a7c0cca95ad66dee13cbb7d0893810c0a9c301","77c1d91a129ba60b8c405f9f539e42df834afb174fe0785f89d92a2c7c16b77a","7a9e0a564fee396cacf706523b5aeed96e04c6b871a8bebefad78499fbffc5bc","906c751ef5822ec0dadcea2f0e9db64a33fb4ee926cc9f7efa38afe5d5371b2a","5387c049e9702f2d2d7ece1a74836a14b47fbebe9bbeb19f94c580a37c855351","c68391fb9efad5d99ff332c65b1606248c4e4a9f1dd9a087204242b56c7126d6","e9cf02252d3a0ced987d24845dcb1f11c1be5541f17e5daa44c6de2d18138d0c","e8b02b879754d85f48489294f99147aeccc352c760d95a6fe2b6e49cd400b2fe","9f6908ab3d8a86c68b86e38578afc7095114e66b2fc36a2a96e9252aac3998e0","0eedb2344442b143ddcd788f87096961cd8572b64f10b4afc3356aa0460171c6","71405cc70f183d029cc5018375f6c35117ffdaf11846c35ebf85ee3956b1b2a6","c68baff4d8ba346130e9753cefe2e487a16731bf17e05fdacc81e8c9a26aae9d","2cd15528d8bb5d0453aa339b4b52e0696e8b07e790c153831c642c3dea5ac8af","479d622e66283ffa9883fbc33e441f7fc928b2277ff30aacbec7b7761b4e9579","ade307876dc5ca267ca308d09e737b611505e015c535863f22420a11fffc1c54","f8cdefa3e0dee639eccbe9794b46f90291e5fd3989fcba60d2f08fde56179fb9","86c5a62f99aac7053976e317dbe9acb2eaf903aaf3d2e5bb1cafe5c2df7b37a8","2b300954ce01a8343866f737656e13243e86e5baef51bd0631b21dcef1f6e954","a2d409a9ffd872d6b9d78ead00baa116bbc73cfa959fce9a2f29d3227876b2a1","b288936f560cd71f4a6002953290de9ff8dfbfbf37f5a9391be5c83322324898","61178a781ef82e0ff54f9430397e71e8f365fc1e3725e0e5346f2de7b0d50dfa","6a6ccb37feb3aad32d9be026a3337db195979cd5727a616fc0f557e974101a54","c649ea79205c029a02272ef55b7ab14ada0903db26144d2205021f24727ac7a3","38e2b02897c6357bbcff729ef84c736727b45cc152abe95a7567caccdfad2a1d","d6610ea7e0b1a7686dba062a1e5544dd7d34140f4545305b7c6afaebfb348341","3dee35db743bdba2c8d19aece7ac049bde6fa587e195d86547c882784e6ba34c","b15e55c5fa977c2f25ca0b1db52cfa2d1fd4bf0baf90a8b90d4a7678ca462ff1","f41d30972724714763a2698ae949fbc463afb203b5fa7c4ad7e4de0871129a17","843dd7b6a7c6269fd43827303f5cbe65c1fecabc30b4670a50d5a15d57daeeb9","f06d8b8567ee9fd799bf7f806efe93b67683ef24f4dea5b23ef12edff4434d9d","6017384f697ff38bc3ef6a546df5b230c3c31329db84cbfe686c83bec011e2b2","e1a5b30d9248549ca0c0bb1d653bafae20c64c4aa5928cc4cd3017b55c2177b0","a593632d5878f17295bd53e1c77f27bf4c15212822f764a2bfc1702f4b413fa0","a868a534ba1c2ca9060b8a13b0ffbbbf78b4be7b0ff80d8c75b02773f7192c29","da7545aba8f54a50fde23e2ede00158dc8112560d934cee58098dfb03aae9b9d","34baf65cfee92f110d6653322e2120c2d368ee64b3c7981dff08ed105c4f19b0","6aee496bf0ecfbf6731aa8cca32f4b6e92cdc0a444911a7d88410408a45ecc5d","4006c872e38a2c4e09c593bc0cdd32b7b4f5c4843910bea0def631c483fff6c5","ab6aa3a65d473871ee093e3b7b71ed0f9c69e07d1d4295f45c9efd91a771241d","70e9a18da08294f75bf23e46c7d69e67634c0765d355887b9b41f0d959e1426e","e9eb1b173aa166892f3eddab182e49cfe59aa2e14d33aedb6b49d175ed6a3750","65dfa4bc49ccd1355789abb6ae215b302a5b050fdee9651124fe7e826f33113c","6d829824ead8999f87b6df21200df3c6150391b894b4e80662caa462bd48d073","afc559c1b93df37c25aef6b3dfa2d64325b0e112e887ee18bf7e6f4ec383fc90","d78e5898c8de5e0f934eee83f680262de005caa268d137101b833fd932f95e07","16d51f964ec125ad2024cf03f0af444b3bc3ec3614d9345cc54d09bab45c9a4c","ba601641fac98c229ccd4a303f747de376d761babb33229bb7153bed9356c9cc",{"version":"c5dd1fef4cd4aaffc78786047bed5ae6fc1200d19a1946cbc4e2d3ed4d62c8fa","affectsGlobalScope":true},"56cbe80e6c42d7e6e66b6f048add8b01c663797b843a074d9f19c4a3d63a269a",{"version":"64d4b35c5456adf258d2cf56c341e203a073253f229ef3208fc0d5020253b241","affectsGlobalScope":true},"a1c79f857f5c7754e14c93949dad8cfefcd7df2ecc0dc9dd79a30fd493e28449","f3e604694b624fa3f83f6684185452992088f5efb2cf136b62474aa106d6f1b6","e793f85164d47950e32731e98897e3e6b285339c5fa1b3a3ddd1711a54f371b1","e050a0afcdbb269720a900c85076d18e0c1ab73e580202a2bf6964978181222a","5b9ecf7da4d71cf3832dbb8336150fa924631811f488ad4690c2dfec2b4fb1d7","951c85f75aac041dddbedfedf565886a7b494e29ec1532e2a9b4a6180560b50e","e6f0cb9d8cb2e38bec66e032e73caa3e7c6671f21ed7196acb821aec462051f2","43cdd474c5aa3340da4816bb8f1ae7f3b1bcf9e70d997afc36a0f2c432378c84","ee65fe452abe1309389c5f50710f24114e08a302d40708101c4aa950a2a7d044","54c9959f2d8ba97a5fcc4345ac2fca6f1bc20fe5764570b7fef37bea107bc70b","6a386ff939f180ae8ef064699d8b7b6e62bc2731a62d7fbf5e02589383838dea",{"version":"bbdf156fea2fabed31a569445835aeedcc33643d404fcbaa54541f06c109df3f","affectsGlobalScope":true},"1c29793071152b207c01ea1954e343be9a44d85234447b2b236acae9e709a383","f5a8b384f182b3851cec3596ccc96cb7464f8d3469f48c74bf2befb782a19de5",{"version":"45e702668a69a742682ccc153d6159a8817fa6387b6d1d91a447e3e4534518b3","affectsGlobalScope":true},"74b0245c42990ed8a849df955db3f4362c81b13f799ebc981b7bec2d5b414a57","acebfe99678cf7cddcddc3435222cf132052b1226e902daac9fbb495c321a9b5","82b1f9a6eefef7386aebe22ac49f23b806421e82dbf35c6e5b7132d79e4165da"],"options":{"composite":true,"declaration":true,"declarationMap":true,"emitDeclarationOnly":false,"esModuleInterop":true,"importsNotUsedAsValues":2,"module":6,"noEmitOnError":true,"noFallthroughCasesInSwitch":true,"noImplicitReturns":false,"noUnusedLocals":true,"noUnusedParameters":false,"outDir":"./","removeComments":false,"skipLibCheck":true,"sourceMap":true,"strict":true,"stripInternal":true,"target":7},"fileIdsList":[[129,156,163,376],[120,156,163],[155,156,163,381],[129,156,163],[156,384,386],[156],[156,320,383,384],[126,129,156,163,379,380],[156,377,380,381,390],[126,129,131,134,144,155,156,163],[156,388],[156,389],[156,394,395,396,397],[127,156,391],[129,156,163,389],[126,129,131,144,152,155,156,161,163],[156,281,283,284],[156,175,281,282],[156,281,283,285],[156,286],[156,175,282,286,287,288],[61,69,76,156,175,281,282,283,286],[156,281],[65,104,156],[156,266],[156,165,291,294],[73,156,165,290,291,292,293],[65,70,73,156,266,290,291,292],[60,80,156],[80,86,156,229],[80,156,241,242],[60,156],[60,156,241],[51,55,156],[61,69,156],[55,61,70,156],[50,51,55,61,70,156],[50,55,61,65,68,69,156],[50,60,62,156],[50,60,61,62,63,156],[57,61,156],[50,51,52,55,61,62,64,67,70,71,72,74,75,76,77,156],[70,156],[51,62,156],[56,60,156],[55,61,156],[50,61,62,156],[51,55,61,62,66,156],[51,61,65,70,73,156],[61,65,156],[61,70,156],[50,69,70,156],[50,51,55,69,70,156,165],[61,77,94,156],[156,187,188,189],[61,156],[50,129,156,163,166,275,279],[55,156],[53,54,156],[126,129,155,156,163,312,313,314],[156,268],[156,316],[126,156,163],[156,323],[110,156],[113,156],[114,119,147,156],[115,126,127,134,144,155,156],[115,116,126,134,156],[117,156],[118,119,127,135,156],[119,144,152,156],[120,122,126,134,156],[121,156],[122,123,156],[126,156],[124,126,156],[126,127,128,144,155,156],[126,127,128,141,144,147,156],[156,160],[122,129,134,144,155,156],[126,127,129,130,134,144,152,155,156],[129,131,144,152,155,156],[110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162],[126,132,156],[133,155,156],[122,126,134,144,156],[135,156],[136,156],[113,137,156],[138,154,156,160],[139,156],[140,156],[126,141,142,156],[141,143,156,158],[114,126,144,145,146,147,156],[114,144,146,156],[144,145,156],[147,156],[148,156],[126,150,151,156],[150,151,156],[119,134,144,152,156],[153,156],[134,154,156],[114,129,140,155,156],[119,156],[144,156,157],[156,158],[156,159],[114,119,126,128,137,144,155,156,158,160],[144,156,161],[129,144,156,163],[156,331,370],[156,331,355,370],[156,370],[156,331],[156,331,356,370],[156,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369],[156,356,370],[156,307],[156,373],[126,144,156,163],[156,268,269,270,271,272,273],[60,79,97,156],[156,263,264],[60,79,97,156,263],[156,227,229,230,231],[156,227,228],[156,227,229],[156,229],[156,227,228,229],[156,244,245],[156,268,269],[79,94,156],[94,156,253,254,255,256,257,258,259,260,261],[79,94,156,255,262],[79,93,94,156,255],[79,94,156,255],[94,156,257],[94,156,262],[60,79,156],[79,93,156],[92,156],[55,60,61,78,79,95,97,109,156,205,208,212,213,216,217],[60,61,78,97,105,107,108,109,156,205,209,211,216],[60,61,105,107,156,206],[61,156,210,212],[50,52,56,60,61,78,95,97,105,106,156,216],[60,105,107,156],[60,105,108,156,217],[50,55,60,61,62,75,78,95,109,156,168,205,214,217],[50,60,61,95,126,156,163,217],[61,106,126,156,163,164,204],[106,126,156,163],[55,60,61,78,95,156,205,206,207,216,217],[60,61,95,109,156,216,217],[60,105,156],[60,78,105,107,156,205],[50,55,61,65,69,156,167],[65,69,156,197],[65,69,156,195,197],[65,156,194,196],[65,69,156],[156,275,277,278],[69,156,275,276,277],[69,156,275],[156,275],[51,55,61,156,166,169],[52,61,71,75,156,166,169,172],[51,55,156,190,191,199,202],[51,52,72,156],[61,67,75,156,168,169,172,174,191,192,193,198,203],[50,52,55,61,156,190,191,203],[51,52,61,67,72,75,156,166,172],[61,67,72,75,156,166,169,172,174,200,201],[51,52,61,67,156,166,172],[52,61,64,67,71,72,74,75,76,94,156,166,168,169,172,174],[50,51,52,55,61,67,76,156,166,168,172,185],[51,156],[50,52,61,75,156,168,172],[50,52,55,61,67,75,156,168,169,171,172],[50,61,62,63,64,67,71,72,74,76,78,94,156,165,166,168,170,173,174,175,176,177,178,179,180,182,183,184,186,203],[52,61,156,166,169,181],[50,52,61,62,67,71,156],[50,52,61,75,156,172],[50,51,52,55,76,156,166,168,169],[57,156],[89,156],[86,87,88,89,156],[59,60,156],[59,156],[58,156],[80,156],[56,156],[56,82,156],[82,156],[83,156],[60,81,82,83,84,85,156],[56,57,58,59,80,156],[56,57,58,156],[156,234,235,236,237],[156,235],[156,235,236],[104,156],[98,156],[98,104,156],[65,98,156],[98,99,100,101,102,103,156],[156,308],[91,156],[86,90,156],[56,60,78,94,95,96,156,217,219,220,221,222,226,249,251,252,262,265,266],[56,60,78,94,97,156,217,219,267],[50,60,94,96,97,156,222,232,233,238,239,240,248],[50,60,79,95,96,97,156,217,218,223,224,225],[86,87,156,222,232,243,246,247],[92,94,156,250],[60,97,156,221],[60,97,156,250,296],[92,156,222,301],[87,156,204,219,222,243,262,265,274,280,289,295,296,297,298],[60,94,156,204,219,222,262,265,274,280,289,295],[156,204,219,222,262,265,274,280,289,295,301,302],[60,87,156,204,219,222,262,265,274,280,289,295,296,305],[60,87,96,97,156,217,226,249,252,262,265,274,296,305,308,309,310],[60,95,97,156,217],[50,60,61,78,79,94,95,96,156,218],[50,60,95,156],[78,94,96,219,222,226],[56,60,78,94,97,217,219],[60,94,96,97,222],[50,60,79,95,96,97,217,218,224],[222],[94],[60,97],[222,301]],"referencedMap":[[377,1],[378,2],[382,3],[376,4],[387,5],[383,6],[386,7],[384,6],[381,8],[391,9],[392,6],[393,10],[385,6],[389,11],[388,12],[394,6],[380,6],[379,6],[395,6],[398,13],[399,6],[397,6],[400,14],[390,15],[401,4],[275,16],[396,6],[181,6],[281,6],[285,17],[283,18],[286,19],[288,20],[289,21],[287,22],[284,23],[282,24],[292,25],[291,6],[295,26],[294,27],[293,28],[290,6],[297,29],[298,30],[243,31],[241,32],[242,33],[169,34],[175,35],[174,36],[172,37],[70,38],[68,6],[72,39],[64,40],[77,41],[78,42],[76,43],[63,44],[61,45],[62,46],[71,47],[67,48],[74,49],[66,50],[75,51],[165,52],[166,53],[51,6],[50,6],[52,6],[180,54],[266,6],[190,55],[189,56],[187,56],[188,56],[280,57],[54,58],[55,59],[53,58],[315,60],[269,61],[273,61],[271,61],[268,6],[317,62],[318,6],[313,6],[319,6],[320,6],[321,6],[322,63],[324,64],[325,6],[326,6],[327,6],[316,6],[110,65],[111,65],[113,66],[114,67],[115,68],[116,69],[117,70],[118,71],[119,72],[120,73],[121,74],[122,75],[123,75],[125,76],[124,77],[126,76],[127,78],[128,79],[112,80],[162,6],[129,81],[130,82],[131,83],[163,84],[132,85],[133,86],[134,87],[135,88],[136,89],[137,90],[138,91],[139,92],[140,93],[141,94],[142,94],[143,95],[144,96],[146,97],[145,98],[147,99],[148,100],[149,6],[150,101],[151,102],[152,103],[153,104],[154,105],[155,106],[156,107],[157,108],[158,109],[159,110],[160,111],[161,112],[328,6],[329,6],[314,113],[330,6],[355,114],[356,115],[331,116],[334,116],[353,114],[354,114],[344,114],[343,117],[341,114],[336,114],[349,114],[347,114],[351,114],[335,114],[348,114],[352,114],[337,114],[338,114],[350,114],[332,114],[339,114],[340,114],[342,114],[346,114],[357,118],[345,114],[333,114],[370,119],[369,6],[364,118],[366,120],[365,118],[358,118],[359,118],[361,118],[363,118],[367,120],[368,120],[360,120],[362,120],[308,121],[307,6],[371,6],[372,6],[323,6],[373,6],[374,122],[375,123],[106,6],[274,124],[263,125],[265,126],[264,127],[232,128],[229,129],[228,6],[230,130],[231,131],[245,130],[244,132],[246,133],[227,6],[272,61],[270,134],[255,135],[253,6],[262,136],[257,137],[256,138],[259,139],[261,140],[254,141],[258,137],[260,139],[310,6],[234,6],[97,142],[94,143],[93,144],[79,6],[214,145],[212,146],[209,147],[211,148],[217,149],[108,150],[109,151],[105,24],[216,152],[213,153],[205,154],[164,155],[210,6],[208,156],[207,157],[107,158],[206,159],[215,160],[305,6],[252,6],[223,6],[225,6],[198,161],[196,162],[194,161],[197,163],[73,6],[195,164],[69,6],[279,165],[278,166],[277,167],[276,168],[312,76],[183,169],[178,170],[203,171],[191,24],[193,172],[199,173],[192,174],[201,175],[202,176],[200,177],[179,178],[186,179],[185,180],[177,181],[173,182],[171,24],[204,183],[182,184],[184,185],[176,186],[170,187],[168,160],[167,6],[224,6],[89,188],[233,189],[247,189],[57,6],[90,190],[58,191],[85,6],[60,192],[80,193],[88,194],[87,194],[82,195],[83,196],[220,197],[56,6],[221,198],[86,199],[81,200],[59,201],[84,6],[240,6],[238,202],[236,203],[237,204],[235,6],[95,6],[98,205],[101,206],[102,207],[99,208],[100,206],[104,209],[103,205],[309,210],[9,6],[10,6],[13,6],[12,6],[2,6],[14,6],[15,6],[16,6],[17,6],[18,6],[19,6],[20,6],[21,6],[3,6],[4,6],[25,6],[22,6],[23,6],[24,6],[26,6],[27,6],[28,6],[5,6],[29,6],[30,6],[31,6],[32,6],[6,6],[36,6],[33,6],[34,6],[35,6],[37,6],[7,6],[38,6],[43,6],[44,6],[39,6],[40,6],[41,6],[42,6],[8,6],[48,6],[45,6],[46,6],[47,6],[1,6],[49,6],[11,6],[65,6],[239,6],[250,211],[92,211],[91,212],[267,213],[222,214],[249,215],[226,216],[248,217],[251,218],[296,219],[301,220],[302,221],[299,222],[300,223],[303,224],[304,224],[306,225],[311,226],[218,227],[219,228],[96,229]],"exportedModulesMap":[[377,1],[378,2],[382,3],[376,4],[387,5],[383,6],[386,7],[384,6],[381,8],[391,9],[392,6],[393,10],[385,6],[389,11],[388,12],[394,6],[380,6],[379,6],[395,6],[398,13],[399,6],[397,6],[400,14],[390,15],[401,4],[275,16],[396,6],[181,6],[281,6],[285,17],[283,18],[286,19],[288,20],[289,21],[287,22],[284,23],[282,24],[292,25],[291,6],[295,26],[294,27],[293,28],[290,6],[297,29],[298,30],[243,31],[241,32],[242,33],[169,34],[175,35],[174,36],[172,37],[70,38],[68,6],[72,39],[64,40],[77,41],[78,42],[76,43],[63,44],[61,45],[62,46],[71,47],[67,48],[74,49],[66,50],[75,51],[165,52],[166,53],[51,6],[50,6],[52,6],[180,54],[266,6],[190,55],[189,56],[187,56],[188,56],[280,57],[54,58],[55,59],[53,58],[315,60],[269,61],[273,61],[271,61],[268,6],[317,62],[318,6],[313,6],[319,6],[320,6],[321,6],[322,63],[324,64],[325,6],[326,6],[327,6],[316,6],[110,65],[111,65],[113,66],[114,67],[115,68],[116,69],[117,70],[118,71],[119,72],[120,73],[121,74],[122,75],[123,75],[125,76],[124,77],[126,76],[127,78],[128,79],[112,80],[162,6],[129,81],[130,82],[131,83],[163,84],[132,85],[133,86],[134,87],[135,88],[136,89],[137,90],[138,91],[139,92],[140,93],[141,94],[142,94],[143,95],[144,96],[146,97],[145,98],[147,99],[148,100],[149,6],[150,101],[151,102],[152,103],[153,104],[154,105],[155,106],[156,107],[157,108],[158,109],[159,110],[160,111],[161,112],[328,6],[329,6],[314,113],[330,6],[355,114],[356,115],[331,116],[334,116],[353,114],[354,114],[344,114],[343,117],[341,114],[336,114],[349,114],[347,114],[351,114],[335,114],[348,114],[352,114],[337,114],[338,114],[350,114],[332,114],[339,114],[340,114],[342,114],[346,114],[357,118],[345,114],[333,114],[370,119],[369,6],[364,118],[366,120],[365,118],[358,118],[359,118],[361,118],[363,118],[367,120],[368,120],[360,120],[362,120],[308,121],[307,6],[371,6],[372,6],[323,6],[373,6],[374,122],[375,123],[106,6],[274,124],[263,125],[265,126],[264,127],[232,128],[229,129],[228,6],[230,130],[231,131],[245,130],[244,132],[246,133],[227,6],[272,61],[270,134],[255,135],[253,6],[262,136],[257,137],[256,138],[259,139],[261,140],[254,141],[258,137],[260,139],[310,6],[234,6],[97,142],[94,143],[93,144],[79,6],[214,145],[212,146],[209,147],[211,148],[217,149],[108,150],[109,151],[105,24],[216,152],[213,153],[205,154],[164,155],[210,6],[208,156],[207,157],[107,158],[206,159],[215,160],[305,6],[252,6],[223,6],[225,6],[198,161],[196,162],[194,161],[197,163],[73,6],[195,164],[69,6],[279,165],[278,166],[277,167],[276,168],[312,76],[183,169],[178,170],[203,171],[191,24],[193,172],[199,173],[192,174],[201,175],[202,176],[200,177],[179,178],[186,179],[185,180],[177,181],[173,182],[171,24],[204,183],[182,184],[184,185],[176,186],[170,187],[168,160],[167,6],[224,6],[89,188],[233,189],[247,189],[57,6],[90,190],[58,191],[85,6],[60,192],[80,193],[88,194],[87,194],[82,195],[83,196],[220,197],[56,6],[221,198],[86,199],[81,200],[59,201],[84,6],[240,6],[238,202],[236,203],[237,204],[235,6],[95,6],[98,205],[101,206],[102,207],[99,208],[100,206],[104,209],[103,205],[309,210],[9,6],[10,6],[13,6],[12,6],[2,6],[14,6],[15,6],[16,6],[17,6],[18,6],[19,6],[20,6],[21,6],[3,6],[4,6],[25,6],[22,6],[23,6],[24,6],[26,6],[27,6],[28,6],[5,6],[29,6],[30,6],[31,6],[32,6],[6,6],[36,6],[33,6],[34,6],[35,6],[37,6],[7,6],[38,6],[43,6],[44,6],[39,6],[40,6],[41,6],[42,6],[8,6],[48,6],[45,6],[46,6],[47,6],[1,6],[49,6],[11,6],[65,6],[239,6],[250,211],[92,211],[91,212],[267,230],[222,231],[249,232],[226,233],[248,234],[251,235],[296,236],[301,236],[302,237],[218,227],[219,228],[96,229]],"semanticDiagnosticsPerFile":[377,378,382,376,387,383,386,384,381,391,392,393,385,389,388,394,380,379,395,398,399,397,400,390,401,275,396,181,281,285,283,286,288,289,287,284,282,292,291,295,294,293,290,297,298,243,241,242,169,175,174,172,70,68,72,64,77,78,76,63,61,62,71,67,74,66,75,165,166,51,50,52,180,266,190,189,187,188,280,54,55,53,315,269,273,271,268,317,318,313,319,320,321,322,324,325,326,327,316,110,111,113,114,115,116,117,118,119,120,121,122,123,125,124,126,127,128,112,162,129,130,131,163,132,133,134,135,136,137,138,139,140,141,142,143,144,146,145,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,328,329,314,330,355,356,331,334,353,354,344,343,341,336,349,347,351,335,348,352,337,338,350,332,339,340,342,346,357,345,333,370,369,364,366,365,358,359,361,363,367,368,360,362,308,307,371,372,323,373,374,375,106,274,263,265,264,232,229,228,230,231,245,244,246,227,272,270,255,253,262,257,256,259,261,254,258,260,310,234,97,94,93,79,214,212,209,211,217,108,109,105,216,213,205,164,210,208,207,107,206,215,305,252,223,225,198,196,194,197,73,195,69,279,278,277,276,312,183,178,203,191,193,199,192,201,202,200,179,186,185,177,173,171,204,182,184,176,170,168,167,224,89,233,247,57,90,58,85,60,80,88,87,82,83,220,56,221,86,81,59,84,240,238,236,237,235,95,98,101,102,99,100,104,103,309,9,10,13,12,2,14,15,16,17,18,19,20,21,3,4,25,22,23,24,26,27,28,5,29,30,31,32,6,36,33,34,35,37,7,38,43,44,39,40,41,42,8,48,45,46,47,1,49,11,65,239,250,92,91,267,222,249,226,248,251,296,301,302,299,300,303,304,306,311,218,219,96],"latestChangedDtsFile":"./test/storage.spec.d.ts"},"version":"4.9.5"}
\ No newline at end of file
diff --git a/node_modules/helia/src/helia.ts b/node_modules/helia/src/helia.ts
index deb41cc..bf2edff 100644
--- a/node_modules/helia/src/helia.ts
+++ b/node_modules/helia/src/helia.ts
@@ -60,7 +60,7 @@ export class HeliaImpl implements Helia {
     })
 
     if (init.libp2p != null) {
-      this.#bitswap = createBitswap(libp2p, blockstore, {
+      this.#bitswap = init.bitswap ?? createBitswap(libp2p, blockstore, {
         hashLoader: {
           getHasher: async (codecOrName: string | number) => {
             const hasher = hashers.find(hasher => {
diff --git a/node_modules/helia/src/index.ts b/node_modules/helia/src/index.ts
index 9b49d0e..a03f244 100644
--- a/node_modules/helia/src/index.ts
+++ b/node_modules/helia/src/index.ts
@@ -32,6 +32,7 @@ import type { Datastore } from 'interface-datastore'
 import type { CID } from 'multiformats/cid'
 import type { MultihashHasher } from 'multiformats/hashes/interface'
 import { HeliaImpl } from './helia.js'
+import type { Bitswap } from 'ipfs-bitswap'
 
 /**
  * DAGWalkers take a block and yield CIDs encoded in that block
@@ -50,6 +51,11 @@ export interface HeliaInit {
    */
   libp2p?: Libp2p
 
+  /**
+   * An optional custom bitswap implementation
+   */
+  bitswap?: Bitswap
+
   /**
    * The blockstore is where blocks are stored
    */
diff --git a/node_modules/helia/src/src/helia.ts b/node_modules/helia/src/src/helia.ts
new file mode 100644
index 0000000..bf2edff
--- /dev/null
+++ b/node_modules/helia/src/src/helia.ts
@@ -0,0 +1,133 @@
+import type { GCOptions, Helia } from '@helia/interface'
+import type { Libp2p } from '@libp2p/interface-libp2p'
+import type { Datastore } from 'interface-datastore'
+import type { CID } from 'multiformats/cid'
+import { identity } from 'multiformats/hashes/identity'
+import { sha256, sha512 } from 'multiformats/hashes/sha2'
+import type { MultihashHasher } from 'multiformats/hashes/interface'
+import type { HeliaInit } from '.'
+import { Bitswap, createBitswap } from 'ipfs-bitswap'
+import { BlockStorage } from './storage.js'
+import type { Pins } from '@helia/interface/pins'
+import { PinsImpl } from './pins.js'
+import { assertDatastoreVersionIsCurrent } from './utils/datastore-version.js'
+import drain from 'it-drain'
+import { CustomProgressEvent } from 'progress-events'
+import { MemoryDatastore } from 'datastore-core'
+import { MemoryBlockstore } from 'blockstore-core'
+import { logger } from '@libp2p/logger'
+
+const log = logger('helia')
+
+export class HeliaImpl implements Helia {
+  public libp2p: Libp2p
+  public blockstore: BlockStorage
+  public datastore: Datastore
+  public pins: Pins
+
+  #bitswap?: Bitswap
+
+  constructor (init: HeliaInit) {
+    const hashers: MultihashHasher[] = [
+      sha256,
+      sha512,
+      identity,
+      ...(init.hashers ?? [])
+    ]
+
+    const datastore = init.datastore ?? new MemoryDatastore()
+    const blockstore = init.blockstore ?? new MemoryBlockstore()
+
+    // @ts-expect-error incomplete libp2p implementation
+    const libp2p = init.libp2p ?? new Proxy<Libp2p>({}, {
+      get (_, prop) {
+        const noop = (): void => {}
+        const noops = ['start', 'stop']
+
+        if (noops.includes(prop.toString())) {
+          return noop
+        }
+
+        if (prop === 'isProxy') {
+          return true
+        }
+
+        throw new Error('Please configure Helia with a libp2p instance')
+      },
+      set () {
+        throw new Error('Please configure Helia with a libp2p instance')
+      }
+    })
+
+    if (init.libp2p != null) {
+      this.#bitswap = init.bitswap ?? createBitswap(libp2p, blockstore, {
+        hashLoader: {
+          getHasher: async (codecOrName: string | number) => {
+            const hasher = hashers.find(hasher => {
+              return hasher.code === codecOrName || hasher.name === codecOrName
+            })
+
+            if (hasher != null) {
+              return await Promise.resolve(hasher)
+            }
+
+            throw new Error(`Could not load hasher for code/name "${codecOrName}"`)
+          }
+        }
+      })
+    }
+
+    this.pins = new PinsImpl(datastore, blockstore, init.dagWalkers ?? [])
+
+    this.libp2p = libp2p
+    this.blockstore = new BlockStorage(blockstore, this.pins, {
+      bitswap: this.#bitswap,
+      holdGcLock: init.holdGcLock
+    })
+    this.datastore = datastore
+  }
+
+  async start (): Promise<void> {
+    await assertDatastoreVersionIsCurrent(this.datastore)
+
+    await this.#bitswap?.start()
+    await this.libp2p.start()
+  }
+
+  async stop (): Promise<void> {
+    await this.libp2p.stop()
+    await this.#bitswap?.stop()
+  }
+
+  async gc (options: GCOptions = {}): Promise<void> {
+    const releaseLock = await this.blockstore.lock.writeLock()
+
+    try {
+      const helia = this
+      const blockstore = this.blockstore.unwrap()
+
+      log('gc start')
+
+      await drain(blockstore.deleteMany((async function * () {
+        for await (const { cid } of blockstore.getAll()) {
+          try {
+            if (await helia.pins.isPinned(cid, options)) {
+              continue
+            }
+
+            yield cid
+
+            options.onProgress?.(new CustomProgressEvent<CID>('helia:gc:deleted', cid))
+          } catch (err) {
+            log.error('Error during gc', err)
+            options.onProgress?.(new CustomProgressEvent<Error>('helia:gc:error', err))
+          }
+        }
+      }())))
+    } finally {
+      releaseLock()
+    }
+
+    log('gc finished')
+  }
+}
diff --git a/node_modules/helia/src/src/index.ts b/node_modules/helia/src/src/index.ts
new file mode 100644
index 0000000..a03f244
--- /dev/null
+++ b/node_modules/helia/src/src/index.ts
@@ -0,0 +1,117 @@
+/**
+ * @packageDocumentation
+ *
+ * Create a Helia node.
+ *
+ * @example
+ *
+ * ```typescript
+ * import { createLibp2p } from 'libp2p'
+ * import { MemoryDatastore } from 'datastore-core'
+ * import { MemoryBlockstore } from 'blockstore-core'
+ * import { createHelia } from 'helia'
+ * import { unixfs } from '@helia/unixfs'
+ * import { CID } from 'multiformats/cid'
+ *
+ * const node = await createHelia({
+ *   blockstore: new MemoryBlockstore(),
+ *   datastore: new MemoryDatastore(),
+ *   libp2p: await createLibp2p({
+ *     //... libp2p options
+ *   })
+ * })
+ * const fs = unixfs(node)
+ * fs.cat(CID.parse('bafyFoo'))
+ * ```
+ */
+
+import type { Helia } from '@helia/interface'
+import type { Libp2p } from '@libp2p/interface-libp2p'
+import type { Blockstore } from 'interface-blockstore'
+import type { Datastore } from 'interface-datastore'
+import type { CID } from 'multiformats/cid'
+import type { MultihashHasher } from 'multiformats/hashes/interface'
+import { HeliaImpl } from './helia.js'
+import type { Bitswap } from 'ipfs-bitswap'
+
+/**
+ * DAGWalkers take a block and yield CIDs encoded in that block
+ */
+export interface DAGWalker {
+  codec: number
+  walk: (block: Uint8Array) => AsyncGenerator<CID, void, undefined>
+}
+
+/**
+ * Options used to create a Helia node.
+ */
+export interface HeliaInit {
+  /**
+   * A libp2p node is required to perform network operations
+   */
+  libp2p?: Libp2p
+
+  /**
+   * An optional custom bitswap implementation
+   */
+  bitswap?: Bitswap
+
+  /**
+   * The blockstore is where blocks are stored
+   */
+  blockstore?: Blockstore
+
+  /**
+   * The datastore is where data is stored
+   */
+  datastore?: Datastore
+
+  /**
+   * By default sha256, sha512 and identity hashes are supported for
+   * bitswap operations. To bitswap blocks with CIDs using other hashes
+   * pass appropriate MultihashHashers here.
+   */
+  hashers?: MultihashHasher[]
+
+  /**
+   * In order to pin CIDs that correspond to a DAG, it's necessary to know
+   * how to traverse that DAG.  DAGWalkers take a block and yield any CIDs
+   * encoded within that block.
+   */
+  dagWalkers?: DAGWalker[]
+
+  /**
+   * Pass `false` to not start the Helia node
+   */
+  start?: boolean
+
+  /**
+   * Garbage collection requires preventing blockstore writes during searches
+   * for unpinned blocks as DAGs are typically pinned after they've been
+   * imported - without locking this could lead to the deletion of blocks while
+   * they are being added to the blockstore.
+   *
+   * By default this lock is held on the main process (e.g. node cluster's
+   * primary process, the renderer thread in browsers) and other processes will
+   * contact the main process for access (worker processes in node cluster,
+   * webworkers in the browser).
+   *
+   * If Helia is being run wholly in a non-primary process, with no other process
+   * expected to access the blockstore (e.g. being run in the background in a
+   * webworker), pass true here to hold the gc lock in this process.
+   */
+  holdGcLock?: boolean
+}
+
+/**
+ * Create and return a Helia node
+ */
+export async function createHelia (init: HeliaInit = {}): Promise<Helia> {
+  const helia = new HeliaImpl(init)
+
+  if (init.start !== false) {
+    await helia.start()
+  }
+
+  return helia
+}
diff --git a/node_modules/helia/src/src/pins.ts b/node_modules/helia/src/src/pins.ts
new file mode 100644
index 0000000..ca53f65
--- /dev/null
+++ b/node_modules/helia/src/src/pins.ts
@@ -0,0 +1,238 @@
+import type { AddOptions, IsPinnedOptions, LsOptions, Pin, Pins, RmOptions } from '@helia/interface/pins'
+import { Datastore, Key } from 'interface-datastore'
+import { CID, Version } from 'multiformats/cid'
+import * as cborg from 'cborg'
+import { base36 } from 'multiformats/bases/base36'
+import type { Blockstore } from 'interface-blockstore'
+import PQueue from 'p-queue'
+import type { AbortOptions } from '@libp2p/interfaces'
+import { equals as uint8ArrayEquals } from 'uint8arrays/equals'
+import defer from 'p-defer'
+import type { DAGWalker } from './index.js'
+import { cborWalker, dagPbWalker, jsonWalker, rawWalker } from './utils/dag-walkers.js'
+
+const DEFAULT_DAG_WALKERS = [
+  rawWalker,
+  dagPbWalker,
+  cborWalker,
+  jsonWalker
+]
+
+interface DatastorePin {
+  /**
+   * 0 for a direct pin or an arbitrary (+ve, whole) number or Infinity
+   */
+  depth: number
+
+  /**
+   * User-specific metadata for the pin
+   */
+  metadata: Record<string, string | number | boolean>
+}
+
+interface DatastorePinnedBlock {
+  pinCount: number
+  pinnedBy: Uint8Array[]
+}
+
+const DATASTORE_PIN_PREFIX = '/pin/'
+const DATASTORE_BLOCK_PREFIX = '/pinned-block/'
+const DATASTORE_ENCODING = base36
+// const DAG_WALK_MAX_QUEUE_LENGTH = 10
+const DAG_WALK_QUEUE_CONCURRENCY = 1
+
+interface WalkDagOptions extends AbortOptions {
+  depth: number
+}
+
+function toDSKey (cid: CID): Key {
+  if (cid.version === 0) {
+    cid = cid.toV1()
+  }
+
+  return new Key(`${DATASTORE_PIN_PREFIX}${cid.toString(DATASTORE_ENCODING)}`)
+}
+
+export class PinsImpl implements Pins {
+  private readonly datastore: Datastore
+  private readonly blockstore: Blockstore
+  private dagWalkers: Record<number, DAGWalker>
+
+  constructor (datastore: Datastore, blockstore: Blockstore, dagWalkers: DAGWalker[]) {
+    this.datastore = datastore
+    this.blockstore = blockstore
+    this.dagWalkers = {}
+
+    ;[...DEFAULT_DAG_WALKERS, ...dagWalkers].forEach(dagWalker => {
+      this.dagWalkers[dagWalker.codec] = dagWalker
+    })
+  }
+
+  async add (cid: CID<unknown, number, number, Version>, options: AddOptions = {}): Promise<Pin> {
+    const pinKey = toDSKey(cid)
+
+    if (await this.datastore.has(pinKey)) {
+      throw new Error('Already pinned')
+    }
+
+    const depth = Math.round(options.depth ?? Infinity)
+
+    if (depth < 0) {
+      throw new Error('Depth must be greater than or equal to 0')
+    }
+
+    // use a queue to walk the DAG instead of recursion so we can traverse very large DAGs
+    const queue = new PQueue({
+      concurrency: DAG_WALK_QUEUE_CONCURRENCY
+    })
+    void queue.add(async () => {
+      await this.#walkDag(cid, queue, (pinnedBlock) => {
+        // do not update pinned block if this block is already pinned by this CID
+        if (pinnedBlock.pinnedBy.find(c => uint8ArrayEquals(c, cid.bytes)) != null) {
+          return
+        }
+
+        pinnedBlock.pinCount++
+        pinnedBlock.pinnedBy.push(cid.bytes)
+      }, {
+        ...options,
+        depth
+      })
+    })
+
+    // if a job in the queue errors, throw that error
+    const deferred = defer()
+
+    queue.on('error', (err) => {
+      queue.clear()
+      deferred.reject(err)
+    })
+
+    // wait for the queue to complete or error
+    await Promise.race([
+      queue.onIdle(),
+      deferred.promise
+    ])
+
+    const pin: DatastorePin = {
+      depth,
+      metadata: options.metadata ?? {}
+    }
+
+    await this.datastore.put(pinKey, cborg.encode(pin), options)
+
+    return {
+      cid,
+      ...pin
+    }
+  }
+
+  /**
+   * Walk the DAG behind the passed CID, ensure all blocks are present in the blockstore
+   * and update the pin count for them
+   */
+  async #walkDag (cid: CID, queue: PQueue, withPinnedBlock: (pinnedBlock: DatastorePinnedBlock) => void, options: WalkDagOptions): Promise<void> {
+    if (options.depth === -1) {
+      return
+    }
+
+    const dagWalker = this.dagWalkers[cid.code]
+
+    if (dagWalker == null) {
+      throw new Error(`No dag walker found for cid codec ${cid.code}`)
+    }
+
+    const block = await this.blockstore.get(cid)
+
+    await this.#updatePinnedBlock(cid, withPinnedBlock, options)
+
+    // walk dag, ensure all blocks are present
+    for await (const cid of dagWalker.walk(block)) {
+      void queue.add(async () => {
+        await this.#walkDag(cid, queue, withPinnedBlock, {
+          ...options,
+          depth: options.depth - 1
+        })
+      })
+    }
+  }
+
+  /**
+   * Update the pin count for the CID
+   */
+  async #updatePinnedBlock (cid: CID, withPinnedBlock: (pinnedBlock: DatastorePinnedBlock) => void, options: AbortOptions): Promise<void> {
+    const blockKey = new Key(`${DATASTORE_BLOCK_PREFIX}${DATASTORE_ENCODING.encode(cid.multihash.bytes)}`)
+
+    let pinnedBlock: DatastorePinnedBlock = {
+      pinCount: 0,
+      pinnedBy: []
+    }
+
+    try {
+      pinnedBlock = cborg.decode(await this.datastore.get(blockKey, options))
+    } catch (err: any) {
+      if (err.code !== 'ERR_NOT_FOUND') {
+        throw err
+      }
+    }
+
+    withPinnedBlock(pinnedBlock)
+
+    if (pinnedBlock.pinCount === 0) {
+      if (await this.datastore.has(blockKey)) {
+        await this.datastore.delete(blockKey)
+        return
+      }
+    }
+
+    await this.datastore.put(blockKey, cborg.encode(pinnedBlock), options)
+  }
+
+  async rm (cid: CID<unknown, number, number, Version>, options: RmOptions = {}): Promise<Pin> {
+    const pinKey = toDSKey(cid)
+    const buf = await this.datastore.get(pinKey, options)
+    const pin = cborg.decode(buf)
+
+    await this.datastore.delete(pinKey, options)
+
+    // use a queue to walk the DAG instead of recursion so we can traverse very large DAGs
+    const queue = new PQueue({
+      concurrency: DAG_WALK_QUEUE_CONCURRENCY
+    })
+    void queue.add(async () => {
+      await this.#walkDag(cid, queue, (pinnedBlock) => {
+        pinnedBlock.pinCount--
+        pinnedBlock.pinnedBy = pinnedBlock.pinnedBy.filter(c => uint8ArrayEquals(c, cid.bytes))
+      }, {
+        ...options,
+        depth: pin.depth
+      })
+    })
+    await queue.onIdle()
+
+    return {
+      cid,
+      ...pin
+    }
+  }
+
+  async * ls (options: LsOptions = {}): AsyncGenerator<Pin, void, undefined> {
+    for await (const { key, value } of this.datastore.query({
+      prefix: DATASTORE_PIN_PREFIX + (options.cid != null ? `${options.cid.toString(base36)}` : '')
+    }, options)) {
+      const cid = CID.parse(key.toString().substring(5), base36)
+      const pin = cborg.decode(value)
+
+      yield {
+        cid,
+        ...pin
+      }
+    }
+  }
+
+  async isPinned (cid: CID, options: IsPinnedOptions = {}): Promise<boolean> {
+    const blockKey = new Key(`${DATASTORE_BLOCK_PREFIX}${DATASTORE_ENCODING.encode(cid.multihash.bytes)}`)
+
+    return await this.datastore.has(blockKey, options)
+  }
+}
diff --git a/node_modules/helia/src/src/storage.ts b/node_modules/helia/src/src/storage.ts
new file mode 100644
index 0000000..3606b92
--- /dev/null
+++ b/node_modules/helia/src/src/storage.ts
@@ -0,0 +1,211 @@
+import filter from 'it-filter'
+import type { Blockstore } from 'interface-blockstore'
+import type { Blocks, Pair, DeleteManyBlocksProgressEvents, DeleteBlockProgressEvents, GetBlockProgressEvents, GetManyBlocksProgressEvents, PutManyBlocksProgressEvents, PutBlockProgressEvents, GetAllBlocksProgressEvents } from '@helia/interface/blocks'
+import type { Bitswap } from 'ipfs-bitswap'
+import type { CID } from 'multiformats/cid'
+import type { AbortOptions } from '@libp2p/interfaces'
+import type { AwaitIterable } from 'interface-store'
+import type { Mortice } from 'mortice'
+import createMortice from 'mortice'
+import type { Pins } from '@helia/interface/pins'
+import forEach from 'it-foreach'
+import { CustomProgressEvent, ProgressOptions } from 'progress-events'
+
+export interface BlockStorageInit {
+  holdGcLock?: boolean
+  bitswap?: Bitswap
+}
+
+export interface GetOptions extends AbortOptions {
+  progress?: (evt: Event) => void
+}
+
+/**
+ * BlockStorage is a hybrid blockstore that puts/gets blocks from a configured
+ * blockstore (that may be on disk, s3, or something else). If the blocks are
+ * not present Bitswap will be used to fetch them from network peers.
+ */
+export class BlockStorage implements Blocks {
+  public lock: Mortice
+  private readonly child: Blockstore
+  private readonly bitswap?: Bitswap
+  private readonly pins: Pins
+
+  /**
+   * Create a new BlockStorage
+   */
+  constructor (blockstore: Blockstore, pins: Pins, options: BlockStorageInit = {}) {
+    this.child = blockstore
+    this.bitswap = options.bitswap
+    this.pins = pins
+    this.lock = createMortice({
+      singleProcess: options.holdGcLock
+    })
+  }
+
+  unwrap (): Blockstore {
+    return this.child
+  }
+
+  /**
+   * Put a block to the underlying datastore
+   */
+  async put (cid: CID, block: Uint8Array, options: AbortOptions & ProgressOptions<PutBlockProgressEvents> = {}): Promise<CID> {
+    const releaseLock = await this.lock.readLock()
+
+    try {
+      if (await this.child.has(cid)) {
+        options.onProgress?.(new CustomProgressEvent<CID>('blocks:put:duplicate', cid))
+        return cid
+      }
+
+      if (this.bitswap?.isStarted() === true) {
+        options.onProgress?.(new CustomProgressEvent<CID>('blocks:put:bitswap:notify', cid))
+        this.bitswap.notify(cid, block, options)
+      }
+
+      options.onProgress?.(new CustomProgressEvent<CID>('blocks:put:blockstore:put', cid))
+
+      return await this.child.put(cid, block, options)
+    } finally {
+      releaseLock()
+    }
+  }
+
+  /**
+   * Put a multiple blocks to the underlying datastore
+   */
+  async * putMany (blocks: AwaitIterable<{ cid: CID, block: Uint8Array }>, options: AbortOptions & ProgressOptions<PutManyBlocksProgressEvents> = {}): AsyncIterable<CID> {
+    const releaseLock = await this.lock.readLock()
+
+    try {
+      const missingBlocks = filter(blocks, async ({ cid }) => {
+        const has = await this.child.has(cid)
+
+        if (has) {
+          options.onProgress?.(new CustomProgressEvent<CID>('blocks:put-many:duplicate', cid))
+        }
+
+        return !has
+      })
+
+      const notifyEach = forEach(missingBlocks, ({ cid, block }) => {
+        options.onProgress?.(new CustomProgressEvent<CID>('blocks:put-many:bitswap:notify', cid))
+        this.bitswap?.notify(cid, block, options)
+      })
+
+      options.onProgress?.(new CustomProgressEvent('blocks:put-many:blockstore:put-many'))
+      yield * this.child.putMany(notifyEach, options)
+    } finally {
+      releaseLock()
+    }
+  }
+
+  /**
+   * Get a block by cid
+   */
+  async get (cid: CID, options: AbortOptions & ProgressOptions<GetBlockProgressEvents> = {}): Promise<Uint8Array> {
+    const releaseLock = await this.lock.readLock()
+
+    try {
+      if (this.bitswap?.isStarted() != null && !(await this.child.has(cid))) {
+        options.onProgress?.(new CustomProgressEvent<CID>('blocks:get:bitswap:get', cid))
+        const block = await this.bitswap.want(cid, options)
+
+        options.onProgress?.(new CustomProgressEvent<CID>('blocks:get:blockstore:put', cid))
+        await this.child.put(cid, block, options)
+
+        return block
+      }
+
+      options.onProgress?.(new CustomProgressEvent<CID>('blocks:get:blockstore:get', cid))
+      return await this.child.get(cid, options)
+    } finally {
+      releaseLock()
+    }
+  }
+
+  /**
+   * Get multiple blocks back from an (async) iterable of cids
+   */
+  async * getMany (cids: AwaitIterable<CID>, options: AbortOptions & ProgressOptions<GetManyBlocksProgressEvents> = {}): AsyncIterable<Pair> {
+    const releaseLock = await this.lock.readLock()
+
+    try {
+      options.onProgress?.(new CustomProgressEvent('blocks:get-many:blockstore:get-many'))
+      yield * this.child.getMany(forEach(cids, async (cid) => {
+        if (this.bitswap?.isStarted() === true && !(await this.child.has(cid))) {
+          options.onProgress?.(new CustomProgressEvent<CID>('blocks:get-many:bitswap:get', cid))
+          const block = await this.bitswap.want(cid, options)
+          options.onProgress?.(new CustomProgressEvent<CID>('blocks:get-many:blockstore:put', cid))
+          await this.child.put(cid, block, options)
+        }
+      }))
+    } finally {
+      releaseLock()
+    }
+  }
+
+  /**
+   * Delete a block from the blockstore
+   */
+  async delete (cid: CID, options: AbortOptions & ProgressOptions<DeleteBlockProgressEvents> = {}): Promise<void> {
+    const releaseLock = await this.lock.writeLock()
+
+    try {
+      if (await this.pins.isPinned(cid)) {
+        throw new Error('CID was pinned')
+      }
+
+      options.onProgress?.(new CustomProgressEvent<CID>('blocks:delete:blockstore:delete', cid))
+      await this.child.delete(cid, options)
+    } finally {
+      releaseLock()
+    }
+  }
+
+  /**
+   * Delete multiple blocks from the blockstore
+   */
+  async * deleteMany (cids: AwaitIterable<CID>, options: AbortOptions & ProgressOptions<DeleteManyBlocksProgressEvents> = {}): AsyncIterable<CID> {
+    const releaseLock = await this.lock.writeLock()
+
+    try {
+      const storage = this
+
+      options.onProgress?.(new CustomProgressEvent('blocks:delete-many:blockstore:delete-many'))
+      yield * this.child.deleteMany((async function * () {
+        for await (const cid of cids) {
+          if (await storage.pins.isPinned(cid)) {
+            throw new Error('CID was pinned')
+          }
+
+          yield cid
+        }
+      }()), options)
+    } finally {
+      releaseLock()
+    }
+  }
+
+  async has (cid: CID, options: AbortOptions = {}): Promise<boolean> {
+    const releaseLock = await this.lock.readLock()
+
+    try {
+      return await this.child.has(cid, options)
+    } finally {
+      releaseLock()
+    }
+  }
+
+  async * getAll (options: AbortOptions & ProgressOptions<GetAllBlocksProgressEvents> = {}): AsyncIterable<Pair> {
+    const releaseLock = await this.lock.readLock()
+
+    try {
+      options.onProgress?.(new CustomProgressEvent('blocks:get-all:blockstore:get-many'))
+      yield * this.child.getAll(options)
+    } finally {
+      releaseLock()
+    }
+  }
+}
diff --git a/node_modules/helia/src/src/utils/dag-walkers.ts b/node_modules/helia/src/src/utils/dag-walkers.ts
new file mode 100644
index 0000000..989f29a
--- /dev/null
+++ b/node_modules/helia/src/src/utils/dag-walkers.ts
@@ -0,0 +1,169 @@
+/* eslint max-depth: ["error", 7] */
+
+import * as dagPb from '@ipld/dag-pb'
+import * as cborg from 'cborg'
+import { Type, Token } from 'cborg'
+import * as cborgJson from 'cborg/json'
+import type { DAGWalker } from '../index.js'
+import * as raw from 'multiformats/codecs/raw'
+import { CID } from 'multiformats'
+import { base64 } from 'multiformats/bases/base64'
+
+/**
+ * Dag walker for dag-pb CIDs
+ */
+export const dagPbWalker: DAGWalker = {
+  codec: dagPb.code,
+  async * walk (block) {
+    const node = dagPb.decode(block)
+
+    yield * node.Links.map(l => l.Hash)
+  }
+}
+
+/**
+ * Dag walker for raw CIDs
+ */
+export const rawWalker: DAGWalker = {
+  codec: raw.code,
+  async * walk () {
+    // no embedded CIDs in a raw block
+  }
+}
+
+// https://github.com/ipfs/go-ipfs/issues/3570#issuecomment-273931692
+const CID_TAG = 42
+
+/**
+ * Dag walker for dag-cbor CIDs. Does not actually use dag-cbor since
+ * all we are interested in is extracting the the CIDs from the block
+ * so we can just use cborg for that.
+ */
+export const cborWalker: DAGWalker = {
+  codec: 0x71,
+  async * walk (block) {
+    const cids: CID[] = []
+    const tags: cborg.TagDecoder[] = []
+    tags[CID_TAG] = (bytes) => {
+      if (bytes[0] !== 0) {
+        throw new Error('Invalid CID for CBOR tag 42; expected leading 0x00')
+      }
+
+      const cid = CID.decode(bytes.subarray(1)) // ignore leading 0x00
+
+      cids.push(cid)
+
+      return cid
+    }
+
+    cborg.decode(block, {
+      tags
+    })
+
+    yield * cids
+  }
+}
+
+/**
+ * Borrowed from @ipld/dag-json
+ */
+class DagJsonTokenizer extends cborgJson.Tokenizer {
+  private readonly tokenBuffer: cborg.Token[]
+
+  constructor (data: Uint8Array, options?: cborg.DecodeOptions) {
+    super(data, options)
+
+    this.tokenBuffer = []
+  }
+
+  done (): boolean {
+    return this.tokenBuffer.length === 0 && super.done()
+  }
+
+  _next (): cborg.Token {
+    if (this.tokenBuffer.length > 0) {
+      // @ts-expect-error https://github.com/Microsoft/TypeScript/issues/30406
+      return this.tokenBuffer.pop()
+    }
+    return super.next()
+  }
+
+  /**
+   * Implements rules outlined in https://github.com/ipld/specs/pull/356
+   */
+  next (): cborg.Token {
+    const token = this._next()
+
+    if (token.type === Type.map) {
+      const keyToken = this._next()
+      if (keyToken.type === Type.string && keyToken.value === '/') {
+        const valueToken = this._next()
+        if (valueToken.type === Type.string) { // *must* be a CID
+          const breakToken = this._next() // swallow the end-of-map token
+          if (breakToken.type !== Type.break) {
+            throw new Error('Invalid encoded CID form')
+          }
+          this.tokenBuffer.push(valueToken) // CID.parse will pick this up after our tag token
+          return new Token(Type.tag, 42, 0)
+        }
+        if (valueToken.type === Type.map) {
+          const innerKeyToken = this._next()
+          if (innerKeyToken.type === Type.string && innerKeyToken.value === 'bytes') {
+            const innerValueToken = this._next()
+            if (innerValueToken.type === Type.string) { // *must* be Bytes
+              for (let i = 0; i < 2; i++) {
+                const breakToken = this._next() // swallow two end-of-map tokens
+                if (breakToken.type !== Type.break) {
+                  throw new Error('Invalid encoded Bytes form')
+                }
+              }
+              const bytes = base64.decode(`m${innerValueToken.value}`)
+              return new Token(Type.bytes, bytes, innerValueToken.value.length)
+            }
+            this.tokenBuffer.push(innerValueToken) // bail
+          }
+          this.tokenBuffer.push(innerKeyToken) // bail
+        }
+        this.tokenBuffer.push(valueToken) // bail
+      }
+      this.tokenBuffer.push(keyToken) // bail
+    }
+    return token
+  }
+}
+
+/**
+ * Dag walker for dag-json CIDs. Does not actually use dag-json since
+ * all we are interested in is extracting the the CIDs from the block
+ * so we can just use cborg/json for that.
+ */
+export const jsonWalker: DAGWalker = {
+  codec: 0x0129,
+  async * walk (block) {
+    const cids: CID[] = []
+    const tags: cborg.TagDecoder[] = []
+    tags[CID_TAG] = (string) => {
+      const cid = CID.parse(string)
+
+      cids.push(cid)
+
+      return cid
+    }
+
+    cborgJson.decode(block, {
+      tags,
+      tokenizer: new DagJsonTokenizer(block, {
+        tags,
+        allowIndefinite: true,
+        allowUndefined: true,
+        allowNaN: true,
+        allowInfinity: true,
+        allowBigInt: true,
+        strict: false,
+        rejectDuplicateMapKeys: false
+      })
+    })
+
+    yield * cids
+  }
+}
diff --git a/node_modules/helia/src/src/utils/datastore-version.ts b/node_modules/helia/src/src/utils/datastore-version.ts
new file mode 100644
index 0000000..3b16b7d
--- /dev/null
+++ b/node_modules/helia/src/src/utils/datastore-version.ts
@@ -0,0 +1,23 @@
+import { Datastore, Key } from 'interface-datastore'
+import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string'
+import { toString as uint8ArrayToString } from 'uint8arrays/to-string'
+
+const DS_VERSION_KEY = new Key('/version')
+const CURRENT_VERSION = 1
+
+export async function assertDatastoreVersionIsCurrent (datastore: Datastore): Promise<void> {
+  if (!(await datastore.has(DS_VERSION_KEY))) {
+    await datastore.put(DS_VERSION_KEY, uint8ArrayFromString(`${CURRENT_VERSION}`))
+
+    return
+  }
+
+  const buf = await datastore.get(DS_VERSION_KEY)
+  const str = uint8ArrayToString(buf)
+  const version = parseInt(str, 10)
+
+  if (version !== CURRENT_VERSION) {
+    // TODO: write migrations when we break compatibility - for an example, see https://github.com/ipfs/js-ipfs-repo/tree/master/packages/ipfs-repo-migrations
+    throw new Error('Unknown datastore version, a datastore migration may be required')
+  }
+}
